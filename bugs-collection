=================================================
This is an automated collection of open reports in
the R-bugs repository.
=================================================

Directory:  Accuracy

none

Directory:  Add-ons

* PR# 974 *
Subject: Lattice: panel.superpose with ordered factor groups
From: John Maindonald <john.maindonald@anu.edu.au>
Date: Sat, 9 Jun 2001 11:08:51 +1000 (EST)
--The warning is standard S and R behaviour.
--Probably xyplot needs to avoid it (by unclassing?)
--Still there in lattice 0.3-0.
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 974 <==
From postmaster@franz.stat.wisc.edu  Sat Jun  9 03:09:10 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id DAA20814
	for <r-bugs@biostat.ku.dk>; Sat, 9 Jun 2001 03:09:09 +0200 (MET DST)
Received: from leonard.anu.edu.au (really [150.203.2.15]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m158XFN-000JbdC@franz.stat.wisc.edu> (Debian Smail3.2.0.111)
	for <r-bugs@r-project.org>; Fri, 8 Jun 2001 20:09:01 -0500 (CDT) 
Received: (from u9801539@localhost)
	by leonard.anu.edu.au (8.9.3/8.9.3) id LAA01081;
	Sat, 9 Jun 2001 11:08:51 +1000 (EST)
Date: Sat, 9 Jun 2001 11:08:51 +1000 (EST)
From: John Maindonald <john.maindonald@anu.edu.au>
Message-Id: <200106090108.LAA01081@leonard.anu.edu.au>
To: r-bugs@r-project.org
Subject: Lattice: panel.superpose with ordered factor groups
Cc: deepayan@stat.wisc.edu


#       r-bugs@r-project.org
The panel.superpose() function for xyplot() complains when 
the groups parameter is set to be an ordered factor.

> library(mass)
> data(cabbages)
> library(lattice)
> xyplot(HeadWt~VitC|Cult, panel=panel.superpose,
+   groups=Date, data=cabbages)
> cabbages$Date <- ordered(cabbages$Date)  # Make Date an ordered factor
> xyplot(HeadWt~VitC|Cult, panel=panel.superpose,
+   groups=Date, data=cabbages)
Warning messages: 
1: Incompatible methods ("Ops.ordered", "Ops.factor") for "==" 
2: Incompatible methods ("Ops.ordered", "Ops.factor") for "==" 
3: Incompatible methods ("Ops.ordered", "Ops.factor") for "==" 
4: Incompatible methods ("Ops.ordered", "Ops.factor") for "==" 
5: Incompatible methods ("Ops.ordered", "Ops.factor") for "==" 
6: Incompatible methods ("Ops.ordered", "Ops.factor") for "==" 

--please do not edit the information below--

Version:
 platform = i386-pc-mingw32
 arch = x86
 os = Win32
 system = x86, Win32
 status = 
 major = 1
 minor = 2.3
 year = 2001
 month = 04
 day = 26
 language = R

Windows ME 4.90 (build 3000)  

Search Path:
 .GlobalEnv, package:grid, package:lattice, package:mass, package:ctest, Autoloads, package:base
John Maindonald            email: john.maindonald@anu.edu.au        
phone : (6125)3998         fax   : (6125)5549 
Statistical Consulting Unit, Room 1194,
John Dedman Mathematical Sciences Building
(Centre for Mathematics & Its Applications.)

==> 974.audit <==
Sun Jun 17 09:39:36 2001	ripley	changed notes
Sun Jun 17 09:39:36 2001	ripley	foobar
Sun Jun 17 09:39:36 2001	ripley	moved from incoming to Add-ons
Sun Sep 30 15:13:56 2001	ripley	changed notes
Sun Sep 30 15:13:56 2001	ripley	foobar
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 981 *
Subject: read.xport() bug
From: abroman@jhu.edu
Date: Fri, 15 Jun 2001 00:25:54 +0200 (MET DST)
--confirmed on Windows and Solaris.
--Seems that file is not in the expected format
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 981 <==
From abroman@jhu.edu  Fri Jun 15 00:25:55 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id AAA17758
	for <R-bugs@biostat.ku.dk>; Fri, 15 Jun 2001 00:25:54 +0200 (MET DST)
Date: Fri, 15 Jun 2001 00:25:54 +0200 (MET DST)
From: abroman@jhu.edu
Message-Id: <200106142225.AAA17758@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: read.xport() bug

Full_Name: Aimee Teo Broman
Version: 1.23
OS: Windows 98
Submission from: (NULL) (162.129.145.115)


When I use the read.xport() function in the foreign library, the Rgui shuts
down.   My xport file was created in SAS ver.6, using the xport engine in proc
copy. 

R commands:
1. library(foreign)
2. lookup.xport("fdt.tpt")  <-- this works fine.
3. read.xport("fdt.tpt")  <-- this produces a window that says "This program has
performed an illegal operation and will be shut down."  The details are shown
below:

RGUI caused an invalid page fault in
module FOREIGN.DLL at 017f:14c727e7.
Registers:
EAX=00000000 CS=017f EIP=14c727e7 EFLGS=00010246
EBX=034a1320 SS=0187 ESP=0270f404 EBP=0270f46c
ECX=00000000 DS=0187 ESI=00000006 FS=1847
EDX=034a1338 ES=0187 EDI=034a1335 GS=0000
Bytes at CS:EIP:
c6 00 00 83 c4 fc 83 c4 10 39 d8 75 09 a1 48 02 
Stack dump:
034a1320 00000020 034b5a50 78037ce8 02c5cf68 00000002 0270f4ac 004250ae 00585140
02c5c728 0270f46c 00000079 00000001 0348c150 0348e9d0 78037ce8 

The date on the foreign.zip file is 18-May-2001, so I believe I have the most
recent version of both R and the foreign package.  I would call this an
intermittant problem, except that I have this problem more frequently than not.
Yesterday it was working, but today it is shutting down the gui again.  Any help
would be appreciated.

thanks much,
Aimee Broman

==> 981.followup.1 <==
From ripley@stats.ox.ac.uk  Fri Jun 15 08:48:44 2001
Received: from toucan.stats.ox.ac.uk (toucan.stats.ox.ac.uk [163.1.20.20])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id IAA19206
	for <R-bugs@biostat.ku.dk>; Fri, 15 Jun 2001 08:48:43 +0200 (MET DST)
Received: from max153.public.ox.ac.uk (max153.public.ox.ac.uk [192.76.27.153])
	by toucan.stats.ox.ac.uk (8.9.0/8.9.0) with ESMTP id HAA03707;
	Fri, 15 Jun 2001 07:48:34 +0100 (BST)
Date: Fri, 15 Jun 2001 07:48:39 +0100 (BST)
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Sender: <ripley@auk.stats>
To: <abroman@jhu.edu>
cc: <R-bugs@biostat.ku.dk>
Subject: Re: [Rd] read.xport() bug (PR#981)
In-Reply-To: <200106142225.AAA17768@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.31.0106150743370.21768-100000@auk.stats>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

All packages have a version number, in their DESCRIPTION file or via

package.description("foreign")$Version

I suspect this is 0.4-3, but please confirm.

We do need a reproducible example to make any sense of this bug report, and
for that we need fdt.tpt.  Could you please attach that file to your reply.


On Fri, 15 Jun 2001 abroman@jhu.edu wrote:

> Full_Name: Aimee Teo Broman
> Version: 1.23
> OS: Windows 98
> Submission from: (NULL) (162.129.145.115)
>
>
> When I use the read.xport() function in the foreign library, the Rgui shuts
> down.   My xport file was created in SAS ver.6, using the xport engine in proc
> copy.
>
> R commands:
> 1. library(foreign)
> 2. lookup.xport("fdt.tpt")  <-- this works fine.
> 3. read.xport("fdt.tpt")  <-- this produces a window that says "This program has
> performed an illegal operation and will be shut down."  The details are shown
> below:
>
> RGUI caused an invalid page fault in
> module FOREIGN.DLL at 017f:14c727e7.
> Registers:
> EAX=00000000 CS=017f EIP=14c727e7 EFLGS=00010246
> EBX=034a1320 SS=0187 ESP=0270f404 EBP=0270f46c
> ECX=00000000 DS=0187 ESI=00000006 FS=1847
> EDX=034a1338 ES=0187 EDI=034a1335 GS=0000
> Bytes at CS:EIP:
> c6 00 00 83 c4 fc 83 c4 10 39 d8 75 09 a1 48 02
> Stack dump:
> 034a1320 00000020 034b5a50 78037ce8 02c5cf68 00000002 0270f4ac 004250ae 00585140
> 02c5c728 0270f46c 00000079 00000001 0348c150 0348e9d0 78037ce8
>
> The date on the foreign.zip file is 18-May-2001, so I believe I have the most
> recent version of both R and the foreign package.  I would call this an
> intermittant problem, except that I have this problem more frequently than not.
> Yesterday it was working, but today it is shutting down the gui again.  Any help
> would be appreciated.
>
> thanks much,
> Aimee Broman
>
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


==> 981.followup.2 <==
From abroman@dcpom.med.jhu.edu  Fri Jun 15 15:50:25 2001
Received: from dcpom.med.jhu.edu ([162.129.145.30])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id PAA26162
	for <R-bugs@biostat.ku.dk>; Fri, 15 Jun 2001 15:50:24 +0200 (MET DST)
Received: from localhost (abroman@localhost)
	by dcpom.med.jhu.edu (8.9.1b+Sun/8.9.1) with ESMTP id JAA29889;
	Fri, 15 Jun 2001 09:50:38 -0400 (EDT)
Date: Fri, 15 Jun 2001 09:50:38 -0400 (EDT)
From: Aimee Teo Broman <abroman@dcpom.med.jhu.edu>
Reply-To: abroman@jhu.edu
To: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
cc: abroman@jhu.edu, R-bugs@biostat.ku.dk
Subject: Re: [Rd] read.xport() bug (PR#981)
In-Reply-To: <Pine.GSO.4.31.0106150743370.21768-100000@auk.stats>
Message-ID: <Pine.GSO.4.05.10106150926320.29736-101000@dcpom.med.jhu.edu>
MIME-Version: 1.0
Content-Type: MULTIPART/MIXED; BOUNDARY="-559023410-851401618-992613038=:29850"

  This message is in MIME format.  The first part should be readable text,
  while the remaining parts are likely unreadable without MIME-aware tools.
  Send mail to mime@docserver.cac.washington.edu for more info.

---559023410-851401618-992613038=:29850
Content-Type: TEXT/PLAIN; charset=US-ASCII



Yes, the version of the foreign package is 0.4-3 .

I've found that the problem is with a particular variable in the
dataset--a character variable containing names.  If I remove this
variable from the rest of the dataset, the transfer file reads in
fine.  I attach a transfer file with just the name variable, in the
case that you'd like to take a look at it.

Thanks very much,
Aimee

On Fri, 15 Jun 2001, Prof Brian D Ripley wrote:

> All packages have a version number, in their DESCRIPTION file or via
> 
> package.description("foreign")$Version
> 
> I suspect this is 0.4-3, but please confirm.
> 
> We do need a reproducible example to make any sense of this bug report, and
> for that we need fdt.tpt.  Could you please attach that file to your reply.
> 
> 
> On Fri, 15 Jun 2001 abroman@jhu.edu wrote:
> 
> > Full_Name: Aimee Teo Broman
> > Version: 1.23
> > OS: Windows 98
> > Submission from: (NULL) (162.129.145.115)
> >
> >
> > When I use the read.xport() function in the foreign library, the Rgui shuts
> > down.   My xport file was created in SAS ver.6, using the xport engine in proc
> > copy.
> >
> > R commands:
> > 1. library(foreign)
> > 2. lookup.xport("fdt.tpt")  <-- this works fine.
> > 3. read.xport("fdt.tpt")  <-- this produces a window that says "This program has
> > performed an illegal operation and will be shut down."  The details are shown
> > below:
> >
> > RGUI caused an invalid page fault in
> > module FOREIGN.DLL at 017f:14c727e7.
> > Registers:
> > EAX=00000000 CS=017f EIP=14c727e7 EFLGS=00010246
> > EBX=034a1320 SS=0187 ESP=0270f404 EBP=0270f46c
> > ECX=00000000 DS=0187 ESI=00000006 FS=1847
> > EDX=034a1338 ES=0187 EDI=034a1335 GS=0000
> > Bytes at CS:EIP:
> > c6 00 00 83 c4 fc 83 c4 10 39 d8 75 09 a1 48 02
> > Stack dump:
> > 034a1320 00000020 034b5a50 78037ce8 02c5cf68 00000002 0270f4ac 004250ae 00585140
> > 02c5c728 0270f46c 00000079 00000001 0348c150 0348e9d0 78037ce8
> >
> > The date on the foreign.zip file is 18-May-2001, so I believe I have the most
> > recent version of both R and the foreign package.  I would call this an
> > intermittant problem, except that I have this problem more frequently than not.
> > Yesterday it was working, but today it is shutting down the gui again.  Any help
> > would be appreciated.
> >
> > thanks much,
> > Aimee Broman
> >
> > -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> > r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> > Send "info", "help", or "[un]subscribe"
> > (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> > _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
> >
> 
> -- 
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272860 (secr)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> 
> 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
dana center for preventive ophthalmology    phone:(410)614-2483
600 n wolfe st. suite wilmer 129              fax:(410)955-0096
baltimore, md 21287

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


---559023410-851401618-992613038=:29850
Content-Type: APPLICATION/octet-stream; name="fdt1.tpt"
Content-Transfer-Encoding: BASE64
Content-ID: <Pine.GSO.4.05.10106150950380.29850@dcpom.med.jhu.edu>
Content-Description: 
Content-Disposition: attachment; filename="fdt1.tpt"

SEVBREVSIFJFQ09SRCoqKioqKipMSUJSQVJZIEhFQURFUiBSRUNPUkQhISEh
ISEhMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwICBTQVMgICAgIFNB
UyAgICAgU0FTTElCICA2LjEyICAgIFNvbGFyaXMgICAgICAgICAgICAgICAg
ICAgICAgICAgMTVKVU4wMTowOTo0NToxOTE1SlVOMDE6MDk6NDU6MTkgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgSEVBREVSIFJFQ09SRCoqKioqKipNRU1CRVIgIEhF
QURFUiBSRUNPUkQhISEhISEhMDAwMDAwMDAwMDAwMDAwMDAxNjAwMDAwMDAw
MTQwICBIRUFERVIgUkVDT1JEKioqKioqKkRTQ1JQVFIgSEVBREVSIFJFQ09S
RCEhISEhISEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAgIFNBUyAg
ICAgQ0FUMSAgICBTQVNEQVRBIDYuMTIgICAgU29sYXJpcyAgICAgICAgICAg
ICAgICAgICAgICAgICAxNUpVTjAxOjA5OjQ1OjE5MTVKVU4wMTowOTo0NTox
OSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBIRUFERVIgUkVDT1JEKioqKioqKk5BTUVT
VFIgSEVBREVSIFJFQ09SRCEhISEhISEwMDAwMDAwMDAxMDAwMDAwMDAwMDAw
MDAwMDAwMDAgIAACAAAAFAABTkFNRSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAAAAAAAAAAACAgICAgICAg
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAICAgICAgICAgICAgICAgICAgICBIRUFERVIgUkVD
T1JEKioqKioqKk9CUyAgICAgSEVBREVSIFJFQ09SRCEhISEhISEwMDAwMDAw
MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAgIE1BTkdBVEhBTCAgICAgICAgICAg
U0VCQVNUSU5FICAgICAgICAgICBBQkRVTCBLQURBUiAgICAgICAgIFNJVkFH
TkFOQSBTVU5EQVJBTSAgUy5NQVJZICAgICAgICAgICAgICBKRVlBUkFNQU4g
ICAgICAgICAgIEJBU0tBUkFOICAgICAgICAgICAgTUFSWSAgICAgICAgICAg
ICAgICBCQUJVICAgICAgICAgICAgICAgIEtSSVNITkFOICAgICAgICAgICAg
REVWQUtJICAgICAgICAgICAgICBSQUpBTU1BTCAgICAgICAgICAgIFdJTExJ
TkdUT04gICAgICAgICAgUkFNQSBLUklTSE5BTiAgICAgICBKRVlBU0VFTEkg
ICAgICAgICAgIE1VVEhBTU1BTCAgICAgICAgICAgTUVFUkEgU0hBSElCICAg
ICAgICBSQUpVICAgICAgICAgICAgICAgIFJBTUEgS1JJU0hOQU4gICAgICAg
S0hBSkEgIE1ZREVFTiAgICAgICBTVUJSQU1BTklBTiAgICAgICAgIEJBTEEg
QVJVTkFDSEFMQU0gICAgU1VEQUxBSU1VVEhVICAgICAgICBDQVRIRVJJTkUu
TS5EICAgICAgIFJBSkxBS1NITUkgICAgICAgICAgUEFHSFJWRUxVLkwgICAg
ICAgICBSQU1BTElOR0FNICAgICAgICAgIFJBVEhOQSBLVU1BUkkgICAgICAg
U0FSQVNXQVRIWSAgICAgICAgICBTQUlMQVBQQU4gICAgICAgICAgIFBBUlZB
VEhZICAgICAgICAgICAgR0FOVEhJTUFUSEkgICAgICAgICBESEFNT0RBUkFO
ICAgICAgICAgIEhBUklIQVJBTi5SICAgICAgICAgUEFVTFNBTVkgICAgICAg
ICAgICBTVUJSQU1BTklBTS5TICAgICAgIFNBTkdBUkFOQVJBWUFOQU4gICAg
QVlZQU5BUiBUSEVWQVIgICAgICBQQUxBTkkgICAgICAgICAgICAgIFZFTFUg
ICAgICAgICAgICAgICAgUEFOTklZQU5NQUxBSSAgICAgICBESEFOQUxBS1NI
TUkgICAgICAgIFJBSFVNQU4gQkVFVkkgICAgICAgVEhJTEFHQVZBVFkgICAg
ICAgICBWQU1FREVSQU4gICAgICAgICAgIEpBTkFOVEhBTkFOIFNBUEFMWUEg
U0VOVEhJTCBBUlVNVUdBTSAgICBQVVJVSk9USEFNQU4gICAgICAgIFNBTktB
UkEgTkFSQVlBTkFOLlMgQUxJQ0UuRCAgICAgICAgICAgICBTSEFOVEhBLksg
ICAgICAgICAgIEpBTkFLSUFNTUFMICAgICAgICAgR09NQVRIWSAgICAgICAg
ICAgICBSQVRISU5BQkFJICAgICAgICAgIEVTVEhFUiAgICAgICAgICAgICAg
Sk9TRVBILlUgICAgICAgICAgICBBTEFNRUxVUiAgICAgICAgICAgIFZJQ1RP
Ui5BICAgICAgICAgICAgUEVSVU1BTCAgICAgICAgICAgICBQQURNQU5BQkFO
Lk4gICAgICAgIFNFTFZBTkFZQUdBTi5TICAgICAgVEhJUlVQQVRIWSAgICAg
ICAgICBNRUVSQU5NT0hBSURFRU4gICAgIFBBVENIQUkgIFBFUlVNQUwgICAg
R1VSVVNBTVkuViAgICAgICAgICBKRVlBUkFOSSAgICAgICAgICAgIFNIQU5N
VUdBTSBBTU1BTCAgICAgU0FOVEhBIEtVTUFSSSAgICAgICBNVVRIVSBTQU1Z
LkEgICAgICAgIEdPTUFUSFkgQU1NQUwgICAgICAgU0FOS0FSQUxJTkdBTSAg
ICAgICBIQVJJSEFSQSBTVUJSQU1BTklBTkFOQkFNTUFMICAgICAgICAgICAg
TUFIQURFVkFOLkIgICAgICAgICBNQURIQVZBTiBOQUlSICAgICAgIEJBTEEg
U0FSQVNXQVRIWSAgICAgQVJVTVVHQU0gICAgICAgICAgICBHQU5HQUNITEVT
QU4gTkFJUiAgIFZFRVJBTEFLU0hNSSAgICAgICAgU0hBTk1VR0FNICAgICAg
ICAgICBQRVJVTUFMIFBJTExBSSAgICAgIERFVkFEQVNTICAgICAgICAgICAg
Q0hJVFJBICAgICAgICAgICAgICBNQUhBTElOR0FNICAgICAgICAgIEMuTVVS
VUdBTiAgICAgICAgICAgR0FOQVBBVEhZLkwgICAgICAgICBHVVJVU0FNWSBO
QUlDS0VSICAgIExBS1NITUkgIFNIQU5NVUdBTSAgVEhBTkdBTUFOSSAgICAg
ICAgICBEVVJBSVNBTVkgICAgICAgICAgIFJBSkFMQUtTSE1JLlIgICAgICAg
TUFOT0hBUkFOICAgICAgICAgICBCQUxTVUJSQU1BTklBTiAgICAgIEFNSU5B
ICAgICAgICAgICAgICAgU0FST0pBICAgICAgICAgICAgICBOQUxMQU1NQUwg
ICAgICAgICAgIFJFTkdBUkFKQU4gICAgICAgICAgU0hFR0EgRkFUSElNQSAg
ICAgICBTSEVOQkFHQUxBS1NITUkgICAgIFBJVENIQUlBSCAgICAgICAgICAg
S0FMSVlBIE1VREFMSUFSICAgICBLUklTSE5BTi5ELksgICAgICAgIFRISVJV
R05BTkFNICAgICAgICAgREhBVURBUEFOSSAgICAgICAgICBLUklTSE5BTiAg
ICAgICAgICAgIFZFTlVHT1BBTCAgICAgICAgICAgTUVFTkFNQkFMLlYgICAg
ICAgICBNQVRIRVcgRlJBTkNJUyAgICAgIFBPTkdBTEFTQU1ZICAgICAgICAg
TkFUQVJBSkEgUEFORElBTiAgICBLQU5EQU4gICAgICAgICAgICAgIEtBTUFM
VURFRU4gICAgICAgICAgUi5MQUtTSE1JICAgICAgICAgICBLQU5USElBTU1B
TC5EICAgICAgIFBFUlVNQUwgICAgICAgICAgICAgU1VCQUlEQSAgICAgICAg
ICAgICBWQVNBTlRIQSAgICAgICAgICAgIFNSSU5JVkFTQU4gICAgICAgICAg
UkFKLlIuQiAgICAgICAgICAgICBTQU5USE9SQUdJUkkuUyAgICAgIE1FSEFS
VU5JU0hBICAgICAgICAgR09WSU5EQVNBTVkgICAgICAgICBHUkVUQSBGRVJO
QU5ETyAgICAgIE1VTklZQU1NQUwgICAgICAgICAgTE9HQU5BVEhBTiAgICAg
ICAgICBKT1NFUEguSy5UICAgICAgICAgIFRIQU5HQVJBSkFOLkEgICAgICAg
R0FOQVBBVEhJICAgICAgICAgICBDSElOTkFJQU4gICAgICAgICAgIE5BTExB
TU1BTCAgICAgICAgICAgUkFKRVNXQVJJICAgICAgICAgICBLVVBQQU1NQUwg
ICAgICAgICAgIE1PSEFOICAgICAgICAgICAgICAgS1JJU0hOQU1PT1JUSFkg
ICAgICBQVU5OVVNBTVkgICAgICAgICAgIFZJUlVUSEFHSVJJLk0gICAgICAg
QkFTS0FSQU4gICAgICAgICAgICBLT1RUQUlBUFBBTiAgICAgICAgIFJBSkFU
SFkuSyAgICAgICAgICAgUkFKQSAgICAgICAgICAgICAgICBHQU5FU0hBTi5D
LlYgICAgICAgIERBTkRBWUFUSEFQQU5JLk0gICAgQkFDS0lBTS5QICAgICAg
ICAgICBsTEFLU0hNSS5OICAgICAgICAgIFJBTUFLUklTSE5BSUFIICAgICAg
UkFNVVRIQUkgICAgICAgICAgICBTVUJCVVJBWUFFTFUgICAgICAgIEFSVU1V
R0FNICAgICAgICAgICAgS0FMVURFRU4gICAgICAgICAgICBTVUJCQU1NQUwg
ICAgICAgICAgIFJFTkdBTkFUSEFOICAgICAgICAgQ0hJTk5BU01BWS5BICAg
ICAgICBCQUxBU1VCUkFNQU5JQU4gQUNIQUtVTEFOVEhBSSBUSEVSQVMgICAg
Sk9TRVBILkQgICAgICAgICAgICBNQU5JQ0tBTS5BICAgICAgICAgIE1VVEhV
IE1FRU5BS1NISVNVTkRBTU9IQU4gICAgICAgICAgICAgICBDSElUQU1CQVJB
TS4gICAgICAgIE1BSEFCVSBCSSAgICAgICAgICAgR09QQUxBS1JJU0hOQVdB
UlJJT1JBTEVZQU1NQSAgICAgICAgICAgIEFCUkFIQU0gR0VPUkdFICAgICAg
Uk9TQU1NQUwgICAgICAgICAgICBWQUlSQVZBTiAgICAgICAgICAgIFlBR0FN
TUFMICAgICAgICAgICAgS0FTVEhVUkkgICAgICAgICAgICBTQU5HSUxJQU1N
QUwgICAgICAgIEtBTElBUFBBIFBJTExBSSAgICAgSEFKSSBBQkRVTExBSCAg
ICAgICBSRU5HQU5BVEhBTiAgICAgICAgIEtBUlVQUEFJQUggICAgICAgICAg
U0VMVkFSQUogICAgICAgICAgICBNVVRIVVNBTVkgVC5LICAgICAgIEtBUlVQ
UFVTQU1ZICAgICAgICAgUEhJTElQIEpPSE4gICAgICAgICBNT0hBTUVEIEEu
UCAgICAgICAgIEpFWUFWRUwgICAgICAgICAgICAgQklCSUpIT04gICAgICAg
ICAgICBWSUpBWUFTVU5EQVJBTSAgICAgIA==
---559023410-851401618-992613038=:29850--

==> 981.audit <==
Sun Jun 17 09:36:50 2001	ripley	changed notes
Sun Jun 17 09:36:50 2001	ripley	foobar
Sun Jun 17 09:36:50 2001	ripley	moved from incoming to Add-ons
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1038 *
Subject: nlme: bug in getCovariateFormula
From: Setzer.Woodrow@epamail.epa.gov
Date: Tue, 31 Jul 2001 11:24:09 -0400
--change needed in package nlme
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1038 <==
From Setzer.Woodrow@epamail.epa.gov  Tue Jul 31 17:47:13 2001
Received: from stat.math.ethz.ch (daemon@hypatia.ethz.ch [129.132.58.23])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id RAA10358
	for <R-bugs@biostat.ku.dk>; Tue, 31 Jul 2001 17:47:12 +0200 (MET DST)
From: Setzer.Woodrow@epamail.epa.gov
Received: (from daemon@localhost)
	by stat.math.ethz.ch (8.9.1/8.9.1) id RAA29279
	for <r-bugs@lists.r-project.org>; Tue, 31 Jul 2001 17:47:07 +0200 (MET DST)
Received: from marconi.rtp.epa.gov(134.67.208.99)
 via SMTP by hypatia, id smtpdAAAa0079S; Tue Jul 31 17:47:02 2001
Received: from epahub11.rtp.epa.gov (epahub11.rtp.epa.gov [134.67.213.52])
 by epamail.epa.gov (PMDF V5.2-33 #42056)
 with ESMTP id <0GHC004FLGOB26@epamail.epa.gov> for r-bugs@lists.r-project.org;
 Tue, 31 Jul 2001 11:40:58 -0400 (EDT)
Date: Tue, 31 Jul 2001 11:24:09 -0400
Subject: nlme: bug in getCovariateFormula
To: r-bugs@hypatia.math.ethz.ch
Message-id: <OF64B799E7.BEBD283E-ON85256A9A.0052DE38@rtp.epa.gov>
MIME-version: 1.0
X-Mailer: Lotus Notes Release 5.0.3  March 21, 2000
Content-type: text/plain; charset=us-ascii
X-MIMETrack: Serialize by Router on EPAHUB11/USEPA/US(Release 5.0.6a |January
 17, 2001) at 07/31/2001 11:40:58 AM

I found that predict.gnls failed with a wierd error message about a
non-numeric argument to a binary vector in one of three nearly identical
uses.

Error in Inh/Ki : non-numeric argument to binary operator

(Inh and Ki are arguments to the function used in the formula for the
object whose predictions were requested).

It turns out that the problem is in getCovariateFormula().

The final line in getCovariateFormula() in the nlme package (version
3.1-16) is:
    eval(parse(text = paste("~", deparse(form))))

however, if deparse(form) exceeds 'width.cutoff (which defaults to 60)',
this results in inappropriately placed "~" signs:
For example, in my application with the error, form is

UnCompetitive(MethoxyresorufinConc, InhibitorConc, Vmax, Km, Ki)

the result of the paste() operation in the last line of getCovariateFormula
is:

> paste("~",deparse(form))
[1] "~ UnCompetitive(MethoxyresorufinConc, InhibitorConc, Vmax, Km, "
[2] "~     Ki)"

extending width.cutoff gives the intended value:

> paste("~",deparse(form,width.cutoff=500))
[1] "~ UnCompetitive(MethoxyresorufinConc, InhibitorConc, Vmax, Km, Ki)"

Seems a bit risky for an enforced cutoff in deparse, though.

R. Woodrow Setzer, Jr.                                            Phone:
(919) 541-0128
Experimental Toxicology Division                       Fax:  (919) 541-5394
Pharmacokinetics Branch
NHEERL MD-74; US EPA; RTP, NC 27711


==> 1038.reply.1 <==
From pd@blueberry.kubism.ku.dk  Tue Jul 31 18:12:16 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id SAA10513;
	Tue, 31 Jul 2001 18:12:16 +0200 (MET DST)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.9.3/8.9.3) id SAA26023;
	Tue, 31 Jul 2001 18:21:47 +0200
Sender: pd@pubhealth.ku.dk
To: Setzer.Woodrow@epamail.epa.gov
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] nlme: bug in getCovariateFormula (PR#1038)
References: <200107311547.RAA10368@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 31 Jul 2001 18:21:46 +0200
In-Reply-To: Setzer.Woodrow@epamail.epa.gov's message of "Tue, 31 Jul 2001 17:47:14 +0200 (MET DST)"
Message-ID: <x2d76h6pd1.fsf@blueberry.kubism.ku.dk>
Lines: 50
X-Mailer: Gnus v5.7/Emacs 20.7
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

Setzer.Woodrow@epamail.epa.gov writes:

> The final line in getCovariateFormula() in the nlme package (version
> 3.1-16) is:
>     eval(parse(text = paste("~", deparse(form))))
> 
> however, if deparse(form) exceeds 'width.cutoff (which defaults to 60)',
> this results in inappropriately placed "~" signs:
> For example, in my application with the error, form is
> 
> UnCompetitive(MethoxyresorufinConc, InhibitorConc, Vmax, Km, Ki)
> 
> the result of the paste() operation in the last line of getCovariateFormula
> is:
> 
> > paste("~",deparse(form))
> [1] "~ UnCompetitive(MethoxyresorufinConc, InhibitorConc, Vmax, Km, "
> [2] "~     Ki)"
> 
> extending width.cutoff gives the intended value:
> 
> > paste("~",deparse(form,width.cutoff=500))
> [1] "~ UnCompetitive(MethoxyresorufinConc, InhibitorConc, Vmax, Km, Ki)"
> 
> Seems a bit risky for an enforced cutoff in deparse, though.

parse(...deparse(...)) always looks wrong to me anyway. Couldn't one
use something like

f <- ~1
f[[2]] <- form
eval(f)

or 

eval(as.call(list(as.name("~"),form)))

or

eval(substitute(~form)) # that's not going to work in S, though...

??

(What is the eval for? Doesn't usually do anything to a
formula argument.)
-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 1038.reply.2 <==
From bates@stat.wisc.edu  Tue Jul 31 21:17:07 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id VAA11163;
	Tue, 31 Jul 2001 21:17:06 +0200 (MET DST)
Received: by franz.stat.wisc.edu
	via sendmail from stdin
	id <m15RegF-000JP1C@franz.stat.wisc.edu> (Debian Smail3.2.0.111)
	for R-bugs@biostat.ku.dk; Tue, 31 Jul 2001 13:55:47 -0500 (CDT) 
Sender: bates@franz.stat.wisc.edu
To: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Cc: Setzer.Woodrow@epamail.epa.gov, r-devel@stat.math.ethz.ch,
        R-bugs@biostat.ku.dk
Subject: Re: [Rd] nlme: bug in getCovariateFormula (PR#1038)
References: <200107311547.RAA10368@pubhealth.ku.dk>
	<x2d76h6pd1.fsf@blueberry.kubism.ku.dk>
From: Douglas Bates <bates@stat.wisc.edu>
Date: 31 Jul 2001 13:55:47 -0500
In-Reply-To: <x2d76h6pd1.fsf@blueberry.kubism.ku.dk>
Message-ID: <6relqxorm4.fsf@franz.stat.wisc.edu>
Lines: 55
User-Agent: Gnus/5.0808 (Gnus v5.8.8) Emacs/20.7
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

> Setzer.Woodrow@epamail.epa.gov writes:
> 
> > The final line in getCovariateFormula() in the nlme package (version
> > 3.1-16) is:
> >     eval(parse(text = paste("~", deparse(form))))
> > 
> > however, if deparse(form) exceeds 'width.cutoff (which defaults to 60)',
> > this results in inappropriately placed "~" signs:
> > For example, in my application with the error, form is
> > 
> > UnCompetitive(MethoxyresorufinConc, InhibitorConc, Vmax, Km, Ki)
> > 
> > the result of the paste() operation in the last line of getCovariateFormula
> > is:
> > 
> > > paste("~",deparse(form))
> > [1] "~ UnCompetitive(MethoxyresorufinConc, InhibitorConc, Vmax, Km, "
> > [2] "~     Ki)"
> > 
> > extending width.cutoff gives the intended value:
> > 
> > > paste("~",deparse(form,width.cutoff=500))
> > [1] "~ UnCompetitive(MethoxyresorufinConc, InhibitorConc, Vmax, Km, Ki)"
> > 
> > Seems a bit risky for an enforced cutoff in deparse, though.
> 
> parse(...deparse(...)) always looks wrong to me anyway. Couldn't one
> use something like
> 
> f <- ~1
> f[[2]] <- form
> eval(f)
> 
> or 
> 
> eval(as.call(list(as.name("~"),form)))

> or
> 
> eval(substitute(~form)) # that's not going to work in S, though...

Exactly.  The code was originally written for S and ported to R.  Some
of the contorted expressions were things that we found by
experimentation would work in both systems.

> ??
> 
> (What is the eval for? Doesn't usually do anything to a
> formula argument.)

In Sv3 at least it assigns a class to the object.

I'll change it to eval(substitute(~form)) for the R package.

==> 1038.followup.1 <==
From Setzer.Woodrow@epamail.epa.gov  Tue Jul 31 22:19:22 2001
Received: from marconi.rtp.epa.gov (marconi.rtp.epa.gov [134.67.208.99])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id WAA11392;
	Tue, 31 Jul 2001 22:19:19 +0200 (MET DST)
From: Setzer.Woodrow@epamail.epa.gov
Received: from epahub11.rtp.epa.gov (epahub11.rtp.epa.gov [134.67.213.52])
 by epamail.epa.gov (PMDF V5.2-33 #42056)
 with ESMTP id <0GHC00AQNTEESU@epamail.epa.gov>; Tue,
 31 Jul 2001 16:11:02 -0400 (EDT)
Date: Tue, 31 Jul 2001 16:10:54 -0400
Subject: Re: [Rd] nlme: bug in getCovariateFormula (PR#1038)
To: Douglas Bates <bates@stat.wisc.edu>
Cc: bates@franz.stat.wisc.edu, Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>,
        R-bugs@biostat.ku.dk, r-devel@stat.math.ethz.ch
Message-id: <OF7528A682.B9E78D2C-ON85256A9A.006E9C38@rtp.epa.gov>
MIME-version: 1.0
X-Mailer: Lotus Notes Release 5.0.3  March 21, 2000
Content-type: text/plain; charset=us-ascii
X-MIMETrack: Serialize by Router on EPAHUB11/USEPA/US(Release 5.0.6a |January
 17, 2001) at 07/31/2001 04:11:02 PM


It looks clunky, but you could maintain consistency across S and R forms
with

eval(parse(text=paste("~",paste(deparse(form),collapse=" "))))


R. Woodrow Setzer, Jr.                                            Phone:
(919) 541-0128
Experimental Toxicology Division                       Fax:  (919) 541-5394
Pharmacokinetics Branch
NHEERL MD-74; US EPA; RTP, NC 27711


                                                                                                                
                    Douglas Bates                                                                               
                    <bates@stat.wis        To:     Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>                
                    c.edu>                 cc:     Woodrow Setzer/RTP/USEPA/US@EPA, r-devel@stat.math.ethz.ch,  
                    Sent by:               R-bugs@biostat.ku.dk                                                 
                    bates@franz.sta        Subject:     Re: [Rd] nlme: bug in getCovariateFormula (PR#1038)     
                    t.wisc.edu                                                                                  
                                                                                                                
                                                                                                                
                    07/31/01 02:55                                                                              
                    PM                                                                                          
                                                                                                                
                                                                                                                




Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

> Setzer.Woodrow@epamail.epa.gov writes:
>
> > The final line in getCovariateFormula() in the nlme package (version
> > 3.1-16) is:
> >     eval(parse(text = paste("~", deparse(form))))
> >
> > however, if deparse(form) exceeds 'width.cutoff (which defaults to
60)',
> > this results in inappropriately placed "~" signs:
> > For example, in my application with the error, form is
> >
> > UnCompetitive(MethoxyresorufinConc, InhibitorConc, Vmax, Km, Ki)
> >
> > the result of the paste() operation in the last line of
getCovariateFormula
> > is:
> >
> > > paste("~",deparse(form))
> > [1] "~ UnCompetitive(MethoxyresorufinConc, InhibitorConc, Vmax, Km, "
> > [2] "~     Ki)"
> >
> > extending width.cutoff gives the intended value:
> >
> > > paste("~",deparse(form,width.cutoff=500))
> > [1] "~ UnCompetitive(MethoxyresorufinConc, InhibitorConc, Vmax, Km,
Ki)"
> >
> > Seems a bit risky for an enforced cutoff in deparse, though.
>
> parse(...deparse(...)) always looks wrong to me anyway. Couldn't one
> use something like
>
> f <- ~1
> f[[2]] <- form
> eval(f)
>
> or
>
> eval(as.call(list(as.name("~"),form)))

> or
>
> eval(substitute(~form)) # that's not going to work in S, though...

Exactly.  The code was originally written for S and ported to R.  Some
of the contorted expressions were things that we found by
experimentation would work in both systems.

> ??
>
> (What is the eval for? Doesn't usually do anything to a
> formula argument.)

In Sv3 at least it assigns a class to the object.

I'll change it to eval(substitute(~form)) for the R package.





==> 1038.reply.3 <==
From pd@blueberry.kubism.ku.dk  Tue Jul 31 23:16:31 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id XAA11578;
	Tue, 31 Jul 2001 23:16:30 +0200 (MET DST)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.9.3/8.9.3) id XAA26225;
	Tue, 31 Jul 2001 23:26:04 +0200
Sender: pd@pubhealth.ku.dk
To: Douglas Bates <bates@stat.wisc.edu>
Cc: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>,
        Setzer.Woodrow@epamail.epa.gov, r-devel@stat.math.ethz.ch,
        R-bugs@biostat.ku.dk
Subject: Re: [Rd] nlme: bug in getCovariateFormula (PR#1038)
References: <200107311547.RAA10368@pubhealth.ku.dk> <x2d76h6pd1.fsf@blueberry.kubism.ku.dk> <6relqxorm4.fsf@franz.stat.wisc.edu>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 31 Jul 2001 23:26:04 +0200
In-Reply-To: Douglas Bates's message of "31 Jul 2001 13:55:47 -0500"
Message-ID: <x2ae1k23kj.fsf@blueberry.kubism.ku.dk>
Lines: 25
X-Mailer: Gnus v5.7/Emacs 20.7
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

Douglas Bates <bates@stat.wisc.edu> writes:

> Exactly.  The code was originally written for S and ported to R.  Some
> of the contorted expressions were things that we found by
> experimentation would work in both systems.
> 
> > ??
> > 
> > (What is the eval for? Doesn't usually do anything to a
> > formula argument.)
> 
> In Sv3 at least it assigns a class to the object.

Aha. In R too.

> I'll change it to eval(substitute(~form)) for the R package.

Great. I would have thought that one of the two other forms would be
portable, though. 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 1038.audit <==
Fri Aug  3 12:00:14 2001	ripley	changed notes
Fri Aug  3 12:00:14 2001	ripley	foobar
Fri Aug  3 12:00:14 2001	ripley	moved from incoming to Add-ons
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1044 *
Subject: Polymarsall.c
From: pleu@hotmail.com
Date: Tue, 7 Aug 2001 22:42:07 +0200 (MET DST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1044 <==
From pleu@hotmail.com  Tue Aug  7 22:42:07 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id WAA01752
	for <R-bugs@biostat.ku.dk>; Tue, 7 Aug 2001 22:42:07 +0200 (MET DST)
Date: Tue, 7 Aug 2001 22:42:07 +0200 (MET DST)
From: pleu@hotmail.com
Message-Id: <200108072042.WAA01752@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: Polymarsall.c

Full_Name: Paul Leu
Version: 1.2.3
OS: Windows NT
Submission from: (NULL) (12.2.142.7)


There is a bug in the polymars code.  

Line 655   m=m+k-1;

ought to be moved in front of the for loop in line 652 or else the levels array
will go out of bounds in the loop.

This does not seem to cause any errors in R, but caused crashes when I attempted
to link the file to PV-wave.  

Paul

==> 1044.audit <==
Sat Aug 11 09:56:56 2001	ripley	moved from incoming to Add-ons
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1116 *
Subject: get.hist.quote does not work
From: arto.luoma@uta.fi
Date: Thu, 4 Oct 2001 14:45:29 +0200 (MET DST)
--Seems specific to one locale on one system.
--The bug is unlikely to be in R.
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1116 <==
From arto.luoma@uta.fi  Thu Oct  4 14:45:29 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id OAA18632
	for <R-bugs@biostat.ku.dk>; Thu, 4 Oct 2001 14:45:29 +0200 (MET DST)
Date: Thu, 4 Oct 2001 14:45:29 +0200 (MET DST)
From: arto.luoma@uta.fi
Message-Id: <200110041245.OAA18632@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: get.hist.quote does not work

Full_Name: Arto Luoma
Version: 1.3.1
OS: Windows 98
Submission from: (NULL) (153.1.53.119)


Hi!

The function get.hist.quote in the package tseries (Version 0.7-6) does not work
in 
my computer. 
I found that it uses the function strptime which did not "understand" English
month
names in my Finnish locale (see bug report 811). I changed the regional settings
to 
be English (UK) and strptime started to work as I liked. However, get.hist.quote
does 
not work yet, since the function julian does not work. Is this problem only in
my computer? The previous version of get.hist.quote (tseries 0.7-0) did work.

Sys.time and julian produce

> Sys.time()
[1] "2001-10-04 15:33:14 GTB Daylight Time"
> julian(Sys.time())
Error in fromchar(x) : character string is not in a standard unambiguous format
> 

get.hist.quote produces
 
 x <- get.hist.quote(instrument = "^spc", start = "1998-01-01",
+                     quote = "Close")
trying URL `http://chart.yahoo.com/table.csv?s=^spc&a=01&b=01&c=1998&d=10&e=03&f=2001&g=d&q=q&y=0&z=^spc&x=.csv'
Content type `application/octet-stream' length unknown
opened URL
downloaded 38Kb

time series starts 1998-01-02
Error in fromchar(x) : character string is not in a standard unambiguous format
 

==> 1116.reply.1 <==
From hornik@ci.tuwien.ac.at  Thu Oct  4 18:23:14 2001
Received: from isis.wu-wien.ac.at (isis.wu-wien.ac.at [137.208.3.42])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id SAA21198
	for <R-bugs@biostat.ku.dk>; Thu, 4 Oct 2001 18:23:13 +0200 (MET DST)
Received: from mithrandir.hornik.net (wu057056.wu-wien.ac.at [137.208.57.56])
	by isis.wu-wien.ac.at (8.8.7/8.8.7) with ESMTP id SAA719600emf hornik@ci.tuwien.ac.at; Thu, 4 Oct 2001 18:23:08 +0200
Received: from hornik by mithrandir.hornik.net with local (Exim 3.12 #1 (Debian))
	id 15pBHQ-0008T1-00; Thu, 04 Oct 2001 18:23:24 +0200
From: Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Message-ID: <15292.36092.160657.354210@mithrandir.hornik.net>
Date: Thu, 4 Oct 2001 18:23:24 +0200
To: arto.luoma@uta.fi
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] get.hist.quote does not work (PR#1116)
In-Reply-To: <200110041245.OAA18643@pubhealth.ku.dk>
References: <200110041245.OAA18643@pubhealth.ku.dk>
X-Mailer: VM 6.96 under Emacs 20.7.2
Reply-To: Kurt.Hornik@ci.tuwien.ac.at
Sender: Kurt Hornik <hornik@ci.tuwien.ac.at>

>>>>> arto luoma writes:

> Full_Name: Arto Luoma
> Version: 1.3.1
> OS: Windows 98
> Submission from: (NULL) (153.1.53.119)

> Hi!

> The function get.hist.quote in the package tseries (Version 0.7-6)
> does not work in my computer.  I found that it uses the function
> strptime which did not "understand" English month names in my Finnish
> locale (see bug report 811). I changed the regional settings to be
> English (UK) and strptime started to work as I liked. However,
> get.hist.quote does not work yet, since the function julian does not
> work. Is this problem only in my computer? The previous version of
> get.hist.quote (tseries 0.7-0) did work.

> Sys.time and julian produce

>> Sys.time()
> [1] "2001-10-04 15:33:14 GTB Daylight Time"
>> julian(Sys.time())
> Error in fromchar(x) : character string is not in a standard unambiguous format
>> 

> get.hist.quote produces
 
>  x <- get.hist.quote(instrument = "^spc", start = "1998-01-01",
> +                     quote = "Close")
> trying URL `http://chart.yahoo.com/table.csv?s=^spc&a=01&b=01&c=1998&d=10&e=03&f=2001&g=d&q=q&y=0&z=^spc&x=.csv'
> Content type `application/octet-stream' length unknown
> opened URL
> downloaded 38Kb

> time series starts 1998-01-02
> Error in fromchar(x) : character string is not in a standard unambiguous format

I am confused by the subject: above you indicate that get.hist.quote
does not work because julian does not work.

What precisely are your locale settings?

-k

==> 1116.followup.1 <==
From al18853@uta.fi  Fri Oct  5 15:04:46 2001
Received: from uta.fi (uta.fi [153.1.1.12])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id PAA01166
	for <R-bugs@biostat.ku.dk>; Fri, 5 Oct 2001 15:04:45 +0200 (MET DST)
Received: from vuokko.uta.fi (vuokko [153.1.1.11])
	by uta.fi (8.11.6/8.11.6) with ESMTP id f95D4fB28446;
	Fri, 5 Oct 2001 16:04:41 +0300 (EEST)
Received: from localhost (al18853@localhost) by vuokko.uta.fi (8.8.5/8.8.2) with SMTP id QAA03268; Fri, 5 Oct 2001 16:04:41 +0300 (EET DST)
Date: Fri, 5 Oct 2001 16:04:40 +0300 (EET DST)
From: Arto Luoma <al18853@uta.fi>
X-Sender: al18853@vuokko
To: Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at>
cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] get.hist.quote does not work (PR#1116)
In-Reply-To: <15292.36092.160657.354210@mithrandir.hornik.net>
Message-ID: <Pine.GSO.3.95.1011005155411.3064C-100000@vuokko>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Thu, 4 Oct 2001, Kurt Hornik wrote:

> >>>>> arto luoma writes:
> 
> > Full_Name: Arto Luoma
> > Version: 1.3.1
> > OS: Windows 98
> > Submission from: (NULL) (153.1.53.119)
> 
> > Hi!
> 
> > The function get.hist.quote in the package tseries (Version 0.7-6)
> > does not work in my computer.  I found that it uses the function
> > strptime which did not "understand" English month names in my Finnish
> > locale (see bug report 811). I changed the regional settings to be
> > English (UK) and strptime started to work as I liked. However,
> > get.hist.quote does not work yet, since the function julian does not
> > work. Is this problem only in my computer? The previous version of
> > get.hist.quote (tseries 0.7-0) did work.
> 
> > Sys.time and julian produce
> 
> >> Sys.time()
> > [1] "2001-10-04 15:33:14 GTB Daylight Time"
> >> julian(Sys.time())
> > Error in fromchar(x) : character string is not in a standard unambiguous format
> >> 
> 
> > get.hist.quote produces
>  
> >  x <- get.hist.quote(instrument = "^spc", start = "1998-01-01",
> > +                     quote = "Close")
> > trying URL `http://chart.yahoo.com/table.csv?s=^spc&a=01&b=01&c=1998&d=10&e=03&f=2001&g=d&q=q&y=0&z=^spc&x=.csv'
> > Content type `application/octet-stream' length unknown
> > opened URL
> > downloaded 38Kb
> 
> > time series starts 1998-01-02
> > Error in fromchar(x) : character string is not in a standard unambiguous format
> 
> I am confused by the subject: above you indicate that get.hist.quote
> does not work because julian does not work.
> 
> What precisely are your locale settings?
> 
> -k
> 
I think this is what you are interested in:

Sys.getlocale()
[1] "LC_COLLATE=English_United Kingdom.1252;LC_CTYPE=English_United
Kingdom.1252;LC_MONETARY=C;LC_NUMERIC=C;LC_TIME=English_United
Kingdom.1252"

Arto L. 


==> 1116.audit <==
Sun Oct  7 12:34:39 2001	ripley	changed notes
Sun Oct  7 12:34:39 2001	ripley	foobar
Sun Oct  7 12:34:39 2001	ripley	moved from incoming to Add-ons
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1124 *
Subject: Wrong df in bartlett.test when subsetting data
From: jens.lund@nordea.com
Date: Wed, 10 Oct 2001 17:43:42 +0200 (MET DST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1124 <==
From jens.lund@nordea.com  Wed Oct 10 17:43:52 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id RAA01449
	for <R-bugs@biostat.ku.dk>; Wed, 10 Oct 2001 17:43:42 +0200 (MET DST)
Date: Wed, 10 Oct 2001 17:43:42 +0200 (MET DST)
From: jens.lund@nordea.com
Message-Id: <200110101543.RAA01449@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: Wrong df in bartlett.test when subsetting data

Full_Name: Jens Lund
Version: 1.3.1
OS: Windows
Submission from: (NULL) (194.239.194.210)


When we subset a dataset bartlett.test does not calculate the df correctly:

X <- rnorm(50)     # Generate simulated samples
f <- gl(10,5)      # Generate a factor with 10 levels and
                   # 5 replications of each level

# Works correctly
bartlett.test(X,f) # Correct number of df = 9

# Just use the first 5 levels of f
# Does not work correctly
bartlett.test(X[1:25],f[1:25]) # Should have df = 4, but uses df = 9
bartlett.test(X~f,subset=1:25) # Should have df = 4, but uses df = 9

In version 1.2.2 the problem could be solved by substituting
        k <- nlevels(g)
with    k <- length(unique(g))
(I do not get the R-code in the new version get by typing bartlett.test at the
prompt.)

This might leed to a discussion on whether nlevels should return the number of
attained factor levels or the number of "theoretical" levels:
nlevels(f)       # Returns 10, fine!
nlevels(f[1:25]) # Returns 10, might not be fine; 5 might be the correct
answer.
The same question might be asked for levels, levels(f) versus levels(f[1:25]).
At least the documentation should be clear on this point, which I do not think
it is now. (Perhaps the levels attribute on the factor should be changed for a
subset of the data, but this is probably not an efficient way of doing
things...)

A similar problem also comes up with interactions between factors in unbalanced
designs:
g <- gl(2,40,50)
nlevels(f:g)         # Returns 20
length(unique(f:g))  # Returns 10
table(f,g)           # See the design

This bug has also been seen on version 1.2.2 on Linux, but is reproduced for
this bug report on:
> version
         _              
platform i386-pc-mingw32
arch     x86            
os       Win32          
system   x86, Win32     
status                  
major    1              
minor    3.1            
year     2001           
month    08             
day      31             
language R              

Best regards, Jens

==> 1124.audit <==
Wed Oct 10 19:08:54 2001	ripley	moved from incoming to Add-ons
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Directory:  Analyses

none

Directory:  Documentation

* PR# 988 *
Subject: input for R-intro
From: "Paul E. Johnson" <pauljohn@ku.edu>
Date: Mon, 18 Jun 2001 13:57:10 -0500
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 988 <==
From pauljohn@ku.edu  Mon Jun 18 21:03:09 2001
Received: from lark.cc.ku.edu (root@lark.cc.ku.edu [129.237.34.2])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id VAA14694
	for <r-bugs@biostat.ku.dk>; Mon, 18 Jun 2001 21:03:08 +0200 (MET DST)
Received: from ku.edu by lark.cc.ku.edu (8.8.8/1.1.8.2/12Jan95-0207PM)
	id OAA0000024737; Mon, 18 Jun 2001 14:02:11 -0500 (CDT)
Sender: pauljohn@lark.cc.ku.edu
Message-ID: <3B2E4F06.F3198537@ku.edu>
Date: Mon, 18 Jun 2001 13:57:10 -0500
From: "Paul E. Johnson" <pauljohn@ku.edu>
X-Mailer: Mozilla 4.77 [en] (X11; U; Linux 2.4.2-2 i686)
X-Accept-Language: en
MIME-Version: 1.0
To: r-bugs@biostat.ku.dk
Subject: input for R-intro
Content-Type: multipart/mixed;
 boundary="------------1C95DB321C5D7CBC643B8CA3"

This is a multi-part message in MIME format.
--------------1C95DB321C5D7CBC643B8CA3
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

I asked Prof. Brian Ripley if I might submit some text/input for the
R-intro writers, he said this is the place to do it.

I was on a plane a couple of weeks ago reading R-intro as I plan for a
course and made these notes, some of which I think will help my students
if you incorporate them.  I've attached a raw text file I wrote in Emacs
to this message "Rintrochanges.txt".

I have written documents like R-intro before and understand it is
difficult to please everybody, and I thank you for your effort on the
project.

Paul Johnson
Assoc. Professor
Dept. of Political Science
University of Kansas

--------------1C95DB321C5D7CBC643B8CA3
Content-Type: text/plain; charset=us-ascii;
 name="Rintrochanges.txt"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline;
 filename="Rintrochanges.txt"

R-intro comments/enhancements  Part I.

I think something more verbose like this would help under
"Ordered and Unordered factors"

Texts on research design emphasize that variables have
different levels of measurement. Typically, there are three levels.
If a measurement is taken with a precise scale (one on which it is
meaningful to say new_value = b*old_value, as with readings of a
thermometer), it is considered an "interval" level variable.  Many
statistical models were originally designed for interval level
variables.  If a measurement is not so precise, but only provides an
ordered categorization of observations, such as "low" "medium" and
"high", it is called an ordinal variable.  If a measurement is
categorical and implies no sense of ordering, such as "European",
"Asian", or "South American", then it is typically called an ordinal
variable.  Assigning the values of "1", "2", and "3" to these
observations has no substantive significance, as we might as well
number them "3","2","1".

Many statistical models are designed for interval level data, but with
appropriate recoding of input, they can also be made to work with
nominal and ordinal data.  In the "old days" of statistical computing,
users were forced to create a lot of indicator (or "dummy") variables,
thereby converting information from nominal or ordinal measurements
into variables that have only values 0 and 1.  For example, to
represent the information about the home continents of survey
respondents, we might create two dummy variables, one for Asia (coded
1 if respondent is from Asia, 0 otherwise) and one for South America
(likewise 0 and 1).  A respondent for whom we find both of these dummy
variables equal to 0 is sure to be from Europe, so we don't usually
need to create three dummy variables.  Doing so would be redundant.

With a modern language like R, much of the drudgery of creating the
indicator variables is handled automatically if the user declares the
variables properly.  In R, and S before it, the term "factor" is used
to refer to a variable that is not measured at the interval level. An
"unordered factor" is a nominal (or categorical) variable, while an
"ordered factor" is the term for an ordinal measurement.  Many
statistical procedures in R have builtin procedures for handling
factors.

Beyond handling coding of noninterval variables, factors play a vital
role in many R procedures.  Procedures can be designed to do a chore
for each value of a factor.  Many procedures will in fact insist that
a variable be designated as a factor.

 ------------------


In this section "Named arguments and defaults", I am left in a
confusion about a few things.  This confusion has bothered me a while.
Can you do more to explain which arguments must be specified, which
are optional, and under what conditions is it necessary to include the
parameter= which calling a function.

1.  When I use a function, and I look in its help page, how do I know
which input variables must be declared and which can be ignored?  This
is quite mysterious.  When invocations leave out some arguments, how
does R "sift through" the ones that are provided to know which is
which?


For example, consider the page on "update.packages".  

Under Usage, I find:
update.packages(lib.loc = .lib.loc, CRAN = getOption("CRAN"),
                contriburl = contrib.url(CRAN),
                method = "auto", instlib = NULL,
                ask=TRUE, available=NULL, destdir=NULL)

I've been using computers a long time, and I use this function every two months or so.  Between times I forget, come back to this page, and still this one leaves me totally confused.  

After fiddling a while, I find this works on Linux:
>update.packages(lib="/usr/lib/R/library",CRAN="http://lib.stat.cmu.edu/R/CRAN")

but what bothered me thd most is the "getOption("CRAN") option for CRAN.  I tried many variations on that and never figured how to make it work.


Maybe any clarifications could be related to the section "Getting help with functions and features"

In this section, I think it would be nice to have a paragraph about
"how to read a help page."  Some things are not obvious to all new
users.  Some things in help pages are tough to describe... Maybe I'd
say

How to read a help page.

If you find a help page, notice that it is made up of different parts.

1. "Description". These are usually terse, so read every word
   carefully.

2. Look for the "Value" heading.  That tells you what this procedure is
   going to return when you call it. If this procedure doesn't return
   what you need, you should find out immediately.

3. Under "Usage", most help pages list a number of possible commands
   that can be used.  These are not commands to be typed
   literally. Many of them contain abstract references which provide
   information about the nature of the variables that might be
   entered.  

   Here is a simple case.  The coefficients help page has this:

Usage

coef(object, ...)
coefficients(object, ...)

   Clearly, coef and coefficients are going to do the same thing, and you must supply the appropriate object.

4. Under "Arguments," the help page indicates what inputs this
   procedure wants.  The inputs are described line-by-line, and often
   the comments indicate of parameters are optional or what their
   default value might be.

   Many help pages have the infamous "...", which is something like
   "fill in the appropriately, depending on whatever context you
   find."  In some situations this is easy to understand .  Many help
   pages will eplicitly say that "..." refers to any options that
   might be used with a particular kind of object, and in that case
   one must find the help page for that other object. For example, the
   dev.copy help page clearly indicates that "..." refers to any
   options that might be used with the particular device in question.

   Other help pages are not so informative.  Consider the output from ?coefficients:

Arguments

 object
       an object for which the extraction of model coefficients is meaningful.
 ...
       other arguments.

Here it is clear you need to give a statistical object to have
coefficients removed.  The "..." is a mystery, and most R users will
try to use the coefficients command without worrying about it, and
then backtrack if an error occurs.  And, if an error occurs, there may be no recourse but to read the source code for this command or ask  about it in the r-help email list.

--------------1C95DB321C5D7CBC643B8CA3--


==> 988.audit <==
Tue Jun 19 09:07:09 2001	ripley	moved from incoming to Documentation
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1011 *
Subject: R-intro suggestions part II
From: "Paul E. Johnson" <pauljohn@ukans.edu>
Date: Tue, 03 Jul 2001 15:50:06 -0500
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1011 <==
From pauljohn@ukans.edu  Tue Jul  3 22:55:21 2001
Received: from lark.cc.ku.edu (root@lark.cc.ku.edu [129.237.34.2])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id WAA25420
	for <r-bugs@biostat.ku.dk>; Tue, 3 Jul 2001 22:55:20 +0200 (MET DST)
Received: from ukans.edu by lark.cc.ku.edu (8.8.8/1.1.8.2/12Jan95-0207PM)
	id PAA0000007085; Tue, 3 Jul 2001 15:55:12 -0500 (CDT)
Sender: pauljohn@lark.cc.ku.edu
Message-ID: <3B422FFE.F4450D57@ukans.edu>
Date: Tue, 03 Jul 2001 15:50:06 -0500
From: "Paul E. Johnson" <pauljohn@ukans.edu>
X-Mailer: Mozilla 4.77 [en] (X11; U; Linux 2.4.2-2 i686)
X-Accept-Language: en
MIME-Version: 1.0
To: r-bugs@biostat.ku.dk
Subject: R-intro suggestions part II
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

Brian Ripley said that, if I sent these here, they might find their way
to the R-intro team.  So, here is another installment:


Concerning this section:

Data permanency and removing objects.

This is the first place R-intro discusses objects.  I was thinking a
better discussion of objects and syntax is needed, perhaps here, or in
the later section "Objects, their modes and attributes."  I suggest
this:


The fact that R is an object-oriented approach to programming for
statistical analysis has pervasive implications.  If one has studied a
programming language like Java or C++, the notions of object and
method are not new.  For readers who have not studied languages like
that, perhaps we can offer a brief explanation.  An object is a "self
contained data holder" that can follow instructions (do calculations,
provide values).  One intention of this design is to keep things
separate if they belong that way, to reduce the risk that one
calculation accidentally influences the result of another.
Object-orientation also has important implications for the way the
different parts of a program fit together.  Since an object is
supposed to be able to carry out a certain set of actions (which are
called methods, but in R one often says "functions" or "procedures"),
then both the user and the programmer understand what the object can
be expected to do.  There are numerous implications of object
orientation that come into play "under the hood" of the R statistical
engine, but it is not important to delve into them from a user's point
of view.


There is one wrinkle about the syntax of R that we hasten to
emphasize.  In object-oriented computer languages, syntax typically
puts the object first, followed by the instruction, followed any needed
parameters.  In Java, to tell the object "regression" to calculate
estimates for vectors y and x, one would write something like:

   regression.estimate(y,x);

Assuming that object's class has an "estimate" method which knows how
to handle the input, we would be in business.

In R, the syntax is totally different.  Instead of thinking of the
object itself as the primary thing, the syntax in R is designed to use
the method name--the instruction--as the leading concept, and then the
object that is being acted upon is given as a parameter.

When a model gives a result in R, the result is almost invariably an
object, which can then be "poked and prodded" with other methods.
If a linear regression is calculated, for example:

resultObject <- lm(y~x)

the return value is an object.  But, unlike other object-oriented
languages, in R one would write summary(resultObject), or
coefficients(resultObject), rather than the Java style
result_object.summary() or some such thing, in order to investigate the
result.


Paul E. Johnson
Political Science
University of Kansas


==> 1011.audit <==
Fri Aug  3 11:30:05 2001	ripley	moved from incoming to Documentation
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1113 *
Subject: bug.report() & docs should mention r-devel
From: murdoch@stats.uwo.ca
Date: Thu, 4 Oct 2001 01:23:27 +0200 (MET DST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1113 <==
From murdoch@stats.uwo.ca  Thu Oct  4 01:23:28 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id BAA11114
	for <R-bugs@biostat.ku.dk>; Thu, 4 Oct 2001 01:23:27 +0200 (MET DST)
Date: Thu, 4 Oct 2001 01:23:27 +0200 (MET DST)
From: murdoch@stats.uwo.ca
Message-Id: <200110032323.BAA11114@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: bug.report() & docs should mention r-devel

Full_Name: Duncan Murdoch
Version: 1.3.1
OS: Windows
Submission from: (NULL) (64.231.172.71)


None of the web page on bug tracking, the ?bug.report help page, 
nor the disclaimer inserted at the beginning of the text generated by bug.report
in Windows mention
 - that only one bug should go in each report
 - that it's a good idea to discuss things on r-devel if you're not sure
something
is a bug.

I'd add this to the bug.report disclaimer:

"If you are not sure if what you see is a bug, please discuss it on the r-devel

mailing list first.  If you are sure, please copy the bug report 
(after finishing it) to your favorite email program and send it to
<address>.  Please submit just one bug per message."

The other places could have more verbose versions of this advice, including 
advice not to cc it to other lists.

 

==> 1113.audit <==
Wed Oct 10 19:08:54 2001	ripley	moved from incoming to Documentation
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Directory:  Graphics

* PR# 202 *
Subject: persp box occlusion bug
From: wsi@gcal.ac.uk
Date: Wed, 2 Jun 1999 15:02:03 +0200 (MET DST)
--The persp algorithm does not apply the occlusion rules to the frame, 
--which is always plotted first. 
--A bug, but not very simple to fix.
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 202 <==
From wsi@gcal.ac.uk  Wed Jun  2 15:02:10 1999
Received: from localhost (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id PAA27126
	for <R-bugs@biostat.ku.dk>; Wed, 2 Jun 1999 15:02:03 +0200 (MET DST)
Date: Wed, 2 Jun 1999 15:02:03 +0200 (MET DST)
From: wsi@gcal.ac.uk
Message-Id: <199906021302.PAA27126@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: persp box occlusion bug

Full_Name: Bill Simpson
Version: 64.1
OS: linux
Submission from: (NULL) (193.62.250.209)


Bug in persp() bounding box:
If the surface being plotted extends below the lower z-axis boundary, the box
is
drawn with the wrong occlusion. The box is shown as being occluded by the
surface
even though it should be in front of the surface.

The box is correct for surface extending above the box. Problem is only for
surface extending below the box.

This exhibits the bug:

std<-rep(seq(-32,32,8),9)/1000 * 60
cf<-rep(seq(-32,32,8),rep(9,9))/1000 *60 
dp<-(cf-std)/.6
std<-unique(std)
cf<-unique(cf)
dp<-t(matrix(dp,length(cf),length(std)))
persp(std,cf,dp, xlim=c(-2,2), ylim=c(-2,2), zlim=c(0,5),theta=-40,    
phi=45,
box=TRUE,ltheta=-120, lphi=120,
d=1.5, shade=.7)


==> 202.audit <==
Wed Jun 30 19:31:18 1999	pd	moved from incoming to Graphics
Thu Jul 01 18:19:48 1999	pd	changed notes
Sun Feb 20 10:07:11 2000	ripley	changed notes
Mon Feb 28 17:17:51 2000	pd	changed notes
Mon Feb 28 17:18:28 2000	pd	changed notes
Mon Feb 28 17:19:35 2000	pd	changed notes
Mon Feb 28 17:20:17 2000	pd	changed notes
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 660 *
Subject: identify.default ignores any setting of cex.
From: Prof Brian Ripley <ripley@stats.ox.ac.uk>
Date: Fri, 15 Sep 2000 10:23:39 +0100 (BST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 660 <==
From postmaster@franz.stat.wisc.edu  Fri Sep 15 11:23:32 2000
Received: from stat.math.ethz.ch (daemon@hypatia.ethz.ch [129.132.58.23])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id LAA13327
	for <R-bugs@biostat.ku.dk>; Fri, 15 Sep 2000 11:23:32 +0200 (MET DST)
Received: (from daemon@localhost)
	by stat.math.ethz.ch (8.9.1/8.9.1) id LAA17846
	for <r-bugs@hypatia.math.ethz.ch>; Fri, 15 Sep 2000 11:23:49 +0200 (MET DST)
Received: from franz.stat.wisc.edu(128.105.174.95)
 via SMTP by hypatia, id smtpdAAAa004Mn; Fri Sep 15 11:23:42 2000
Received: from toucan.stats.ox.ac.uk (really [163.1.20.20]) by franz.stat.wisc.edu
	via in.smtpd with esmtp
	id <m13Zrkl-000IW0C@franz.stat.wisc.edu> (Debian Smail3.2.0.102)
	for <R-bugs@r-project.org>; Fri, 15 Sep 2000 04:25:51 -0500 (CDT) 
Received: from localhost (ripley@localhost)
	by toucan.stats.ox.ac.uk (8.9.0/8.9.0) with ESMTP id KAA14892
	for <R-bugs@r-project.org>; Fri, 15 Sep 2000 10:23:39 +0100 (BST)
X-Authentication-Warning: toucan.stats: ripley owned process doing -bs
Date: Fri, 15 Sep 2000 10:23:39 +0100 (BST)
From: Prof Brian Ripley <ripley@stats.ox.ac.uk>
X-Sender: ripley@toucan.stats
To: R-bugs@r-project.org
Subject: identify.default ignores any setting of cex.
Message-ID: <Pine.GSO.4.05.10009151011510.14885-100000@toucan.stats>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

R 1.1.1 on Windows, but I think this is widespread.

Using either

par(cex=0.5)
plot(1:10)
identify(1:10)

or

plot(1:10)
identify(1:10, cex=0.5)

ignores the cex setting.  The root cause is that par(cex=0.5)
alters cexbase for the device but sets cex=1.0, and the internal
text plotting routines use cex and not cexbase.

The obvious fix is to set cex to cexbase in do_identify. However,
if this is fixed, there is another problem, The offset of the label
is related to the cex in use for the label, and not for the symbol.
So

plot(1:10, type="n")
points(1:10, cex=5)
identify(1:10)

is not sensible in placing the labels.  That may be hard to anticipate,
but 

plot(1:10)
identify(1:10, cex=0.5)

needs to use cex=1 not cex=0.5 for the adjustment.  Perhaps identify is
trying too hard, and should give the user more control over the precise
position of the label (as S-PLUS does).

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


==> 660.audit <==
Wed Oct 25 06:57:35 2000	ripley	moved from incoming to Graphics

==> 660.followup.1 <==
From ligges@statistik.uni-dortmund.de  Wed Apr 25 17:24:42 2001
Received: from nx5.HRZ.Uni-Dortmund.DE (nx5.HRZ.Uni-Dortmund.DE [129.217.131.21])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id RAA02114
	for <R-bugs@biostat.ku.dk>; Wed, 25 Apr 2001 17:24:42 +0200 (MET DST)
Received: from amadeus.statistik.uni-dortmund.de by nx5.HRZ.Uni-Dortmund.DE
          via smtp-local with ESMTP; Wed, 25 Apr 2001 17:24:51 +0200
Received: from statistik.uni-dortmund.de ([129.217.207.201])
	by amadeus.statistik.uni-dortmund.de (8.9.3+Sun/8.9.3) with ESMTP id RAA01760;
	Wed, 25 Apr 2001 17:24:50 +0200 (MET DST)
Message-ID: <3AE6EC55.6C1D8C7A@statistik.uni-dortmund.de>
Date: Wed, 25 Apr 2001 17:25:09 +0200
From: Uwe Ligges <ligges@statistik.uni-dortmund.de>
Organization: Fachbereich Statistik, Universitaet Dortmund
X-Mailer: Mozilla 4.76 [en] (WinNT; U)
X-Accept-Language: en
MIME-Version: 1.0
To: r-bugs <R-bugs@biostat.ku.dk>
CC: "Brian D. Ripley" <ripley@stats.ox.ac.uk>
Subject: Re: identify.default ignores any setting of cex (PR#660)
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

A follow-up to PR#660 (15 Sep 2000) from Brian Ripley:

> R 1.1.1 on Windows, but I think this is widespread.
>
> Using either
>
> par(cex=0.5)
> plot(1:10)
> identify(1:10)
>
> or
> 
> plot(1:10)
> identify(1:10, cex=0.5)
> 
> ignores the cex setting.  The root cause is that par(cex=0.5)
> alters cexbase for the device but sets cex=1.0, and the internal
> text plotting routines use cex and not cexbase.
> 
> The obvious fix is to set cex to cexbase in do_identify. However,
> if this is fixed, there is another problem, The offset of the label
> is related to the cex in use for the label, and not for the symbol.
> So
> 
> plot(1:10, type="n")
> points(1:10, cex=5)
> identify(1:10)
> 
> is not sensible in placing the labels.  That may be hard to anticipate,
> but 
> 
> plot(1:10)
> identify(1:10, cex=0.5)
> 
> needs to use cex=1 not cex=0.5 for the adjustment.  Perhaps identify is
> trying too hard, and should give the user more control over the precise
> position of the label (as S-PLUS does).


The same with 

 par(cex=1); plot(1:10); text(4, 5, "Hello World") # OK
 par(cex=2); plot(1:10); text(4, 5, "Hello World") # OK
 par(cex=2); plot(1:10); text(4, 5, "Hello World", cex = 1) # NOT OK
 par(cex=2); plot(1:10); text(4, 5, "Hello World", cex = 0.5)

So the scaling with cex in text() is relative to the par() settings,
which is not the expected behaviour.


[R-1.2.2 on WinNT 4.0]

Uwe Ligges

==> 660.followup.2 <==
From ripley@stats.ox.ac.uk  Wed Apr 25 20:00:09 2001
Received: from toucan.stats.ox.ac.uk (toucan.stats.ox.ac.uk [163.1.20.20])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id UAA03187
	for <R-bugs@biostat.ku.dk>; Wed, 25 Apr 2001 20:00:09 +0200 (MET DST)
Received: from max166.public.ox.ac.uk (max166.public.ox.ac.uk [192.76.27.166])
	by toucan.stats.ox.ac.uk (8.9.0/8.9.0) with ESMTP id SAA06061;
	Wed, 25 Apr 2001 18:56:30 +0100 (BST)
Date: Wed, 25 Apr 2001 18:55:47 +0100 (GMT Daylight Time)
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
To: <ligges@statistik.uni-dortmund.de>
cc: <r-devel@stat.math.ethz.ch>, <R-bugs@biostat.ku.dk>
Subject: Re: [Rd] Re: identify.default ignores any setting of cex (PR#660)
In-Reply-To: <200104251524.RAA02124@pubhealth.ku.dk>
Message-ID: <Pine.WNT.4.31.0104251852500.300-100000@tern.stats>
Sender: ripley@stats.ox.ac.uk
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Wed, 25 Apr 2001 ligges@statistik.uni-dortmund.de wrote:

> A follow-up to PR#660 (15 Sep 2000) from Brian Ripley:

[...]

> The same with
>
>  par(cex=1); plot(1:10); text(4, 5, "Hello World") # OK
>  par(cex=2); plot(1:10); text(4, 5, "Hello World") # OK
>  par(cex=2); plot(1:10); text(4, 5, "Hello World", cex = 1) # NOT OK
>  par(cex=2); plot(1:10); text(4, 5, "Hello World", cex = 0.5)
>
> So the scaling with cex in text() is relative to the par() settings,
> which is not the expected behaviour.

It is the documented behaviour, though: see the description of cex in
?help.

     cex: numeric character expansion factor; multiplied by
          `par("cex")' yields the final character size.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 776 *
Subject: strwidth does not take font into account
From: Martyn Plummer <plummer@iarc.fr>
Date: Tue, 19 Dec 2000 14:56:01 +0100 (CET)
--This needs a substantial redesign.
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 776 <==
From postmaster@franz.stat.wisc.edu  Tue Dec 19 14:53:40 2000
Received: from franz.stat.wisc.edu (franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id OAA05819
	for <r-bugs@biostat.ku.dk>; Tue, 19 Dec 2000 14:53:39 +0100 (MET)
Received: from smtp02.iarc.fr (really [212.157.236.234]) by franz.stat.wisc.edu
	via in.smtpd with esmtp
	id <m148NHG-000IYiC@franz.stat.wisc.edu> (Debian Smail3.2.0.102)
	for <r-bugs@r-project.org>; Tue, 19 Dec 2000 07:58:02 -0600 (CST) 
Received: from xena.iarc.fr ([10.10.150.125])
	by smtp02.iarc.fr (8.9.3/8.9.3) with ESMTP id OAA21720
	for <r-bugs@r-project.org>; Tue, 19 Dec 2000 14:53:55 +0100
Message-ID: <XFMail.001219145601.plummer@iarc.fr>
X-Mailer: XFMail 1.3 [p0] on Linux
X-Priority: 3 (Normal)
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 8bit
MIME-Version: 1.0
Date: Tue, 19 Dec 2000 14:56:01 +0100 (CET)
Organization: International Agency for Research on Cancer
Sender: martyn@xena.iarc.fr
From: Martyn Plummer <plummer@iarc.fr>
To: r-bugs@r-project.org
Subject: strwidth does not take font into account

One for the wishlist.

The text() function permits the use of different fonts with the arguments
"font" or "vfont".  These create text strings of the same height as the
default font, but of different widths: bold face is slightly wider; vector
fonts are usually much wider.  I think the strwidth() function needs to
take the font into account by also having "font" and "vfont" arguments.
Currently it reports the string width using the default font, which can
be quite different.

Here is a little test function you can use to see how far off the
reported string width is.

test.strwidth <-
function(text, vfont=NULL, cex=NULL, ...)
{
 plot(0,0,xlim=c(-1,1),ylim=c(-1,1), type="n")
 text(0,0, text, adj=c(0,0), offset=0, cex=cex, vfont=vfont, ...)
 abline(h=c(0, strheight(text, cex=cex)), lty=2)
 abline(v=c(0, strwidth(text, cex=cex)), lty=2)
}

e.g.

test.strwidth("This is some text", cex=2)
test.strwidth("This is some text", cex=2, font=2)
test.strwidth("This is some text", vfont=c("sans serif", "plain"))

Martyn

Please do not edit the information below--

Version:
 platform = i686-pc-linux-gnu
 arch = i686
 os = linux-gnu
 system = i686, linux-gnu
 status =
 major = 1
 minor = 2.0
 year = 2000
 month = 12
 day = 15
 language = R

Search Path:
 .GlobalEnv, package:ctest, Autoloads, package:base




==> 776.audit <==
Tue Dec 26 10:31:10 2000	ripley	moved from incoming to Graphics
Sat Feb 24 08:55:28 2001	ripley	changed notes
Sat Feb 24 08:55:28 2001	ripley	foobar
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 791 *
Subject:  par(lab= *) / axis(*) bug 
From: maechler@stat.math.ethz.ch
Date: Fri, 22 Dec 2000 10:59:26 +0100
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 791 <==
From postmaster@franz.stat.wisc.edu  Fri Dec 22 10:59:23 2000
Received: from franz.stat.wisc.edu (franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id KAA08619
	for <r-bugs@biostat.ku.dk>; Fri, 22 Dec 2000 10:59:23 +0100 (MET)
Received: from stat.math.ethz.ch (really [129.132.58.23]) by franz.stat.wisc.edu
	via in.smtpd with esmtp (ident daemon using rfc1413)
	id <m149OzA-000IXMC@franz.stat.wisc.edu> (Debian Smail3.2.0.102)
	for <r-bugs@r-project.org>; Fri, 22 Dec 2000 03:59:36 -0600 (CST) 
Received: (from daemon@localhost)
	by stat.math.ethz.ch (8.9.1/8.9.1) id KAA02617;
	Fri, 22 Dec 2000 10:59:34 +0100 (MET)
Received: from UNKNOWN(129.132.58.33), claiming to be "florence.ethz.ch"
 via SMTP by hypatia, id smtpdAAAa000cp; Fri Dec 22 10:59:26 2000
Received: (maechler@localhost) by florence.ethz.ch (8.9.3/D-MATH-client) id KAA23075; Fri, 22 Dec 2000 10:59:26 +0100
Date: Fri, 22 Dec 2000 10:59:26 +0100
From: maechler@stat.math.ethz.ch
Message-Id: <200012220959.KAA23075@florence.ethz.ch>
To: r-bugs@r-project.org
Subject:  par(lab= *) / axis(*) bug 
Cc: maechler@stat.math.ethz.ch

As the subject says,
here is example code (with comments) showing the problem:

p1 <- function(lab = c(8,12,7))
{
    ## This `fails' (on a virgin device)
    clab <- paste(lab,collapse=",")
    plot(1,1, xlim = c(0,15), ylim = c(-.8,1), type ="n", axes = FALSE,
         main=paste("plot(*,axes=F); par(lab= c(",clab,"));  axis(*) x 2",sep=""))
    box(col="gray80")
    op <- par(lab = lab) ; on.exit(par(op))
    axis(1, pos = 0)
    axis(2, pos = 0, las = 1)
    par(op)
    op
}

p2 <- function(lab = c(8,12,7))
{
    ## This works  [par()  *BEFORE*  plot() ]
    clab <- paste(lab,collapse=",")
    op <- par(lab = lab) ; on.exit(par(op))

    plot(1,1, xlim = c(0,15), ylim = c(-.8,1), type ="n", axes = FALSE,
         main=paste("par(lab= c(",clab,")); plot(*,axes=F); axis(*) x 2",sep=""))
    box(col="gray80")
    axis(1, pos = 0)
    axis(2, pos = 0, las = 1)
    op ## lab 5 5 7
}

dev.off()
par(mfrow=c(2,1), mar=c(2,2,3,1))
p1()
p2()




--please do not edit the information below--

Version:
 platform = i686-pc-linux-gnu
 arch = i686
 os = linux-gnu
 system = i686, linux-gnu
 status = Patched
 major = 1
 minor = 2.0
 year = 2000
 month = 12
 day = 19
 language = R

Search Path:
 .GlobalEnv, package:nls, package:splines, package:lqs, package:modreg, package:stepfun, package:mva, package:eda, package:ts, package:VLMC, package:ctest, package:SfS, Autoloads, package:base

==> 791.audit <==
Tue Dec 26 10:31:10 2000	ripley	moved from incoming to Graphics
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 816 *
Subject: dotplot: character size of labels
From: RINNER Heinrich <H.RINNER@TIROL.GV.AT>
Date: Thu, 18 Jan 2001 14:54:32 +0100
--Suggested fix is incorporated in 1.2.2.
--
--There is a deeper problem:  mtext() ignores par(cex=.5) in general.  
--To see the problem try:  par(cex=.5); mtext("hi")
--Paul thinks the right fix is to change the argument list for mtext so that
--cex=par(cex) by default rather than cex=NA by default (plus corresponding
--internal changes to  do_mtext in plot.c).
--This needs to be done very carefully because (i) the change suggested above 
--mayhave side-effects in many other pieces of interpreted code 
--(ii) do_mtext ignores dd->gp.cexbase unlike, for example, do_plot_xy 
--and anything to do with cexbase needs extreme care.
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 816 <==
From postmaster@franz.stat.wisc.edu  Thu Jan 18 16:57:16 2001
Received: from franz.stat.wisc.edu (franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id QAA13627
	for <r-bugs@biostat.ku.dk>; Thu, 18 Jan 2001 16:57:15 +0100 (MET)
Received: from ingw1.tirol.gv.at (really [212.183.27.1]) by franz.stat.wisc.edu
	via in.smtpd with esmtp
	id <m14JHRE-000IWyC@franz.stat.wisc.edu> (Debian Smail3.2.0.102)
	for <r-bugs@r-project.org>; Thu, 18 Jan 2001 09:57:24 -0600 (CST) 
Received: from xms.tirol.gv.at (xms.tirol.gv.at [10.11.128.200])
	by ingw1.tirol.gv.at (Mailer) with ESMTP id 22ADE2825
	for <r-bugs@r-project.org>; Thu, 18 Jan 2001 14:49:47 +0100 (NFT)
Received: from xms.tirol.gv.at (unverified) by xms.tirol.gv.at
 (Content Technologies SMTPRS 4.1.5) with ESMTP id <T0a0b80c8512ecf1400@xms.tirol.gv.at> for <r-bugs@r-project.org>;
 Thu, 18 Jan 2001 14:54:33 +0100
Received: by xms.tirol.gv.at with Internet Mail Service (5.5.2650.21)
	id <CLGLQ6B7>; Thu, 18 Jan 2001 14:54:33 +0100
Message-ID: <C4D44AB4CB62D311BA6500041202E8862640F8@xms1.tirol.gv.at>
From: RINNER Heinrich <H.RINNER@TIROL.GV.AT>
To: "'r-bugs@r-project.org'" <r-bugs@r-project.org>
Subject: dotplot: character size of labels
Date: Thu, 18 Jan 2001 14:54:32 +0100
Return-Receipt-To: RINNER Heinrich <H.RINNER@TIROL.GV.AT>
MIME-Version: 1.0
X-Mailer: Internet Mail Service (5.5.2650.21)
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: 8bit
X-MIME-Autoconverted: from quoted-printable to 8bit by pubhealth.ku.dk id QAA13627

There seems to be a bug in "dotplot" concerning the "cex" parameter. Setting
cex has no effect on the character size of the labels of the points.
This problem was posted to r-help today (Thu, 18 Jan 2001); the solution
given by Brian Ripley (and Uwe Ligges) seems to work for me.

Heinrich Rinner.
 
> version
         _              
platform i386-pc-mingw32
arch     x86            
os       Win32          
system   x86, Win32     
status                  
major    1              
minor    2.0            
year     2000           
month    12             
day      15             
language R              

> ----------
> Von: 	Prof Brian Ripley[SMTP:ripley@stats.ox.ac.uk]
> Gesendet: 	Donnerstag, 18. Jnner 2001 10:35
> An: 	RINNER Heinrich
> Cc: 	'r-help@stat.math.ethz.ch'
> Betreff: 	Re: [R] dotplot: character size of labels
> 
> On Thu, 18 Jan 2001, RINNER Heinrich wrote:
> 
> > Dear R users,
> >
> > using dotplot (R1.2.0, WinNT4.0), I am trying to change the character
> size
> > of the labels of the points:
> >
> > > # example
> > > data(VADeaths)
> > > dotplot(VADeaths, main = "Death Rates in Virginia - 1940")
> > > # I'd like to have smaller character size of the labels (for age and
> > population groups)
> > > ?dotplot
> > > # for argument "cex", this says: "Setting cex to a value smaller than
> one
> > can be a useful way of avoiding label overlap."
> > > dotplot(VADeaths, main = "Death Rates in Virginia - 1940", cex = 0.5)
> > > # the main title and the plotting characters are smaller now, but not
> the
> > labels
> > > # trying to set other graphics parameters seems to have no effect:
> > > dotplot(VADeaths, main = "Death Rates in Virginia - 1940", cex.axis =
> 0.5)
> > > dotplot(VADeaths, main = "Death Rates in Virginia - 1940", cex.lab =
> 0.5)
> >
> > I'd be grateful for any hint how to do this correctly;
> 
> Looks like a bug. Inside dotplot alter to
> 
>         for (i in 1:n) mtext(labs[i], side = 2, line = loffset,
>             at = y[i], adj = 0, col = color, las = 2, cex = cex, ...)
> 
>         for (i in 1:nlevels(groups)) mtext(glabels[i], side = 2,
>             line = goffset, at = gpos[i], adj = 0, col = gcolor,
>             las = 2, cex = cex, ...)
> 
> However, it really needs more than that to calculate the spaces for the
> labels correctly.
> 
> 
> -- 
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272860 (secr)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> 

==> 816.audit <==
Sat Jan 20 10:24:14 2001	ripley	moved from incoming to Graphics
Tue Jan 23 03:38:23 2001	paul	changed notes
Tue Jan 23 03:38:23 2001	paul	foobar
Sun Feb 18 10:11:12 2001	ripley	changed notes
Sun Feb 18 10:11:12 2001	ripley	foobar
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 820 *
Subject: interaction.plot
From: "Mark M. Span" <span@psy.uva.nl>
Date: Mon, 22 Jan 2001 10:47:39 +0100
--mtext is unscaled by default.  It is not clear if this should
--use the par("cex") setting or an inline cex setting such as cex.axis.
--It might make more sense to use axis rather than mtext, as boxplot does.
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 820 <==
From postmaster@franz.stat.wisc.edu  Mon Jan 22 10:43:38 2001
Received: from franz.stat.wisc.edu (franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id KAA09043
	for <r-bugs@biostat.ku.dk>; Mon, 22 Jan 2001 10:43:37 +0100 (MET)
Received: from mail.psy.uva.nl (really [145.18.113.16]) by franz.stat.wisc.edu
	via in.smtpd with esmtp
	id <m14KdVr-000IWyC@franz.stat.wisc.edu> (Debian Smail3.2.0.102)
	for <r-bugs@r-project.org>; Mon, 22 Jan 2001 03:43:47 -0600 (CST) 
Received: from rea2205 (rea2205.psy.uva.nl [145.18.152.205])
	by mail.psy.uva.nl (8.9.3/8.9.3) with SMTP id KAA21513
	for <r-bugs@r-project.org>; Mon, 22 Jan 2001 10:43:45 +0100 (MET)
Message-ID: <008501c08458$5bfc6530$cd981291@psy.uva.nl>
From: "Mark M. Span" <span@psy.uva.nl>
To: <r-bugs@r-project.org>
Subject: interaction.plot
Date: Mon, 22 Jan 2001 10:47:39 +0100
Organization: UvA
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: 7bit
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook Express 5.50.4133.2400
X-MimeOLE: Produced By Microsoft MimeOLE V5.50.4133.2400

I notices some indesireable behaviour in interaction.plot. The scaling of
the x-axis labels discards the overall settings for the 'cex' attribute,
leading to unscaled labels. The source for this behaviour is the line

mtext(xlabs, 1, at = xvals)

in interaction.plot.

to get this function to perform conform the manual, change this line to

mtext(xlabs, 1, at = xvals, cex=par("cex"))

and all is well.

because of the simplicity of this 'fix' I assume that it is a crossplatform
thingie, but for the record:

I use R-Win in winNT, 1.2.0, upgrading soon.

just my .02 euro..

I'll just end this mail with a standard declaration of love for R

greetz. Mark M. Span


==> 820.audit <==
Thu Jan 25 00:05:53 2001	ripley	moved from incoming to Graphics
Sat Feb 24 08:53:40 2001	ripley	changed notes
Sat Feb 24 08:53:40 2001	ripley	foobar
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 828 *
Subject: termplot fails for composite non-factor terms
From: John Maindonald <john.maindonald@anu.edu.au>
Date: Sat, 27 Jan 2001 11:57:37 +1100 (EST)
--Neither of the proposed changes actually works in sufficient generality.
--
--The easy and unimportant part of this, the labels, is fixed in 1.2.2. Getting
--the data right is a project for 1.3
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 828 <==
From postmaster@franz.stat.wisc.edu  Sat Jan 27 01:57:37 2001
Received: from franz.stat.wisc.edu (franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id BAA07865
	for <r-bugs@biostat.ku.dk>; Sat, 27 Jan 2001 01:57:36 +0100 (MET)
Received: from leonard.anu.edu.au (really [150.203.2.15]) by franz.stat.wisc.edu
	via in.smtpd with esmtp
	id <m14MJgZ-000IWyC@franz.stat.wisc.edu> (Debian Smail3.2.0.102)
	for <r-bugs@r-project.org>; Fri, 26 Jan 2001 18:57:47 -0600 (CST) 
Received: (from u9801539@localhost)
	by leonard.anu.edu.au (8.9.3/8.9.3) id LAA25063
	for r-bugs@r-project.org; Sat, 27 Jan 2001 11:57:37 +1100 (EST)
Date: Sat, 27 Jan 2001 11:57:37 +1100 (EST)
From: John Maindonald <john.maindonald@anu.edu.au>
Message-Id: <200101270057.LAA25063@leonard.anu.edu.au>
To: r-bugs@r-project.org
Subject: termplot fails for composite non-factor terms

I am running R 1.2.1 under Windows 98SE.

termplot() currently fails when there are composite terms, thus:
  > library(mass)
  > data(hills)
  > hills.lm <- lm(time ~ climb + poly(dist, 2), data = hills)
  > termplot(hills.lm)
  Hit <Return> to see next plot: 
  Error in eval(expr, envir, enclos) : Object "dist" not found

The call
  > termplot(hills.lm,data=hills)
does run without generating an error message, i.e. there is a 
problem with the default setting for the parameter 'data'. 
However the x-axis for the term poly(dist,2) is then incorrectly 
labelled as poly(dist,2), rather than dist
The label poly(dist,2) surely belongs as part of the y-axis label.

Here are suggested fixes

1. In the default parameters for the function call change
   data = model.frame(model)
to
   data = get(as.character(model$call$data))

[This does not work if the variable values are specified in the
function call.  It is not clear to me how to fix that.]

2. A few lines from the beginning, replace
    if (is.null(xlabs)) 
        xlabs <- nmt
    if (is.null(ylab)) 
        ylab <- substitute(link(foo), list(foo = formula(model)[[2]]))
with
   if (is.null(xlabs)) 
        xlabs <- unlist(lapply(cn,function(x)
        if(length(x)>1)as.character(x[[2]]) else as.character(x)))
   if (is.null(ylab)) 
        ylab <- paste("Partial for", nmt)

[The current y-label is "link(<yvar>)".  If it is thought necessary
to specify this, it should be additional to e.g., in my example,
"Partial for poly(dist,2)"]

Replace ylab = ylab with 
   ylab = ylab[i]
in the two places (arguments to plot()) where it appears.

John Maindonald               email : john.maindonald@anu.edu.au        
Statistical Consulting Unit,  phone : (6125)3998        
c/o CMA, SMS,                 fax   : (6125)5549  
John Dedman Mathematical Sciences Building
Australian National University
Canberra ACT 0200
Australia

==> 828.followup.1 <==
From tlumley@u.washington.edu  Sat Jan 27 02:08:54 2001
Received: from jason02.u.washington.edu (root@jason02.u.washington.edu [140.142.8.52])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id CAA07896
	for <R-bugs@biostat.ku.dk>; Sat, 27 Jan 2001 02:08:53 +0100 (MET)
Received: from homer06.u.washington.edu (tlumley@homer06.u.washington.edu [140.142.15.40])
	by jason02.u.washington.edu (8.9.3+UW00.05/8.9.3+UW00.12) with ESMTP id RAA28204;
	Fri, 26 Jan 2001 17:09:04 -0800
Received: from localhost (tlumley@localhost)
	by homer06.u.washington.edu (8.9.3+UW00.05/8.9.3+UW00.12) with ESMTP id RAA186066;
	Fri, 26 Jan 2001 17:09:03 -0800
Date: Fri, 26 Jan 2001 17:09:03 -0800 (PST)
From: Thomas Lumley <tlumley@u.washington.edu>
To: john.maindonald@anu.edu.au
cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] termplot fails for composite non-factor terms (PR#828)
In-Reply-To: <200101270057.BAA07875@pubhealth.ku.dk>
Message-ID: <Pine.A41.4.21.0101261704120.21498-100000@homer06.u.washington.edu>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Sat, 27 Jan 2001 john.maindonald@anu.edu.au wrote:

> I am running R 1.2.1 under Windows 98SE.
> 
> termplot() currently fails when there are composite terms, thus:
>   > library(mass)
>   > data(hills)
>   > hills.lm <- lm(time ~ climb + poly(dist, 2), data = hills)
>   > termplot(hills.lm)
>   Hit <Return> to see next plot: 
>   Error in eval(expr, envir, enclos) : Object "dist" not found
> 
> The call
>   > termplot(hills.lm,data=hills)
> does run without generating an error message, i.e. there is a 
> problem with the default setting for the parameter 'data'. 
> However the x-axis for the term poly(dist,2) is then incorrectly 
> labelled as poly(dist,2), rather than dist
> The label poly(dist,2) surely belongs as part of the y-axis label.
> 
> Here are suggested fixes
> 
> 1. In the default parameters for the function call change
>    data = model.frame(model)
> to
>    data = get(as.character(model$call$data))
> 
> [This does not work if the variable values are specified in the
> function call.  It is not clear to me how to fix that.]

Also, it does not specify where to get() the data: what environment to
use. The reason that the data= argument is present in termplot() is that
we can't tell where to find the data in general.

The situation is better as of R1.2, since we can look up variables in the
environment of the model formula. This would fix not only termplot() but a
number of other prediction-related problems.


> 2. A few lines from the beginning, replace
>     if (is.null(xlabs)) 
>         xlabs <- nmt
>     if (is.null(ylab)) 
>         ylab <- substitute(link(foo), list(foo = formula(model)[[2]]))
> with
>    if (is.null(xlabs)) 
>         xlabs <- unlist(lapply(cn,function(x)
>         if(length(x)>1)as.character(x[[2]]) else as.character(x)))
>    if (is.null(ylab)) 
>         ylab <- paste("Partial for", nmt)
> 
> [The current y-label is "link(<yvar>)".  If it is thought necessary
> to specify this, it should be additional to e.g., in my example,
> "Partial for poly(dist,2)"]
> 
> Replace ylab = ylab with 
>    ylab = ylab[i]
> in the two places (arguments to plot()) where it appears.


This looks like a good idea. 

	-thomas


==> 828.audit <==
Mon Jan 29 08:36:10 2001	ripley	moved from incoming to Graphics
Fri Feb 16 22:43:59 2001	thomas	changed notes
Fri Feb 16 22:43:59 2001	thomas	foobar
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 831 *
Subject: screen can't go back to (split) screen with log="y" plot
From: Thomas Vogels <tov@ece.cmu.edu>
Date: 30 Jan 2001 00:39:41 -0500
--Still there. Suggested fix included in followups, but we didn't get around to
--try it in time for 1.2.3.
--
--Fix doesn't work. One problem is that the opar<-par();par(opar) idiom updates
--xaxp before xlog, and the new value of xaxp may only be valid under the new
--value of xlog.
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 831 <==
From postmaster@franz.stat.wisc.edu  Tue Jan 30 06:39:31 2001
Received: from franz.stat.wisc.edu (franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id GAA28455
	for <r-bugs@biostat.ku.dk>; Tue, 30 Jan 2001 06:39:30 +0100 (MET)
Received: from infiniti.ece.cmu.edu (really [128.2.216.84]) by franz.stat.wisc.edu
	via in.smtpd with esmtp
	id <m14NTW2-000IWyC@franz.stat.wisc.edu> (Debian Smail3.2.0.102)
	for <r-bugs@r-project.org>; Mon, 29 Jan 2001 23:39:42 -0600 (CST) 
Received: (from tov@localhost) by infiniti.ece.cmu.edu (AIX4.3/UCB 8.8.8/8.8.8) id AAA26672; Tue, 30 Jan 2001 00:39:42 -0500
X-Authentication-Warning: infiniti.ece.cmu.edu: tov set sender to tov@ece.cmu.edu using -f
Sender: tov@infiniti.ece.cmu.edu
To: r-bugs@r-project.org
Cc: Thomas Vogels <tov@ece.cmu.edu>
Subject: screen can't go back to (split) screen with log="y" plot
Reply-To: Thomas Vogels <tov@ece.cmu.edu>
X-URI: http://www.ece.cmu.edu/~tov
From: Thomas Vogels <tov@ece.cmu.edu>
User-Agent: Gnus/5.0807 (Gnus v5.8.7) Emacs/20.7
Date: 30 Jan 2001 00:39:41 -0500
Message-ID: <pxsnm1egyq.fsf@infiniti.ece.cmu.edu>
Lines: 76
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii


Hi.  Let's try to explain the subject line with some code:

> split.screen (c(2,1))
[1] 1 2
> screen(1)
> plot (1:2, 1:2, log="y", main="1")
> screen (2)
> plot (1:2, 1:2, main="2")
> screen (1)
Error in par(.split.screens[[n]]) : invalid value specified for graphics parameter "yaxp".
> close.screen(all=TRUE)

Let's add comments:

> split.screen (c(2,1))
[1] 1 2

OK, plot in the top half screen:
> screen(1)
> plot (1:2, 1:2, log="y", main="1")
> par("yaxp")
[1]  1  2 -5

OK, switch to bottom half:
> screen (2)
> plot (1:2, 1:2, main="2")
> par("yaxp")
[1] 1 2 5

OK, looks fine, let's go back up:
> screen (1)
Error in par(.split.screens[[n]]) : invalid value specified for graphics parameter "yaxp".

Bummer.
> close.screen(all=TRUE)

Somehow I'm hoping you'll tell me I'm doing something wrong, because
I'd really would like to be able to do the following:
  repeat {
    #calculate
    screen(1)
    #fancy plot
    screen (2)
    #even fancier plot ;-)
    if (user.bored()) break
  }
Which is roughly what I was doing when the error messages started
popping up.

Thanks,
  -tom

--please do not edit the information below--

Version:
 platform = i386-pc-linux-gnu
 arch = i386
 os = linux-gnu
 system = i386, linux-gnu
 status = 
 major = 1
 minor = 2.1
 year = 2001
 month = 01
 day = 15
 language = R

Search Path:
 .GlobalEnv, package:ctest, Autoloads, package:base



-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204


==> 831.followup.1 <==
From ripley@stats.ox.ac.uk  Tue Jan 30 08:40:46 2001
Received: from toucan.stats.ox.ac.uk (toucan.stats.ox.ac.uk [163.1.20.20])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id IAA28901
	for <R-bugs@biostat.ku.dk>; Tue, 30 Jan 2001 08:40:46 +0100 (MET)
Received: from max144.public.ox.ac.uk (max144.public.ox.ac.uk [192.76.27.144])
	by toucan.stats.ox.ac.uk (8.9.0/8.9.0) with ESMTP id HAA21509;
	Tue, 30 Jan 2001 07:40:54 GMT
Date: Tue, 30 Jan 2001 07:39:25 +0000 (GMT)
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Sender: <ripley@auk.stats>
To: <tov@ece.cmu.edu>
cc: <R-bugs@biostat.ku.dk>
Subject: Re: [Rd] screen can't go back to log="y" plot (PR#831)
In-Reply-To: <200101300539.GAA28465@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.31.0101300725290.17104-100000@auk.stats>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

[I have abbreviated the subject as jitterbug has been having probems
with long subjects.]

The issue here is that one cannot mix log/non-log axes in the calls to
screen(), as the appropriate par() parameter is read-only, but the
meaning of yaxp depends on it.  But beyond that you can't set
x/yaxp for log axes.

You should be able to do this: you can in the S original.

A simpler version:

plot (1:2, 1:2, log="y", main="1")
zz <- par("yaxp")
zz
[1]  1  2 -5
par(yaxp=zz)
Error in par(yaxp = zz) : invalid value specified for graphics parameter
"yaxp".

So you can't reset the yaxp parameter to what it is reported as!


Additional bug: the meaning of x/yaxp for log axes is not defined
in help(par).


On Tue, 30 Jan 2001 tov@ece.cmu.edu wrote:

>
> Hi.  Let's try to explain the subject line with some code:
>
> > split.screen (c(2,1))
> [1] 1 2
> > screen(1)
> > plot (1:2, 1:2, log="y", main="1")
> > screen (2)
> > plot (1:2, 1:2, main="2")
> > screen (1)
> Error in par(.split.screens[[n]]) : invalid value specified for graphics parameter "yaxp".
> > close.screen(all=TRUE)
>
> Let's add comments:
>
> > split.screen (c(2,1))
> [1] 1 2
>
> OK, plot in the top half screen:
> > screen(1)
> > plot (1:2, 1:2, log="y", main="1")
> > par("yaxp")
> [1]  1  2 -5
>
> OK, switch to bottom half:
> > screen (2)
> > plot (1:2, 1:2, main="2")
> > par("yaxp")
> [1] 1 2 5
>
> OK, looks fine, let's go back up:
> > screen (1)
> Error in par(.split.screens[[n]]) : invalid value specified for graphics parameter "yaxp".
>
> Bummer.
> > close.screen(all=TRUE)
>
> Somehow I'm hoping you'll tell me I'm doing something wrong, because
> I'd really would like to be able to do the following:
>   repeat {
>     #calculate
>     screen(1)
>     #fancy plot
>     screen (2)
>     #even fancier plot ;-)
>     if (user.bored()) break
>   }
> Which is roughly what I was doing when the error messages started
> popping up.
>
> Thanks,
>   -tom
>
> --please do not edit the information below--
>
> Version:
>  platform = i386-pc-linux-gnu
>  arch = i386
>  os = linux-gnu
>  system = i386, linux-gnu
>  status =
>  major = 1
>  minor = 2.1
>  year = 2001
>  month = 01
>  day = 15
>  language = R
>
> Search Path:
>  .GlobalEnv, package:ctest, Autoloads, package:base
>
>
>
> --
> mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204
>
>
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


==> 831.followup.2 <==
From tov@ece.cmu.edu  Thu Feb  1 02:13:08 2001
Received: from infiniti.ece.cmu.edu (INFINITI.ECE.CMU.EDU [128.2.133.84])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id CAA25173
	for <R-bugs@biostat.ku.dk>; Thu, 1 Feb 2001 02:13:07 +0100 (MET)
Received: (from tov@localhost) by infiniti.ece.cmu.edu (AIX4.3/UCB 8.8.8/8.8.8) id UAA19026; Wed, 31 Jan 2001 20:12:41 -0500
X-Authentication-Warning: infiniti.ece.cmu.edu: tov set sender to tov@ece.cmu.edu using -f
Sender: tov@infiniti.ece.cmu.edu
To: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Cc: <R-bugs@biostat.ku.dk>
Subject: Re: [Rd] screen can't go back to log="y" plot (PR#831)
References: <Pine.GSO.4.31.0101300725290.17104-100000@auk.stats>
Reply-To: Thomas Vogels <tov@ece.cmu.edu>
X-URI: http://www.ece.cmu.edu/~tov
From: Thomas Vogels <tov@ece.cmu.edu>
Date: 31 Jan 2001 20:12:41 -0500
In-Reply-To: Prof Brian D Ripley's message of "Tue, 30 Jan 2001 07:39:25 +0000 (GMT)"
Message-ID: <px7l3bcik6.fsf@infiniti.ece.cmu.edu>
Lines: 81
User-Agent: Gnus/5.0807 (Gnus v5.8.7) Emacs/20.7
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii


Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:

> [I have abbreviated the subject as jitterbug has been having probems
> with long subjects.]
> 
> The issue here is that one cannot mix log/non-log axes in the calls to
> screen(), as the appropriate par() parameter is read-only, but the
> meaning of yaxp depends on it.  But beyond that you can't set
> x/yaxp for log axes.
> 
> You should be able to do this: you can in the S original.
> 
> A simpler version:
> 
> plot (1:2, 1:2, log="y", main="1")
> zz <- par("yaxp")
> zz
> [1]  1  2 -5
> par(yaxp=zz)
> Error in par(yaxp = zz) : invalid value specified for graphics parameter
> "yaxp".
> 
> So you can't reset the yaxp parameter to what it is reported as!
[snip]

The code in main/par.c ignores the value of xlog (or ylog) when
setting xaxp (or yaxp).  Right now you have in Specify (and Specify2):

... else if (streql(what, "xaxp")) {
	value = coerceVector(value, REALSXP);
	lengthCheck(what, value, 3);
	naRealCheck(REAL(value)[0], what);
	naRealCheck(REAL(value)[1], what);
        posIntCheck((int) (REAL(value)[2]), what);

Shouldn't that be something like:

... else if (streql(what, "xaxp")) {
	value = coerceVector(value, REALSXP);
	lengthCheck(what, value, 3);
	naRealCheck(REAL(value)[0], what);
	naRealCheck(REAL(value)[1], what);
        if (dd->gp.xlog)
            logAxpCheck((int) (REAL(value)[2]), what);
        else
            posIntCheck((int) (REAL(value)[2]), what);

Where logAxpCheck is suitably defined as:

static void logAxpCheck(int x, char *s)
{
    if (x == NA_INTEGER || x == 0 || x > 4)
	par_error(s);
}

since only values < 0 or the values 1, 2, 3 are allowed?


> Additional bug: the meaning of x/yaxp for log axes is not defined
> in help(par).

excerpt from help(par):

    xaxp: A vector of the form `c(x1, x2, n)' giving the coordinates
          of the extreme tick marks and the number of intervals
          between tick-marks.

Could you add:

          The value of n must be positive for linear scale axes.  For
          logarithmic scale axes n must be either negative (then there
          will be (1-n) ticks at a linear distance) or one of 1, 2, or
          3 where n then indicates the number of ticks per decade.

similar for yaxp?  What am I missing?
Regards,
  -tom

-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204

==> 831.audit <==
Wed Feb  7 08:51:14 2001	ripley	moved from incoming to Graphics
Thu Apr 26 12:13:40 2001	pd	changed notes
Thu Apr 26 12:13:40 2001	pd	foobar
Thu Jun  7 19:13:15 2001	thomas	changed notes
Thu Jun  7 19:13:15 2001	thomas	foobar
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 837 *
Subject: screen doesn't handle redrawing properly
From: Thomas Vogels <tov@ece.cmu.edu>
Date: 01 Feb 2001 14:20:52 -0500
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 837 <==
From tov@ece.cmu.edu  Thu Feb  1 20:20:40 2001
Received: from infiniti.ece.cmu.edu (INFINITI.ECE.CMU.EDU [128.2.133.84])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id UAA08721
	for <r-bugs@biostat.ku.dk>; Thu, 1 Feb 2001 20:20:39 +0100 (MET)
Received: (from tov@localhost) by infiniti.ece.cmu.edu (AIX4.3/UCB 8.8.8/8.8.8) id OAA30464; Thu, 1 Feb 2001 14:20:52 -0500
X-Authentication-Warning: infiniti.ece.cmu.edu: tov set sender to tov@ece.cmu.edu using -f
Sender: tov@infiniti.ece.cmu.edu
To: r-bugs@biostat.ku.dk
Cc: Thomas Vogels <tov@ece.cmu.edu>
Subject: screen doesn't handle redrawing properly
Reply-To: Thomas Vogels <tov@ece.cmu.edu>
X-URI: http://www.ece.cmu.edu/~tov
From: Thomas Vogels <tov@ece.cmu.edu>
Date: 01 Feb 2001 14:20:52 -0500
Message-ID: <pxitmub46j.fsf@infiniti.ece.cmu.edu>
Lines: 74
User-Agent: Gnus/5.0807 (Gnus v5.8.7) Emacs/20.7
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii


Hi.  As far as I understand it, there is a list of graphic primitives
stored for a device.  So for example, when I iconify/deiconify an X11
window, the plot will be redrawn.  Now screen (split.screen and
friends) appear not to handle this list properly, the list is reset or
not reset at odd times.  The commands below will show clearly what I
mean.  There are two effects:

  - After splitting the device real estate into two screens, I can
    plot on these screens, alternating between them.  When I then
    touch the window to force a redraw, *all* the plots are redrawn,
    not just the last (and visible) ones.
    [This happens when the X server runs on AIX, R runs on AIX or Sun.]

  - Again, after splitting, plotting on one screen can affect the
    other screen.  I.e. plot(...); plot (...) on the left screen can
    erase the *right* screen.
    [This happens for all platforms I have access to, AIX, Linux, Sun.]

The first effect may be due to a bad interaction with the X server,
but the second effect is surely not desirable, is it?  Am I mis-using
'screen' here?

R> split.screen (c(1,2))
[1] 1 2
R> # Draw 10000 points to make the effect obvious
R> screen (1)
R> plot (1:10000, 1:10000, main="1")
R> screen (2)
R> plot (1:10000, 1:10000, main="2")
R> # Ok, go back to screen 1, draw plots 3 and 4
R> screen (1)
R> plot (1:10000, 10000:1, main="3")
R> screen (2)
R> plot (1:10000, 10000:1, main="4")
R> 
R> ########################################
R> # NOW lower/raise window, do something to force device to redraw itself.
R> # You'll see again plot 1 (!), 2 (!), 3, and 4.  Why 1 and 2?
R> ########################################
R> 
R> # Here's how to erase screen 2 from screen 1 (!)
R> screen (1)
R> plot (1:10, 1:10, main="3a")
R> ########################################
R> # The following plot will erase screen 2
R> ########################################
R> plot (1:10, 1:10, main="3b")
R> 
R> # The good news is that this resets the list of graphic ops:
R> screen (2)
R> plot (1:10, 1:10, main="4")
R> # Now if you touch the window, you'll see only plot 3b and 4.

Regards,
  -tom

R> R.version
         _                   
platform sparc-sun-solaris2.7
arch     sparc               
os       solaris2.7          
system   sparc, solaris2.7   
status   Patched             
major    1                   
minor    2.1                 
year     2001                
month    01                  
day      31                  
language R                   

-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204


==> 837.audit <==
Wed Feb  7 08:51:14 2001	ripley	moved from incoming to Graphics
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 887 *
Subject: axis(adj=anything) has no effect
From: jhallman@frb.gov
Date: Wed, 28 Mar 2001 20:51:05 +0200 (MET DST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 887 <==
From jhallman@frb.gov  Wed Mar 28 20:51:06 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id UAA23265
	for <R-bugs@biostat.ku.dk>; Wed, 28 Mar 2001 20:51:05 +0200 (MET DST)
Date: Wed, 28 Mar 2001 20:51:05 +0200 (MET DST)
From: jhallman@frb.gov
Message-Id: <200103281851.UAA23265@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: axis(adj=anything) has no effect

Full_Name: Jeff Hallman
Version: 1.2.2
OS: SunOS5.6
Submission from: (NULL) (132.200.32.33)


Giving an adj argument to axis() seems to have no effect.  In Splus, adj = 0 
left-justifies the labels under the ticks, adj = 1 right justifies them, and 
numbers in between can also be used.  I like to use adj = 0.9 to get something
that looks like this:

-----------+-----------+-----------+------------+---------
        1980        1981        1982         1983

as an axis for a plot of monthly time series data.



==> 887.audit <==
Sat Apr  7 10:29:17 2001	ripley	moved from incoming to Graphics

==> 887.followup.1 <==
From paul@stat.auckland.ac.nz  Tue Jun 19 06:05:35 2001
Received: from mailhost.auckland.ac.nz (mailhost.auckland.ac.nz [130.216.191.4] (may be forged))
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id GAA16140
	for <R-bugs@biostat.ku.dk>; Tue, 19 Jun 2001 06:05:33 +0200 (MET DST)
Received: from stat1.stat.auckland.ac.nz (stat1.stat.auckland.ac.nz [130.216.93.1])
	by mailhost.auckland.ac.nz (8.9.2/8.9.2/8.9.2-ua) with ESMTP id QAA00412;
	Tue, 19 Jun 2001 16:05:26 +1200 (NZST)
Received: from murrell (murrell.stat.auckland.ac.nz [130.216.93.23])
	by stat1.stat.auckland.ac.nz (8.9.3+Sun/8.8.8) with SMTP id QAA24826;
	Tue, 19 Jun 2001 16:05:25 +1200 (NZST)
Message-ID: <020401c0f877$becbd540$175dd882@stat.auckland.ac.nz>
From: "Paul Murrell" <paul@stat.auckland.ac.nz>
To: <r-core@r-project.org>
Cc: <R-bugs@biostat.ku.dk>
Subject: Re: axis(adj=anything) has no effect (PR#887)
Date: Tue, 19 Jun 2001 16:24:35 +1200
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: 7bit
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook Express 5.50.4522.1200
X-MimeOLE: Produced By Microsoft MimeOLE V5.50.4522.1200

Hi

----Bug summary:----
Giving an adj argument to axis() seems to have no effect.  In Splus, adj = 0
left-justifies the labels under the ticks, adj = 1 right justifies them, and
numbers in between can also be used.  I like to use adj = 0.9 to get
something
that looks like this:

-----------+-----------+-----------+------------+---------
        1980        1981        1982         1983

as an axis for a plot of monthly time series data.
----Bug summary:----


Are missing features bugs or wish-list items ?

Paul


~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 916 *
Subject:  par(mgp) bug 
From: paul@stat.auckland.ac.nz
Date: Fri, 20 Apr 2001 08:33:45 +1200 (NZST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 916 <==
From postmaster@franz.stat.wisc.edu  Thu Apr 19 22:33:54 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id WAA02208
	for <r-bugs@biostat.ku.dk>; Thu, 19 Apr 2001 22:33:53 +0200 (MET DST)
Received: from mailhost.auckland.ac.nz (really [130.216.1.4]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m14qL7p-000J8eC@franz.stat.wisc.edu> (Debian Smail3.2.0.111)
	for <r-bugs@r-project.org>; Thu, 19 Apr 2001 15:34:01 -0500 (CDT) 
Received: from stat1.stat.auckland.ac.nz (stat1.stat.auckland.ac.nz [130.216.93.1])
	by mailhost.auckland.ac.nz (8.9.2/8.9.2/8.9.2-ua) with ESMTP id IAA16455
	for <r-bugs@r-project.org>; Fri, 20 Apr 2001 08:33:45 +1200 (NZST)
Received: (from paul@localhost)
	by stat1.stat.auckland.ac.nz (8.9.3+Sun/8.8.8) id IAA18528;
	Fri, 20 Apr 2001 08:33:45 +1200 (NZST)
Date: Fri, 20 Apr 2001 08:33:45 +1200 (NZST)
Message-Id: <200104192033.IAA18528@stat1.stat.auckland.ac.nz>
From: paul@stat.auckland.ac.nz
To: r-bugs@r-project.org
Cc: paul@stat1.stat.auckland.ac.nz
Subject:  par(mgp) bug 

Hi

The behaviour of the third argument of par(mgp), which controls the
placement of the axis ticks, is not working.  

In the following example, the plots should NOT be
identical; the axis ticks plus the axis major line should be drawn one
line out from the edges of the plot region.

par(mfrow=c(2,1))
plot(1:10)
par(mgp=c(3,1,1))
plot(1:10)

Paul

<<insert bug report here>>



--please do not edit the information below--

Version:
 platform = sparc-sun-solaris2.7
 arch = sparc
 os = solaris2.7
 system = sparc, solaris2.7
 status = Under development (unstable)
 major = 1
 minor = 3.0
 year = 2001
 month = 02
 day = 18
 language = R

Search Path:
 .GlobalEnv, package:ctest, Autoloads, package:base

==> 916.audit <==
Sat Apr 21 12:59:42 2001	ripley	moved from incoming to Graphics

==> 916.followup.1 <==
From paul@stat.auckland.ac.nz  Tue Jun 19 03:36:11 2001
Received: from mailhost.auckland.ac.nz (mailhost.auckland.ac.nz [130.216.191.4] (may be forged))
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id DAA15904
	for <R-bugs@biostat.ku.dk>; Tue, 19 Jun 2001 03:36:08 +0200 (MET DST)
Received: from stat1.stat.auckland.ac.nz (stat1.stat.auckland.ac.nz [130.216.93.1])
	by mailhost.auckland.ac.nz (8.9.2/8.9.2/8.9.2-ua) with ESMTP id NAA25485;
	Tue, 19 Jun 2001 13:36:01 +1200 (NZST)
Received: from murrell (murrell.stat.auckland.ac.nz [130.216.93.23])
	by stat1.stat.auckland.ac.nz (8.9.3+Sun/8.8.8) with SMTP id NAA21072;
	Tue, 19 Jun 2001 13:36:00 +1200 (NZST)
Message-ID: <012601c0f862$df47ec10$175dd882@stat.auckland.ac.nz>
From: "Paul Murrell" <paul@stat.auckland.ac.nz>
To: <r-core@r-project.org>
Cc: <R-bugs@biostat.ku.dk>
References: <200104192033.WAA02218@pubhealth.ku.dk>
Subject: Re: [Rd] par(mgp) bug (PR#916)
Date: Tue, 19 Jun 2001 13:55:09 +1200
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: 7bit
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook Express 5.50.4522.1200
X-MimeOLE: Produced By Microsoft MimeOLE V5.50.4522.1200

Hi


> The behaviour of the third argument of par(mgp), which controls the
> placement of the axis ticks, is not working.
>
> In the following example, the plots should NOT be
> identical; the axis ticks plus the axis major line should be drawn one
> line out from the edges of the plot region.
>
> par(mfrow=c(2,1))
> plot(1:10)
> par(mgp=c(3,1,1))
> plot(1:10)


This is more of an incompatibility-with-S rather than a bug.  In R,
axis(pos=) overrides axis(line=) which overrides par(mgp=).  It is possible
to get axis to respond to par(mgp=), but this is NOT the default behaviour.
For example,

par(mgp=c(3, 1, 1))
plot(1:10, axes=F)
box()
axis(1, line=NA)
axis(2)

In S, par(mgp=) specifies locations RELATIVE TO axis(line=), which can be
overridden by axis(pos=).

So the options are:
(i) become compatible NOW (for 1.3)
(ii) become compatible later
(iii) remain incompatible

I think we should do (i), especially because the default behaviour, which I
think would cover 99.999% of user code, would NOT change.

This is your chance to disagree ...

Paul



~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 940 *
Subject: GCircle(): fails for non-clippable devices under certain circumstances (see below)
From: "Thomas Hoffmann" <thoffman@zappa.sax.de>
Date: Tue, 15 May 01 23:34:17 +0100
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 940 <==
From postmaster@franz.stat.wisc.edu  Tue May 15 23:36:36 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id XAA19114
	for <r-bugs@biostat.ku.dk>; Tue, 15 May 2001 23:36:35 +0200 (MET DST)
Received: from sax.sax.de (really [193.175.26.33]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m14zmUW-000JGWC@franz.stat.wisc.edu> (Debian Smail3.2.0.111)
	for <r-bugs@r-project.org>; Tue, 15 May 2001 16:36:28 -0500 (CDT) 
Received: (from uucp@localhost)
	by sax.sax.de (8.9.3/8.9.3) with UUCP id XAA02964
	for r-bugs@r-project.org; Tue, 15 May 2001 23:36:22 +0200 (CEST)
Received:  by zappa.sax.de (UUPC/extended 1.13f);
           Tue, 15 May 2001 23:34:19 +0100
From: "Thomas Hoffmann" <thoffman@zappa.sax.de>
To: "r-bugs@r-project.org" <r-bugs@r-project.org>
Date: Tue, 15 May 01 23:34:17 +0100
Reply-To: "Thomas Hoffmann" <thoffman@zappa.sax.de>
Priority: Normal
X-Mailer: PMMail 1.9 For OS/2 UNREGISTERED SHAREWARE
X-Mailer-Gate: PMMail<->UUPC/extended Gateway v1.01
MIME-Version: 1.0
Content-Type: text/plain; charset="iso-8859-1"
Content-Transfer-Encoding: 7bit
Subject: GCircle(): fails for non-clippable devices under certain circumstances (see below)
Message-ID: <3b01aeeb.thoffman.zappa@zappa.sax.de>

The following code snippet from graphics.c: GCircle() (around line 3100) fails for devices which 
can not clip (dd->dp.canClip==0) and try to plot a circle that does not fit into the plot region, but
fits into the device region, see inserted comments:

....
    result = clipCircleCode(x, y, coords, ir, dd);
// result>0, because circle does not fit into plot region (for dd->gp.xpd=0)

    switch (result) {
    case -2: /* No clipping;  draw all of circle */
        dd->dp.circle(x, y, coords, ir, bg, fg, dd);
        break;
    case -1: /* Total clipping; draw nothing */
        break;
    default: /* Partial clipping; draw poly[line|gon] */
// we proceed here:
        dd->gp.xpd = 2;
// check clipping for the device region:
        result = clipCircleCode(x, y, coords, ir, dd);
// ...if it fits, result=-2: ouch, we have thrown away the result from the 1st check!
        dd->gp.xpd = xpdsaved;
        if (dd->dp.canClip && result == -2) {
// ...but it does not matter if we can clip!
            GClip(dd);
            dd->dp.circle(x, y, coords, ir, bg, fg, dd);
        }
        else {
//...BUT if we can not clip, then we call for trouble:
            vmax = vmaxget();$

....
    default: /* Partial clipping; draw poly[line|gon] */
      if (dd->dp.canClip) {
	dd->gp.xpd = 2;
	result = clipCircleCode(x, y, coords, ir, dd);
	dd->gp.xpd = xpdsaved;
	if (result == -2) {
	    GClip(dd);
	    dd->dp.circle(x, y, coords, ir, bg, fg, dd);
	    break;
	}
      }
      vmax = vmaxget();
      xc = (double*)R_alloc(result+1, sizeof(double));
      yc = (double*)R_alloc(result+1, sizeof(double));
      GConvert(&x, &y, coords, DEVICE, dd);
      convertCircle(x, y, ir, result, xc, yc, dd);
      if (bg == NA_INTEGER) {
	dd->gp.col = fg;
	GPolyline(result+1, xc, yc, DEVICE, dd);
      }
      else {
	int npts;
	double *xcc, *ycc;
	xcc = ycc = 0;	/* -Wall */
	npts = GClipPolygon(xc, yc, result, DEVICE, 0, xcc, ycc, dd);
	if (npts > 1) {
	  xcc = (double*)R_alloc(npts, sizeof(double));
	  ycc = (double*)R_alloc(npts, sizeof(double));
	  npts = GClipPolygon(xc, yc, result, DEVICE, 1,
			      xcc, ycc, dd);
	  dd->dp.polygon(npts, xcc, ycc, DEVICE, bg, fg, dd);
	}
      }
      vmaxset(vmax);
    }
}


This works at least in my test case at

> version
         _
platform i386-pc-os2_emx
arch     i386
os       os2_emx
system   i386, os2_emx
status
major    1
minor    2.2
year     2001
month    02
day      26
language R


Thomas Hoffmann.


==> 940.audit <==
Mon May 21 08:54:07 2001	ripley	moved from incoming to Graphics
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 943 *
Subject: legend() with xpd=T; omission of initial plot character
From: John Maindonald <john.maindonald@anu.edu.au>
Date: Sun, 20 May 2001 10:35:16 +1000
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 943 <==
From postmaster@franz.stat.wisc.edu  Sun May 20 02:32:40 2001
Received: from franz.stat.wisc.edu (franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id CAA02494
	for <r-bugs@biostat.ku.dk>; Sun, 20 May 2001 02:32:39 +0200 (MET DST)
Received: from mail.anu.edu.au (really [150.203.2.7]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m151H95-000JH8C@franz.stat.wisc.edu> (Debian Smail3.2.0.111)
	for <r-bugs@r-project.org>; Sat, 19 May 2001 19:32:31 -0500 (CDT) 
Received: from anugpo.anu.edu.au (anugpo.anu.edu.au [150.203.2.6])
	by mail.anu.edu.au (8.9.3/8.9.3) with ESMTP id KAA18515
	for <r-bugs@r-project.org>; Sun, 20 May 2001 10:32:27 +1000 (EST)
Received: from soda.anu.edu.au (soda.anu.edu.au [150.203.33.17])
	by anugpo.anu.edu.au (8.9.3+Sun/8.9.3) with ESMTP id KAA22405
	for <r-bugs@r-project.org>; Sun, 20 May 2001 10:32:27 +1000 (EST)
Message-Id: <5.0.2.1.1.20010520103337.00ac8b10@pophost.anu.edu.au>
X-Sender: u9801539@pophost.anu.edu.au (Unverified)
X-Mailer: QUALCOMM Windows Eudora Version 5.0.2
Date: Sun, 20 May 2001 10:35:16 +1000
To: r-bugs@r-project.org
From: John Maindonald <john.maindonald@anu.edu.au>
Subject: legend() with xpd=T; omission of initial plot character
Mime-Version: 1.0
Content-Type: text/plain; charset="us-ascii"; format=flowed


In the following:

plot(0:1, 0:1)
legend(x=0, y=1.2, pch=c(1,2), legend=c("May","June"))

the first plot character is omitted when plotting to
the screen.

I obtained the same behaviour when placing a legend
in the margin following use of pairs()

-please do not edit the information below--

Version:
  platform = i386-pc-mingw32
  arch = x86
  os = Win32
  system = x86, Win32
  status =
  major = 1
  minor = 2.3
  year = 2001
  month = 04
  day = 26
  language = R

Windows 98 SE 4.10 (build 2222)  A

Search Path:
  .GlobalEnv, package:ctest, Autoloads, package:base
John Maindonald               email : john.maindonald@anu.edu.au
Statistical Consulting Unit,  phone : (6125)3998
c/o CMA, SMS,                 fax   : (6125)5549
John Dedman Mathematical Sciences Building
Australian National University
Canberra ACT 0200
Australia


==> 943.reply.1 <==
From: paul@stat.auckland.ac.nz
To: r-core@r-project.org
Subject: Re: legend() with xpd=T; omission of initial plot character (PR#943)
Date: Tue Jun 19 05:58:40 2001
CC: r-bugs@r-project.org; john.maindonald@anu.edu.au

Hi

Bug summary:----
par(xpd=T)
plot(0:1, 0:1)
legend(x=0, y=1.2, pch=c(1,2), legend=c("May","June"))

the first plot character is omitted when plotting to
the screen.
Bug summary:----

I cannot reproduce this bug, BUT it did show up a bug in rect() -- in the
example above, the border around the legend is not drawn.

This is because rect() ignores par(xpd).  The default is rect(xpd=FALSE).  This
is at odds with text(xpd=NULL) and polygon(xpd=NULL) which use par(xpd) by
default.  arrows(xpd=FALSE) has the same problem as rect().  

I propose modifying rect() and arrows() to use par(xpd) by default like text()
and polygon().  There will, as usual, be a small risk that someone's code will
produce different output after this change, but this risk should be pretty
small.

Any objections ... ?

Paul

==> 943.followup.1 <==
From postmaster@franz.stat.wisc.edu  Tue Jun 19 05:56:22 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id FAA16092
	for <r-bugs@biostat.ku.dk>; Tue, 19 Jun 2001 05:56:21 +0200 (MET DST)
Received: from pubhealth.ku.dk (really [130.225.108.10]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m15CCch-000JGhC@franz.stat.wisc.edu> (Debian Smail3.2.0.111)
	for <r-bugs@r-project.org>; Mon, 18 Jun 2001 22:56:15 -0500 (CDT) 
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id FAA16087;
	Tue, 19 Jun 2001 05:55:27 +0200 (MET DST)
From: paul@stat.auckland.ac.nz
Received: from blueberry.kubism.ku.dk (blueberry.kubism.ku.dk [130.225.108.193])
	by blueberry.kubism.ku.dk (8.9.3/8.9.3) with ESMTP id FAA32381;
	Tue, 19 Jun 2001 05:58:35 +0200
Date: Tue, 19 Jun 2001 05:58:35 +0200
Message-Id: <200106190358.FAA32381@blueberry.kubism.ku.dk>
To: r-core@r-project.org
Subject: Re: legend() with xpd=T; omission of initial plot character (PR#943)
CC: r-bugs@r-project.org;john.maindonald@anu.edu.au;;;
X-Loop: R-bugs@biostat.ku.dk

Hi

Bug summary:----
par(xpd=T)
plot(0:1, 0:1)
legend(x=0, y=1.2, pch=c(1,2), legend=c("May","June"))

the first plot character is omitted when plotting to
the screen.
Bug summary:----

I cannot reproduce this bug, BUT it did show up a bug in rect() -- in the
example above, the border around the legend is not drawn.

This is because rect() ignores par(xpd).  The default is rect(xpd=FALSE).  This
is at odds with text(xpd=NULL) and polygon(xpd=NULL) which use par(xpd) by
default.  arrows(xpd=FALSE) has the same problem as rect().  

I propose modifying rect() and arrows() to use par(xpd) by default like text()
and polygon().  There will, as usual, be a small risk that someone's code will
produce different output after this change, but this risk should be pretty
small.

Any objections ... ?

Paul


==> 943.reply.2 <==
From postmaster@franz.stat.wisc.edu  Tue Jun 19 08:43:07 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id IAA16819
	for <r-bugs@biostat.ku.dk>; Tue, 19 Jun 2001 08:43:07 +0200 (MET DST)
Received: from stat.math.ethz.ch (really [129.132.58.23]) by franz.stat.wisc.edu
	via smail with esmtp (ident daemon using rfc1413)
	id <m15CFDy-000JJWC@franz.stat.wisc.edu> (Debian Smail3.2.0.111)
	for <r-bugs@r-project.org>; Tue, 19 Jun 2001 01:42:54 -0500 (CDT) 
Received: (from daemon@localhost)
	by stat.math.ethz.ch (8.9.1/8.9.1) id IAA02705;
	Tue, 19 Jun 2001 08:42:52 +0200 (MET DST)
Received: from lynne(129.132.58.30), claiming to be "lynne.ethz.ch"
 via SMTP by hypatia, id smtpdAAAa000eE; Tue Jun 19 08:42:50 2001
Received: (maechler@localhost) by lynne.ethz.ch (8.9.3/D-MATH-client) id IAA08111; Tue, 19 Jun 2001 08:42:50 +0200
X-Authentication-Warning: lynne.ethz.ch: maechler set sender to maechler@stat.math.ethz.ch using -f
From: Martin Maechler <maechler@stat.math.ethz.ch>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Message-ID: <15150.62570.490993.741070@gargle.gargle.HOWL>
Date: Tue, 19 Jun 2001 08:42:50 +0200
To: paul@stat.auckland.ac.nz
Cc: r-bugs@r-project.org, john.maindonald@anu.edu.au
Subject: Re: legend() with xpd=T; omission of initial plot character (PR#943)
In-Reply-To: <200106190358.FAA32381@blueberry.kubism.ku.dk>
References: <200106190358.FAA32381@blueberry.kubism.ku.dk>
X-Mailer: VM 6.92 under Emacs 20.7.1
Reply-To: Martin Maechler <maechler@stat.math.ethz.ch>

>>>>> "Paul" == Paul Murrell <paul@stat.auckland.ac.nz> writes:

    Paul> Hi
    Paul> Bug summary:----
    Paul> par(xpd=T)
    Paul> plot(0:1, 0:1)
    Paul> legend(x=0, y=1.2, pch=c(1,2), legend=c("May","June"))

    Paul> the first plot character is omitted when plotting to
    Paul> the screen.
    Paul> Bug summary:----

    Paul> I cannot reproduce this bug, BUT it did show up a bug in rect()
    Paul> -- in the example above, the border around the legend is not
    Paul> drawn.

Coincidence, I *did* look at that bug only yesterday.
My experience:
   I *could* reproduce the bug {X11(), Linux-386}, but only a few times. 
   Then, it didn't show anymore. Even restarting R wouldn't show it again.
   My ``explanation'' was that it might be (a bug) inside X11 / Window manager
   handling of things... ??


    Paul> This is because rect() ignores par(xpd).  The default is
    Paul> rect(xpd=FALSE).  This is at odds with text(xpd=NULL) and
    Paul> polygon(xpd=NULL) which use par(xpd) by default.
    Paul> arrows(xpd=FALSE) has the same problem as rect().

    Paul> I propose modifying rect() and arrows() to use par(xpd) by
    Paul> default like text() and polygon().  There will, as usual, be a
    Paul> small risk that someone's code will produce different output
    Paul> after this change, but this risk should be pretty small.

    Paul> Any objections ... ?

not at all, but please fix  abline(*) at the same time.
It doesn't obey xpd either (PR#750).

Martin

==> 943.reply.3 <==
From: paul murrell <R-bugs@biostat.ku.dk>
To: paul@stat.auckland.ac.nz
Subject: Re: legend() with xpd=T; omission of initial plot character (PR#943)
Date: Tue Jul 17 04:28:44 2001
CC: John Maindonald <john.maindonald@anu.edu.au>

Hi


> Bug summary:----
> par(xpd=T)
> plot(0:1, 0:1)
> legend(x=0, y=1.2, pch=c(1,2), legend=c("May","June"))
> 
> the first plot character is omitted when plotting to
> the screen.
> Bug summary:----
> 
> I cannot reproduce this bug, BUT it did show up a bug in rect() -- in the
> example above, the border around the legend is not drawn.


Still can't reproduce original bug, so no progress there.


> This is because rect() ignores par(xpd).  The default is rect(xpd=FALSE). 
This
> is at odds with text(xpd=NULL) and polygon(xpd=NULL) which use par(xpd) by
> default.  arrows(xpd=FALSE) has the same problem as rect().  
> 
> I propose modifying rect() and arrows() to use par(xpd) by default like
text()
> and polygon().  There will, as usual, be a small risk that someone's code
will
> produce different output after this change, but this risk should be pretty
> small.


Both of these changes made now (for 1.3.1).  
The following code should demonstrate the bugs (in pre-1.3.1 R) and the fixes:

par(mfrow=c(2,1), xpd=FALSE)
plot(1:10)
plot(1:10)
# rect() and arrow() ignored par(xpd=)
rect(1, 9, 2, 20, col="red")
arrows(1.5, 20, 1.5, 10)
par(xpd=TRUE)
rect(3, 9, 4, 20, col="blue")
arrows(3.5, 20, 3.5, 10)
par(xpd=NA)
rect(5, 9, 6, 20, col="green")
arrows(5.5, 20, 5.5, 10)

Paul


==> 943.audit <==
Mon May 21 08:54:07 2001	ripley	moved from incoming to Graphics
Tue Jun 19 05:58:40 2001	paul	sent reply 1
Tue Jul 17 04:28:44 2001	paul	sent reply 3

==> 943.followup.2 <==
From MAILER-DAEMON  Tue Jul 17 04:21:22 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id EAA16216
	for <R-bugs@biostat.ku.dk>; Tue, 17 Jul 2001 04:21:21 +0200 (MET DST)
Received: from localhost (localhost)
	by blueberry.kubism.ku.dk (8.9.3/8.9.3) with internal id EAA21901;
	Tue, 17 Jul 2001 04:28:45 +0200
Date: Tue, 17 Jul 2001 04:28:45 +0200
From: Mail Delivery Subsystem <MAILER-DAEMON@pubhealth.ku.dk>
Message-Id: <200107170228.EAA21901@blueberry.kubism.ku.dk>
To: <R-bugs@biostat.ku.dk>
MIME-Version: 1.0
Content-Type: multipart/report; report-type=delivery-status;
	boundary="EAA21901.995336925/blueberry.kubism.ku.dk"
Subject: Returned mail: User unknown
Auto-Submitted: auto-generated (failure)

This is a MIME-encapsulated message

--EAA21901.995336925/blueberry.kubism.ku.dk

The original message was received at Tue, 17 Jul 2001 04:28:44 +0200
from blueberry.kubism.ku.dk [130.225.108.193]

   ----- The following addresses had permanent fatal errors -----
<John>
    (expanded from: <John>)
<Maindonald>
    (expanded from: <Maindonald>)

   ----- Transcript of session follows -----
... while talking to mail.kubism.ku.dk.:
>>> RCPT To:<maindonald@mail.kubism.ku.dk>
<<< 550 <maindonald@mail.kubism.ku.dk>... User unknown
550 <Maindonald>... User unknown
>>> RCPT To:<john@mail.kubism.ku.dk>
<<< 550 <john@mail.kubism.ku.dk>... User unknown
550 <John>... User unknown

--EAA21901.995336925/blueberry.kubism.ku.dk
Content-Type: message/delivery-status

Reporting-MTA: dns; blueberry.kubism.ku.dk
Received-From-MTA: DNS; blueberry.kubism.ku.dk
Arrival-Date: Tue, 17 Jul 2001 04:28:44 +0200

Final-Recipient: RFC822; john@blueberry.kubism.ku.dk
X-Actual-Recipient: RFC822; john@mail.kubism.ku.dk
Action: failed
Status: 5.1.1
Remote-MTA: DNS; mail.kubism.ku.dk
Diagnostic-Code: SMTP; 550 <john@mail.kubism.ku.dk>... User unknown
Last-Attempt-Date: Tue, 17 Jul 2001 04:28:44 +0200

Final-Recipient: RFC822; maindonald@blueberry.kubism.ku.dk
X-Actual-Recipient: RFC822; maindonald@mail.kubism.ku.dk
Action: failed
Status: 5.1.1
Remote-MTA: DNS; mail.kubism.ku.dk
Diagnostic-Code: SMTP; 550 <maindonald@mail.kubism.ku.dk>... User unknown
Last-Attempt-Date: Tue, 17 Jul 2001 04:28:44 +0200

--EAA21901.995336925/blueberry.kubism.ku.dk
Content-Type: message/rfc822

Return-Path: <R-bugs@biostat.ku.dk>
Received: from blueberry.kubism.ku.dk (blueberry.kubism.ku.dk [130.225.108.193])
	by blueberry.kubism.ku.dk (8.9.3/8.9.3) with ESMTP id EAA21899;
	Tue, 17 Jul 2001 04:28:44 +0200
Date: Tue, 17 Jul 2001 04:28:44 +0200
Message-Id: <200107170228.EAA21899@blueberry.kubism.ku.dk>
From: paul murrell <R-bugs@biostat.ku.dk>
To: paul@stat.auckland.ac.nz
Subject: Re: legend() with xpd=T; omission of initial plot character (PR#943)
CC: John Maindonald <john.maindonald@anu.edu.au>
X-Loop: R-bugs@biostat.ku.dk

Hi


> Bug summary:----
> par(xpd=T)
> plot(0:1, 0:1)
> legend(x=0, y=1.2, pch=c(1,2), legend=c("May","June"))
> 
> the first plot character is omitted when plotting to
> the screen.
> Bug summary:----
> 
> I cannot reproduce this bug, BUT it did show up a bug in rect() -- in the
> example above, the border around the legend is not drawn.


Still can't reproduce original bug, so no progress there.


> This is because rect() ignores par(xpd).  The default is rect(xpd=FALSE). 
This
> is at odds with text(xpd=NULL) and polygon(xpd=NULL) which use par(xpd) by
> default.  arrows(xpd=FALSE) has the same problem as rect().  
> 
> I propose modifying rect() and arrows() to use par(xpd) by default like
text()
> and polygon().  There will, as usual, be a small risk that someone's code
will
> produce different output after this change, but this risk should be pretty
> small.


Both of these changes made now (for 1.3.1).  
The following code should demonstrate the bugs (in pre-1.3.1 R) and the fixes:

par(mfrow=c(2,1), xpd=FALSE)
plot(1:10)
plot(1:10)
# rect() and arrow() ignored par(xpd=)
rect(1, 9, 2, 20, col="red")
arrows(1.5, 20, 1.5, 10)
par(xpd=TRUE)
rect(3, 9, 4, 20, col="blue")
arrows(3.5, 20, 3.5, 10)
par(xpd=NA)
rect(5, 9, 6, 20, col="green")
arrows(5.5, 20, 5.5, 10)

Paul



--EAA21901.995336925/blueberry.kubism.ku.dk--

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 997 *
Subject:  las=1 with log axis 
From: Peter Dalgaard BSA <pd@pubhealth.ku.dk>
Date: Wed, 27 Jun 2001 11:54:06 +0200
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 997 <==
From postmaster@franz.stat.wisc.edu  Wed Jun 27 11:50:00 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id LAA01987
	for <r-bugs@biostat.ku.dk>; Wed, 27 Jun 2001 11:49:59 +0200 (MET DST)
Received: from pubhealth.ku.dk (really [130.225.108.10]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m15FBxI-000JJjC@franz.stat.wisc.edu> (Debian Smail3.2.0.111)
	for <r-bugs@r-project.org>; Wed, 27 Jun 2001 04:49:52 -0500 (CDT) 
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id LAA01969;
	Wed, 27 Jun 2001 11:49:40 +0200 (MET DST)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.9.3/8.9.3) id LAA25776;
	Wed, 27 Jun 2001 11:54:06 +0200
Date: Wed, 27 Jun 2001 11:54:06 +0200
From: Peter Dalgaard BSA <pd@pubhealth.ku.dk>
Message-Id: <200106270954.LAA25776@blueberry.kubism.ku.dk>
To: r-bugs@r-project.org
Subject:  las=1 with log axis 
Cc: pd@pubhealth.ku.dk

This just came in:

plot(c(0.1,100),log="y", las=1)

(Numbers and tick marks are unaligned)

Same thing with mtext(), try

mtext("x",2,at=0.1)
mtext("x",2,at=0.1,las=1)

--please do not edit the information below--

Version:
 platform = i586-pc-linux-gnu
 arch = i586
 os = linux-gnu
 system = i586, linux-gnu
 status = 
 major = 1
 minor = 3.0
 year = 2001
 month = 06
 day = 22
 language = R

Search Path:
 .GlobalEnv, package:ctest, Autoloads, package:base

==> 997.followup.1 <==
From paul@stat.auckland.ac.nz  Fri Jun 29 00:19:03 2001
Received: from mailhost.auckland.ac.nz (mailhost.auckland.ac.nz [130.216.1.4] (may be forged))
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id AAA21935;
	Fri, 29 Jun 2001 00:19:01 +0200 (MET DST)
Received: from stat1.stat.auckland.ac.nz (stat1.stat.auckland.ac.nz [130.216.93.1])
	by mailhost.auckland.ac.nz (8.9.2/8.9.2/8.9.2-ua) with ESMTP id KAA24932;
	Fri, 29 Jun 2001 10:18:52 +1200 (NZST)
Received: from murrell (murrell.stat.auckland.ac.nz [130.216.93.23])
	by stat1.stat.auckland.ac.nz (8.9.3+Sun/8.8.8) with SMTP id KAA25180;
	Fri, 29 Jun 2001 10:18:52 +1200 (NZST)
Message-ID: <00fc01c10023$19a40700$175dd882@stat.auckland.ac.nz>
From: "Paul Murrell" <paul@stat.auckland.ac.nz>
To: <pd@pubhealth.ku.dk>, <r-devel@stat.math.ethz.ch>
Cc: <R-bugs@biostat.ku.dk>
References: <200106270950.LAA01997@pubhealth.ku.dk>
Subject: Re: [Rd] las=1 with log axis (PR#997)
Date: Fri, 29 Jun 2001 10:38:49 +1200
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: 7bit
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook Express 5.50.4522.1200
X-MimeOLE: Produced By Microsoft MimeOLE V5.50.4522.1200

Hi


> This just came in:
>
> plot(c(0.1,100),log="y", las=1)
>
> (Numbers and tick marks are unaligned)
>
> Same thing with mtext(), try
>
> mtext("x",2,at=0.1)
> mtext("x",2,at=0.1,las=1)


This is related to bug #865, which I have discovered is a problem with some
of the very basic transformation code in R graphics (for transforming widths
or heights when there are log scales).  I have a fix for this particular
mtext() problem, but I'm still working on the more general transformation
bug.

Paul



==> 997.reply.1 <==
From: paul murrell <R-bugs@biostat.ku.dk>
To: pd@pubhealth.ku.dk
Subject: Re: las=1 with log axis (PR#997)
Date: Tue Jul 17 06:05:49 2001

Hi


> plot(c(0.1,100),log="y", las=1)
> 
> (Numbers and tick marks are unaligned)
> 
> Same thing with mtext(), try
> 
> mtext("x",2,at=0.1)
> mtext("x",2,at=0.1,las=1)


This is now fixed (which also fixes PR#865).
Also fixed for mtext() when side=1, log="x", and las=2 (and for corresponding
siutations on sides 3 and 4).
Also fixed for mtext() when text is an expression (i.e., mathematical
annotation).

Unfortunately, the problem goes pretty deep -- it is to do with transformation
of widths and heights to or from USER coordinates when the axis is logged. 
There are a couple of other places where this causes a problem:
(i) strwidth() and strheight() 
(ii) symbols()

I'm leaving this bug active until these other issues are resolved.

Paul


==> 997.audit <==
Sat Jun 30 08:57:44 2001	ripley	moved from incoming to Graphics
Tue Jul 17 06:05:49 2001	paul	sent reply 1
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1045 *
Subject: Palette changes on redraw
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 08 Aug 2001 19:08:01 +0200
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1045 <==
From postmaster@franz.stat.wisc.edu  Wed Aug  8 19:07:59 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id TAA11349
	for <r-bugs@biostat.ku.dk>; Wed, 8 Aug 2001 19:07:58 +0200 (MET DST)
Received: from blueberry.kubism.ku.dk (really [130.225.108.193]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m15UWoD-000JIvC@franz.stat.wisc.edu> (Debian Smail3.2.0.111)
	for <r-bugs@r-project.org>; Wed, 8 Aug 2001 12:07:53 -0500 (CDT) 
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.11.2/8.11.2) id f78H81o29218;
	Wed, 8 Aug 2001 19:08:01 +0200
X-Authentication-Warning: blueberry.kubism.ku.dk: pd set sender to p.dalgaard@biostat.ku.dk using -f
Sender: pd@pubhealth.ku.dk
To: r-bugs@r-project.org
Subject: Palette changes on redraw
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 08 Aug 2001 19:08:01 +0200
Message-ID: <x2snf2zdhq.fsf@blueberry.kubism.ku.dk>
Lines: 14
User-Agent: Gnus/5.0808 (Gnus v5.8.8) Emacs/20.7
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

Try this

example(palette)

then trigger a redraw e.g. by resizing the window. Shouldn't the
palette be stored as part of the display list?

(This only happens because the palette was reset at the end of the
example, but still...)
-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 1045.reply.1 <==
From ihaka@stat.auckland.ac.nz  Wed Aug  8 22:36:29 2001
Received: from mailhost.auckland.ac.nz (mailhost.auckland.ac.nz [130.216.1.4] (may be forged))
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id WAA12009;
	Wed, 8 Aug 2001 22:36:26 +0200 (MET DST)
Received: from stat1.stat.auckland.ac.nz (stat1.stat.auckland.ac.nz [130.216.93.1])
	by mailhost.auckland.ac.nz (8.9.2/8.9.2/8.9.2-ua) with ESMTP id IAA21626;
	Thu, 9 Aug 2001 08:36:20 +1200 (NZST)
Received: from stat.auckland.ac.nz (g.ihaka.slip.auckland.ac.nz [130.216.9.243])
	by stat1.stat.auckland.ac.nz (8.10.2+Sun/8.8.8) with ESMTP id f78KaJ720404;
	Thu, 9 Aug 2001 08:36:19 +1200 (NZST)
Sender: ihaka@stat.auckland.ac.nz
Message-ID: <3B71A31A.8BB29F85@stat.auckland.ac.nz>
Date: Thu, 09 Aug 2001 08:37:46 +1200
From: Ross Ihaka <ihaka@stat.auckland.ac.nz>
Organization: University of Auckland
X-Mailer: Mozilla 4.76 [en] (X11; U; Linux 2.2.12 i386)
X-Accept-Language: en
MIME-Version: 1.0
To: p.dalgaard@biostat.ku.dk
CC: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] Palette changes on redraw (PR#1045)
References: <200108081708.TAA11359@pubhealth.ku.dk>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

p.dalgaard@biostat.ku.dk wrote:
> 
> Try this
> 
> example(palette)
> 
> then trigger a redraw e.g. by resizing the window. Shouldn't the
> palette be stored as part of the display list?
> 
> (This only happens because the palette was reset at the end of the
> example, but still...)

I could argue either way on this.

I agree that its nasty to have plot colours change in mid-stream,
but I suspect that adding the palette to the display list may not
be the "right" solution.

A different approach would be to map the colour indices (and names)
to RGB values at a slightly higher level.  That way it would be the
RGB values which would be captured in the display list, not the
indices.

[ I'm afraid that I think that the whole display list mechanism is
  "wrong".  We need a much higher level way of describing plots. ]

	Ross

==> 1045.audit <==
Sat Aug 11 09:57:42 2001	ripley	moved from incoming to Graphics
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1088 *
Subject:  barplot forces xpd=TRUE 
From: Peter Whiting <pwhiting@whitings.org>
Date: Sat, 8 Sep 2001 10:19:00 -0500
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1088 <==
From postmaster@franz.stat.wisc.edu  Sat Sep  8 17:19:16 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id RAA14427
	for <r-bugs@biostat.ku.dk>; Sat, 8 Sep 2001 17:19:15 +0200 (MET DST)
Received: from whitings.org (really [65.169.182.99]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m15fjt2-000J0iC@franz.stat.wisc.edu> (Debian Smail3.2.0.111)
	for <r-bugs@r-project.org>; Sat, 8 Sep 2001 10:19:12 -0500 (CDT) 
Received: (from pwhiting@localhost)
	by whitings.org (8.11.2/8.11.2) id f88FJ0832396;
	Sat, 8 Sep 2001 10:19:00 -0500
Date: Sat, 8 Sep 2001 10:19:00 -0500
From: Peter Whiting <pwhiting@whitings.org>
Message-Id: <200109081519.f88FJ0832396@whitings.org>
To: r-bugs@r-project.org
Subject:  barplot forces xpd=TRUE 
Cc: pwhiting@whitings.org


<<insert bug report here>>

barplot hardcodes xpd as "TRUE" causing the bars to go outside of the
plot region.  True can be the default, but it shouldn't be the only
option.

*** barplot.R   Sat Sep  8 10:15:16 2001
--- barplot.R.orig      Sat Sep  8 10:03:39 2001
***************
*** 5,11 ****
           legend.text = NULL, beside = FALSE, horiz = FALSE,
           col = heat.colors(NR), border = par("fg"),
           main = NULL, sub = NULL, xlab = NULL, ylab = NULL,
!          xlim = NULL, ylim = NULL, xpd = TRUE,
           axes = TRUE, axisnames = TRUE, inside = TRUE, plot = TRUE, ...)
  {
      if (!missing(inside)) .NotYetUsed("inside", error = FALSE)
--- 5,11 ----
           legend.text = NULL, beside = FALSE, horiz = FALSE,
           col = heat.colors(NR), border = par("fg"),
           main = NULL, sub = NULL, xlab = NULL, ylab = NULL,
!          xlim = NULL, ylim = NULL,
           axes = TRUE, axisnames = TRUE, inside = TRUE, plot = TRUE, ...)
  {
      if (!missing(inside)) .NotYetUsed("inside", error = FALSE)
***************
*** 61,68 ****
        w.m <- matrix(w.m, nc = NC)
      if(plot) { ##-------- Plotting :
        opar <-
!           if (horiz)  par(xaxs = "i", xpd=xpd)
!           else        par(yaxs = "i", xpd=xpd)
        on.exit(par(opar))

        plot.new()
--- 61,68 ----
        w.m <- matrix(w.m, nc = NC)
      if(plot) { ##-------- Plotting :
        opar <-
!           if (horiz)  par(xaxs = "i", xpd = TRUE)
!           else        par(yaxs = "i", xpd = TRUE)
        on.exit(par(opar))

        plot.new()



--please do not edit the information below--

Version:
 platform = i686-pc-linux-gnu
 arch = i686
 os = linux-gnu
 system = i686, linux-gnu
 status = 
 major = 1
 minor = 3.1
 year = 2001
 month = 08
 day = 31
 language = R

Search Path:
 .GlobalEnv, package:ctest, Autoloads, package:base

==> 1088.audit <==
Sun Sep 16 11:01:03 2001	ripley	moved from incoming to Graphics
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1095 *
Subject:  Bizarre clipping with abline and points 
From: J.C.Rougier@durham.ac.uk
Date: Wed, 19 Sep 2001 14:45:52 +0100
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1095 <==
From postmaster@franz.stat.wisc.edu  Wed Sep 19 15:48:46 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id PAA27702
	for <r-bugs@biostat.ku.dk>; Wed, 19 Sep 2001 15:48:45 +0200 (MET DST)
Received: from hermes.dur.ac.uk (really [129.234.4.9]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m15jhiO-000JH4C@franz.stat.wisc.edu> (Debian Smail3.2.0.111)
	for <r-bugs@r-project.org>; Wed, 19 Sep 2001 08:48:36 -0500 (CDT) 
Received: from euclid (euclid.dur.ac.uk [129.234.21.53])
	by hermes.dur.ac.uk (8.11.1/8.11.1) with ESMTP id f8JDjqZ02373
	for <r-bugs@r-project.org>; Wed, 19 Sep 2001 14:45:52 +0100 (BST)
Received: from arrow.dur.ac.uk by euclid id <OAA25566@euclid>; Wed, 19 Sep 2001 14:45:51 +0100 (BST)
From: J.C.Rougier@durham.ac.uk
Date: Wed, 19 Sep 2001 14:45:52 +0100
Message-Id: <19251.200109191345@arrow.dur.ac.uk>
To: r-bugs@r-project.org
Subject:  Bizarre clipping with abline and points 
Cc: dma0jcr@arrow.dur.ac.uk
X-ECS-MailScanner: Found to be clean

I want to put some points along the horizontal axis.

> plot(1:10, 1:10)
> points(4, par("usr")[3], xpd=TRUE)
> abline(v=5)

works fine for me.  But if I try

> plot(1:10, 1:10)
> abline(v=5)
> points(4, par("usr")[3], xpd=TRUE)

then the points are clipped.  The call to abline seems to be
enforcing xpd=FALSE for later calls to the plot.

Cheers, Jonathan.

--please do not edit the information below--

Version:
 platform = i686-pc-linux-gnu
 arch = i686
 os = linux-gnu
 system = i686, linux-gnu
 status = 
 major = 1
 minor = 3.1
 year = 2001
 month = 08
 day = 31
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base

==> 1095.reply.1 <==
From p.dalgaard@biostat.ku.dk  Wed Sep 19 16:12:24 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id QAA27973;
	Wed, 19 Sep 2001 16:12:23 +0200 (MET DST)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.11.2/8.11.2) id f8JE8u905437;
	Wed, 19 Sep 2001 16:08:56 +0200
X-Authentication-Warning: blueberry.kubism.ku.dk: pd set sender to p.dalgaard@biostat.ku.dk using -f
Sender: pd@pubhealth.ku.dk
To: J.C.Rougier@durham.ac.uk
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] Bizarre clipping with abline and points (PR#1095)
References: <200109191348.PAA27712@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 19 Sep 2001 16:08:56 +0200
In-Reply-To: <200109191348.PAA27712@pubhealth.ku.dk>
Message-ID: <x2elp39ssn.fsf@blueberry.kubism.ku.dk>
Lines: 28
User-Agent: Gnus/5.0808 (Gnus v5.8.8) Emacs/20.7
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

J.C.Rougier@durham.ac.uk writes:

> I want to put some points along the horizontal axis.
> 
> > plot(1:10, 1:10)
> > points(4, par("usr")[3], xpd=TRUE)
> > abline(v=5)
> 
> works fine for me.  But if I try
> 
> > plot(1:10, 1:10)
> > abline(v=5)
> > points(4, par("usr")[3], xpd=TRUE)
> 
> then the points are clipped.  The call to abline seems to be
> enforcing xpd=FALSE for later calls to the plot.

Confirmed, same effect with 

plot(1:10, 1:10)
points(4, par("usr")[3], xpd=FALSE)
points(4, par("usr")[3], xpd=TRUE)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 1095.audit <==
Fri Sep 21 07:47:35 2001	ripley	foobar
Fri Sep 21 07:47:35 2001	ripley	moved from incoming to Graphics
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1101 *
Subject: ugly in plotmath: frac(1, sqrt(...))
From: Uwe Ligges <ligges@statistik.uni-dortmund.de>
Date: Thu, 27 Sep 2001 10:37:07 +0200
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1101 <==
From ligges@amadeus.statistik.uni-dortmund.de  Thu Sep 27 10:36:49 2001
Received: from nx5.HRZ.Uni-Dortmund.DE (nx5.HRZ.Uni-Dortmund.DE [129.217.131.21])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id KAA10714
	for <R-bugs@biostat.ku.dk>; Thu, 27 Sep 2001 10:36:49 +0200 (MET DST)
Received: from amadeus.statistik.uni-dortmund.de by nx5.HRZ.Uni-Dortmund.DE
          via smtp-local with ESMTP; Thu, 27 Sep 2001 10:36:34 +0200
Received: from statistik.uni-dortmund.de ([129.217.207.201])
	by amadeus.statistik.uni-dortmund.de (8.10.2+Sun/8.10.2) with ESMTP id f8R8aYK05193
	for <R-bugs@biostat.ku.dk>; Thu, 27 Sep 2001 10:36:34 +0200 (MET DST)
Message-ID: <3BB2E533.BC9E59D2@statistik.uni-dortmund.de>
Date: Thu, 27 Sep 2001 10:37:07 +0200
From: Uwe Ligges <ligges@statistik.uni-dortmund.de>
Organization: Fachbereich Statistik, Universitaet Dortmund
X-Mailer: Mozilla 4.78 [en] (WinNT; U)
X-Accept-Language: en
MIME-Version: 1.0
To: r-bugs <R-bugs@biostat.ku.dk>
Subject: ugly in plotmath: frac(1, sqrt(...))
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit


Sometimes (dependent on device and settings of 'cex' and 'lwd') the line
of a square root symbol plottet in the denominator of a fraction appears
to be in or above the line of the fraction.

Examples:


### Choose one of these:
# pdf("test.pdf", height=6, width=8)
# bmp("test.bmp", width=1100, height=800, pointsize=12)
# bitmap("test.tif", type="tiff24nc", width=12, height=9, res=300,
pointsize=12)
# png("test.png", width=1100, height=800, pointsize=12)
# postscript("test.eps", height=6, width=8, horizontal=FALSE)

 par(cex=2, lwd=2)
 plot(1:10)
 text(2, 8, expression(frac(1, sigma[i]*sqrt(2*pi))))
dev.off()


Uwe Ligges


[Happens also on Linux, ...]

--please do not edit the information below--

Version:
 platform = i386-pc-mingw32
 arch = x86
 os = Win32
 system = x86, Win32
 status = 
 major = 1
 minor = 3.1
 year = 2001
 month = 08
 day = 31
 language = R

Windows NT 4.0 (build 1381) Service Pack 6

Search Path:
 .GlobalEnv, package:ctest, Autoloads, package:base

==> 1101.audit <==
Sun Sep 30 15:00:27 2001	ripley	moved from incoming to Graphics

==> 1101.followup.1 <==
From ligges@amadeus.statistik.uni-dortmund.de  Wed Oct  3 12:53:15 2001
Received: from nx5.HRZ.Uni-Dortmund.DE (nx5.HRZ.Uni-Dortmund.DE [129.217.131.21])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id MAA05173
	for <R-bugs@biostat.ku.dk>; Wed, 3 Oct 2001 12:53:15 +0200 (MET DST)
Received: from amadeus.statistik.uni-dortmund.de by nx5.HRZ.Uni-Dortmund.DE
          via smtp-local with ESMTP; Wed, 3 Oct 2001 12:52:31 +0200
Received: from statistik.uni-dortmund.de (dial-142086.HRZ.Uni-Dortmund.DE [129.217.142.86])
	by amadeus.statistik.uni-dortmund.de (8.10.2+Sun/8.10.2) with ESMTP id f93AqTK29851
	for <R-bugs@biostat.ku.dk>; Wed, 3 Oct 2001 12:52:29 +0200 (MET DST)
Message-ID: <3BBAEE09.7D21A043@statistik.uni-dortmund.de>
Date: Wed, 03 Oct 2001 12:52:57 +0200
From: Uwe Ligges <ligges@statistik.uni-dortmund.de>
X-Mailer: Mozilla 4.78 [en] (WinNT; U)
X-Accept-Language: en
MIME-Version: 1.0
To: R-bugs@biostat.ku.dk
Subject: Re: [Rd] ugly in plotmath: frac(1, sqrt(...)) (PR#1101)
References: <200109270836.KAA10724@pubhealth.ku.dk>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

ligges@statistik.uni-dortmund.de wrote:
> 
> Sometimes (dependent on device and settings of 'cex' and 'lwd') the line
> of a square root symbol plottet in the denominator of a fraction appears
> to be in or above the line of the fraction.
> 
> Examples:
> 
> ### Choose one of these:
> # pdf("test.pdf", height=6, width=8)
> # bmp("test.bmp", width=1100, height=800, pointsize=12)
> # bitmap("test.tif", type="tiff24nc", width=12, height=9, res=300,
> pointsize=12)
> # png("test.png", width=1100, height=800, pointsize=12)
> # postscript("test.eps", height=6, width=8, horizontal=FALSE)
> 
>  par(cex=2, lwd=2)
>  plot(1:10)
>  text(2, 8, expression(frac(1, sigma[i]*sqrt(2*pi))))
> dev.off()

After some investigations:
In plotmath.c, line 2250 the "the gap between the nucleus and the
radical extension" is defined:
 #define RADICAL_GAP    0.4

It looks like this gap is not added to the hight (or included in the
calculations of the hight) of the denominator of a fraction. So the
whole denominator is located to close to the fraction bar, if a root is
drawn.
I don't see, how this can be fixed smartly ...

Uwe Ligges

==> 1101.followup.2 <==
From ligges@amadeus.statistik.uni-dortmund.de  Thu Oct  4 11:40:31 2001
Received: from nx5.HRZ.Uni-Dortmund.DE (nx5.HRZ.Uni-Dortmund.DE [129.217.131.21])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id LAA15056
	for <R-bugs@biostat.ku.dk>; Thu, 4 Oct 2001 11:40:30 +0200 (MET DST)
Received: from amadeus.statistik.uni-dortmund.de by nx5.HRZ.Uni-Dortmund.DE
          via smtp-local with ESMTP; Thu, 4 Oct 2001 11:40:12 +0200
Received: from statistik.uni-dortmund.de ([129.217.207.201])
	by amadeus.statistik.uni-dortmund.de (8.10.2+Sun/8.10.2) with ESMTP id f949eCK06222
	for <R-bugs@biostat.ku.dk>; Thu, 4 Oct 2001 11:40:12 +0200 (MET DST)
Message-ID: <3BBC2EA3.D310675E@statistik.uni-dortmund.de>
Date: Thu, 04 Oct 2001 11:40:51 +0200
From: Uwe Ligges <ligges@statistik.uni-dortmund.de>
Organization: Fachbereich Statistik, Universitaet Dortmund
X-Mailer: Mozilla 4.78 [en] (WinNT; U)
X-Accept-Language: en
MIME-Version: 1.0
To: R-bugs@biostat.ku.dk
Subject: Re: [Rd] ugly in plotmath: frac(1, sqrt(...)) (PR#1101)
References: <200110031053.MAA05183@pubhealth.ku.dk>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

ligges@statistik.uni-dortmund.de wrote:
> 
> ligges@statistik.uni-dortmund.de wrote:
> >
> > Sometimes (dependent on device and settings of 'cex' and 'lwd') the line
> > of a square root symbol plottet in the denominator of a fraction appears
> > to be in or above the line of the fraction.
> >
> > Examples:
> >
> > ### Choose one of these:
> > # pdf("test.pdf", height=6, width=8)
> > # bmp("test.bmp", width=1100, height=800, pointsize=12)
> > # bitmap("test.tif", type="tiff24nc", width=12, height=9, res=300,
> > pointsize=12)
> > # png("test.png", width=1100, height=800, pointsize=12)
> > # postscript("test.eps", height=6, width=8, horizontal=FALSE)
> >
> >  par(cex=2, lwd=2)
> >  plot(1:10)
> >  text(2, 8, expression(frac(1, sigma[i]*sqrt(2*pi))))
> > dev.off()
> 
> After some investigations:
> In plotmath.c, line 2250 the "the gap between the nucleus and the
> radical extension" is defined:
>  #define RADICAL_GAP    0.4
> 
> It looks like this gap is not added to the hight (or included in the
> calculations of the hight) of the denominator of a fraction. So the
> whole denominator is located to close to the fraction bar, if a root is
> drawn.
> I don't see, how this can be fixed smartly ...


Suggestion for a fix.

plotmath.c, lines 2340 ff.:

    orderBBox = CombineBBoxes(orderBBox, RenderElement(body, draw));
    orderBBox = CombineBBoxes(orderBBox, RenderGap(2 * radTrail, draw));
 +  orderBBox = EnlargeBBox(orderBBox, radGap, 0, 0);
    SetStyle(style);
    return orderBBox;


Uwe Ligges
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Directory:  In-Out

none

Directory:  Installation

* PR# 1034 *
Subject: Compiling R (1.3.0) on AIX (4.3) fails
From: "Thomas J Vogels" <tov@ece.cmu.edu>
Date: Sun, 29 Jul 2001 12:27:51 -0400
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1034 <==
From tov@ece.cmu.edu  Sun Jul 29 18:28:26 2001
Received: from ece.cmu.edu (ECE.CMU.EDU [128.2.236.200])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id SAA24361
	for <r-bugs@biostat.ku.dk>; Sun, 29 Jul 2001 18:28:25 +0200 (MET DST)
Received: from bavaria (AC9B4D83.ipt.aol.com [172.155.77.131])
	by ece.cmu.edu (8.11.0/8.10.2) with SMTP id f6TGSK224272;
	Sun, 29 Jul 2001 12:28:20 -0400 (EDT)
Reply-To: <vogels@cmu.edu>
From: "Thomas J Vogels" <tov@ece.cmu.edu>
To: <r-bugs@biostat.ku.dk>
Cc: "Vogels@Cmu. Edu" <vogels@cmu.edu>
Subject: Compiling R (1.3.0) on AIX (4.3) fails
Date: Sun, 29 Jul 2001 12:27:51 -0400
Message-ID: <NFBBKIAHMMCHOBIBLMMPKEBLCAAA.tov@ece.cmu.edu>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook IMO, Build 9.0.2416 (9.0.2910.0)
Importance: Normal
X-MimeOLE: Produced By Microsoft MimeOLE V5.00.2314.1300

Hi,

This email reports bugs in acinclude.m4, src/library/tcltk/src/Makefile,
and share/perl/Rd2contents.pl.  It is based on R-patched.tgz from 07/27/2001
(R 1.3.0) and comes from trying to compile R on AIX 4.3.

1) acinclude.m4:  A string on line 3096 starts with a single quote: ' but
is terminated with a double quote: ".  (This leads to the weird error
message that configure can't execute 'shared' on line 4060.)
     The fix is simply to use single quotes both times:
allow_undefined_flag='${wl}-berok'

2) after configure (with CC=gcc but using AIX's linker /usr/bin/ld), the
Makefile in src/library/tcltk/src doesn't protect the linker flags -bI
with -Xlinker! (-Xlinker is required when using gcc so that the linker flags
are passed on to ld correctly.  Which I know that you know...)
  The fix is to add -Xlinker before every -bI. Sorry, haven't looked into
patching configure yet...

3) Rd2contents.pl:  this perl script fails in the base library!  There are
too many files in the man directory and perl reports 'glob failed'.  When I
try 'ls man/*.Rd'  bash also reports that the argument list is too long.  I
don't know whether this limitation comes from AIX, bash or perl and why it
doesn't happen with, say, Linux.
The fix is to replace the simple while loop (line 6):
  while(<$ARGV[0]/man/*.Rd>){ &do_one; }

with a loop over the contents of the directory using readdir:

if (opendir RD, "$ARGV[0]/man") {
    my $f;
    while (defined ($f = readdir RD)) {
     $_ = "$ARGV[0]/man/$f", &do_one if $f =~ m,.Rd$,;
    }
    closedir RD;
}

A) tkConfig.sh contains a line like this:
   TK_XINCLUDES='# no special path needed'
This has nothing to do with R proper but this bug which is either in AIX or
the local installation of X shows up during the compilation of R.  Anyhow,
this line is plain stupid since when passed on to the compiler _comments
out_ the rest of the line!  (Think about:
  gcc fine_program.c #no special path needed -lX11 -Xm
)  The fix is to use "TK_XINCLUDES=''" in tkConfig.sh
Again, I know this is not a problem with R but I'm adding it here for people
to find if they use the mailing list archive.

After these changes R compiles (producing warnings about duplicate
symbols...) and installs.  'make check' fails in mva--report to follow.

Regards,
  -tom

--
Email: vogels@cmu.edu



==> 1034.followup.1 <==
From ripley@stats.ox.ac.uk  Sun Jul 29 21:17:50 2001
Received: from toucan.stats.ox.ac.uk (toucan.stats.ox.ac.uk [163.1.20.20])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id VAA24784
	for <R-bugs@biostat.ku.dk>; Sun, 29 Jul 2001 21:17:49 +0200 (MET DST)
Received: from gannet.stats (IDENT:root@gannet.stats [163.1.20.127])
	by toucan.stats.ox.ac.uk (8.9.0/8.9.0) with ESMTP id UAA28002;
	Sun, 29 Jul 2001 20:17:46 +0100 (BST)
Received: from localhost (ripley@localhost)
	by gannet.stats (8.11.3/8.11.3) with ESMTP id f6TJHjt08161;
	Sun, 29 Jul 2001 20:17:45 +0100
X-Authentication-Warning: gannet.stats: ripley owned process doing -bs
Date: Sun, 29 Jul 2001 20:17:45 +0100 (BST)
From: Prof Brian Ripley <ripley@stats.ox.ac.uk>
X-X-Sender:  <ripley@gannet.stats>
To: <vogels@cmu.edu>
cc: <R-bugs@biostat.ku.dk>
Subject: Re: [Rd] Compiling R (1.3.0) on AIX (4.3) fails (PR#1034)
In-Reply-To: <200107291628.SAA24371@pubhealth.ku.dk>
Message-ID: <Pine.LNX.4.31.0107292005120.8135-100000@gannet.stats>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Sun, 29 Jul 2001 vogels@cmu.edu wrote:

> Hi,
>
> This email reports bugs in acinclude.m4, src/library/tcltk/src/Makefile,
> and share/perl/Rd2contents.pl.  It is based on R-patched.tgz from 07/27/2001
> (R 1.3.0) and comes from trying to compile R on AIX 4.3.

Would that be 2001-07-27?  Not all of us live in countries that flout ISO
standards!

> 1) acinclude.m4:  A string on line 3096 starts with a single quote: ' but
> is terminated with a double quote: ".  (This leads to the weird error
> message that configure can't execute 'shared' on line 4060.)
>      The fix is simply to use single quotes both times:
> allow_undefined_flag='${wl}-berok'

That is a generated file.  It coems from m4/libtool.m4.

> 2) after configure (with CC=gcc but using AIX's linker /usr/bin/ld), the
> Makefile in src/library/tcltk/src doesn't protect the linker flags -bI
> with -Xlinker! (-Xlinker is required when using gcc so that the linker flags
> are passed on to ld correctly.  Which I know that you know...)
>   The fix is to add -Xlinker before every -bI. Sorry, haven't looked into
> patching configure yet...
>
> 3) Rd2contents.pl:  this perl script fails in the base library!  There are
> too many files in the man directory and perl reports 'glob failed'.  When I
> try 'ls man/*.Rd'  bash also reports that the argument list is too long.  I

(! That looks like a bash bug.  Your bash version is ?  sh is supposed ot
have no line length limits.)

> don't know whether this limitation comes from AIX, bash or perl and why it
> doesn't happen with, say, Linux.

Do you have a current perl?  Globbing was changed in 5.6.0 to be handled
in C code, as I recall.  It does not happen on Solaris, Linux or Windows,
and I suspect a perl upgrade might fix it.  Try 5.6.1, if you are not
already using it.

> The fix is to replace the simple while loop (line 6):
>   while(<$ARGV[0]/man/*.Rd>){ &do_one; }
>
> with a loop over the contents of the directory using readdir:
>
> if (opendir RD, "$ARGV[0]/man") {
>     my $f;
>     while (defined ($f = readdir RD)) {
>      $_ = "$ARGV[0]/man/$f", &do_one if $f =~ m,.Rd$,;
>     }
>     closedir RD;
> }

(slower and less portable if it is not needed.)

Your perl version is ?


> A) tkConfig.sh contains a line like this:
>    TK_XINCLUDES='# no special path needed'
> This has nothing to do with R proper but this bug which is either in AIX or
> the local installation of X shows up during the compilation of R.  Anyhow,
> this line is plain stupid since when passed on to the compiler _comments
> out_ the rest of the line!  (Think about:
>   gcc fine_program.c #no special path needed -lX11 -Xm
> )  The fix is to use "TK_XINCLUDES=''" in tkConfig.sh
> Again, I know this is not a problem with R but I'm adding it here for people
> to find if they use the mailing list archive.
>
> After these changes R compiles (producing warnings about duplicate
> symbols...) and installs.  'make check' fails in mva--report to follow.
>
> Regards,
>   -tom
>
> --
> Email: vogels@cmu.edu
>
>
>
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


==> 1034.followup.2 <==
From tov@ece.cmu.edu  Sun Jul 29 22:10:52 2001
Received: from infiniti.ece.cmu.edu (INFINITI.ECE.CMU.EDU [128.2.133.84])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id WAA24908
	for <R-bugs@biostat.ku.dk>; Sun, 29 Jul 2001 22:10:51 +0200 (MET DST)
Received: (from tov@localhost) by infiniti.ece.cmu.edu (AIX4.3/UCB 8.8.8/8.8.8) id QAA16896; Sun, 29 Jul 2001 16:10:48 -0400
X-Authentication-Warning: infiniti.ece.cmu.edu: tov set sender to tov@ece.cmu.edu using -f
Sender: tov@infiniti.ece.cmu.edu
To: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] Compiling R (1.3.0) on AIX (4.3) fails (PR#1034)
References: <200107291917.VAA24794@pubhealth.ku.dk>
Reply-To: Thomas Vogels <tov@ece.cmu.edu>
X-URI: http://www.ece.cmu.edu/~tov
From: Thomas Vogels <tov@ece.cmu.edu>
Date: 29 Jul 2001 16:10:47 -0400
In-Reply-To: ripley@stats.ox.ac.uk's message of "Sun, 29 Jul 2001 21:17:55 +0200 (MET DST)"
Message-ID: <pxsnffpkc8.fsf@infiniti.ece.cmu.edu>
Lines: 133
User-Agent: Gnus/5.0807 (Gnus v5.8.7) Emacs/20.7
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii


ripley@stats.ox.ac.uk writes:

> On Sun, 29 Jul 2001 vogels@cmu.edu wrote:
> 
> > Hi,
> >
> > This email reports bugs in acinclude.m4, src/library/tcltk/src/Makefile,
> > and share/perl/Rd2contents.pl.  It is based on R-patched.tgz from 07/27/2001
> > (R 1.3.0) and comes from trying to compile R on AIX 4.3.
> 
> Would that be 2001-07-27?  Not all of us live in countries that flout ISO
> standards!

Oops.  Should have used the contents of the date stamp file...

> > 1) acinclude.m4:  A string on line 3096 starts with a single quote: ' but
> > is terminated with a double quote: ".  (This leads to the weird error
> > message that configure can't execute 'shared' on line 4060.)
> >      The fix is simply to use single quotes both times:
> > allow_undefined_flag='${wl}-berok'
> 
> That is a generated file.  It coems from m4/libtool.m4.

...which means I should have said...
 Line 1473 in m4/libtool.m4 contains the unterminated string.

Hmm, should the name of the file suggest to me that it's part of some
other package, like 'libtool', and I should file a bug report with
it's maintainer?

> > 2) after configure (with CC=gcc but using AIX's linker /usr/bin/ld), the
> > Makefile in src/library/tcltk/src doesn't protect the linker flags -bI
> > with -Xlinker! (-Xlinker is required when using gcc so that the linker flags
> > are passed on to ld correctly.  Which I know that you know...)
> >   The fix is to add -Xlinker before every -bI. Sorry, haven't looked into
> > patching configure yet...
> >
> > 3) Rd2contents.pl:  this perl script fails in the base library!  There are
> > too many files in the man directory and perl reports 'glob failed'.  When I
> > try 'ls man/*.Rd'  bash also reports that the argument list is too long.  I
> 
> (! That looks like a bash bug.  Your bash version is ?  sh is supposed ot
> have no line length limits.)

Guilty as suspected.  My bash and perl is rather old...  

> > don't know whether this limitation comes from AIX, bash or perl and why it
> > doesn't happen with, say, Linux.
> 
> Do you have a current perl?  Globbing was changed in 5.6.0 to be handled
> in C code, as I recall.  It does not happen on Solaris, Linux or Windows,
> and I suspect a perl upgrade might fix it.  Try 5.6.1, if you are not
> already using it.

I'm not and I won't.  I'll live with my old perl since I don't want to
download and compile perl and bash...  I have a work around and if the
installation fails for somebody else they might have a hack available
when they search the r-bugs/r-devel archive.  Should I encounter the
problem again with a current installation (on a different system),
I'll let you know, otherwise I'll shut up.


> > The fix is to replace the simple while loop (line 6):
> >   while(<$ARGV[0]/man/*.Rd>){ &do_one; }
> >
> > with a loop over the contents of the directory using readdir:
> >
> > if (opendir RD, "$ARGV[0]/man") {
> >     my $f;
> >     while (defined ($f = readdir RD)) {
> >      $_ = "$ARGV[0]/man/$f", &do_one if $f =~ m,.Rd$,;
> >     }
> >     closedir RD;
> > }
> 
> (slower and less portable if it is not needed.)

True (especially the portability argument) if globbing is handled in
C in Perl nowadays.  I'd challenge the "slower" if Perl had to use the
shell since the shell would sort the file list which readdir won't.
 
> Your perl version is ?

Too embarassed to tell ;-)  Mea culpa, I'll bring up Perl issues in
the future only when I know I have a recent version...


> > A) tkConfig.sh contains a line like this:
> >    TK_XINCLUDES='# no special path needed'
> > This has nothing to do with R proper but this bug which is either in AIX or
> > the local installation of X shows up during the compilation of R.  Anyhow,
> > this line is plain stupid since when passed on to the compiler _comments
> > out_ the rest of the line!  (Think about:
> >   gcc fine_program.c #no special path needed -lX11 -Xm
> > )  The fix is to use "TK_XINCLUDES=''" in tkConfig.sh
> > Again, I know this is not a problem with R but I'm adding it here for people
> > to find if they use the mailing list archive.
> >
> > After these changes R compiles (producing warnings about duplicate
> > symbols...) and installs.  'make check' fails in mva--report to follow.
> >
> > Regards,
> >   -tom
> >
> > --
> > Email: vogels@cmu.edu
> >
> >
> >
> > -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> > r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> > Send "info", "help", or "[un]subscribe"
> > (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> > _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
> >
> 
> -- 
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272860 (secr)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> 
> 
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204

==> 1034.reply.1 <==
From hornik@ci.tuwien.ac.at  Mon Jul 30 09:36:24 2001
Received: from mr.tuwien.ac.at (mr.tuwien.ac.at [128.130.2.10])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id JAA26859
	for <R-bugs@biostat.ku.dk>; Mon, 30 Jul 2001 09:36:23 +0200 (MET DST)
Received: from mithrandir.hornik.net (a61.dialin.tuwien.ac.at [192.35.240.71])
	by mr.tuwien.ac.at (8.11.1/8.11.1) with ESMTP id f6U7cms20529;
	Mon, 30 Jul 2001 09:38:49 +0200 (MET DST)
Received: from hornik by mithrandir.hornik.net with local (Exim 3.12 #1 (Debian))
	id 15R7aA-0003R8-00; Mon, 30 Jul 2001 09:35:18 +0200
From: Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Message-ID: <15205.3637.903902.962867@mithrandir.hornik.net>
Date: Mon, 30 Jul 2001 09:35:17 +0200
To: Thomas Vogels <tov@ece.cmu.edu>
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] Compiling R (1.3.0) on AIX (4.3) fails (PR#1034)
In-Reply-To: <pxsnffpkc8.fsf@infiniti.ece.cmu.edu>
References: <200107291917.VAA24794@pubhealth.ku.dk>
	<pxsnffpkc8.fsf@infiniti.ece.cmu.edu>
X-Mailer: VM 6.94 under Emacs 20.7.2
Reply-To: Kurt.Hornik@ci.tuwien.ac.at
Sender: Kurt Hornik <hornik@ci.tuwien.ac.at>

>>>>> Thomas Vogels writes:

> ripley@stats.ox.ac.uk writes:

>> On Sun, 29 Jul 2001 vogels@cmu.edu wrote:
>> 
>> > Hi,
>> >
>> > This email reports bugs in acinclude.m4, src/library/tcltk/src/Makefile,
>> > and share/perl/Rd2contents.pl.  It is based on R-patched.tgz from 07/27/2001
>> > (R 1.3.0) and comes from trying to compile R on AIX 4.3.
>> 
>> Would that be 2001-07-27?  Not all of us live in countries that flout ISO
>> standards!

> Oops.  Should have used the contents of the date stamp file...

>> > 1) acinclude.m4:  A string on line 3096 starts with a single quote: ' but
>> > is terminated with a double quote: ".  (This leads to the weird error
>> > message that configure can't execute 'shared' on line 4060.)
>> >      The fix is simply to use single quotes both times:
>> > allow_undefined_flag='${wl}-berok'
>> 
>> That is a generated file.  It coems from m4/libtool.m4.

> ...which means I should have said...
>  Line 1473 in m4/libtool.m4 contains the unterminated string.

> Hmm, should the name of the file suggest to me that it's part of some
> other package, like 'libtool', and I should file a bug report with
> it's maintainer?

Fixed now.  The file comes from libtool 1.4.  Unfortunately, we have to
patch it ourselves, as the libtool 1.4 `patch release' suddenly requires
autoconf 2.50 ...

>> > 2) after configure (with CC=gcc but using AIX's linker /usr/bin/ld), the
>> > Makefile in src/library/tcltk/src doesn't protect the linker flags -bI
>> > with -Xlinker! (-Xlinker is required when using gcc so that the linker flags
>> > are passed on to ld correctly.  Which I know that you know...)
>> >   The fix is to add -Xlinker before every -bI. Sorry, haven't looked into
>> > patching configure yet...

Very strange.  Configure has

  *aix4.[2-9]*)
    EXPORTFILE="\$(top_builddir)/etc/R.exp"
    cpicflags=
    cxxpicflags=
    fpicflags=
    wl="-Wl,"
    main_ldflags="${wl}-bdynamic ${wl}-bE:${EXPORTFILE} ${wl}-bM:SRE"
    shlib_ldflags="${wl}-bM:SRE ${wl}-H512 ${wl}-T512 ${wl}-bnoentry \
      ${wl}-bexpall ${wl}-bI:\$(R_HOME)/etc/R.exp"
    SHLIB_LIBADD="\$(LIBM)"
    ;;

so unless I am missing something obvious all linker flages are protected
via `-Wl,' (which should also work if the C compiler is not gcc).

-k

==> 1034.followup.3 <==
From tov@ece.cmu.edu  Mon Jul 30 16:18:40 2001
Received: from infiniti.ece.cmu.edu (INFINITI.ECE.CMU.EDU [128.2.133.84])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id QAA01527
	for <R-bugs@biostat.ku.dk>; Mon, 30 Jul 2001 16:18:39 +0200 (MET DST)
Received: (from tov@localhost) by infiniti.ece.cmu.edu (AIX4.3/UCB 8.8.8/8.8.8) id KAA20604; Mon, 30 Jul 2001 10:18:35 -0400
X-Authentication-Warning: infiniti.ece.cmu.edu: tov set sender to tov@ece.cmu.edu using -f
Sender: tov@infiniti.ece.cmu.edu
To: r-devel@stat.math.ethz.ch
Cc: R-bugs@biostat.ku.dk
Subject: Re: [Rd] Compiling R (1.3.0) on AIX (4.3) fails (PR#1034)
References: <200107291917.VAA24794@pubhealth.ku.dk>
	<pxsnffpkc8.fsf@infiniti.ece.cmu.edu>
Reply-To: Thomas Vogels <tov@ece.cmu.edu>
X-URI: http://www.ece.cmu.edu/~tov
From: Thomas Vogels <tov@ece.cmu.edu>
Date: 30 Jul 2001 10:18:35 -0400
In-Reply-To: Thomas Vogels's message of "29 Jul 2001 16:10:47 -0400"
Message-ID: <pxlml6cxfo.fsf@infiniti.ece.cmu.edu>
Lines: 52
User-Agent: Gnus/5.0807 (Gnus v5.8.7) Emacs/20.7
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii


Excerpt from Kurt's email this morning:

>>> > 2) after configure (with CC=gcc but using AIX's linker
>/usr/bin/ld), the
>>> > Makefile in src/library/tcltk/src doesn't protect the linker
>flags
>-bI
>>> > with -Xlinker! (-Xlinker is required when using gcc so that the
>linker flags
>>> > are passed on to ld correctly.  Which I know that you know...)
>>> >   The fix is to add -Xlinker before every -bI. Sorry, haven't
>looked into
>>> > patching configure yet...
>
>Very strange.  Configure has
>
>  *aix4.[2-9]*)
>    EXPORTFILE="\$(top_builddir)/etc/R.exp"
>    cpicflags=
>    cxxpicflags=
>    fpicflags=
>    wl="-Wl,"
>    main_ldflags="${wl}-bdynamic ${wl}-bE:${EXPORTFILE} ${wl}-bM:SRE"
>    shlib_ldflags="${wl}-bM:SRE ${wl}-H512 ${wl}-T512 ${wl}-bnoentry \
>      ${wl}-bexpall ${wl}-bI:\$(R_HOME)/etc/R.exp"
>    SHLIB_LIBADD="\$(LIBM)"
>    ;;
>
>so unless I am missing something obvious all linker flages are
>protected
>via `-Wl,' (which should also work if the C compiler is not gcc).
>

Sorry, should have been more explicit, I guess: the problem is with
PKG_LIBS (which is the only variable in that Makefile using linker
flags...)  Some digging shows that '-Wl,' (or '-Xlinker') is missing
in tkConfig.sh.  So if you have Tcl/Tk (8.3 in my case) installed and
used AIX's 'cc' compiler, you get in trouble with later using gcc
(e.g. for R).  Oddly, this didn't show when compiling, say, Tktable.

There is the question, why configure didn't "see" this coming.  What
would be nice is a warning to the effect that tkConfig.sh is broken
when R can't compile tcltk.c.  (Currently I get messages about libc.a
not found...)

Thanks,
  -tom

-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204


==> 1034.audit <==
Fri Aug  3 11:36:36 2001	ripley	moved from incoming to Installation
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Directory:  Language

* PR# 408 *
Subject: convolution bug
From: wsimpson@gcal.ac.uk
Date: Fri, 28 Jan 2000 11:17:36 +0100 (MET)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 408 <==
From wsimpson@gcal.ac.uk  Fri Jan 28 11:17:36 2000
Received: from localhost (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id LAA11325
	for <R-bugs@biostat.ku.dk>; Fri, 28 Jan 2000 11:17:36 +0100 (MET)
Date: Fri, 28 Jan 2000 11:17:36 +0100 (MET)
From: wsimpson@gcal.ac.uk
Message-Id: <200001281017.LAA11325@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: convolution bug

Full_Name: Bill Simpson
Version: 65.1 , 0.90.1
OS: Linux
Submission from: (NULL) (193.62.250.209)


I reported this on r-help, but here is official bug report.

The present convolve() does not do convolution by default. Its default behaviour
is
correlation. This is a bug.

The default argument conj should be set to FALSE.

The zero-padding should be on the right for linear convolution (don't ask me
why you call this type="open"; I suggest type="linear").

Here is what I expect linear convolution to do:
myconvolve<-function (x,h) 
{
    nx <- length(x)
    nh <- length(h)
    #zero pad
    if(nx>nh)
       {
       x <- c(x,rep(0, nh-1))
       h<-c(h,rep(0,nx-1))
       }
    else
       {
       h <- c(h,rep(0, nx-1))
       x<-c(x,rep(0,nh-1))
       }
    x <- fft(fft(x) * fft(h), inv = TRUE)
    Re(x)/length(x)
#I am not sure about this, the R IFFT is weird
}

What "circular" convolution should do is just
eliminate the zero-padding:

myconvolve2<-function (x,h)
{
#no padding, circular convolution
    nx <- length(x)
    nh <- length(h)
    x <- fft(fft(x) * fft(h), inv = TRUE)
    Re(x)/(nx)
}


I suggest that you create two functions, convolve() and correlate(), and get
rid
of the conj argument in convolve().

==> 408.audit <==
Wed Feb 16 19:28:42 2000	ripley	moved from incoming to Language
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 412 *
Subject: anomalies with call objects
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 06 Feb 2000 01:18:50 +0100
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 412 <==
From postmaster@franz.stat.wisc.edu  Sun Feb  6 01:16:33 2000
Received: from stat.math.ethz.ch (daemon@hypatia.ethz.ch [129.132.58.23])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id BAA26868
	for <R-bugs@biostat.ku.dk>; Sun, 6 Feb 2000 01:16:31 +0100 (MET)
Received: (from daemon@localhost)
	by stat.math.ethz.ch (8.9.1/8.9.1) id BAA18080
	for <r-bugs@hypatia.math.ethz.ch>; Sun, 6 Feb 2000 01:16:38 +0100 (MET)
Received: from franz.stat.wisc.edu(128.105.174.95)
 via SMTP by hypatia, id smtpdAAAa004QS; Sun Feb  6 01:16:33 2000
Received: from pubhealth.ku.dk (really [130.225.108.10]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m12HFNP-000ZSxC@franz.stat.wisc.edu> (Debian Smail3.2.0.102)
	for <r-bugs@r-project.org>; Sat, 5 Feb 2000 18:16:31 -0600 (CST) 
Received: from biostat.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id BAA26864
	for <r-bugs@r-project.org>; Sun, 6 Feb 2000 01:16:18 +0100 (MET)
Received: (from pd@localhost)
	by biostat.ku.dk (8.9.3/8.9.3) id BAA12311;
	Sun, 6 Feb 2000 01:18:51 +0100
Sender: pd@blueberry.kubism.ku.dk
To: r-bugs@r-project.org
Subject: anomalies with call objects
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 06 Feb 2000 01:18:50 +0100
Message-ID: <x2900zyyhh.fsf@blueberry.kubism.ku.dk>
Lines: 51
X-Mailer: Gnus v5.7/Emacs 20.4
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit


Call objects don't always behave as you'd expect. They're mostly
list-like, but with exceptions:

> f<-function(x,y,...)match.call(expand.dots=FALSE)
> xx <- f(y=1,2,z=3,4)
> dd <- xx$...
> xx$... <- NULL
> c(xx,dd)
[[1]]
f(x = 2, y = 1)

$z
[1] 3

[[3]]
[1] 4

> as.call(c(as.list(xx),dd))
f(x = 2, y = 1, z = 3, 4)

(Splus has this rather differently, since dd becomes a call to list()
rather than a list of promises:

S> c(xx,dd)
f(x = 2, y = 1, list, z = 3, 4)
S> as.call(c(as.list(xx),dd))
f(x = 2, y = 1, list, z = 3, 4)

...but at least gives the same in both cases)

Also, the names of arguments added with [[<- is getting dropped if a
new element is required:

> xx[["abc"]]<-123
> xx
f(x = 2, y = 1, 123)

S has what I'd expect there:

S> xx[["abc"]]<-123
S> xx
f(x = 2, y = 1, abc = 123)

[R-0.99.0 prerelease on RedHat6.1, but this is likely not a new thing.]

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 412.audit <==
Wed Feb 16 19:26:57 2000	ripley	moved from incoming to Language
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 669 *
Subject: Bug(s) w/ rbind.data.frame(); fix also read.table(*, as.is = TRUE) ?
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Mon, 25 Sep 2000 10:17:15 +0200
--status of AsIs columns
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 669 <==
From maechler@stat.math.ethz.ch  Mon Sep 25 10:17:01 2000
Received: from stat.math.ethz.ch (daemon@hypatia.ethz.ch [129.132.58.23])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id KAA01907
	for <R-bugs@biostat.ku.dk>; Mon, 25 Sep 2000 10:17:01 +0200 (MET DST)
Received: (from daemon@localhost)
	by stat.math.ethz.ch (8.9.1/8.9.1) id KAA07627
	for <R-bugs@stat.math.ethz.ch>; Mon, 25 Sep 2000 10:17:19 +0200 (MET DST)
Received: from lynne(129.132.58.30), claiming to be "lynne.ethz.ch"
 via SMTP by hypatia, id smtpdAAAa001r9; Mon Sep 25 10:17:15 2000
Received: (maechler@localhost) by lynne.ethz.ch (8.9.3/D-MATH-client) id KAA01475; Mon, 25 Sep 2000 10:17:15 +0200
X-Authentication-Warning: lynne.ethz.ch: maechler set sender to maechler@stat.math.ethz.ch using -f
From: Martin Maechler <maechler@stat.math.ethz.ch>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Message-ID: <14799.2571.494467.836722@gargle.gargle.HOWL>
Date: Mon, 25 Sep 2000 10:17:15 +0200
To: R-bugs@stat.math.ethz.ch
Subject: Bug(s) w/ rbind.data.frame(); fix also read.table(*, as.is = TRUE) ?
X-Mailer: VM 6.76 under Emacs 20.7.1
Reply-To: Martin Maechler <maechler@stat.math.ethz.ch>

This is not only bug report, but also a RFC (request for comments):

The basic problem is that there are (at least) two ways of easily getting
non-factor character columns in data.frames.
The first is  
    read.table(*, as.is = TRUE) 
and the second is
    data.frame(.., I(...), ..)	      

which differ in their result. Whereas the first produces `pure' character
columns in the data.frame, the second approach gives `AsIs' classed
columns (character, or, e.g. logical).

Now, as the following shows,  rbind.data.frame()  *is* buggy anyway,
I wonder if we shouldn't change read.table(*, as.is = TRUE)
such that the non-numeric columns of its result become "AsIs" classed as
well:

-----------

str(d1 <- data.frame(a=1:3, b = I(letters[1:3])))
## d1 is `alright'
## d0: The same but a `character' *not* protected by AsIs:
d0 <- d1
d0$b <- unclass(d0$b)
str(d0)
## Note that this is *really* the same as a what you get from
##  read.table(*, as.is = TRUE)
##  ----------
##  R's read.table() is S+ compatible; however I wonder if
##  we shouldn't add  "AsIs" classes to all non-numeric components...
##  the classes, shouldn't harm, but ensure consistency of treatment..

str(d11 <- rbind(d1, new = c(7, "N"))) ## alright
str(d01 <- rbind(d0, new = c(7, "N"))) ## all wrong :
## Both columns were coerced to factors !!
##-- S-PLUS 5 coerces both to "character" -- which is better,
##  since the new row *is* all character

## R makes nonsense with 'b' [factor w/ 1 level "N": NA NA NA 1]
## S+ 5.1 does exactly the right thing [both a & b still look like in d0,d1 :
str(d12 <- rbind(d1, new = data.frame(a= 7, b="N")))##
str(d02 <- rbind(d0, new = data.frame(a= 7, b="N")))##

---------

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO D10	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><

==> 669.audit <==
Wed Oct 25 20:31:21 2000	ripley	changed notes
Wed Oct 25 20:31:21 2000	ripley	foobar
Wed Oct 25 20:31:21 2000	ripley	moved from incoming to Language
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 921 *
Subject:  Managed to confuse match.arg 
From: J.C.Rougier@durham.ac.uk
Date: Wed, 25 Apr 2001 12:22:54 +0100 (BST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 921 <==
From postmaster@franz.stat.wisc.edu  Wed Apr 25 13:23:07 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id NAA14338
	for <r-bugs@biostat.ku.dk>; Wed, 25 Apr 2001 13:23:06 +0200 (MET DST)
Received: from hermes.dur.ac.uk (really [129.234.4.9]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m14sNO6-000JH1C@franz.stat.wisc.edu> (Debian Smail3.2.0.111)
	for <r-bugs@r-project.org>; Wed, 25 Apr 2001 06:23:14 -0500 (CDT) 
Received: from euclid (euclid.dur.ac.uk [129.234.21.53])
	by hermes.dur.ac.uk (8.11.1/8.11.1) with ESMTP id f3PBMtl04590
	for <r-bugs@r-project.org>; Wed, 25 Apr 2001 12:22:55 +0100 (BST)
Received: from laplace by euclid id <MAA23210@euclid>; Wed, 25 Apr 2001 12:22:49 +0100 (BST)
From: J.C.Rougier@durham.ac.uk
Date: Wed, 25 Apr 2001 12:22:54 +0100 (BST)
Message-Id: <8522.200104251122@laplace>
To: r-bugs@r-project.org
Cc: dma0jcr@laplace.dur.ac.uk
Subject:  Managed to confuse match.arg 

This one may not strictly be a bug, and it was certainly my
fault, but it took me a while to track it down and it is rather
strange:

funOne <- function(x)
{
  funTwo <- 1:10
  funTwo(x)
}

funTwo <- function(v) 2*v

funOne(5) # answer is 10 as expected

# now a different definition for funTwo with a match.arg

funTwo <- function(v, foo=c("small", "large"))
{
  foo <- match.arg(foo)
  print(foo)
  2*v
}

funOne(5) # answer is 10, but foo is NULL

What happens is that in funOne I mask funTwo with a vector, but
that doesn't matter as the call to funTwo specifies
mode="function" (or something similar).  But what happens when
funTwo includes a match.arg?  In this case match.arg fails, and
the reason it fails is that sys.function(sys.parent()) in
match.arg evaluates to 1:10.  If there is a bug here it is the
failure of sys.function to grab a function, with the result that
formal.args in match.fun is NULL.

Cheers, Jonathan.

--please do not edit the information below--

Version:
 platform = sparc-sun-solaris2.7
 arch = sparc
 os = solaris2.7
 system = sparc, solaris2.7
 status = 
 major = 1
 minor = 2.1
 year = 2001
 month = 01
 day = 15
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base

==> 921.reply.1 <==
From postmaster@franz.stat.wisc.edu  Thu Apr 26 01:01:48 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id BAA04470
	for <r-bugs@biostat.ku.dk>; Thu, 26 Apr 2001 01:01:47 +0200 (MET DST)
Received: from pubhealth.ku.dk (really [130.225.108.10]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m14sYIG-000JdlC@franz.stat.wisc.edu> (Debian Smail3.2.0.111)
	for <r-bugs@r-project.org>; Wed, 25 Apr 2001 18:01:56 -0500 (CDT) 
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id BAA04466
	for <r-bugs@r-project.org>; Thu, 26 Apr 2001 01:01:27 +0200 (MET DST)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.9.3/8.9.3) id BAA30388;
	Thu, 26 Apr 2001 01:10:27 +0200
Sender: pd@pubhealth.ku.dk
To: r-bugs@r-project.org
Subject: match.arg confusion (PR#921)
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 26 Apr 2001 01:10:27 +0200
Message-ID: <x2zod4r2xo.fsf@blueberry.kubism.ku.dk>
Lines: 22
X-Mailer: Gnus v5.7/Emacs 20.7
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit


[sys.function fails sometimes (sorry, our mail system decide to throw
away the original mail)]

Yes, I bumped into something similar recently. The problem is that we
only actually store the call in the context structure, not the
function, so sys.function has to grab the call, take the 1st element,
and reevaluate it in the parent frame. It is quite easy to think up
examples where a second evaluation does not give the same value as
the first. 

Your particular case is of a slightly different natur and should be
easily fixable by replacing findVar in R_sysfunction by findVar1 and
looking specifically for objects of mode "function", but the basic
problem persists. I don't think I want to risk fixing this (and maybe
unfixing something else) for 1.2.3 tomorrow though.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 921.audit <==
Thu Apr 26 12:30:31 2001	pd	moved from incoming to Language
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1052 *
Subject:  Inconsistent behaviour of is.vector? 
From: J.C.Rougier@durham.ac.uk
Date: Tue, 14 Aug 2001 09:04:57 +0100
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1052 <==
From postmaster@franz.stat.wisc.edu  Tue Aug 14 10:09:16 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id KAA19232
	for <r-bugs@biostat.ku.dk>; Tue, 14 Aug 2001 10:09:14 +0200 (MET DST)
Received: from hermes.dur.ac.uk (really [129.234.4.9]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m15WZG1-000JHrC@franz.stat.wisc.edu> (Debian Smail3.2.0.111)
	for <r-bugs@r-project.org>; Tue, 14 Aug 2001 03:09:01 -0500 (CDT) 
Received: from euclid (euclid.dur.ac.uk [129.234.21.53])
	by hermes.dur.ac.uk (8.11.1/8.11.1) with ESMTP id f7E84vu13050
	for <r-bugs@r-project.org>; Tue, 14 Aug 2001 09:04:58 +0100 (BST)
Received: from modigliani.dur.ac.uk by euclid id <JAA02083@euclid>; Tue, 14 Aug 2001 09:04:45 +0100 (BST)
From: J.C.Rougier@durham.ac.uk
Date: Tue, 14 Aug 2001 09:04:57 +0100
Message-Id: <17014.200108140804@modigliani.dur.ac.uk>
To: r-bugs@r-project.org
Subject:  Inconsistent behaviour of is.vector? 
Cc: dma0jcr@modigliani.dur.ac.uk
X-ECS-MailScanner: Found to be clean

Hi everyone,

I have noticed that is.vector returns FALSE if I attach
attributes:

> x <- c(a = 1, b = 2)
> attributes(x)
$names
[1] "a" "b"

> is.vector(x)
[1] TRUE
> attr(x, "fred") <- "happy"
> attributes(x)
$names
[1] "a" "b"

$fred
[1] "happy"

> is.vector(x)
[1] FALSE

This seems inconsistent to me, as "names" is itself an attribute
yet this does negate is.vector.  As the original x is clearly a
vector, albeit one with names, wouldn't it be consistent to allow
any attributes?  This appears to be the case for is.matrix ...

> x <- matrix(1:4, 2, 2)
> is.matrix(x)
[1] TRUE
> attributes(x)
$dim
[1] 2 2
> attr(x, "fred") <- "happy"
> x
     [,1] [,2]
[1,]    1    3
[2,]    2    4
attr(,"fred")
[1] "happy"
> is.matrix(x)
[1] TRUE

Cheers, Jonathan.

--please do not edit the information below--

Version:
 platform = i686-pc-linux-gnu
 arch = i686
 os = linux-gnu
 system = i686, linux-gnu
 status = Patched
 major = 1
 minor = 3.0
 year = 2001
 month = 06
 day = 27
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base

==> 1052.followup.1 <==
From ripley@stats.ox.ac.uk  Tue Aug 14 10:43:20 2001
Received: from toucan.stats.ox.ac.uk (toucan.stats.ox.ac.uk [163.1.20.20])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id KAA19924
	for <R-bugs@biostat.ku.dk>; Tue, 14 Aug 2001 10:43:20 +0200 (MET DST)
Received: from gannet.stats (IDENT:root@gannet.stats [163.1.20.127])
	by toucan.stats.ox.ac.uk (8.9.0/8.9.0) with ESMTP id JAA12431;
	Tue, 14 Aug 2001 09:43:16 +0100 (BST)
Received: from localhost (ripley@localhost)
	by gannet.stats (8.11.3/8.11.3) with ESMTP id f7E8hGu16468;
	Tue, 14 Aug 2001 09:43:16 +0100
X-Authentication-Warning: gannet.stats: ripley owned process doing -bs
Date: Tue, 14 Aug 2001 09:43:16 +0100 (BST)
From: Prof Brian Ripley <ripley@stats.ox.ac.uk>
X-X-Sender:  <ripley@gannet.stats>
To: <J.C.Rougier@durham.ac.uk>
cc: <R-bugs@biostat.ku.dk>
Subject: Re: [Rd] Inconsistent behaviour of is.vector? (PR#1052)
In-Reply-To: <200108140809.KAA19242@pubhealth.ku.dk>
Message-ID: <Pine.LNX.4.31.0108140926180.16448-100000@gannet.stats>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

This seems intentional.  as.vector(x) changes x, and is.vector should be a
test of no change.  It is in S:

From S-PLUS 3.4:

       is.vector returns TRUE if x is a simple object of the mode
       specified, and FALSE otherwise.  If the mode is "any", any
       simple object will match,  that  is,  an  object  with  no
       attributes.   Note  that  a  list is typically a vector in
       this sense.

Note the `simple' in there.

R appears to allow names as attributes but nothing else, but does not
document this (except in the source code).  Anyone want to explain why R
is incompatible with S?  And why as.vector and is.vector are inconsistent?
(Note that the isas tests do not pick this up.)

This is a documentation bug, at least.


On Tue, 14 Aug 2001 J.C.Rougier@durham.ac.uk wrote:

> Hi everyone,
>
> I have noticed that is.vector returns FALSE if I attach
> attributes:
>
> > x <- c(a = 1, b = 2)
> > attributes(x)
> $names
> [1] "a" "b"
>
> > is.vector(x)
> [1] TRUE
> > attr(x, "fred") <- "happy"
> > attributes(x)
> $names
> [1] "a" "b"
>
> $fred
> [1] "happy"
>
> > is.vector(x)
> [1] FALSE
>
> This seems inconsistent to me, as "names" is itself an attribute
> yet this does negate is.vector.  As the original x is clearly a
> vector, albeit one with names, wouldn't it be consistent to allow
> any attributes?

Well, dim is an attribute, so you want an array to be a vector?

> This appears to be the case for is.matrix ...
>
> > x <- matrix(1:4, 2, 2)
> > is.matrix(x)
> [1] TRUE
> > attributes(x)
> $dim
> [1] 2 2
> > attr(x, "fred") <- "happy"
> > x
>      [,1] [,2]
> [1,]    1    3
> [2,]    2    4
> attr(,"fred")
> [1] "happy"
> > is.matrix(x)
> [1] TRUE
>
> Cheers, Jonathan.
>
> --please do not edit the information below--
>
> Version:
>  platform = i686-pc-linux-gnu
>  arch = i686
>  os = linux-gnu
>  system = i686, linux-gnu
>  status = Patched
>  major = 1
>  minor = 3.0
>  year = 2001
>  month = 06
>  day = 27
>  language = R
>
> Search Path:
>  .GlobalEnv, Autoloads, package:base
>
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


==> 1052.audit <==
Tue Aug 28 10:18:34 2001	ripley	moved from incoming to Language
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1073 *
Subject: Wierd problem comparing numeric values and list using ==
From: "Warnes, Gregory R" <gregory_r_warnes@groton.pfizer.com>
Date: Fri, 24 Aug 2001 22:07:41 -0400
--see also PR#1075
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1073 <==
From postmaster@franz.stat.wisc.edu  Sat Aug 25 04:08:02 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id EAA03646
	for <r-bugs@biostat.ku.dk>; Sat, 25 Aug 2001 04:08:01 +0200 (MET DST)
Received: from mailrelay1.pfizer.com (really [192.77.198.2]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m15aSrf-000JIlC@franz.stat.wisc.edu> (Debian Smail3.2.0.111)
	for <r-bugs@r-project.org>; Fri, 24 Aug 2001 21:07:59 -0500 (CDT) 
Received: from gsun56.pfizer.com (localhost [127.0.0.1])
	by mailrelay1.pfizer.com (8.9.3/Pro-8.9.3) with ESMTP id WAA09177
	for <r-bugs@r-project.org>; Fri, 24 Aug 2001 22:07:43 -0400 (EDT)
Received: from groexms01.pfizer.com (localhost [127.0.0.1])
	by gsun56.pfizer.com (Pro-8.9.3/Pro-8.9.3) with ESMTP id WAA24921
	for <r-bugs@r-project.org>; Fri, 24 Aug 2001 22:08:07 -0400 (EDT)
Received: from groexcncr05.pfizer.com (unverified) by groexms01.pfizer.com
 (Content Technologies SMTPRS 4.2.1) with ESMTP id <T559305f66fac1e08e203f@groexms01.pfizer.com> for <r-bugs@r-project.org>;
 Fri, 24 Aug 2001 22:07:41 -0400
Received: by groexcncr05.pfizer.com with Internet Mail Service (5.5.2650.21)
	id <R3ZPXZDF>; Fri, 24 Aug 2001 22:07:41 -0400
Message-ID: <5429125E11E4D411AF7300805FE603A8014CED55@groexmbcr02.pfizer.com>
From: "Warnes, Gregory R" <gregory_r_warnes@groton.pfizer.com>
To: "'r-bugs@r-project.org'" <r-bugs@r-project.org>
Subject: Wierd problem comparing numeric values and list using ==
Date: Fri, 24 Aug 2001 22:07:41 -0400
MIME-Version: 1.0
X-Mailer: Internet Mail Service (5.5.2650.21)
Content-Type: text/plain; charset="ISO-8859-1"


Under R 1.3.0 on Solaris and Windows NT  there seems to be a bug in == when
applied to elements of a list, particularly when one of the elements is of
mode integer:

	> list(1) == list(1)
	[1] FALSE
	> 1 == list(1)
	[1] TRUE
	> as.integer(1)==list(as.integer(1))
	[1] FALSE
	> as.integer(1)==list(as.double(1))
	[1] FALSE
	> list(as.integer(1))==list(as.integer(1))
	[1] FALSE
	> list(as.integer(1))==as.integer(1)
	[1] FALSE
	> list(as.double(1))==list(as.double(1))
	[1] FALSE

However, these cases work:

	> as.double(1)==list(as.integer(1))
	[1] TRUE
	> list(as.integer(1))==as.double(1)
	[1] TRUE

Replacing the bare integer/double with a vector constructed with c() doesn't
change the results, and comparing between vectors created with c() appears
correct.

-Greg

--please do not edit the information below--

Version:
 platform = i386-pc-mingw32
 arch = x86
 os = Win32
 system = x86, Win32
 status = 
 major = 1
 minor = 3.0
 year = 2001
 month = 06
 day = 22
 language = R

Windows NT 4.0 (build 1381) Service Pack 5

Search Path:
 .GlobalEnv, package:ctest, Autoloads, package:base


LEGAL NOTICE
Unless expressly stated otherwise, this message is confidential and may be privileged. It is intended for the addressee(s) only. Access to this E-mail by anyone else is unauthorized. If you are not an addressee, any disclosure or copying of the contents of this E-mail or any action taken (or not taken) in reliance on it is unauthorized and may be unlawful. If you are not an addressee, please inform the sender immediately.

==> 1073.reply.1 <==
From p.dalgaard@biostat.ku.dk  Sat Aug 25 15:58:26 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id PAA04833;
	Sat, 25 Aug 2001 15:58:25 +0200 (MET DST)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.11.2/8.11.2) id f7PDv9r21975;
	Sat, 25 Aug 2001 15:57:09 +0200
X-Authentication-Warning: blueberry.kubism.ku.dk: pd set sender to p.dalgaard@biostat.ku.dk using -f
Sender: pd@pubhealth.ku.dk
To: gregory_r_warnes@groton.pfizer.com
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] Wierd problem comparing numeric values and list using == (PR#1073)
References: <200108250208.EAA03656@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 25 Aug 2001 15:57:09 +0200
In-Reply-To: <200108250208.EAA03656@pubhealth.ku.dk>
Message-ID: <x23d6gmedm.fsf@blueberry.kubism.ku.dk>
Lines: 57
User-Agent: Gnus/5.0808 (Gnus v5.8.8) Emacs/20.7
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

gregory_r_warnes@groton.pfizer.com writes:

> Under R 1.3.0 on Solaris and Windows NT  there seems to be a bug in == when
> applied to elements of a list, particularly when one of the elements is of
> mode integer:
> 
> 	> list(1) == list(1)
> 	[1] FALSE
> 	> 1 == list(1)
> 	[1] TRUE
> 	> as.integer(1)==list(as.integer(1))
> 	[1] FALSE
> 	> as.integer(1)==list(as.double(1))
> 	[1] FALSE
> 	> list(as.integer(1))==list(as.integer(1))
> 	[1] FALSE
> 	> list(as.integer(1))==as.integer(1)
> 	[1] FALSE
> 	> list(as.double(1))==list(as.double(1))
> 	[1] FALSE
> 
> However, these cases work:
> 
> 	> as.double(1)==list(as.integer(1))
> 	[1] TRUE
> 	> list(as.integer(1))==as.double(1)
> 	[1] TRUE
> 
> Replacing the bare integer/double with a vector constructed with c() doesn't
> change the results, and comparing between vectors created with c() appears
> correct.

It is not entirely clear what we *should* be doing here. S (-PLUS 3.4)
is at least consistent:

> list(1) == list(1)
Error in list(1) == list(1): == operation on mode "list" undefined
Dumped
>  1 == list(1)
Error in 1 == list(1): == operation on mode "list" undefined
Dumped
> as.integer(1)==list(as.integer(1))
Error in as.integer(1) == list(as.integer(1)): == operation on mode "list"
        undefined
Dumped
...

so one might argue that you shouldn't do that in the first place...
(or that the bug is that we do not expressly forbid doing this.)

        -p

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 1073.audit <==
Tue Aug 28 10:14:14 2001	ripley	moved from incoming to Language
Tue Aug 28 10:16:19 2001	ripley	changed notes
Tue Aug 28 10:16:19 2001	ripley	foobar
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1076 *
Subject: Re: [Rd] Wierd problem comparing numeric values and list using == 
From: John Chambers <jmc@research.bell-labs.com>
Date: Mon, 27 Aug 2001 08:44:22 -0400
--part of PR#1073
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1076 <==
From jmc@research.bell-labs.com  Mon Aug 27 14:45:38 2001
Received: from crufty.research.bell-labs.com (crufty.research.bell-labs.com [204.178.16.49])
	by pubhealth.ku.dk (8.9.3/8.9.1) with SMTP id OAA16860;
	Mon, 27 Aug 2001 14:45:37 +0200 (MET DST)
Received: from scummy.research.bell-labs.com ([135.104.2.10]) by crufty; Mon Aug 27 08:40:52 EDT 2001
Received: from jessie.research.bell-labs.com (jessie.research.bell-labs.com [135.104.13.5])
	by scummy.research.bell-labs.com (8.11.4/8.11.4) with ESMTP id f7RCiOl07715;
	Mon, 27 Aug 2001 08:44:24 -0400 (EDT)
Received: from research.bell-labs.com (IDENT:jmc@newton.research.bell-labs.com [135.104.13.158])
	by jessie.research.bell-labs.com (8.9.1/8.9.1) with ESMTP id IAA18247;
	Mon, 27 Aug 2001 08:44:23 -0400 (EDT)
Sender: jmc@research.bell-labs.com
Message-ID: <3B8A40A6.15AF96C2@research.bell-labs.com>
Date: Mon, 27 Aug 2001 08:44:22 -0400
From: John Chambers <jmc@research.bell-labs.com>
Organization: Bell Labs, Lucent Technologies
X-Mailer: Mozilla 4.72 [en] (X11; U; Linux 2.2.14-5.0 i686)
X-Accept-Language: en
MIME-Version: 1.0
To: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
CC: gregory_r_warnes@groton.pfizer.com, r-devel@stat.math.ethz.ch,
        R-bugs@biostat.ku.dk
Subject: Re: [Rd] Wierd problem comparing numeric values and list using == 
 (PR#1073)
References: <200108250208.EAA03656@pubhealth.ku.dk> <x23d6gmedm.fsf@blueberry.kubism.ku.dk>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

Peter Dalgaard BSA wrote:
> 
> gregory_r_warnes@groton.pfizer.com writes:
> 
> > Under R 1.3.0 on Solaris and Windows NT  there seems to be a bug in == when
> > applied to elements of a list, particularly when one of the elements is of
> > mode integer:
> >
> >       > list(1) == list(1)
> >       [1] FALSE
> >       > 1 == list(1)
> >       [1] TRUE
> >       > as.integer(1)==list(as.integer(1))
> >       [1] FALSE
> >       > as.integer(1)==list(as.double(1))
> >       [1] FALSE
> >       > list(as.integer(1))==list(as.integer(1))
> >       [1] FALSE
> >       > list(as.integer(1))==as.integer(1)
> >       [1] FALSE
> >       > list(as.double(1))==list(as.double(1))
> >       [1] FALSE
> >
> > However, these cases work:
> >
> >       > as.double(1)==list(as.integer(1))
> >       [1] TRUE
> >       > list(as.integer(1))==as.double(1)
> >       [1] TRUE
> >
> > Replacing the bare integer/double with a vector constructed with c() doesn't
> > change the results, and comparing between vectors created with c() appears
> > correct.
> 
> It is not entirely clear what we *should* be doing here. S (-PLUS 3.4)
> is at least consistent:
> 
> > list(1) == list(1)
> Error in list(1) == list(1): == operation on mode "list" undefined
> Dumped
> >  1 == list(1)
> Error in 1 == list(1): == operation on mode "list" undefined
> Dumped
> > as.integer(1)==list(as.integer(1))
> Error in as.integer(1) == list(as.integer(1)): == operation on mode "list"
>         undefined
> Dumped
> ...
> 
> so one might argue that you shouldn't do that in the first place...
> (or that the bug is that we do not expressly forbid doing this.)
> 
>         -p
> 
> --
>    O__  ---- Peter Dalgaard             Blegdamsvej 3
>   c/ /'_ --- Dept. of Biostatistics     2200 Cph. N
>  (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

As of 1.4, we will have the `identical' function, which is the right way
to do such comparisons in any case.

So I'd vote for making a use of the comparison operators an error unless
the type is correct (or there is a method defined).  There is even code
in relop.c (commented out) that looks like the right test.  Any
objections?

John

-- 
John M. Chambers                  jmc@bell-labs.com
Bell Labs, Lucent Technologies    office: (908)582-2681
700 Mountain Avenue, Room 2C-282  fax:    (908)582-3340
Murray Hill, NJ  07974            web: http://www.cs.bell-labs.com/~jmc

==> 1076.reply.1 <==
From p.dalgaard@biostat.ku.dk  Mon Aug 27 15:36:50 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id PAA17663;
	Mon, 27 Aug 2001 15:36:49 +0200 (MET DST)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.11.2/8.11.2) id f7RDZHZ03790;
	Mon, 27 Aug 2001 15:35:17 +0200
X-Authentication-Warning: blueberry.kubism.ku.dk: pd set sender to p.dalgaard@biostat.ku.dk using -f
Sender: pd@pubhealth.ku.dk
To: jmc@research.bell-labs.com
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] Wierd problem comparing numeric values and list using == (PR#1076)
References: <200108271245.OAA16874@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 27 Aug 2001 15:35:17 +0200
In-Reply-To: <200108271245.OAA16874@pubhealth.ku.dk>
Message-ID: <x27kvpwrqi.fsf@blueberry.kubism.ku.dk>
Lines: 56
User-Agent: Gnus/5.0808 (Gnus v5.8.8) Emacs/20.7
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

jmc@research.bell-labs.com writes:

> > >       > list(1) == list(1)
> > >       [1] FALSE
> > >       > 1 == list(1)
> > >       [1] TRUE
> > >       > as.integer(1)==list(as.integer(1))
> > >       [1] FALSE
> > >       > as.integer(1)==list(as.double(1))
> > >       [1] FALSE
> > >       > list(as.integer(1))==list(as.integer(1))
> > >       [1] FALSE
> > >       > list(as.integer(1))==as.integer(1)
> > >       [1] FALSE
> > >       > list(as.double(1))==list(as.double(1))
> > >       [1] FALSE
> > >
> > > However, these cases work:
> > >
> > >       > as.double(1)==list(as.integer(1))
> > >       [1] TRUE
> > >       > list(as.integer(1))==as.double(1)
> > >       [1] TRUE
....
> As of 1.4, we will have the `identical' function, which is the right way
> to do such comparisons in any case.
> 
> So I'd vote for making a use of the comparison operators an error unless
> the type is correct (or there is a method defined).  There is even code
> in relop.c (commented out) that looks like the right test.  Any
> objections?

Not really, except that I get the usual nagging suspicion that someone
(who?) meant something by doing it this way...

The current logic seems to be that if either side of the == is a
vector of atomic type, try to coerce the list on the other side to a
similar object and then test. However this has a clear bug in that the
coercion is to double even when the atomic vector is integer. If there
are lists on both sides, a pointer comparison is done:

> x<-2
> list(x)==list(x)
[1] FALSE
> list(.Alias(x))==list(.Alias(x))
[1] TRUE

The latter seems highly dubious to me. I'd rather have a recursive
pairwise application of "==" there. However, none of this is what
identical does, is it?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 1076.audit <==
Tue Aug 28 10:14:14 2001	ripley	moved from incoming to Language
Tue Aug 28 10:15:49 2001	ripley	changed notes
Tue Aug 28 10:15:49 2001	ripley	foobar
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Directory:  Low-level

* PR# 989 *
Subject: "[.data.frame" allows un-named 3rd subscript
From: "Charles C. Berry" <cberry@tajo.ucsd.edu>
Date: Mon, 18 Jun 2001 13:13:46 -0700 (PDT)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 989 <==
From cberry@tajo.ucsd.edu  Mon Jun 18 22:10:28 2001
Received: from mailbox4.ucsd.edu (mailbox4.ucsd.edu [132.239.1.56])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id WAA14900
	for <r-bugs@biostat.ku.dk>; Mon, 18 Jun 2001 22:10:27 +0200 (MET DST)
Received: from smtp.ucsd.edu (smtp.ucsd.edu [132.239.1.49])
	by mailbox4.ucsd.edu (8.11.3/8.11.0) with ESMTP id f5IKAKq28590
	for <r-bugs@biostat.ku.dk>; Mon, 18 Jun 2001 13:10:20 -0700 (PDT)
Received: from tajo.ucsd.edu (tajo.ucsd.edu [132.239.99.2])
	by smtp.ucsd.edu (8.9.3/8.9.3) with ESMTP id NAA24075
	for <r-bugs@biostat.ku.dk>; Mon, 18 Jun 2001 13:10:20 -0700 (PDT)
Received: by tajo.ucsd.edu (8.9.3+Sun/SMI-SVR4-UCSD.1)
	id NAA15110; Mon, 18 Jun 2001 13:13:46 -0700 (PDT)
Date: Mon, 18 Jun 2001 13:13:46 -0700 (PDT)
Message-Id: <200106182013.NAA15110@tajo.ucsd.edu>
From: "Charles C. Berry" <cberry@tajo.ucsd.edu>
To: r-bugs@biostat.ku.dk
Subject: "[.data.frame" allows un-named 3rd subscript


Since the Extract page has usage as:

     x[i, j, ... , drop=TRUE]

I would expect that 'drop=' would need to be given to the third 'subscript'

> diag(4)[ , 4 , 4 ] # Forgot 'drop=' or added extra ','
Error in diag(4)[, 4, 4] : incorrect number of dimensions
> 
> as.data.frame( diag(4) )[ , 4 , 4 ] # should return error, right?
[1] 0 0 0 1


Also note:

> diag(4)[ ,  , drop=TRUE ]
     [,1] [,2] [,3] [,4]
[1,]    1    0    0    0
[2,]    0    1    0    0
[3,]    0    0    1    0
[4,]    0    0    0    1
> 
> as.data.frame( diag(4) )[ ,  , drop=TRUE ]
Error in [.data.frame(as.data.frame(diag(4)), , , drop = 4) : 
	Argument "j" is missing, with no default
> 

--please do not edit the information below--

Version:
 platform = sparc-sun-solaris2.7
 arch = sparc
 os = solaris2.7
 system = sparc, solaris2.7
 status = 
 major = 1
 minor = 2.3
 year = 2001
 month = 04
 day = 26
 language = R

Search Path:
 .GlobalEnv, package:nls, package:nlme, package:ctest, Autoloads, package:base



Chuck

-- 
Charles C. Berry                        (858) 534-2098 
                                         Dept of Family/Preventive Medicine
E mailto:cberry@tajo.ucsd.edu	         UC San Diego
http://hacuna.ucsd.edu/members/ccb.html  La Jolla, San Diego 92093-0645

 

==> 989.reply.1 <==
From pd@blueberry.kubism.ku.dk  Mon Jun 18 22:35:29 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id WAA15008;
	Mon, 18 Jun 2001 22:35:28 +0200 (MET DST)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.9.3/8.9.3) id WAA31163;
	Mon, 18 Jun 2001 22:38:38 +0200
Sender: pd@pubhealth.ku.dk
To: cberry@tajo.ucsd.edu
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] "[.data.frame" allows un-named 3rd subscript (PR#989)
References: <200106182010.WAA14911@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 18 Jun 2001 22:38:38 +0200
In-Reply-To: cberry@tajo.ucsd.edu's message of "Mon, 18 Jun 2001 22:10:29 +0200 (MET DST)"
Message-ID: <x27ky9o75d.fsf@blueberry.kubism.ku.dk>
Lines: 34
X-Mailer: Gnus v5.7/Emacs 20.7
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

cberry@tajo.ucsd.edu writes:

> Since the Extract page has usage as:
> 
>      x[i, j, ... , drop=TRUE]
> 
> I would expect that 'drop=' would need to be given to the third 'subscript'
> 
> > diag(4)[ , 4 , 4 ] # Forgot 'drop=' or added extra ','
> Error in diag(4)[, 4, 4] : incorrect number of dimensions
> > 
> > as.data.frame( diag(4) )[ , 4 , 4 ] # should return error, right?
> [1] 0 0 0 1
> 

And the bug is?

The generic indexing should really be x[...,drop=T].  Methods for
specific classes can specialize to a particular number of indices if
they want to, which is what is happening here

> get ("[.data.frame")
function (x, i, j, drop = if (missing(i)) TRUE else length(cols) == 
    1) 

one could fairly easily slip in a "..." argument after "j", and then
inside the function give an error if "..." is not empty, but what
would the point be?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 989.followup.1 <==
From cberry@tajo.ucsd.edu  Mon Jun 18 23:06:32 2001
Received: from mailbox3.ucsd.edu (mailbox3.ucsd.edu [132.239.1.55])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id XAA15201;
	Mon, 18 Jun 2001 23:06:31 +0200 (MET DST)
Received: from smtp.ucsd.edu (smtp.ucsd.edu [132.239.1.49])
	by mailbox3.ucsd.edu (8.10.1/8.11.0) with ESMTP id f5IL6PR16820;
	Mon, 18 Jun 2001 14:06:25 -0700 (PDT)
Received: from tajo.ucsd.edu (tajo.ucsd.edu [132.239.99.2])
	by smtp.ucsd.edu (8.9.3/8.9.3) with ESMTP id OAA06469;
	Mon, 18 Jun 2001 14:06:24 -0700 (PDT)
Received: from localhost by tajo.ucsd.edu (8.9.3+Sun/SMI-SVR4-UCSD.1)
	id OAA15733; Mon, 18 Jun 2001 14:09:49 -0700 (PDT)
Date: Mon, 18 Jun 2001 14:09:49 -0700 (PDT)
From: "Charles C. Berry" <cberry@tajo.ucsd.edu>
To: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] "[.data.frame" allows un-named 3rd subscript (PR#989)
In-Reply-To: <x27ky9o75d.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.GSO.4.05.10106181348090.12737-100000@tajo.ucsd.edu>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII


See below.

On 18 Jun 2001, Peter Dalgaard BSA wrote:

> cberry@tajo.ucsd.edu writes:
> 
> > Since the Extract page has usage as:
> > 
> >      x[i, j, ... , drop=TRUE]
> > 
> > I would expect that 'drop=' would need to be given to the third 'subscript'
> > 
> > > diag(4)[ , 4 , 4 ] # Forgot 'drop=' or added extra ','
> > Error in diag(4)[, 4, 4] : incorrect number of dimensions
> > > 
> > > as.data.frame( diag(4) )[ , 4 , 4 ] # should return error, right?
> > [1] 0 0 0 1
> > 
> 
> And the bug is?
> 
> The generic indexing should really be x[...,drop=T].  Methods for
> specific classes can specialize to a particular number of indices if
> they want to, which is what is happening here
> 
> > get ("[.data.frame")
> function (x, i, j, drop = if (missing(i)) TRUE else length(cols) == 
>     1) 
> 
> one could fairly easily slip in a "..." argument after "j", and then
> inside the function give an error if "..." is not empty, but what
> would the point be?
> 

The point would be to catch errors like this

for ( i in 1:2 ) foo[i,2] <- my.fun( bar[,i,2] , another.arg )

that might otherwise pass unnoticed when 'bar' is a data.frame.


Charles C. Berry                        (858) 534-2098 
                                         Dept of Family/Preventive Medicine
E mailto:cberry@tajo.ucsd.edu	         UC San Diego
http://hacuna.ucsd.edu/members/ccb.html  La Jolla, San Diego 92093-0645

 


==> 989.audit <==
Tue Jun 19 09:07:09 2001	ripley	moved from incoming to Low-level
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1063 *
Subject: interrupting Sys.sleep
From: Thomas Lumley <tlumley@u.washington.edu>
Date: Mon, 20 Aug 2001 13:55:29 -0700 (PDT)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1063 <==
From postmaster@franz.stat.wisc.edu  Mon Aug 20 22:55:35 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id WAA16433
	for <r-bugs@biostat.ku.dk>; Mon, 20 Aug 2001 22:55:35 +0200 (MET DST)
Received: from jason03.u.washington.edu (really [140.142.8.11]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m15Yw56-000JH0C@franz.stat.wisc.edu> (Debian Smail3.2.0.111)
	for <R-bugs@r-project.org>; Mon, 20 Aug 2001 15:55:32 -0500 (CDT) 
Received: from homer28.u.washington.edu (tlumley@homer28.u.washington.edu [140.142.8.38])
	by jason03.u.washington.edu (8.11.2+UW01.01/8.11.2+UW01.04) with ESMTP id f7KKtUu37756
	for <R-bugs@r-project.org>; Mon, 20 Aug 2001 13:55:30 -0700
Received: from localhost (tlumley@localhost)
	by homer28.u.washington.edu (8.11.2+UW01.01/8.11.2+UW01.04) with ESMTP id f7KKtTY130770
	for <R-bugs@r-project.org>; Mon, 20 Aug 2001 13:55:29 -0700
Date: Mon, 20 Aug 2001 13:55:29 -0700 (PDT)
From: Thomas Lumley <tlumley@u.washington.edu>
To: <R-bugs@r-project.org>
Subject: interrupting Sys.sleep
Message-ID: <Pine.A41.4.33.0108201130100.142352-100000@homer28.u.washington.edu>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII


On Linux R1.3.0 (and current pre1.3.1 and pre1.4.0)
 Sys.sleep(30)
interrupt with CTRL-C
 Sys.sleep(30)
causes a segmentation fault. It doesn't happen under Windows (2000).


	-thomas





==> 1063.followup.1 <==
From tlumley@u.washington.edu  Tue Aug 21 20:24:10 2001
Received: from jason03.u.washington.edu (jason03.u.washington.edu [140.142.8.11])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id UAA27594
	for <R-bugs@biostat.ku.dk>; Tue, 21 Aug 2001 20:24:09 +0200 (MET DST)
Received: from homer06.u.washington.edu (tlumley@homer06.u.washington.edu [140.142.15.40])
	by jason03.u.washington.edu (8.11.2+UW01.01/8.11.2+UW01.04) with ESMTP id f7LINQu46490;
	Tue, 21 Aug 2001 11:23:27 -0700
Received: from localhost (tlumley@localhost)
	by homer06.u.washington.edu (8.11.2+UW01.01/8.11.2+UW01.04) with ESMTP id f7LINQV169084;
	Tue, 21 Aug 2001 11:23:26 -0700
Date: Tue, 21 Aug 2001 11:23:26 -0700 (PDT)
From: Thomas Lumley <tlumley@u.washington.edu>
To: <r-devel@stat.math.ethz.ch>
cc: <R-bugs@biostat.ku.dk>
Subject: Re: [Rd] interrupting Sys.sleep (PR#1063)
In-Reply-To: <200108202055.WAA16443@pubhealth.ku.dk>
Message-ID: <Pine.A41.4.33.0108211114160.88898-100000@homer06.u.washington.edu>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Mon, 20 Aug 2001 tlumley@u.washington.edu wrote:

>
> On Linux R1.3.0 (and current pre1.3.1 and pre1.4.0)
>  Sys.sleep(30)
> interrupt with CTRL-C
>  Sys.sleep(30)
> causes a segmentation fault. It doesn't happen under Windows (2000).
>

The problem is that SleepHandler is not removed if the sleep is
interrupted. The segfault occurs if Sys.sleep() called again, or as soon
as the timer runs out.

It looks as though either do_syssleep needs to handle SIGINT itself or
jump_to_toplevel needs to know about event handlers.

	-thomas


==> 1063.audit <==
Tue Aug 21 20:25:22 2001	thomas	moved from incoming to Low-level
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1068 *
Subject: Interrupts (was Re: [Rd] X11 protocol errors ...)
From: Luke Tierney <luke@nokomis.stat.umn.edu>
Date: Wed, 22 Aug 2001 19:32:51 -0500
--see also followup in PR#1069
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1068 <==
From luke@nokomis.stat.umn.edu  Thu Aug 23 02:32:58 2001
Received: from nokomis.stat.umn.edu (root@nokomis.stat.umn.edu [134.84.86.39])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id CAA09952
	for <R-bugs@biostat.ku.dk>; Thu, 23 Aug 2001 02:32:57 +0200 (MET DST)
Received: (from luke@localhost)
	by nokomis.stat.umn.edu (8.11.3/8.10.2/SuSE Linux 8.10.0-0.3) id f7N0Wpq10715;
	Wed, 22 Aug 2001 19:32:51 -0500
Date: Wed, 22 Aug 2001 19:32:51 -0500
From: Luke Tierney <luke@nokomis.stat.umn.edu>
To: maechler@stat.math.ethz.ch
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Interrupts (was Re: [Rd] X11 protocol errors ...)
Message-ID: <20010822193251.A10682@nokomis.stat.umn.edu>
References: <200108221235.OAA05855@pubhealth.ku.dk>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: Mutt/1.2.5i
In-Reply-To: <200108221235.OAA05855@pubhealth.ku.dk>; from maechler@stat.math.ethz.ch on Wed, Aug 22, 2001 at 02:35:24PM +0200

Martin wrote:

> Just this morning,
> I found (again!, we had something close to this before) 
> the following related bugous behavior :
> After interrupting a plot (which would have taken a few minutes and was
> "wrong" anyway), starting another plot, interrupting again [with C-c],
> and maybe the same once more,
> R started just giving a ">" prompt
> but did not react any further at all.
> (C-c would return the prompt, but no other reaction was possible)
> Only killing the R process helped.
> 
> I may try to reproduce more exactly later today.

I'm surprised we don't get more of these sorts of things on UNIX.  Our
current UNIX interrupt handling approach takes an immediate LONGJMP
out of the signal handler no matter where the signal occurs (except
for two places where signals are suspended).  Any place where an
invariant is temporarily broken, any place where an assignment is not
yet complete, is a potential trouble spot.

I've been meaning to raise this issue at some point: I think we will
need to eventually spend some time re-examining how we want to handle
interrupts.  Right now on Windows/Mac interrupts are only processed at
special points in the evaluation process, which is a bit restrictive
(but perhaps unavoidable due to OS limitations).  On UNIX on the other
hand we LONGJUMP out of the signal handler except for the very few
places where the signal gets masked temporarily (GC and one place in
graphics I believe).  The UNIX approach is much too loose even now,
and it becomes even more untenable if we add any kind of threading
support.

We will I think have to come up with a cleaner model for very
selectively enabling interrupt processing, perhaps with some
integration with the external function registration mechanism Duncan
added recently (e.g. marking a function as one where LONGJMP's are
safe).  We will also need some means of controlling interrupt
behaviour from R, such as having some sort of without.interrupts and
with.interrupts functions to be able to program reliable interaction
with interrupts at the R level. (Another sort of thing we might
consider is suspending interrupts during on.exit processing.)

It's a farily big can of worms, and probably not urgent for now, but
we will need to look at it eventually.

luke

-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
313 Ford Hall, 224 Church St. S.E.           email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu

==> 1068.audit <==
Tue Aug 28 10:16:46 2001	ripley	moved from incoming to Low-level
Tue Aug 28 10:23:54 2001	ripley	changed notes
Tue Aug 28 10:23:54 2001	ripley	foobar
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1069 *
Subject: Interrupts (was Re: [Rd] X11 protocol errors ...)
From: "John W. Eaton" <jwe@bevo.che.wisc.edu>
Date: Wed, 22 Aug 2001 21:56:33 -0500
--part of PR#1068
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1069 <==
From jwe@ricotta.che.wisc.edu  Thu Aug 23 04:57:11 2001
Received: from ricotta.che.wisc.edu (ricotta.che.wisc.edu [128.104.179.160])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id EAA10175
	for <R-bugs@biostat.ku.dk>; Thu, 23 Aug 2001 04:57:10 +0200 (MET DST)
Received: from ricotta.che.wisc.edu (jwe@localhost [127.0.0.1])
        by localhost (8.12.0.Beta7/8.12.0.Beta7/Debian 8.12.0.Beta7-1) with ESMTP id f7N2uZqU003270;
	Wed, 22 Aug 2001 21:56:35 -0500
Received: (from jwe@localhost)
        by ricotta.che.wisc.edu (8.12.0.Beta7/8.12.0.Beta7/Debian 8.12.0.Beta7-1) id f7N2uXNS003266;
	Wed, 22 Aug 2001 21:56:33 -0500
From: "John W. Eaton" <jwe@bevo.che.wisc.edu>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Message-ID: <15236.28897.468790.842201@ricotta.che.wisc.edu>
Date: Wed, 22 Aug 2001 21:56:33 -0500
To: Luke Tierney <luke@nokomis.stat.umn.edu>
Cc: maechler@stat.math.ethz.ch, r-devel@stat.math.ethz.ch,
        R-bugs@biostat.ku.dk
Subject: Interrupts (was Re: [Rd] X11 protocol errors ...)
In-Reply-To: <20010822193251.A10682@nokomis.stat.umn.edu>
References: <200108221235.OAA05855@pubhealth.ku.dk>
	<20010822193251.A10682@nokomis.stat.umn.edu>
X-Mailer: VM 6.95 under Emacs 20.7.2

On 22-Aug-2001, Luke Tierney <luke@nokomis.stat.umn.edu> wrote:

| We will I think have to come up with a cleaner model for very
| selectively enabling interrupt processing, perhaps with some
| integration with the external function registration mechanism Duncan
| added recently (e.g. marking a function as one where LONGJMP's are
| safe).

FWIW, Octave doesn't do this correctly either, it just does a longjmp,
same as R, which can result in leaking memory, and possibly other bad
things.

The way Bash handles this is to only set a flag in the handler for
SIGINT, then at safe places in the code, there are

  QUIT;

statements.  These are macros that expand to some code that may
longjump somewhere depending on the interrupt state.  This method
avoids the problems of jumping out of the signal handler, which may
result in memory leaks or inconsistencies in global state.  The hard
part is inserting the (many!) QUIT statements, though it is probably
somewhat easier if this type of choice is made early on in the life of
the program instead of late.

I only mention Bash because it is a program that is expected to
handle a lot of interrupts without leaking memory or crashing, and
seems to do so reasonably well.

Packages like R and Octave also have to be able to handle interrupts
in calls Fortran or C code that may run for a long time, and which
cannot be modified (at least not easily) to add the equivalent QUIT
calls.  I'm not sure what the right solution is for cases like that.

jwe

-- 
www.octave.org        | Unfortunately we were hoplessly optimistic in 1954
www.che.wisc.edu/~jwe | about the problems of debugging FORTRAN programs.
                      |                                       -- J. Backus

==> 1069.audit <==
Tue Aug 28 10:16:46 2001	ripley	moved from incoming to Low-level
Tue Aug 28 10:23:24 2001	ripley	changed notes
Tue Aug 28 10:23:24 2001	ripley	foobar
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1120 *
Subject: bug in write.table?
From: Ott Toomet <siim@obs.ee>
Date: Sun, 7 Oct 2001 18:24:34 +0200 (CEST)
--Traced down to an effect of read.dta in foreign interacting with do_paste. Fixed
--in foreign, but do_paste may need to use strlen() rather than LENGTH().
--
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1120 <==
From siim@obs.ee  Sun Oct  7 18:24:20 2001
Received: from ecopc15.eco.au.dk (ecopc15.eco.au.dk [192.38.42.15])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id SAA11074
	for <r-bugs@biostat.ku.dk>; Sun, 7 Oct 2001 18:24:19 +0200 (MET DST)
Received: from localhost (siim@localhost)
	by ecopc15.eco.au.dk (8.11.2/8.11.2) with ESMTP id f97GOZm08466
	for <r-bugs@biostat.ku.dk>; Sun, 7 Oct 2001 18:24:35 +0200
X-Authentication-Warning: ecopc15.eco.au.dk: siim owned process doing -bs
Date: Sun, 7 Oct 2001 18:24:34 +0200 (CEST)
From: Ott Toomet <siim@obs.ee>
X-X-Sender:  <siim@ecopc15.eco.au.dk>
To: <r-bugs@biostat.ku.dk>
Subject: bug in write.table?
Message-ID: <Pine.LNX.4.33.0110071821220.8457-102000@ecopc15.eco.au.dk>
MIME-Version: 1.0
Content-Type: MULTIPART/MIXED; BOUNDARY="650121002-237711743-1002471874=:8457"

  This message is in MIME format.  The first part should be readable text,
  while the remaining parts are likely unreadable without MIME-aware tools.
  Send mail to mime@docserver.cac.washington.edu for more info.

--650121002-237711743-1002471874=:8457
Content-Type: TEXT/PLAIN; charset=US-ASCII

r-bugs@biostat.ku.dk

Hi,

I have found something I guess is a bug in write.table.  When saving
the object "e2" (see the session transcription below, I have attached
the Rdata file in gzipped form), the resulting table (also attached)
contains a spurious space in the front of columns from starting the
column "c05ak01" (column 234).

This would not be a problem, but if the object is large (the original
database contained not 10 but 7000 observations), some of the colums
are missing at all.  The problem is similar when you use quote=FALSE
option.

Best wishes

Ott Toomet
otoomet@econ.au.dk

Attachments:
table - ETU2000.and
R-datafile - e2.rd

--------------------------

Now the session sample: start R without previous .RData

> load( "/home/siim/a/e2.rd")
> ls()
[1] "e2"
> write.table( e2, quote=TRUE, sep="\t", file="ETU2000.and", na="", row.names=FALSE)
> dim(e2)
[1]   10 1197
> version
         _
platform i686-pc-linux-gnu
arch     i686
os       linux-gnu
system   i686, linux-gnu
status
major    1
minor    3.1
year     2001
month    08
day      31
language R


--650121002-237711743-1002471874=:8457
Content-Type: APPLICATION/x-gzip; name="ETU2000.and.gz"
Content-Transfer-Encoding: BASE64
Content-ID: <Pine.LNX.4.33.0110071824340.8457@ecopc15.eco.au.dk>
Content-Description: 
Content-Disposition: attachment; filename="ETU2000.and.gz"

H4sICFx1wDsAA0VUVTIwMDAuYW5kAO2b2XLbypJFn3G/Ql+gYGXWADx2REd3
9EN/BClRA0kd35BlX9+/76q9iqMoeTjWsY/bMFUJgkCuwiYqswb6w4fH+z9u
P/wx/HO+/DisP3zQzn3bux/m8/dP82H9cf74NN8Mm+X9Yv3uj+th/e/390+b
5dMwn4X6Z4v55rbZebeL1dNa77Hej3s/z7fHdd7i07Cop1ZP1SxknHfe313J
xG6uZZLKvJYpmJHLRi6bWhlmKgPea5WAGBADYkAMiAExQQyIATEgBsQEMUFM
EAPiQByIA3EgDsSBuCAOxIE4EAfigrggLogDiUAikAgkAolAIpAoSAQSgUQg
EUgUJAoSBYlAEpAEJAFJQBKQBCQJkoAkIAlIApIESYIkQRKQDCQDyUAykAwk
A8mCZCAZSAaSgWRBsiBZkAykAClACpACpAApQIogBUgBUoAUIEWQIkgRpAAZ
gYxARiAjkBHICGQUZAQyAhmBjEBGQUZBRkFGIBOQCcgEZAIyAZmATIJMQCYg
E5AJyCTIJMgkiLzPw0wQGeed93dXMrGba5mkMq9lCmbkspHLplbWVtjKgPd5
oMUHWjymv7sKtHjMtUwKtPhAiw+0eAyXTUEtXmXA+zzQ4gMtHtPfXQVaPOZa
JgVafKDFB1o8hsumoBavMuB9HmjxgRaP6e+uAi0ecy2TAi0+0OIDLR7DZVNQ
i1cZ8D4PtPhAi8f0d1eBFo+5lkmBFh9o8YEWj+GyKajFqwy1rPF13orF0IJg
i1FXn6pJLao2s8YuuuFtVlk4p/DZuOGz8aHbR+zEWZPOUmS+UmSu34BKVxn5
WHG+miXmRiapzJyROSPzUVGpFFANZ4xXGE4EH8Cb8Ca8KftUwyd2hbnGLDE3
mFvMHeYes5JR9S2qRDRDLMtdQcnahDSEtC6kSUhDSENI60JaF9K6kIaQhpAm
IU1CmoQ0CWkIaQhpCGkIaRLSENIQ0hDSJKQhpCGkIaQhpCGkIaRJSJOQhpCG
kIaQhpCGkIaQhpCGkIaQhpAmIU1CGkIaQpqERMH2bEpIR0jvQrqEdIR0hPQu
pHchvQvpCOkI6RLSJaRLSJeQjpCOkI6QjpAuIR0hHSEdIV1COkI6QjpCOkI6
QjpCuoR0CekI6QjpCOkI6QjpCOkI6QjpCOkI6RLSJaQjpCOkS0gUnMUuZETI
2IWMEjIiZETI2IWMXcjYhYwIGREySsgoIaOEjBIyImREyIiQESGjhIwIGREy
ImSUkBEhI0JGhIwIGREyImSUkFFCRoSMCBkRMiJkRMiIkBEhI0JGhIwIGSVk
lJARISNCRgkZh+tPQ40VtY1f04+9ph9bv62PW2MYx0RMwmRMwYyYSaZmSpnm
JcpXUplVFmAF2PhxawzjmIhJmIwpmBEzyQg2AqsGLwEvAS8BLwEvAS+heWm9
7WvF9CaFIYUhBTcfukGDgAYBDQIaBDQIaBDQwNDAUNJMUpikMElhSGFI0avN
LRm3ZNyS8ZlxS8YtGbdk3JJxS4YwhhfHi+PF8eJ4cbw4XjxLCpMUJikcKRwp
uHnrBg0MDQwNDA0MDQwNHA0cDRwlVYMol0llVlmAlUV/AJxbcm7JuaXILUVu
KXJLkQsitxS5pYgwES8RLxEvCS8JLwkvCS8pSgqXFD4sPw1LtZElbWRJG6mh
TGVUmfgk8Un+uDWGcUzEJEzGFMyImWTqAy2Dl4CXgJeAl4CXgJeAl4CX0LwU
1WFUGVQRPddLnutWfVP1jeob1Qdl8A2+9YPwDb7BN/gG3+Abd+F4cbw4Xhwv
jhfHi+PF8eKjqm+qvqn6TvWd6ruq76q+U32n+t05/Ag/wo/wI6dE+BF+hB/h
R+4i4iXhJeEl4SXhJeEl4SXhJRVV31V9H25a5/SmdU5rcdWK61YsW3HTitta
WDvF2ilWT/lUrWYSbphJuNFTdqMQekPwbGaNXXTD21FlC2o3YaaP1FO9CXp4
q+GYq5TbgFvNKtwwq3Az04Nxo0h1Q4yCaBCtE01EE9EgmogG0SCaiCaiiWgQ
HaLrFl1AB+gd6AC9A11AF9ABuoAO0AG6gC6gC+gAI8AoYBQwAowdGAHGDowC
RgEjwChgBBgBRgGjgFHACDABTAImARPA1IEJYOrAJGASMAFMAiaACWASMAmY
BEwAM8AsYBYwA8wdmAHmDswCZgEzwCxgBpgBZgGzgFnAPLQxResO335qNupd
Wr+TzRpLVfvQ7SNWj+8tj+2tHtdbPa63YTbH8El7UvBm3Zt1b9a9Gd4MbyZv
Jm+GN8ObyZt3b969effm3ZvjzfHm8uby5nhzvDXT7rg5d+5V7ehW7YhjpmOm
Y9vzXMdcx7wfizoWdSz2Y0nHko6lfizrWNax3I8VHSs61so8b8WiFqXtlbY3
1r+pvZvqO5u1tCRjGMdETMJkTMGMmEmmpqVbC3gJeAl4CXhpR3xoQ8z616ZM
2yDp7lM1Cmd3hLM7PSl3Cmd3xJ074s6dvvU7hZ06Qt2sW/mg8rGV9einauTs
Hme1t6sHrdqHbh+xSWXm1Lk8CsIV1q+wfoXpCtMVxhXOFd6v8H6F9ytcV7iu
8KGNpNsgcKX9OKw+VZP1fKyUi1d61ld61lfqb65CmGMWmCvMNWaJucHcYu5k
TKWrjCqTyowjcFkP4kqZdKWmsVLTWKmHJ7gBN+AG3IAbcANuwE1wE9wEN8EN
uAluHe6Cu+AuuAvuwB24A3fgDtyBO3AH7oK74C64C+7AXXDv8Ch4FDwKHgWP
wCPwCDwCj8Aj8Ag8Ao+CR8Gj4FHwCDwKHjs8CZ4ET4InwRPwBDwBT8AT8AQ8
AU/Ak+BJ8CR4EjwBT4KnDs+CZ8Gz4FnwDDwDz8Az8Aw8A8/AM/AseBY8C54F
z8Cz4LnDi+BF8CJ4EbwAL8AL8AK8AC/AC/ACvAheBC+CF8EL8CJ4LWuPdVW7
q6saglY1BK1qL3VVu6gry/P1g4zKRS3a2WP9m4ZV7aGuavd0Vfumq9oxXdVe
6ap2SVe1I9piSIsKtZ3PW7EYWl+gpeeWMdc1VahYt3Khou2O63fvroc2Wb2u
KaMV9bPajW/zsW26tM1mrmvXfV377evaaV/XEL2u3fU1wXlNcF4TnNcE5zXB
eU1wXhOc1wTnNcF5TXCWwUvAS8BLwEsDW/u8fdg+aYeT1riqXXQ73+idyqt+
7LrbKx29Vrnsx266XeroTStbNUv3W7rfIr9Ffkv3W7rfIr9Ffkv3W7rfIr9F
fsf54v6x2fdP9/9s9und8qnaqkD9Kteu3CRjGMdETMJkTMGMmOaiXdS+ba/f
9qa62NTrN/XiTb1yw6huw6huw6huw6huw6huw6huw6huw6huw6huw6huw6hu
Mys4Kzhrp00129WyZruHNk54aOOEh5lt2nvTUXtspeuI64jrSKx/ad720qKV
9f7qUxiGp/n7ZdC+ad+079p37UftR+0n7ad6/Vj/puGhVrfGyfqt1XKhsq9+
xr5KmuqfRJkjyhxR5ogyR5Q5orSm31aI2gJOW19pyx99iWOu1QGtDWhlQOsC
WhXQmsCw6ItzWg3QWoBWAoYFyz+DllA+TdPwr9un2ayVdf/u7rLuDO+f5k8f
3g+bm3ePV8th8+6P26fl48Mwv122vzD8693jur15mD/et4Xi5fWHq/nTcP/+
anld31xulh/r4/f+6cP1v2vJ23/URlWDiA8XNsTBZpUZhtCSamg79VhtZ8NQ
W7fsRR6Czq2vaWyvMOUyXAQdC+01bG3/25029etOTqs33c/RaaXszznyZjqN
z8I0ibg/qZw9KW4rwUn57En53Ek/agvTmIaLrVRh+A/VLbV61oOqtaP3NAw1
TGyVylxuqX6B3r7F3U1c6Pvabz/y7s5uoT1a3F/Svcz0Cgfl4YvvivPLuROO
Tz7rpDayKsv3vg2qVR9ia3e0q2R8+V5mrx7/s/W0o3+05zfc7Pg5e2lTw/Vk
PNX1aZ+ytSe7ijU7PTdyhjVjQ3vGZ6/8qw2C9nxQDTWXMLxUMQlC+1G7iDM1
soMXx3S9p8N29VdurQ17b8nt5cPUHi3VvEXtHoD1t6vuue01+aR+2LXEbQvb
1eHljwbIZx32+BSPovpRgwinraFIZ765ll1Cb1vbL1PPcT3Ub7pvvKmJKibu
46Ae9cL2CLTPvSewg+wVCLWhX1a/6DFd5hxzxfllLrXD6T67zLF2M3UCd9Pq
k+R4NryWRu0ojap2rQ6/3Fbb6KiQfJS6xjOpSy8lrzjsUtdBZvo7pKz4C6Ws
WUtZfEMnKesrK/mLpqxXskfgsf/RqennSEuhpaWRj+xnTUjnNo1O2hOXpi9M
M6PGLc/STOhpZhflDkY/9izNzOzSZ6XmkDK7nKXsL6aZ+AVpxg/STK/dL5lm
rI9utmnmf1q4qX8Hx/dpxpoQYdfziN1HSH+rEdKLz+3bbj2SB3U41cTa7mez
wktjmdmvlxj0VMVsPXOOZ04pfUzYTPqCPBGGb8kRcZ8jyvErHQTgkH/8ACZs
dy5acKKNxu84gPnc1/b8ohdhmow6mxUOr6DWNeT6uYSwG3eoARzPczEBdZgQ
rIb/1MYdIV+OpQ4VThLC7opRI4+aEHqEq19tq+I+IcTQ6xpG3YkeBFXUu9bb
ilg8nb4bz03f+Xg6fTf+fIHyC7cwtWcs9xv6QdH1O2w/Li8onJEXelr9qlxw
9MpfFmvPbz9xXtAcV24PWz5zivGB8TB+2fghz74iN9i2vX67uG++7ebgt5GF
6NRmDv6rHSjUPhx20N4qA1xsA+PpRNXJpNXBq3bgfTdRVeOoZoTK+RHEvuvT
E8bU5u2GXboIJyOIZxNV8r8bQYwqLy7qwKEFfY/xMuc6vtwlDO9Oehbq44dX
0oUdpQv7haepUtlPU/0O/l+5HQT/9Dv4nz/t/BYI+sl/R/s+YCHa/6c6/uNf
GOrPberh2l7mZwG87pdpH8d3UbwvN5yP4s/mgQQ5ieI25suUa8y2cbyskOk0
imvkPNs95i2Ou5bkB40MDuJ42nb7XaOKqbUx1o9PV+3rmOak23921T496/af
XY4fw1HafGlBfjxZkP+KVfufZKv34Nuhz3buSUscpU/X7eeefL/EwThdj85+
1umksf5EN8n2gxLM22CtN8ptG2pNi0ey6OcW3ua2/vdiNyXBw9ibw3ftBX3N
ECKXWa/luSpMfBB2swm2D0SH/8I+9tWhRkstZfzqSaZ9BPjsQsROO99rt59j
ffvnvC9IHJa1ozz0Od/2Sj98vmk/FfYlo41dzNVI43A66nyiSppiO8hXfdVi
6usDL6xaPBtziHS6alHqUCPkMnieXYZYA9/JJFXerlpMQxriZ7KVHWWr8AuP
OlremHre2Aaag6M9b3hb4DhYseDxilW0bVEO5t2Ol6Z+55C3xb6YQ6ZzOSQc
55BzawPfvPUfFMSh/TZlFy+00MDT9ErKIrFw3RcllvDmiaXrZFl9qKxX5Ich
th0gbh/8nahjH3pqTW87fKh9Zf8r+ov75LJb1bho9b3QgJhf/7WXfsjZJlN+
lhWN9OIgR0mjDXKo+cGQh9jfE0h8vsoRXh7upKPhznaVo1yWsS1u1B0r/myV
4ySBtAf9tRTiRykk/rIL3/zk7/ek1TdsPSC2lnpuuuoLftbUX9OfiS2n01Ut
f7zh1hcMSUd0L/i1+7TPF1P/RX82O8oj0wt55DO/hKrXfecV7r/LvJYdvtv+
dKdvf22EH+lUXzz/wewuwk+7CM/Xu5vLSq+NDnbzRweTPgdL2IXgHsZLi9WV
h9mleTqdy+pP2BD6b5raJOBrwT0eBff0y44Pfgf3b97+3wb3PoVxENzL57v/
r0Rwx8XvCP6jI3h8aX7nuI9+ML9DeG7/EeRwNYIR2msRPHa/wy5+z8JltHE6
WFo+E79nw+7nRdXXPyrUtdt+z3AQv3PoY4PQl3bSSz9CytO++3G0zHC8GlGO
V+f3iwR/w233P/30Dfy3+mlGDy0cTgJmzVAe3rS2/RzQ71+v/oXY0zBvn236
fxL35YsFU5n1tah49pShr71+Pr4bP1b9ht+h9ic0kU1HNfRChy39+P+rEA5m
bNovUG03Y2NHKwKnTepoe6tccLFdNTxdEZgd7x/0Z3YrAnmim/ziisB269M4
kd/3HK9ax5fXAeR/19Pv0zi7/yQ3+eWU4uzz/3vh/wCjPeTF5VwAAA==
--650121002-237711743-1002471874=:8457
Content-Type: APPLICATION/x-gzip; name="e2.rd.gz"
Content-Transfer-Encoding: BASE64
Content-ID: <Pine.LNX.4.33.0110071824341.8457@ecopc15.eco.au.dk>
Content-Description: 
Content-Disposition: attachment; filename="e2.rd.gz"

H4sICAd8wDsAA2UyLnJkAO1dS4wkyVnOfszUzOzO7tpeCdkIey8r78WjjozM
yiq4jIVlhAQXuCBOW1lZWV1Z1TtLd83srMRhhHxC4mL5AgdeEjbCWJZlZGEk
v8AYZK8fJyQkywIZISTEjTMmH5EZ//9VZj27uqt6/pCiK7+M+OJ/RGRmvDL7
Nz7xW+qe4zh3nCLcymJ/0ru4KPDdLJ4/eufBW72zgTmX5b/3pHf+YNILB5Pi
ZCuL8aPzs970oioHOdPR2eDBxbR39rYtO+pNe3k5Rb7DLA7c6rgMB+T4zs/S
kP5+wKYdfyH9vU/y3DO4jIcmHkG8ZcpC7s+TeM/E90H8SAOXln/QFBu4hyS+
YuLPQbzdwD0msUnuYT239aNlYoPcRhsX2nvwhX8k8V9N/CnE/5kjt6zT8pie
O57j5/V13sjPzsskvt/Ej0B8sY77LP2zTLxsrmPbe6brBxri/Tn2fswcZ/eE
D5q07PwbaQyyuGP23i7T03Bofm9RntNcv/eXiU3XPin/gMqn55fgHjZwm3QO
SZ6Q/tLzl89tfdHmaX3K/H6Oc1tfarp+SfkH9Jee38BXjfeNDeSuzaV55sUt
XAtU5zv7YO8+ynWu7xr8ks3T+rT5/Szntv5mC/ccuQaX5Dr7eQ3O8B2o3ybu
hnJDzFd3bgXuUjo3cA+W47a+OsttfW1JuTP6raDzjH7L63w9XMzTFLd5DRKd
W7tsr7NB29hQ7ibX4DW159Y/zXJb39xA56uo3+ftGpy53urO7ZK9jlyDTt25
hmvwu7Pc2XM7Vr/P2zV4G/PVndsle52atrssd0O5M9fbVejs1Ph0eW7rveuQ
uwxvO/Zej84b2jtzvd1ke4UrXOEKV7jCFa5whStc4QpXuMIVrnCFK1zhCle4
whWucIUrXOHuF9dxWt9K47fNe0afSeNfpPEbRfzoy0Vsfauem79Hlr1/lr13
c9scZ++z3S1lZscN3MOamL/DQ7jLvKuVR8KpcAOXvitUhhlsuK/UcT9OOPT4
V53aQNPy41+fk+9XFut9RGw9Qtyg96WGy2+D+ftJWbuhtmSYtoWm9+d+aOKP
bN7W97P2S/B7DXLv1Mg5dnj7fWFRG6Q6Osu139fLSPIiXvj+HM27pNy7DVzq
99p3HEleam/FK2OD3A+beI9wM/wqwW/Ma1dpeJHKQTzHV8fObP0u46vGPftL
cG+beEzzOvCe2S49By6b6yzZNprkpLew00XctDl/e33uC39b5L31Y+B+ZTF3
/WuwyV6Mwt34mVK9C17mc2bvz0cN3Ln9ihLvkr3CvdlcR+4587i73t/ddf2E
K1zhCle4whWucIUr3Jvc3911/YQrXOEKV7jCFa5whSvcm9zf3XX9hCtc4QpX
uMIVrnCFK9xL4zqz+89rQwM3+38OL60nt9g7vabO+f+Z2cTeNbl5uAbudem8
j77aR+7afl7E2ZbcDa/f/P9GXb3ORRCucGu4co+92dwXsrgml+3lX4W7iCNc
4QpXuMIVrnCFK1zhCle4whWucIUrXOE6fJ1u7jekFnCPnNn39qu5rXpu6wdp
/E6Rt/XPWVxB5xcd860cI6d2za6Bm60t3jFlsLm7xToX37sx+Y4d/i2cCjfY
+8Nl1jYa5B6b+OIa3Jl1WKJzhRu4M2EF7sza7xXJvSwutud90Bm5lQ0LuFVd
rSB3XrtaVm4dd5Fcpu8a3E3kCnc57gsmVt8NI9zse21353CPSMTvE81tV2W+
RVG4whWucIUrXOEKV7jCFa5wbzrXqf8+/Uy8Im45f3DVcnedWzcfOxNX4B5B
XEXuUtxnzmz7cxw+f5bF5bmtf8i+d78e184vrMGd2Y+5Areakwbuuu+B0/+r
MO9/LOThEmzc+/fVnY3aHP+O9hrcwzW5a+tcF3fdzxvKzdrunauWu4PcXb9W
d10/4QpXuPtxre66fsIVrnD341rddf2EK1zh7se1uuv6CVe4wt2Pa3XX9ROu
cJfiOs3rXXRdaaV1MyqzidukYynPWWPfaBpecsy61+rcw+9SvIbOa+11Nbzq
/y5fndz8fY73ynW7FeXedRbsC96OztV7K43vfDRxjc3Vuxyrc+2e6DW499fn
Hr61gdyD/eNuVEd3N+BuYu/RulwahSvcm851yPO94TjHTf2NZ8Vx9fxwYG27
mXvwZpF+8AN7fPjHaYwt9+i7DXJvmbIz3W43yL1Tz219q0jPn7d/ZI6/kUXL
bTXIPfr7Ms+82KDznfW5xXue63CX4QlXuMLdHtcp3j3O7k/Z91XL+2vZZ1+w
J3Hx/WqO3Np7OYlHc+R+PY3fTuP30viZNP5ZGr9qYvYe9vezd84b5N6uiaXs
6tyyfnZqxrFbqKO6MPOO7grcmSBc4ZpwY9vVM+dyr980vJHFRVzH7rGu23e9
YN4sn3d5r5DX+ksT/y6LVo/W9+bcY9faq15nb10U7vPHdTZ7B+L1ZeKc8eC6
70/ItSBc4QpXuFviOrAO6KwwX0fLLvPW4V3iUnvnlNH0PCrHmsc075LcOrlL
zW1Se+fFLbSNNxzoLxv8IYLdBu4dE1skb4aPCb67Ivc2xRtw72+gc+uy5ZL0
uf/rasfqd2Y/QB3epfa8CTeFf13YdPshzes4r3xlMfdyr33n+Xu/caP3DB1y
/a4q9zrs3UTnTeVeB9fZoH6dK5jL3TVu2jTq3mu/kde+cIUrXOEKV7jCFa5w
hStc4QpXuMIVrnCFK1zhCne3uA7ZL1nmq8MrcJddo99EbrXfAeSuwl3X3gNn
1t6DxdyPvpzGl7LzJG8W6Lrzh5at31Tk/+K5Bp2r97OInCXf1XKOSxuBe0zw
cQP3VZNO16xvpfFlgj/YpLMz69dldW5a72ZtZZXryFniu8hz5G51nd1p3hvw
QYIXXQvXtjdgnvwluI37gxZzV/vfiTU6H6/JnVnbW4Gbpd1fk7tI7rLfUsnL
+Tg5/sSczBiW1JOtE2+i5ydX0G0FHWv1e7YcN3sXrPad0G1eK/Pilq9v1mad
Bf/vc9/tFe58rrNkEK5whbsd7jNnL+8bM//3pi7Wcxf//+g5crMxy9z9vs3c
jeRm/YTWOtxFHOHuN9eZ05dfzJVrQbjCvU6uU7MX+orkLhWE+/xxnzlFu3H2
6B1uB+bd6S853/ieH81Df5fgHpM85bfQUG7jnGsNd6lvtW6o8z5yWZ4G7jJt
Yxtyt20v+6Xn94C7Th01cRt89Qu/ZvO80Niv3MI1+DrJ8zr9pecb+sBfTOOX
zLe0PpXGT6fxc2n8bBq/lsZvZulz+vz0ve/DmnPz3mme933ped96zNJ/ycSu
w78lUn0zed44ZVGc10daFJvqaJm4BZ2vhfvM2ewZ6vD2tLLOzwpM8/8hiXPr
13CPnA3sTcOXjazPm+PPN9lbw8VvRa30PWwjr+R+eUUu+27VKtxSNsUrcnf2
/UKnfq5vqW9dOKRdEVtXWtOmcuvKaJD7vjS+38QP1MRX0/hSA/dj5vfDJl+G
X3aKdfzAKeZdavdKUDvnxS3W0ab3ujLMnNul8RFkQd2r82vKPVhSbmNY8RlK
r6Om/Tv03nRlz+5nzkZt8rrk3jf+oMflbym36Vsmm3DLugwdXq/lubDJXpJe
F0u54Rrcsm00cK+tD1zX9qtzz4p8N6ZftwkXdCu/l1Pilon7bO9LlPvw6Yf+
PDt4eP4f//2n2e/03rsPSYaHv/NfP8vww3dGP8nx9Hf/ICvr4cVPf/JvOe9f
fpz/mnJqZbzz21/Pue+89p/fzLnf/7/Xst/Hv/+VoozDf8/Tn/zeID8/nb75
Zp6v/503qS5P/+SXG+2Y/tUn87Iu6XeJ+sW+c4WX4K7Ur8tsXiY2yD028dCk
ZefKb4SV8pueg3iPOKrTfYN+zlr3qwVybxl77xB9y++OHy+wt6zDW4R7i+C8
nhfoXPIOHO77eTo3BeavFcc4L5m8tN9+CGWXofxe2Ct16Qu4txu42ZjgfW73
td8cvP2ae3KiXlPuL/pqcXm3Zss7/oJj7sWPH5+P3ho+fssxvn27N3jimHob
P36c87OYnR8ZchbTtFGZ1utdTHvG7iyOn/TOp72JU8qYDEbh+NFbUYnH716M
ppPBtJTTO1EVt3fihr3JkOIe4DCZjlk6xxryayhPY/6yvLy9hU+LOshimJZd
qFbhkGMN6RrT+xx7iCODcz+GJ76BZXp7zPMHgDsgvxPy8rpleQVWJ4AVyEvt
dcFehjWka0zvc+whjgyu7HXRXpY/ANwB+Z2Ql9cty6vs5ViBvNReDfYyrCFd
Y3qfYw9xZHBlr0Z7Wf4AcAfkd0JeXrcsr7KXYwXyUns9sJdhDeka0/sce4gj
gyt7PbSX5Q8Ad0B+J+TldcvyKns5ViAvtdcHexnWkK4xvc+xhzgyuLLXR3tZ
/gBwB+R3Ql5etyyvspdjBfJSe9tgL8Ma0jWm9zn2EEcGV/a20V6WPwDcAfmd
kJfXLcur7OVYgbzU3gDsZVhDusb0Psce4sjgyt4A7WX5A8AdkN8JeXndsrzK
Xo4VyEvt7YC9DGtI15je59hDHBlc2dtBe1n+AHAH5HdCXl63LK+yl2MF8lJ7
u2AvwxrSNab3OfYQRwZX9nbRXpY/ANwB+Z2Ql9cty6vs5ViBPLenTri9HGtI
15je59hDHBlc2mugtZfnDwB3QH4n5OV1y/JKewErkJfaC/0rBf0rwJjeV9C/
Ahwp3r9S2L9S0L9S0L8CHPLyugr6V4CVwv6Vgv6Vgv4VYEzvK+hfAY4U718p
7F8p6F8p6F8BDnl5XQX9K8BKYf9KQf9KQf8KMKb3FfSvAEeK968U9q8U9K8U
9K8Ah7y8roL+FWClsH+loH+loH8FGNP7CvpXgCPF+1cK+1cK+lcK+leAQ15e
V0H/CrAqcT4GTAczPXKczdfm4znT6TfHuYfysVWfjK3SjlQ5dsnHYRk2g5sy
PYT00KTnuqQdEzZ2SR/cbCyUYuB3JmMyzkzxGeBzLr8L5XXZ2KoPY6m+HUsZ
7ALWXF/lsbFiiiPAA8Axl+9DeW0orw3ltYEfAJ+PJVMM5XX6gKF88JcCf7ng
L5ePPfsuH2unOATcBxwBHgCOAQ8BnwIeAU64/hr090B/H/T3wX5sr345liXt
36XpIaSHJr1q/y4rL2Bj47z9M37W/l2KzwCfc/ldKK/Lxtp9GFv37di6av8c
a65v1v5dhiPAA8Axl+9DeW0orw3ltYEfAJ/PLeTtn+M+YCgf/KXAXy74y+Vz
EXn7dxkOAfcBR4AHgGPAQ8CngEeAE66/Bv090N8H/X2wH9urX85tkPavaXoI
6aFJr9q/ZuUFbK4kb/+Mn7V/TfEZ4HMuvwvlddncSx/mWvp2rqVq/xxrrm/W
/jXDEeAB4JjL96G8NpTXhvLawA+Az+ea8vbPcR8wlA/+UuAvF/zl8rmpvP1r
hkPAfcAR4AHgGPAQ8CngEeCE669Bfw/090F/H+zH9uqXc12k/Xs0PYT00KRX
7d9j5QVs7ixv/4yftX+P4jPA51x+F8rrsrm4Psy99e3cW9X+OdZc36z9ewxH
gAeAYy7fh/LaUF4bymsDPwA+n3vM2z/HfcBQPvhLgb9c8JfL5yrz9u8xHALu
A44ADwDHgIeATwGPACdcfw36e6C/D/r7YH/VXvOxQPTUpqUdOdY3imDdJYJ1
l/TCfzKDXcAasAfYB9wGHADuAO5yTOdFckz6fmlFsb5jZNd5DG6D/QHYH4D9
nScz2AWsAXuAfcBtwAHgDuAux9z+zhMF+inQT4F+CvRToJ8C/RTop8g8YwTr
XhGM1bL2RvsiEax7RbDuldcnYmhfCtqXgvaloH0paF8K2peC9uVC+3Kh/buk
r5W1N9pXi+w6W9XeuP0B2B+E2J4U1LcL9e1CfbvAd6G+XahvF+rbhfp2ob5d
aI8u6KdBPw36adBPg34a9NOgnybrFhGsO0YwNsraG332R7DuGMG6Y16fiKF9
udC+XGhfLrQvF9qXC+1LQ/vS0L40tH9N+jZZe6N9o8iuc1btjdsfgP1BiPcr
DfWtob411LcH9e1BfXtQ3x7I86C+PahvD9qjB/p5oJ8H+vmgnw/6+aCfD/r5
5FkawbpvZMci+bN1QJ6tA3i2DuDZOrDPVpOfz3MMTjzg+8D3Q47bT2awC1gD
9gD7gNuAA8AdwF2O6bMpx6CfAv0U6KdAPwX6KdBPgX4K9FNkjWhwEoC/O4D5
s2oAz6qBfVZV9ecyvgd8H/h+iPXjgr9c8JeL+cFfLvjLBX+54C8X/OWCv1yo
Tw36adBPg34a9NOgnwb9NOinQT9N+hpZ/XF/dwDze/8A7v0De++v6k8zvgd8
H/h+iNeTBn954C8P/OWBvzwozwN/eeAvD/zlgb88qE8P9PNBPx/080E/H/Tz
QT8f9PNBP5+swWf1x/3dKXG+rhGTNY64WOMoj/vkOCLHA3Ick+OhPXZJmS4p
083KzO/hMVkriWGfWWz3meU6xzC+iGEfWWzHE/lYP8N0rSOGtZIM07WWGO5J
se1fF3x1wvWBfWWx4s+cFEN+/syJFdij0B6+Dy2GfWjxSXXTq/zhMn7A5t4L
f7g0PYR0NvcewzUe2/6f9QeVD/vOcn+4DEN+fg/P/MEx2sP3qcV2n1rVPmgb
j2EfWmz7Y8QfmqaHkM7mYmN7zVT+YOVn/qD6wL603B+aYcjP74mZPzhGe/g+
ttjuY6v8QecyYtinFtu5NOIPj6aHkM7m5jJ/8PK7vPzMH1Qf2LeW+8NjGPLz
uZjMHxyjPXyfW2z3uVX+oPvKYtjHlvvDR3/43B88PTTplT94+V1efuYPqg/s
a8v94TMM+TUvX4E9Cu3h++Biuw+u8gfddxbDPrfcH230R5v7g6eHJr3yBy+/
y8vP/EH1gX1vuT/aDEN+zctXYI+q7MnX6M3CqDm2a/fDp/YZMLTPmNym4Yk/
fkTWz4cnbba+nuIzwGx9fQhzXEP7DDLy+DNnCM+coTrhfHgGDW2/l+jrEtxm
66GFvgyz9dAhzJEM7TOi0pfeo4fwTMj1dRkGfnVPI/pqgtts/arQl2G2fjWE
MfbQ3sMrfek9dAj37FxfzXDJL9qGou2E+E3psl0U5cKzfGif5SS/y/K7kN+d
ya9Zfg359Ux+j+X3IL83k99n+X3I78/kb7P8bcjfnskfsPwB5Dc47xMOVbtH
jkN7HJDzQbX3ZlgMNs35LsnTDau6dE/YGD3HLmAN2APsA24DDgB3AHc5pmP0
oatAPwX6KdBPlfoVPnBJ2ywGp/nxKbn/pMfmtZAyLefkfe9T0vc+hb73KfS9
T6HvfQp971Poq57avmrFd4FP8ehETcYcnwE+Nzi3Y0TsGBE7RmDHyNqRt8vR
icfu3yk+A3xOxwQjWMMYwRrGCOweWbuJPBfkuSDPZfJckOeiPA3yNMrTIE+D
PM3kaZCniZ8T8sxMyDPTLBqbY6+qi+Sp1SU5abN7ZAJzQAk8+xJYz0jsekZu
a6IUq9sUh4D7gCPAA8Ax4CHgU3oNJLDXLYHxXALPgATGc4ndu2bSK38Qf9m2
kMCcSwLP3gTm4xM7H2/95TIcAu4DjgAPAMeAh4BP6TWfwN6oBMZ7CTwDExjv
JXavU+Uv+ows/GXbcgJzHAk8+xOYT07sfLL1l2Y4BNwHHAEeAI4BDwGf0r5K
AntpEhgPJtAHSGA8mNi9MZW/aB+h8JftI2T+on2EBMZzCbyHlNi9ENZfHsMh
4D7gCPAAcAx4CPiUjg8T2HuRwHgxgT5QAuPFxO6lqPxF+0iFv2wfKfMX7SMl
MN5L4D2mxL7HZP3lMxwC7gOOAA8Ax4CHgE/p+DHzF9dPA/YA+6B/O+TlBayP
WPjL9hEzf9E+YgLjwQTeg0rse1DWX22GQ8B9wBHgAeAY8BDwKR1fZv7i+mnA
HmAf9G+HvLyA9ZELf9k+cuYv2kfO/MUxf48qse9RWX8FDIeA+4AjwAPAMeAh
4FP6nlfmL66fBuwB9kH/dsjLq/xR9DOKBRtzTPolpB+ckH5wUizQmGM7j5O4
7d74jMhJcQGLMUSKQ8sLSBkdcty1x5ropYlemuiliV6a6FUsyphjK2tM+l2m
f1i8j572/8hxaPN4JL9PjtuEm4+lcpuz4zGxOcUhSQtNWvGe+0ln/OhRRMrs
Wl46fibHVh9F9CdjaPNiijkmOiuic7HQaI6JT1SHHHer+hzDOG8M47wxjPPG
MM4bwzhvDOO8MYzzxjDOG8M4bwzjvByDfgr0U6CfAv3MWmxhO2n7Y9L2x6Tt
j12753Hs+uxbASkuvxVQ1HeaPinqu8ThhNa/6/eBHwG/D/wI+APgx8AfAD82
2NjSJtwAbAnAlgBsCcCWAGwJwJYAbAnAlgBsCcCWAGwJYs7v9MLROcUX09Hb
FE8f5Z+MKG2395lxcZ8p2oTmcwc5dgFrwB5gH3AbcAC4A7hL6kiTe5Qm9yht
71ETMn6ckPHjhNy7JmS+fQJ7LCawx2ICeywmsMdiAnssJrDHYgJ7LCawx2IC
eywmsMdiAnssJicB6BuU+hrb8sLzdjE56bL5jhSf0fvxGVl3PSvWXfN8Zycu
46X4DPA5xxrya8iv2bzKGRkfnGV7tVleP+R5bV8ve0DQse+0dzGgOEt3Id2F
dA3pGtI9SPcg3Yd0n+naIcf2mjorKjTnpIMZdu9IMbt3ZOn8mype+U0V830X
23Z70HZ70HZ70HZ70HZ70HZ7tu0aWQE57pBja5t5idkcK3Jsr9WQrNGHZI0+
JP2MsOhnlMd9e+zR46gs3wwSzPn22B4H5LhDyu+Elmv1D4n+5oXkIv/Tbres
o3eG0xP67nWKu/Rd89PTB+kpiy+mvenjC4sn8aPz/iDHxTd8Hr01nA7Ozypf
DQeV3PRYlXX/zqPzsUnL8VnvfGS+BZSXO4ge93tTq9fooj+IHCtnED2YDJ7k
j4o8/WL6OHqXpF9Mi/QF3zw6bvjmUV7m696DkyHxzca4syC9e8ny9h0v8td1
lyf27pZ+Yu9uYbF3t8oTe2+2fmKv2Cv2ir1i727og/jyxnf52Pp1dbFq2n76
7bLbAaZjvSzCm8rbNfuvurz1+dLut4nRH5vW+763++vWd5V235V2fw31sht4
39r9qv2c+ra9ersXLPgm4f29rsX+fcTPu7+fd/vF34KfJ3x18xqCpf4Ei/8F
XyVev31d7jz0dV8X2/TDNudnxA+75teb5Yf1scxbih8u/3511fx903ff8arr
OJL/atMFb9efN+1+sWv7H/ZdnuDt4st+/+ymt4+bbp/4S/y1T1j8Jfgm41XH
Q/t+fVyevtudr983vwq+3Prd9fRd0+ey0ze9L+46vmn2bBuvOo7dd//u2vV4
3f4QfLX1te363/T9zD3BC75VddTwrSoJEiRIkCBBggQJEiRIkCBBggQJEiRI
kCBBggQJEiRIkCBBggQJEiRIkDAnLNibdTi7N8u5Z/IcKJv/wCXHmhx75Ngn
x21yHJDjDjk2/68x0+0w+5ePC3Q9qNH1wOh7L+pNew/i897ZoChn2fD/O2eO
NU3YAQA=
--650121002-237711743-1002471874=:8457--

==> 1120.audit <==
Thu Oct 11 17:59:27 2001	thomas	changed notes
Thu Oct 11 17:59:27 2001	thomas	foobar
Thu Oct 11 18:00:09 2001	thomas	moved from incoming to Low-level
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Directory:  Macintosh

none

Directory:  Misc

* PR# 1126 *
Subject: R-bug report www page whishlist
From: jens.lund@nordea.com
Date: Wed, 10 Oct 2001 18:24:29 +0200 (MET DST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1126 <==
From jens.lund@nordea.com  Wed Oct 10 18:24:29 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id SAA01798
	for <R-bugs@biostat.ku.dk>; Wed, 10 Oct 2001 18:24:29 +0200 (MET DST)
Date: Wed, 10 Oct 2001 18:24:29 +0200 (MET DST)
From: jens.lund@nordea.com
Message-Id: <200110101624.SAA01798@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: R-bug report www page whishlist

Full_Name: Jens Lund
Version: --
OS: --
Submission from: (NULL) (194.239.194.210)


On http://r-bugs.biostat.ku.dk/cgi-bin/R pressing "new bug report" returns a new
form. It would, IMHO, be natural to place the "submit bug report" button on this
form *below* the input area for the actual bug report :-)

Cheers, Jens

==> 1126.audit <==
Wed Oct 10 19:08:54 2001	ripley	moved from incoming to Misc
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Directory:  Models

none

Directory:  Startup

none

Directory:  System-specific

* PR# 848 *
Subject: X11 device doesn't handle destroy events correcly
From: Thomas Vogels <tov@ece.cmu.edu>
Date: 13 Feb 2001 17:40:46 -0500
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 848 <==
From postmaster@franz.stat.wisc.edu  Tue Feb 13 23:40:36 2001
Received: from franz.stat.wisc.edu (franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id XAA10552
	for <r-bugs@biostat.ku.dk>; Tue, 13 Feb 2001 23:40:36 +0100 (MET)
Received: from infiniti.ece.cmu.edu (really [128.2.133.84]) by franz.stat.wisc.edu
	via in.smtpd with esmtp
	id <m14So7r-000J2mC@franz.stat.wisc.edu> (Debian Smail3.2.0.102)
	for <r-bugs@r-project.org>; Tue, 13 Feb 2001 16:40:47 -0600 (CST) 
Received: (from tov@localhost) by infiniti.ece.cmu.edu (AIX4.3/UCB 8.8.8/8.8.8) id RAA70658; Tue, 13 Feb 2001 17:40:46 -0500
X-Authentication-Warning: infiniti.ece.cmu.edu: tov set sender to tov@ece.cmu.edu using -f
Sender: tov@infiniti.ece.cmu.edu
To: r-bugs@r-project.org
Cc: Thomas Vogels <tov@ece.cmu.edu>
Subject: X11 device doesn't handle destroy events correcly
Reply-To: Thomas Vogels <tov@ece.cmu.edu>
X-URI: http://www.ece.cmu.edu/~tov
From: Thomas Vogels <tov@ece.cmu.edu>
Date: 13 Feb 2001 17:40:46 -0500
Message-ID: <px3ddi6wb5.fsf@infiniti.ece.cmu.edu>
Lines: 258
User-Agent: Gnus/5.0807 (Gnus v5.8.7) Emacs/20.7
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii


Hi, there are two problems in devX11.c.  The one is an undocumented
nuisance and the other isn't a bug until you try to embed an X11
device in another window (think tktoplevel() in tcltk package...).

Let's take a look at locator() first: Assuming you call locator() with
a current X11 device, this call is handled in X11_Locator
(src/unix/X11/devX11.c).  When you have one window open and call
locator, you have three options to quit the locator: click Button 1
(to locate), click Button 2 (to abort), or destroy the window.  The
later results in the error message: "Error in locator(1) : No graphics
device is active". That's OK, sort of.

This gets problematic when you open two windows:
> x11()  # assume that's device 2
> x11()  # assume that's device 3
> plot(1)
> locator(1)  # with device 3 == dev.cur()!

When you now destroy device 3 (where locator expects the click), you have
*no alternative but to close _all_ windows* to abort the locator.  The
locator continues to wait for mouse clicks in device 3 where of course
no further clicks can come from.  That's the nuisance part.

The second problem is that the device may try to plot() into a
non-existant window.  Assume that the window was destroyed by some
other part of the program.  The device (at some point in the future)
will receive a DestroyNotify event that handleEvent ignores.
Blissfully!  *No KillDevice is called* when the window is destroyed by
something other than the WM_DELETE_WINDOW mechanism!  This happens
when you embed the X11 device into another window/application.  For
starters, the device no longer receives WM_DELETE_WINDOW client
messages.  But it does receive a DestroyNotify event when the parent
(the container window) is destroyed.  HandleEvent should, well
_handle_ this _event_.

The patch below is a _suggestion_ how to solve both problems.  It is
against the current r-devel, 1.3, as of 2/13.  I believe this behavior
exists in version 1.2 as well and can be solved there the same way.
The patch is just meant as a convenient and concise way to describe
my suggestion.  I'd greatly appreciate feedback or other ideas!

Implementation:

-- the variable inclose is now in the device specific structure (why
   was it global?)  After the window is mapped, inclose is TRUE until
   the window is destroyed explicitly or a DestroyNotify event has been
   received.
-- the deviceSpecific pointer is set to NULL after the memory has been
   freed. This (side?) effect is used in X11_Locator to detect the
   closing of the current device  which _must_ lead to an error.
-- the if statement to handle events of type DestroyEvent is added to 
   handleEvent
-- when the user closes the device (dev.off()), the window is
   destroyed in X11_Close
-- when the user pushes the close button in the window frame, the
   window is destroyed in handleEvent and X11_Close is initiated
   (the WM_DELETE_WINDOW mechanism already in place.)
-- when the window is destroyed for another reason (e.g. the parent
   being destroyed), it is not destroyed again but X11_Close is still
   initiated.

Regards,
  -tom


--------------------------------------------------
*** devX11.c_orig	Tue Feb 13 15:32:24 2001
--- devX11.c	Tue Feb 13 17:24:04 2001
***************
*** 116,121 ****
--- 116,122 ----
      FILE *fp;				/* file for a bitmap device */
      int quality;			/* JPEG quality */
  
+     Rboolean inclose;                   /* TRUE if window is being closed */
  } x11Desc;
  
  
***************
*** 145,151 ****
  static Atom _XA_WM_PROTOCOLS, protocol;
  
  static Rboolean displayOpen = FALSE;
- static Rboolean inclose = FALSE;
  static int numX11Devices = 0;
  
  	/********************************************************/
--- 146,151 ----
***************
*** 619,632 ****
  	xd->windowHeight = event.xconfigure.height;
  	xd->resize = 1;
      }
      else if ((event.type == ClientMessage) &&
! 	     (event.xclient.message_type == _XA_WM_PROTOCOLS))
! 	if (!inclose && event.xclient.data.l[0] == protocol) {
! 	    XFindContext(display, event.xclient.window,
  			 devPtrContext, &temp);
  	    dd = (DevDesc *) temp;
! 	    KillDevice(dd);
  	}
  }
  
  static void R_ProcessEvents(void *data)
--- 619,652 ----
  	xd->windowHeight = event.xconfigure.height;
  	xd->resize = 1;
      }
+     else if (event.type == DestroyNotify) {
+         /* The window is being destroyed, kill the device, too. */
+         XFindContext(display, event.xdestroywindow.window,
+                      devPtrContext, &temp);
+         dd = (DevDesc *) temp;
+         xd = (x11Desc *) dd->deviceSpecific;
+         if (!xd->inclose) {
+             xd->inclose = TRUE;
+             KillDevice(dd);
+         }
+     }
      else if ((event.type == ClientMessage) &&
! 	     (event.xclient.message_type == _XA_WM_PROTOCOLS)) {
! 	if (event.xclient.data.l[0] == protocol) {
!             XFindContext(display, event.xclient.window,
  			 devPtrContext, &temp);
  	    dd = (DevDesc *) temp;
! 	    xd = (x11Desc *) dd->deviceSpecific;
! 	    if (!xd->inclose) {
! 		/* Dispatch destroy only once */
! 		xd->inclose = TRUE;
! 		XDestroyWindow(display, xd->window);
! 		XSync (display, 0);
! 		KillDevice(dd);
! 	    }
  	}
+     }
+ 
  }
  
  static void R_ProcessEvents(void *data)
***************
*** 1208,1213 ****
--- 1228,1234 ----
  		     ExposureMask | ButtonPressMask | StructureNotifyMask);
  	XMapWindow(display, xd->window);
  	XSync(display, 0);
+         xd->inclose = FALSE;
  
  	/* Gobble expose events */
  
***************
*** 1464,1476 ****
      x11Desc *xd = (x11Desc *) dd->deviceSpecific;
  
      if (xd->type == WINDOW) {
! 	/* process pending events */
! 	/* set block on destroy events */
! 	inclose = TRUE;
  	R_ProcessEvents((void*) NULL);
  
  	XFreeCursor(display, xd->gcursor);
- 	XDestroyWindow(display, xd->window);
  	XSync(display, 0);
      } else {
  	if (xd->npages && xd->type != XIMAGE) {
--- 1485,1506 ----
      x11Desc *xd = (x11Desc *) dd->deviceSpecific;
  
      if (xd->type == WINDOW) {
! 	/* There are three reasons to be here: */
! 	/* 1) The user clicked on a button in the window frame */
! 	/*    and we received a DELETE_WINDOW from the wm, */
! 	/* 2) Somebody destroyed our window directly, or if */
! 	/*    embedded, the parent is being destroyed, and so */
! 	/*    we got a DestroyNotify event, too, */
! 	/* 3) The user used dev.off() to get rid of us. Bye. */
! 
! 	if (!xd->inclose) {
! 	    xd->inclose = TRUE;
! 	    XDestroyWindow(display, xd->window);
! 	}
! 	/* process pending events (esp. reap events for this window) */
  	R_ProcessEvents((void*) NULL);
  
  	XFreeCursor(display, xd->gcursor);
  	XSync(display, 0);
      } else {
  	if (xd->npages && xd->type != XIMAGE) {
***************
*** 1517,1523 ****
      }
  
      free(xd);
!     inclose = FALSE;
  }
  
  	/********************************************************/
--- 1547,1553 ----
      }
  
      free(xd);
!     dd->deviceSpecific = NULL;
  }
  
  	/********************************************************/
***************
*** 1858,1866 ****
  		else
  		    done = 2;
  	    }
! 	}
! 	else
  	    handleEvent(event);
      }
      /* if it was a Button1 succeed, otherwise fail */
      return (done == 1);
--- 1888,1901 ----
  		else
  		    done = 2;
  	    }
! 	} else {
  	    handleEvent(event);
+ 	    if (!dd->deviceSpecific) {
+ 		/* Allow new active window to redraw */
+ 		R_ProcessEvents((void*)NULL);
+ 		error ("Device closed while waiting for input.\n");
+ 	    }
+         }
      }
      /* if it was a Button1 succeed, otherwise fail */
      return (done == 1);
--------------------------------------------------




--please do not edit the information below--

Version:
 platform = i686-pc-linux-gnu
 arch = i686
 os = linux-gnu
 system = i686, linux-gnu
 status = Under development (unstable)
 major = 1
 minor = 3.0
 year = 2001
 month = 02
 day = 12
 language = R

Search Path:
 .GlobalEnv, package:ctest, Autoloads, package:base


-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204


==> 848.followup.1 <==
From pd@biostat.ku.dk  Wed Feb 14 01:10:35 2001
Received: from biostat.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id BAA10968;
	Wed, 14 Feb 2001 01:10:34 +0100 (MET)
Received: (from pd@localhost)
	by biostat.ku.dk (8.9.3/8.9.3) id BAA02066;
	Wed, 14 Feb 2001 01:11:56 +0100
Sender: pd@blueberry.kubism.ku.dk
To: tov@ece.cmu.edu
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] X11 device doesn't handle destroy events correcly (PR#848)
References: <200102132240.XAA10562@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@pubhealth.ku.dk>
Date: 14 Feb 2001 01:11:56 +0100
In-Reply-To: tov@ece.cmu.edu's message of "Tue, 13 Feb 2001 23:40:37 +0100 (MET)"
Message-ID: <x2elx2yvg3.fsf@blueberry.kubism.ku.dk>
Lines: 25
X-Mailer: Gnus v5.7/Emacs 20.7
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

tov@ece.cmu.edu writes:


> Blissfully!  *No KillDevice is called* when the window is destroyed by
> something other than the WM_DELETE_WINDOW mechanism!  This happens
> when you embed the X11 device into another window/application.  For
> starters, the device no longer receives WM_DELETE_WINDOW client
> messages.  But it does receive a DestroyNotify event when the parent
> (the container window) is destroyed.  HandleEvent should, well
> _handle_ this _event_.

Heh. Quite probably, this is also the source of the FVWM trouble
reported earlier although that triggered an infinite loop which should
probably be guarded against by other means as well. 

Thanks for filing this (good to have as bug report so that we don't
forget - it's the sort of thing that often has to wait until someone
has a clear enough mind and sufficient stamina to try and get it
right.)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 848.audit <==
Sat Feb 17 11:44:41 2001	ripley	moved from incoming to System-specific
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1002 *
Subject: core dump running modreg-Ex.R
From: WhiteG@dfo-mpo.gc.ca
Date: Thu, 28 Jun 2001 19:14:18 +0200 (MET DST)
--Only reported on SGI, solved by removing optimization.
--Needs debugging there.
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1002 <==
From WhiteG@dfo-mpo.gc.ca  Thu Jun 28 19:14:18 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id TAA20611
	for <R-bugs@biostat.ku.dk>; Thu, 28 Jun 2001 19:14:18 +0200 (MET DST)
Date: Thu, 28 Jun 2001 19:14:18 +0200 (MET DST)
From: WhiteG@dfo-mpo.gc.ca
Message-Id: <200106281714.TAA20611@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: core dump running modreg-Ex.R

Full_Name: George N. White III
Version: R-1.3.0 
OS: Irix 6.5
Submission from: (NULL) (142.176.61.253)


R-1.3.0 was built on Irix 6.5 using gcc and MIPSPro f90.  This combination has
worked for previous versions, in particular R-1.2.3.

$ cd test/Examples
$ ../../bin/R --vanilla < modreg-Ex.R > modreg-Ex.Rout

This worked in R-1.2.3.  It looks like there were a number 
of cosmetic changes to the modreg Fortran sources since R-1.2.3. 
SGI MIPSPro f90 was used to compile modreg, e.g.:

   f90 -OPT:IEEE_NaN_inf=ON -KPIC -O2 -c sslvrg.f -o sslvrg.o

$ dbx ../../bin/R.bin
dbx version 7.3 MR 55458_Apr30_MR Apr 30 1999 13:44:41
Core from signal SIGBUS: Bus error
(dbx) where
>  0 sslvrg(0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x7ffdaa38)
["/disk2/gwhite/src/R-1.3.0/src/library/modreg/src/sslvrg.f":94, 0x5fceff54]
   1 sbart(0xd, 0x7ffcebc8, 0x7ffdab20, 0x7ffdf940, 0x7ffe4760, 0x5fd058dc,
0x10cdb9a8, 0x7ffdaa38)
["/disk2/gwhite/src/R-1.3.0/src/library/modreg/src/sbart.f":204, 0x5fcee388]
   2 qsbart(0xd, 0x7ffcf3f8, 0x7ffcf3d8, 0xb, 0x7ffce6c0, 0x4, 0x1, 0x2)
["/disk2/gwhite/src/R-1.3.0/src/library/modreg/src/qsbart.f":15, 0x5fcee140]
   3 bdrspline(0x10cdb9a8, 0x7ffd0df8, 0x10ce0a28, 0x7ffd5c18, 0x3, 0x10cd5ba0,
0x1, 0x2) ["/disk2/gwhite/src/R-1.3.0/src/library/modreg/src/ppr.f":1261,
0x5fcedae0]
   [...]

Regenerating modreg.so using g77 (e.g., $ gmake FC=g77 ALL_FFLAGS='-O2 -g')
did not fix the problem (so it may not be a compiler bug):

$ dbx ../../bin/R.bin                                 
dbx version 7.3 MR 55458_Apr30_MR Apr 30 1999 13:44:41
Core from signal SIGBUS: Bus error
(dbx) where
>  0 sslvrg_() ["/usr/people/gwhite/src/R-1.3.0/src/library/modreg/src/sslvrg.f":94,
0x5fcf3ba0]
   1 sbart_() ["/usr/people/gwhite/src/R-1.3.0/src/library/modreg/src/sbart.f":204,
0x5fcf25c8]
   2 qsbart_() ["/usr/people/gwhite/src/R-1.3.0/src/library/modreg/src/qsbart.f":15,
0x5fcf21c8]
   3 bdrspline_() ["/usr/people/gwhite/src/R-1.3.0/src/library/modreg/src/ppr.f":1261,
0x5fcf1ba0]





==> 1002.followup.1 <==
From ripley@stats.ox.ac.uk  Thu Jun 28 19:30:58 2001
Received: from toucan.stats.ox.ac.uk (toucan.stats.ox.ac.uk [163.1.20.20])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id TAA20684
	for <R-bugs@biostat.ku.dk>; Thu, 28 Jun 2001 19:30:58 +0200 (MET DST)
Received: from max166.public.ox.ac.uk (max166.public.ox.ac.uk [192.76.27.166])
	by toucan.stats.ox.ac.uk (8.9.0/8.9.0) with ESMTP id SAA07791;
	Thu, 28 Jun 2001 18:30:51 +0100 (BST)
Date: Thu, 28 Jun 2001 18:31:21 +0100 (GMT Daylight Time)
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
To: <WhiteG@dfo-mpo.gc.ca>
cc: <R-bugs@biostat.ku.dk>
Subject: Re: [Rd] core dump running modreg-Ex.R (PR#1002)
In-Reply-To: <200106281714.TAA20621@pubhealth.ku.dk>
Message-ID: <Pine.WNT.4.31.0106281828080.90-100000@tern.stats>
Sender: ripley@stats.ox.ac.uk
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Thu, 28 Jun 2001 WhiteG@dfo-mpo.gc.ca wrote:

> Full_Name: George N. White III
> Version: R-1.3.0
> OS: Irix 6.5
> Submission from: (NULL) (142.176.61.253)
>
>
> R-1.3.0 was built on Irix 6.5 using gcc and MIPSPro f90.  This combination has
> worked for previous versions, in particular R-1.2.3.
>
> $ cd test/Examples
> $ ../../bin/R --vanilla < modreg-Ex.R > modreg-Ex.Rout
>
> This worked in R-1.2.3.  It looks like there were a number
> of cosmetic changes to the modreg Fortran sources since R-1.2.3.

We had a private report of this on Iris 6.5, and the resolution was that it
worked with optimization off.

This is the only platform reporting a problem, so we need someone to debug
it there.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


==> 1002.audit <==
Sat Jun 30 08:56:09 2001	ripley	moved from incoming to System-specific
Sat Jun 30 08:59:20 2001	ripley	changed notes
Sat Jun 30 08:59:20 2001	ripley	foobar
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1020 *
Subject: .Call and Mandrake 8.0
From: lcottret@yahoo.fr
Date: Wed, 11 Jul 2001 15:34:23 +0200 (MET DST)
--problem with symbol names only on Mandrake 8.0, not 7.2
--needs reply to follow-up
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1020 <==
From lcottret@yahoo.fr  Wed Jul 11 15:34:24 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id PAA16374
	for <R-bugs@biostat.ku.dk>; Wed, 11 Jul 2001 15:34:23 +0200 (MET DST)
Date: Wed, 11 Jul 2001 15:34:23 +0200 (MET DST)
From: lcottret@yahoo.fr
Message-Id: <200107111334.PAA16374@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: .Call and Mandrake 8.0

Full_Name: Ludovic Cottret
Version: R 1.3.0
OS: Linux
Submission from: (NULL) (157.136.20.138)


I have a R function which call a C function by the instruction ".Call".
The first time I call the R function in a R session, it perfectly runs. But the
next 
times, R returns this error message :

Error in .Call("", bankpath, accn, indexpath, key, beg, end) :
        .Call function name not in load table

The function name has disappeared !!
This function well runs on Mandrake 7.2 but not in Mandrake 8.0. Why ?!?

Thanks for your answers...
PS : Excuse my poor english...




==> 1020.followup.1 <==
From duncan@jessie.research.bell-labs.com  Wed Jul 11 16:15:16 2001
Received: from crufty.research.bell-labs.com (crufty.research.bell-labs.com [204.178.16.49])
	by pubhealth.ku.dk (8.9.3/8.9.1) with SMTP id QAA16686
	for <R-bugs@biostat.ku.dk>; Wed, 11 Jul 2001 16:15:15 +0200 (MET DST)
Received: from scummy.research.bell-labs.com ([135.104.2.10]) by crufty; Wed Jul 11 10:10:04 EDT 2001
Received: from jessie.research.bell-labs.com ([135.104.13.5]) by scummy; Wed Jul 11 10:13:33 EDT 2001
Received: (from duncan@localhost)
	by jessie.research.bell-labs.com (8.9.1/8.9.1) id KAA02731;
	Wed, 11 Jul 2001 10:13:07 -0400 (EDT)
Date: Wed, 11 Jul 2001 10:13:07 -0400
From: Duncan Temple Lang <duncan@research.bell-labs.com>
To: lcottret@yahoo.fr
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] .Call and Mandrake 8.0 (PR#1020)
Message-ID: <20010711101307.E24919@jessie.research.bell-labs.com>
Mail-Followup-To: lcottret@yahoo.fr, r-devel@stat.math.ethz.ch,
	R-bugs@biostat.ku.dk
References: <200107111334.PAA16384@pubhealth.ku.dk>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Mailer: Mutt 1.0us
In-Reply-To: <200107111334.PAA16384@pubhealth.ku.dk>; from lcottret@yahoo.fr on Wed, Jul 11, 2001 at 03:34:25PM +0200

Hi Ludovic.

 There are at least two possible explanations for this behaviour.

  1)  There is a bug in the recently changed code in R to find 
     routines in C and Fortran libraries.

  2)  The routine that you are .Call()'ing is doing something
  that has confused the R internals and makes the next R commands
  not work, and potentially this is not reproducible.

If this is not proprietary or confidential code, you can send the C
code and instructions as to how to call it from R (that is, provide
simple values for the bankpath, accn, indexpath, key, beg and end
arguments), then I can see if the computations are potentially
writing over other values in memory.

Also, you can try a invoking a very simple .Call() routine 
many times to see if that displays the same failure. For example,
put the following C code in a file named simpleCall.c

#include "Rinternals.h"

SEXP
simpleCall() 
{
  static int count = 0;
  SEXP ans;

  PROTECT(ans = allocVector(INTSXP, 1));
  INTEGER(ans)[0] = count++;

  UNPROTECT(1);
  return(ans);
}

Then, compile this with 
  R CMD SHLIB simpleCall.c

and call it from R in the following way

 > dyn.load("simpleCall.so")
 > for(i in 1:10) { print(.Call("simpleCall")) }

If this works, it won't determine whether it is 1) or 2) (or any other
possible reason), but if it doesn't work, we will have a lot more
information.

 Thanks,
   Duncan


lcottret@yahoo.fr wrote:
> Full_Name: Ludovic Cottret
> Version: R 1.3.0
> OS: Linux
> Submission from: (NULL) (157.136.20.138)
> 
> 
> I have a R function which call a C function by the instruction ".Call".
> The first time I call the R function in a R session, it perfectly runs. But the
> next 
> times, R returns this error message :
> 
> Error in .Call("", bankpath, accn, indexpath, key, beg, end) :
>         .Call function name not in load table
> 
> The function name has disappeared !!
> This function well runs on Mandrake 7.2 but not in Mandrake 8.0. Why ?!?
> 
> Thanks for your answers...
> PS : Excuse my poor english...
> 
> 
> 
> 
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

-- 
_______________________________________________________________

Duncan Temple Lang                duncan@research.bell-labs.com
Bell Labs, Lucent Technologies    office: (908)582-3217
700 Mountain Avenue, Room 2C-259  fax:    (908)582-3340
Murray Hill, NJ  07974-2070       
         http://cm.bell-labs.com/stat/duncan

==> 1020.audit <==
Fri Aug  3 11:33:04 2001	ripley	changed notes
Fri Aug  3 11:33:04 2001	ripley	foobar
Fri Aug  3 11:33:04 2001	ripley	moved from incoming to System-specific
Tue Aug  7 08:37:20 2001	ripley	changed notes
Tue Aug  7 08:37:20 2001	ripley	foobar
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1026 *
Subject: make check failure on SGI-IRIX6.5
From: laurent@cbs.dtu.dk
Date: Mon, 16 Jul 2001 15:06:17 +0200 (MET DST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1026 <==
From laurent@cbs.dtu.dk  Mon Jul 16 15:06:17 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id PAA13242
	for <R-bugs@biostat.ku.dk>; Mon, 16 Jul 2001 15:06:17 +0200 (MET DST)
Date: Mon, 16 Jul 2001 15:06:17 +0200 (MET DST)
From: laurent@cbs.dtu.dk
Message-Id: <200107161306.PAA13242@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: make check failure on SGI-IRIX6.5

Full_Name: Laurent Gautier
Version: 1.3.0-patched version
OS: SGI's IRIX 6.5
Submission from: (NULL) (130.225.67.199)


Hello,


During the 'make check' step of the installation procedure, I had the following
error messages


> make test > rapportMakeTest
/bin/sh: /usr/local/bin//perl: arg list too long

----------
I've seen that already in my former life in the software industry.
It seems the SGI sh shell is rather more limitated by the length
of arg lists than it's linux conterpart (I do not know about the other OSs).

----------
>gmake[3]: *** [modreg-Ex.Rout] Bus error (core dumped)
gmake[3]: *** Deleting file `modreg-Ex.Rout'
gmake[2]: *** [test-Examples] Error 2
gmake[1]: *** [test-Examples] Error 2
gmake: *** [test-all-basics] Error 1
----------
I cannot (or rather I do not dare) make any hypothesis about this one...



Cheers,






Laurent

==> 1026.audit <==
Fri Aug  3 11:30:25 2001	ripley	moved from incoming to System-specific
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1057 *
Subject: crt1.o skipped at configure time ?
From: laurent@cbs.dtu.dk
Date: Thu, 16 Aug 2001 08:52:34 +0200 (MET DST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1057 <==
From laurent@cbs.dtu.dk  Thu Aug 16 08:52:35 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id IAA12801
	for <R-bugs@biostat.ku.dk>; Thu, 16 Aug 2001 08:52:34 +0200 (MET DST)
Date: Thu, 16 Aug 2001 08:52:34 +0200 (MET DST)
From: laurent@cbs.dtu.dk
Message-Id: <200108160652.IAA12801@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: crt1.o skipped at configure time ?

Full_Name: Laurent Gautier
Version: 1.3.0-patched
OS: IRIX 6.5
Submission from: (NULL) (130.225.67.199)





During the configuration step, things do not go perfect:

The file config.log has :

configure:3754: gcc -o conftest -g -O2 -I/usr/freeware/include
-I/usr/local/include  -static conftest.c -L/usr/local/lib 1>&5
ld32: FATAL   9  : I/O error (/usr/lib32/mips3/nonshared/crt1.o): No such file
or directory

here is a list of what's in mips3
laurent@ibiology> ls /usr/lib32/mips3/
crt1.o             libdmnet.so        libfpe.so          libmalloc_cv.so
crtn.o             libdmnet.so.1      libfpe_ss.so       libmalloc_ss.so
dmedia             libdplace.so       libftn.so          libmangle.a
dsmcrt.o           libdprof.so        libftn90.so        libmp.a
fixade.o           libelfutil.a       libinstr.so        libmp.so
libMMmalloc.a      libelfutil_xtnd.a  libio_ss.so        libmpc.a
libMMmalloc.so     libexc.so          libkapio.a         libmpi_ss.so
libblas.so         libfastm.a         libkmem.a          libmx.a
libblas_mp.so      libfastm.so        libksync.so        libmx.so
libc.so            libfetchop.so      libksync.so.1      libsgidl.a
libc.so.1          libffio.a          libm.a             libss.so
libdlook.so        libffio.so         libm.so            libssrt.so
libdmedia.so       libfortran.so      libm43.a           mcrt1.o
libdmedia.so.1     libfpe.a           libm43.so



...if it's a real problem (and not the installation here being _really_ exotic,
 it should be fixed in a wink)


Best regards,



Laurent

==> 1057.audit <==
Tue Aug 28 10:12:13 2001	ripley	moved from incoming to System-specific
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1084 *
Subject: Install problems R 1.3.1 on HP-UX
From: Peter Kleiweg <kleiweg@let.rug.nl>
Date: Sun, 2 Sep 2001 15:07:41 +0200 (CEST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1084 <==
From postmaster@franz.stat.wisc.edu  Sun Sep  2 15:07:52 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id PAA14247
	for <r-bugs@biostat.ku.dk>; Sun, 2 Sep 2001 15:07:51 +0200 (MET DST)
Received: from kleigh.nl (really [213.84.55.218]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m15dWyV-000JIdC@franz.stat.wisc.edu> (Debian Smail3.2.0.111)
	for <r-bugs@r-project.org>; Sun, 2 Sep 2001 08:07:43 -0500 (CDT) 
Received: from localhost (peter@localhost)
	by kleigh.nl (8.8.7/8.8.7) with ESMTP id PAA14144
	for <r-bugs@r-project.org>; Sun, 2 Sep 2001 15:07:41 +0200
X-Authentication-Warning: kleigh.nl: peter owned process doing -bs
Date: Sun, 2 Sep 2001 15:07:41 +0200 (CEST)
From: Peter Kleiweg <kleiweg@let.rug.nl>
X-X-Sender:  <kleiweg@kleigh.nl>
To: <r-bugs@r-project.org>
Subject: Install problems R 1.3.1 on HP-UX
Message-ID: <Pine.LNX.4.33.0109021450140.453-100000@kleigh.nl>
Organization: Alfa-Informatica, Rijksuniversiteit Groningen
X-Accept-Language: nl,en,ia,af,de,da,no,sv,fr,it
X-Alert: http://www.opensource.org/halloween/
X-Face: "K~X:~!ydgSdjNy;]_+BCb\OM^pqyg_q*Le84$l46M\-mL=.^,L4B}bDK>`o#r4_>O*
X-Mailer: Pine 4.33, Linux 2.0.36, i586
X-No-Archive: yes
X-Reason: http://www.interlingua.com/
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
Content-Transfer-Encoding: 8BIT


Hi,

I installed R 1.3.1 on HP-UX. This caused me quite some
problems. These problems did not occur with the previous version
I installed, which was R version 1.2.3.

First, the result of configure:

    R is now configured for hppa-hp-hpux10.20

      Source directory:          .
      Installation directory:    /opt_local/opt/R
      C compiler:                cc  -D_HPUX_SOURCE +DA1.1 +DS1.1 -Wp,-H16000 -I/opt_local/opt/readline/include -I/opt_local/opt/tk/include -I/opt_local/opt/tcl/include -I/opt_local/opt/jpeg6/include -I/opt_local/opt/png/include -I/opt_local/opt/ncurses/include -I/opt_local/opt/zlib/include -I/users1/kleiweg/R-1.3.1-source -L/opt_local/opt/readline/lib -L/opt_local/opt/tk/lib -L/opt_local/opt/tcl/lib -L/opt_local/opt/jpeg6/lib -L/opt_local/opt/png/lib -L/opt_local/opt/ncurses/lib -L/opt_local/opt/zlib/lib -L/users1/kleiweg/R-1.3.1-source -Aa
      C++ compiler:              c++  -g -O2
      FORTRAN compiler:          fort77  +DA1.1 +DS1.1

      X11 support:               yes
      Gnome support:             no
      Tcl/Tk support:            yes

      R profiling support:       yes
      R as a shared library:     no

The first make halts on src/main/Rdynload.c, the compiler can't
find the variable CFunTab. I solved this by adding the following
lines after #include "R_ext/Rdynpriv.h" :

    #include "../unix/FFDecl.h"
    static CFunTabEntry CFunTab[] =
    {
    #include "../unix/FFTab.h"
      {NULL, NULL}
    };

Now, make runs a bit further, until it stops with the following
errors:

	    cc -Wl,-E  -o R.bin  CConverters.o  Rdynload.o RNG.o  apply.o arithmetic.o array.o attrib.o  bind.o builtin.o  character.o coerce.o colors.o complex.o connections.o context.o  cov.o cum.o  dcf.o datetime.o debug.o devPS.o devPicTeX.o deparse.o deriv.o  devices.o dotcode.o dstruct.o duplicate.o  envir.o errors.o eval.o  format.o fourier.o  gram.o gram-ex.o graphics.o  internet.o iosupport.o  lapack.o list.o logic.o  main.o match.o memory.o model.o  names.o  objects.o optim.o optimize.o options.o  par.o paste.o platform.o  plot.o plot3d.o plotmath.o  print.o printarray.o printvector.o printutils.o  random.o regex.o relop.o  saveload.o scan.o seq.o size.o sort.o source.o split.o  subassign.o subscript.o subset.o summary.o  unique.o util.o  version.o vfonts.o xxxpr.o ../unix/libunix.a ../appl/libappl.a ../nmath/libnmath.a   -lcl -lisamstub -ldld -L/opt_local/opt/readline/lib -L/opt_local/opt/tk/lib -L/opt_local/opt/tcl/lib -L/opt_local/opt/jpeg6/lib -L/opt_local/opt/png/lib -!
L/opt_local/opt/ncurses/lib -L/opt_local/opt/zlib/lib -L/users1/kleiweg/R-1.3.1-source  -lz -lreadline -lncurses -lm
    /usr/ccs/bin/ld: Duplicate symbol "dlerror" in files ../unix/libunix.a(gnome.o) and ../unix/libunix.a(X11.o)
    /usr/ccs/bin/ld: Duplicate symbol "dlopen" in files ../unix/libunix.a(gnome.o) and ../unix/libunix.a(X11.o)
    /usr/ccs/bin/ld: Duplicate symbol "dlclose" in files ../unix/libunix.a(gnome.o) and ../unix/libunix.a(X11.o)
    /usr/ccs/bin/ld: Duplicate symbol "dlsym" in files ../unix/libunix.a(gnome.o) and ../unix/libunix.a(X11.o)
    /usr/ccs/bin/ld: Unsatisfied symbols:
       moduleCdynload (code)
    /usr/ccs/bin/ld: Found 4 duplicate symbol(s)
    *** Error exit code 1

Why is there an object gnome.o when I don't have Gnome support?

I had to make some more changes to several files before all
compiled OK.

In src/main/Rdynload.c I changed this:

    #ifdef HAVE_DLFCN_H

into this:

    #ifndef HAVE_DLFCN_H

In src/unix/hpdlfcn.c I removed the following functions:
    dlerror
    dlopen
    dlclose
    dlsym

Now make runs without errors. After make install I had to do
chmod +x R.bin.

R seems the work fine now.



Version:
 platform = hppa-hp-hpux10.20
 arch = hppa
 os = hpux10.20
 system = hppa, hpux10.20
 status =
 major = 1
 minor = 3.1
 year = 2001
 month = 08
 day = 31
 language = R

Search Path:
 .GlobalEnv, package:ctest, Autoloads, package:base

-- 
Peter Kleiweg
http://www.let.rug.nl/~kleiweg/


==> 1084.audit <==
Wed Sep  5 18:51:46 2001	thomas	moved from incoming to System-specific-fixed
Wed Sep  5 18:52:05 2001	thomas	moved from System-specific-fixed to System-specific
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1097 *
Subject: R 1.3.1 fails 'make check' on arm in the Bessel example
From: Dirk Eddelbuettel <edd@debian.org>
Date: Thu, 20 Sep 2001 23:54:19 -0500
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1097 <==
From postmaster@franz.stat.wisc.edu  Fri Sep 21 06:54:31 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id GAA13162
	for <r-bugs@biostat.ku.dk>; Fri, 21 Sep 2001 06:54:30 +0200 (MET DST)
Received: from sonny.eddelbuettel.com (really [64.195.36.229]) by franz.stat.wisc.edu
	via smail with esmtp (ident mail using rfc1413)
	id <m15kIKZ-000JJ6C@franz.stat.wisc.edu> (Debian Smail3.2.0.111)
	for <r-bugs@r-project.org>; Thu, 20 Sep 2001 23:54:27 -0500 (CDT) 
Received: from edd by sonny.eddelbuettel.com with local (Exim 3.32 #1 (Debian))
	id 15kIKS-0005EK-00
	for <r-bugs@r-project.org>; Thu, 20 Sep 2001 23:54:20 -0500
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Message-ID: <15274.51195.688109.743960@sonny.eddelbuettel.com>
Date: Thu, 20 Sep 2001 23:54:19 -0500
To: r-bugs@r-project.org
Subject: R 1.3.1 fails 'make check' on arm in the Bessel example
X-Mailer: VM 6.92 under 21.4 (patch 1) "Copyleft" XEmacs Lucid
From: Dirk Eddelbuettel <edd@debian.org>


Debian tries to build its packages on a variety of platforms.  The arm
platform compiled 0.90.1 (the last Debian release before the Debian package
required an Atlas library, something we no longer require) failed in 'make
check'. The log snippet follows; I traced this to the example(Bessel) code.
 
> matplot(nu, t(outer(xx,nu, besselI)), type = 'l', ylim = c(-50,200),
+         main = expression(paste("Bessel ",I[nu](x)," for fixed ", x,
+                                 ",  as ",f(nu))),
+         xlab = expression(nu))
Error in title(main = main, sub = sub, xlab = xlab, ylab = ylab, ...) :
        Metric information not yet available for this device
        In addition: Warning messages:
        1: Nonfinite axis limits [GScale(nan,nan,1, .); log=0]
        2: relative range of values = 9.0072e+15 * EPS, is small (axis 1).
        3: Nonfinite axis limits [GScale(-inf,inf,2, .); log=0]
        4: relative range of values = 9.0072e+15 * EPS, is small (axis 2).
        Execution halted

Casual inspection suggests that GScale(nan,nan,1, .) is probably
incorrect. Now, src/nmath/bessel* provide the Bessel functions but does this
reflect a potential libc bug in IEEE handling?

I have also asked on the debian-arm mailing list, but no result so far. I
have some access to an arm box and could compile small test cases if that
helped. 

Dirk 
 
--please do not edit the information below--
 
Version:
 platform = i386-pc-linux-gnu
 arch = i386
 os = linux-gnu
 system = i386, linux-gnu
 status =
 major = 1
 minor = 3.1
 year = 2001
 month = 08
 day = 31
 language = R
 
Search Path:
 .GlobalEnv, package:ctest, Autoloads, package:base


-- 
Better to have an approximate answer to the right question 
than a precise answer to the wrong question. -- John Tukey

==> 1097.audit <==
Fri Sep 21 07:46:37 2001	ripley	moved from incoming to System-specific
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1106 *
Subject: What is an error bu21?
From: Patrick Lindsey <patrick.lindsey@luc.ac.be>
Date: Mon, 1 Oct 2001 15:43:36 +0200 (MET DST)
--Looks like an SGI make bug
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1106 <==
From patrick.lindsey@luc.ac.be  Mon Oct  1 15:43:41 2001
Received: from luc.ac.be (alpha.luc.ac.be [193.190.2.30])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id PAA16171
	for <R-bugs@biostat.ku.dk>; Mon, 1 Oct 2001 15:43:40 +0200 (MET DST)
Received: (from lucg5606@localhost)
	by luc.ac.be (8.9.3/8.9.3) id PAA28070
	for R-bugs@biostat.ku.dk; Mon, 1 Oct 2001 15:43:36 +0200 (MET DST)
From: Patrick Lindsey <patrick.lindsey@luc.ac.be>
Message-Id: <200110011343.PAA28070@luc.ac.be>
Subject: What is an error bu21?
To: R-bugs@biostat.ku.dk (R bugs)
Date: Mon, 1 Oct 2001 15:43:36 +0200 (MET DST)
X-Mailer: ELM [version 2.5 PL1]
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

Hi everyone,
  I have just tried to compile R 1.3.1 on the following platform:

R is now configured for mips-sgi-irix6.5

  Source directory:          .
  Installation directory:    /usr/local
  C compiler:                gcc  -g -O2
  C++ compiler:              g++  -g -O2
  FORTRAN compiler:          g77  -g -O2

  X11 support:               yes
  Gnome support:             no
  Tcl/Tk support:            no

  R profiling support:       yes
  R as a shared library:     no

and came up with the following error:

making Lapack.d from Lapack.c
        gcc -I. -I../../../src/include -I../../../src/include -I/usr/local/include -DHAVE_CONFIG_H  -fPIC  -g -O2 -c Lapack.c -o Lapack.lo
        g77  -fPIC  -g -O2 -c double.f -o double.lo
        g77  -fPIC  -g -O2 -c cmplx.f -o cmplx.lo
don't know how to make # (bu42).
*** Error code 1 (bu21)

What is "bu42" and or error code "bu21"? And how do I get R to compile?
Thanks,
Patrick.


==> 1106.reply.1 <==
From p.dalgaard@biostat.ku.dk  Mon Oct  1 16:09:39 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id QAA16487;
	Mon, 1 Oct 2001 16:09:38 +0200 (MET DST)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.11.2/8.11.2) id f91E9Du15038;
	Mon, 1 Oct 2001 16:09:13 +0200
X-Authentication-Warning: blueberry.kubism.ku.dk: pd set sender to p.dalgaard@biostat.ku.dk using -f
Sender: pd@pubhealth.ku.dk
To: patrick.lindsey@luc.ac.be
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] What is an error bu21? (PR#1106)
References: <200110011343.PAA16182@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 01 Oct 2001 16:09:12 +0200
In-Reply-To: <200110011343.PAA16182@pubhealth.ku.dk>
Message-ID: <x2k7yfxxiv.fsf@blueberry.kubism.ku.dk>
Lines: 18
User-Agent: Gnus/5.0808 (Gnus v5.8.8) Emacs/20.7
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

patrick.lindsey@luc.ac.be writes:

> making Lapack.d from Lapack.c
>         gcc -I. -I../../../src/include -I../../../src/include -I/usr/local/include -DHAVE_CONFIG_H  -fPIC  -g -O2 -c Lapack.c -o Lapack.lo
>         g77  -fPIC  -g -O2 -c double.f -o double.lo
>         g77  -fPIC  -g -O2 -c cmplx.f -o cmplx.lo
> don't know how to make # (bu42).
> *** Error code 1 (bu21)
> 
> What is "bu42" and or error code "bu21"? And how do I get R to compile?

Highly system-dependent codes, I'd guess. Are you using GNU make?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 1106.audit <==
Sun Oct  7 12:35:48 2001	ripley	changed notes
Sun Oct  7 12:35:48 2001	ripley	foobar
Sun Oct  7 12:35:48 2001	ripley	moved from incoming to System-specific
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Directory:  TooMuchAtOnce

* PR# 1110 *
Subject: Several R vs S-Plus issues
From: David Brahm  <a215020@agate.fmr.com>
Date: Wed, 3 Oct 2001 11:35:58 -0400 (EDT)
--1. is perhaps a bug -- the best handling of string NAs is under discussion
--
--2 & 4 are just S-PLUS incompatibilities
--
--3. May be a bug -- worth checking.
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1110 <==
From postmaster@franz.stat.wisc.edu  Wed Oct  3 17:39:19 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id RAA09389
	for <r-bugs@biostat.ku.dk>; Wed, 3 Oct 2001 17:39:18 +0200 (MET DST)
Received: from gw35i.fmr.com (really [192.223.207.77]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m15oo77-000JLBC@franz.stat.wisc.edu> (Debian Smail3.2.0.111)
	for <r-bugs@r-project.org>; Wed, 3 Oct 2001 10:39:13 -0500 (CDT) 
Received: (from smtp@localhost)
	by gw35i.fmr.com (8.8.7/8.8.7) id LAA13927
	for <r-bugs@r-project.org>; Wed, 3 Oct 2001 11:39:12 -0400 (EDT)
Received: from unknown(172.25.106.96) by gw35i.fmr.com via smap (V2.0)
	id xma011813; Wed, 3 Oct 01 11:36:02 -0400
Received: from arbres1a.fmr.com ([155.1.103.77]) by msgmro102nts.fmr.com with SMTP (Microsoft Exchange Internet Mail Service Version 5.5.2654.89)
	id T5ZMCB9V; Wed, 3 Oct 2001 11:36:01 -0400
Received: (from a215020@localhost)
	by arbres1a.FMR.Com (8.11.1/8.11.1) id f93FZwk16862;
	Wed, 3 Oct 2001 11:35:58 -0400 (EDT)
Date: Wed, 3 Oct 2001 11:35:58 -0400 (EDT)
From: David Brahm  <a215020@agate.fmr.com>
Message-Id: <200110031535.f93FZwk16862@arbres1a.FMR.Com>
Reply-to: brahm@alum.mit.edu
To: r-help@stat.math.ethz.ch
Subject: Several R vs S-Plus issues
Cc: Kurt.Hornik@ci.tuwien.ac.at, r-bugs@r-project.org

Hi, all,

   I've been converting code from S-Plus ("S" for short) to R for a few weeks.
Here are some differences I've found, aside from the big well-known ones
(scoping, models, data storage) and the contents of Kurt Hornik's FAQ section
3.3.3.  Let me start with the ones that seem like serious bugs or deficiencies:

1) LETTERS[c(NA,2)] in S is c("","B"), but in R is c("NA","B").

  This is TERRIBLE!  I have a ton of S-Plus code that looks like:
     y$ticker <- z$ticker[match(y$cusip, z$cusip)]
  and I count on a ticker of "" to indicate failed lookups.  Not only will
  I need to change all that code, but I'll never be able to trade Nabisco
  (ticker NA) again.  PLEASE re-consider this choice, or at least make it
  an option: option(na.char="").


2) system() has no "input" argument in R.

   Here's a (Unix) example:
   S> system("cd mydir; latex myfile", input="x")
     which goes to the directory where myfile lives and LaTeX's it, passing
     an "x" through STDIN in case LaTeX encounters an error.  My R fix is:
   R> system("cd mydir; echo x | latex myfile")
   Note that it's not as simple as  cmd <- paste("echo",input,"|",cmd).


3) R> myfun <- function(x, ...) {x[...] <- 0;  x}
   R> myfun(3)
   Error in myfun(3) : SubAssignArgs: invalid number of arguments

   It failed because no ... was given.  Fortunately, this is easily patched:
   R> myfun <- function(x, ...) {if (missing(...)) x[]<-0 else x[...]<-0; x}


4) Missing functions:
   a) identical() [scheduled for 1.4.0]
   b) slice.index()
   c) rowSums(), colSums(), colVars(), etc.
   d) unpaste() - R has strsplit, whose result is like the transpose of unpaste


5) rowsum() gives character dimnames in S, factor numbers in R.
   I've reported this early, and Brian D. Ripley promised a fix in 1.4.0.


OK, the rest are just differences, not complaints.  In fact, sometimes they are
very good differences.

1) Same argument given twice produces an error in R; S takes the last one.
   S> mean(x=4, x=5)    # Returns 5
   R> mean(x=4, x=5)    # Error

2) row.names(y) <- LETTERS[1:3] coerces list to dataframe in S, is error in R.

3) Default "what" for scan in S is "", in R is double(0).

4) Default "quote" for scan is "'\"" in R, causes different behavior than S.

5) which(<numeric>) converts to logical in S, is an error in R.

6) The NULL returned by if(F){...} is invisible in R, visible in S.

7) The NULL returned by return() is visible in R, invisible in S.

8) Args to "var" differ, and R has "cov".  S na.method="a" is like R use="p".

9) var (or cov) drops dimensions in S, not R.

10) cut allows labels=F in R, not in S (also left.include=T becomes right=F).

11) substring(s,"x") <- "X" only works in S, but R has s <- gsub("x","X",s).

12) S function casefold() replaced in R by toupper() or tolower().

13) Functions missing from S: sub(), gsub(), chartr(), toupper(), tolower()

14) Log scale indicated in S with par(xaxt)=="l", in R with par("xlog")==T.

			-- David Brahm (a215020@agate.fmr.com)

==> 1110.audit <==
Thu Oct 11 18:01:28 2001	thomas	changed notes
Thu Oct 11 18:01:28 2001	thomas	foobar
Thu Oct 11 18:01:28 2001	thomas	moved from incoming to TooMuchAtOnce
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Directory:  Windows

none

Directory:  incoming

* PR# 1127 *
Subject: unary "-" doesn't convert logicals
From: john_heumann@agilent.com
Date: Fri, 12 Oct 2001 00:12:50 +0200 (MET DST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1127 <==
From john_heumann@agilent.com  Fri Oct 12 00:12:51 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id AAA14823
	for <R-bugs@biostat.ku.dk>; Fri, 12 Oct 2001 00:12:50 +0200 (MET DST)
Date: Fri, 12 Oct 2001 00:12:50 +0200 (MET DST)
From: john_heumann@agilent.com
Message-Id: <200110112212.AAA14823@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: unary "-" doesn't convert logicals

Full_Name: John M. Heumann
Version: 1.3.0
OS: Windows NT4/SP5
Submission from: (NULL) (192.25.140.108)


If unary "-" is applied to a logical vector, the resulting value
is computed correctly (i.e. coerced to a numeric), but the type
(incorrectly) remains logical: 

> x <- 1:10
> p1 <- (x > 5)
> p2 <- (-p1)
> is.logical(p2)
[1] TRUE
> is.numeric(p2)
[1] FALSE
> as.numeric(p1)
 [1] 0 0 0 0 0 1 1 1 1 1
> as.numeric(p2)
 [1]  0  0  0  0  0 -1 -1 -1 -1 -1

Since "==" always does binary comparison, this can lead to
some bizarre behavior:

> p1
 [1] FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE
> p2
 [1] FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE
> (p1 == p2)
 [1]  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE
((!p1) == (!p2))
 [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE



~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1129 *
Subject: Unable to use names() to set names on a 'dist' object
From: Peter Kleiweg <kleiweg@let.rug.nl>
Date: Fri, 12 Oct 2001 23:35:59 +0200 (CEST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1129 <==
From postmaster@franz.stat.wisc.edu  Fri Oct 12 23:36:14 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id XAA26069
	for <r-bugs@biostat.ku.dk>; Fri, 12 Oct 2001 23:36:13 +0200 (MET DST)
Received: from kleigh.nl (really [213.84.55.218]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m15s9yR-000JACC@franz.stat.wisc.edu> (Debian Smail3.2.0.111)
	for <r-bugs@r-project.org>; Fri, 12 Oct 2001 16:36:07 -0500 (CDT) 
Received: from kleigh.nl (kleigh [127.0.0.1])
	by kleigh.nl (8.12.0/8.12.0) with ESMTP id f9CLa0jo010094
	for <r-bugs@r-project.org>; Fri, 12 Oct 2001 23:36:00 +0200
Received: from localhost (peter@localhost)
	by kleigh.nl (8.12.0/8.12.0/Submit) with ESMTP id f9CLa0DQ010091
	for <r-bugs@r-project.org>; Fri, 12 Oct 2001 23:36:00 +0200
X-Authentication-Warning: kleigh.nl: peter owned process doing -bs
Date: Fri, 12 Oct 2001 23:35:59 +0200 (CEST)
From: Peter Kleiweg <kleiweg@let.rug.nl>
X-X-Sender:  <kleiweg@kleigh.nl>
To: <r-bugs@r-project.org>
Subject: Unable to use names() to set names on a 'dist' object
Message-ID: <Pine.LNX.4.33.0110122332130.560-100000@kleigh.nl>
Organization: Alfa-Informatica, Rijksuniversiteit Groningen
X-Accept-Language: nl,en,ia,af,de,da,no,sv,fr,it
X-Alert: http://www.opensource.org/halloween/
X-Face: "K~X:~!ydgSdjNy;]_+BCb\OM^pqyg_q*Le84$l46M\-mL=.^,L4B}bDK>`o#r4_>O*
X-Mailer: Pine 4.33, Linux 2.0.36, i586
X-Reason: http://www.interlingua.com/
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII


I am unable to set the names on a 'dist' object using the
function names()


> require(mva)
Loading required package: mva
[1] TRUE
> a <- matrix(nrow=3, ncol=3)
> a[row(a) > col(a)] <- 1:3
> b <- as.dist(a)
> names(b) <- c("X", "Y", "Z")
Error in "names<-.dist"(*tmp*, value = c("X", "Y", "Z")) :
        unused argument(s) (value ...)
> attr(b, "Labels") <- c("X", "Y", "Z")
> names(b)
[1] "X" "Y" "Z"
> b
  X Y
Y 1
Z 2 3


--please do not edit the information below--

Version:
 platform = i586-pc-linux-gnu
 arch = i586
 os = linux-gnu
 system = i586, linux-gnu
 status =
 major = 1
 minor = 3.1
 year = 2001
 month = 08
 day = 31
 language = R

Search Path:
 .GlobalEnv, package:mva, package:ctest, Autoloads, package:base


==> 1129.reply.1 <==
From p.dalgaard@biostat.ku.dk  Fri Oct 12 23:56:24 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id XAA26185;
	Fri, 12 Oct 2001 23:56:23 +0200 (MET DST)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.11.2/8.11.2) id f9CLt0V22527;
	Fri, 12 Oct 2001 23:55:00 +0200
X-Authentication-Warning: blueberry.kubism.ku.dk: pd set sender to p.dalgaard@biostat.ku.dk using -f
Sender: pd@pubhealth.ku.dk
To: kleiweg@let.rug.nl
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] Unable to use names() to set names on a 'dist' object (PR#1129)
References: <200110122136.XAA26079@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 12 Oct 2001 23:55:00 +0200
In-Reply-To: <200110122136.XAA26079@pubhealth.ku.dk>
Message-ID: <x2snco7ccr.fsf@blueberry.kubism.ku.dk>
Lines: 27
User-Agent: Gnus/5.0808 (Gnus v5.8.8) Emacs/20.7
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

kleiweg@let.rug.nl writes:

> I am unable to set the names on a 'dist' object using the
> function names()

Yup, that's a bug.

I wonder how long it has been around. The function definition is

> get("names<-.dist")
function (d, n) 
{
    if (length(n) != attr(d, "Size")) 
        stop("invalid names for dist object")
    attr(d, "Labels") <- n
    d
}

but the value is passed as a named argument called "value", and it has
been like that for ages.  The fix is obvious: replace "n" with "value"
(3 times).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1131 *
Subject: Crash of RGui under Windows 2000
From: dfiaschi@ec.unipi.it
Date: Mon, 15 Oct 2001 09:49:38 +0200 (MET DST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1131 <==
From dfiaschi@ec.unipi.it  Mon Oct 15 09:49:39 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id JAA03586
	for <R-bugs@biostat.ku.dk>; Mon, 15 Oct 2001 09:49:38 +0200 (MET DST)
Date: Mon, 15 Oct 2001 09:49:38 +0200 (MET DST)
From: dfiaschi@ec.unipi.it
Message-Id: <200110150749.JAA03586@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: Crash of RGui under Windows 2000

Full_Name: Davide Fiaschi
Version: R 1.3.1 and 1.2.3
OS: Windows 2000
Submission from: (NULL) (131.114.67.164)


When I try to start RGUI, it generates an error in application and R chashs.
(NOTE: R worked very well with trial version of Windows 2000!)

Here is the (not very informative form me) Dr Watson's report:

Exception dell'applicazione:
        App:  (pid=1140)
        Ora: 15/10/2001 @ 09:39:47.333
        Numero exception: c0000005 (access violation)

*----> System Information <----*
        Nome computer: FIASCHI
        Nome utente: Administrator
        Numero processori: 1
        Tipo processore: x86 Family 6 Model 1 Stepping 2
        Versione di Windows 2000: 5.0
        Build corrente: 2195
        Service Pack: 2
        Tipo corrente: Uniprocessor Free
        Organizzazione registrata: DSE
        Proprietario autorizzato: Davide Fiaschi

*----> Elenco Task <----*
   0 Idle.exe
   8 System.exe
 136 SMSS.exe
 164 CSRSS.exe
 184 WINLOGON.exe
 212 SERVICES.exe
 224 LSASS.exe
 388 svchost.exe
 424 SPOOLSV.exe
 456 svchost.exe
 480 mgabg.exe
 512 regsvc.exe
 552 Smc.exe
 636 ups.exe
 648 WinMgmt.exe
 796 explorer.exe
 788 pdesk.exe
 960 internat.exe
 580 netscp6.exe
 436 drwtsn32.exe
1140 Rgui.exe
 772 DRWTSN32.exe
   0 _Total.exe

(00400000 - 00406000) 
(78460000 - 784E0000) 
(00410000 - 005A8000) 
(77DB0000 - 77E0B000) 
(77E80000 - 77F3C000) 
(77D40000 - 77DB0000) 
(71780000 - 7180A000) 
(77F40000 - 77F7C000) 
(77E10000 - 77E74000) 
(76B10000 - 76B4D000) 
(70BD0000 - 70C34000) 
(78000000 - 78046000) 
(77590000 - 777D6000) 
(77820000 - 77827000) 
(75980000 - 75986000) 
(77A50000 - 77B46000) 
(779B0000 - 77A4B000) 
(6E380000 - 6E386000) 
(75E30000 - 75E4A000) 
(10F70000 - 10F83000) 
(72C90000 - 72D15000) 
(77850000 - 7788D000) 
(770A0000 - 770C3000) 

Scarico dello stato per l'id del thread 0x268

eax=00003a43 ebx=0022fa20 ecx=00000000 edx=7efefeff esi=00000000 edi=00552e02
eip=78001d22 esp=0022f740 ebp=0022fe90 iopl=0         nv up ei pl zr na po nc
cs=001b  ss=0023  ds=0023  es=0023  fs=0038  gs=0000             efl=00000246


funzione: strcpy
        78001d05 7416             jz      _threadhandle+0xf4 (7800a71d)
        78001d07 8a11             mov     dl,[ecx]                    
ds:00000000=??
        78001d09 41               inc     ecx
        78001d0a 84d2             test    dl,dl
        78001d0c 0f84ce0d0000     je      strcat+0x9c (78002ae0)
        78001d12 8817             mov     [edi],dl                    
ds:00552e02=00
        78001d14 47               inc     edi
        78001d15 f7c103000000     test    ecx,0x3
        78001d1b 75ea             jnz     assert+0xe8 (7800d807)
        78001d1d bafffefe7e       mov     edx,0x7efefeff
FAULT ->78001d22 8b01             mov     eax,[ecx]             
ds:00000000=????????
        78001d24 03d0             add     edx,eax
        78001d26 83f0ff           xor     eax,0xff
        78001d29 33c2             xor     eax,edx
        78001d2b 8b11             mov     edx,[ecx]             
ds:00000000=????????
        78001d2d 83c104           add     ecx,0x4
        78001d30 a900010181       test    eax,0x81010100
        78001d35 0f856b0d0000     jne     strcat+0x62 (78002aa6)
        78001d3b 8917             mov     [edi],edx             
ds:00552e02=00000000
        78001d3d 83c704           add     edi,0x4
        78001d40 ebdb             jmp     _unDNameEx+0x3738 (7800731d)

*----> Back Trace dello stack <----*

FramePtr ReturnAd Param#1  Param#2  Param#3  Param#4  Function Name
0022FE90 004012F6 00000000 00AC38A0 77E8DB7E 00670052 !strcpy 
0022FEB0 00401237 00000001 00AC38A0 0022FEE0 00401223 !<nosymbols> 
0022FEE0 004013CD 00400000 00000000 00233123 00000001 !<nosymbols> 
0022FF60 004011C1 00000001 00AC38A0 00AC29D8 004011A6 !<nosymbols> 
0022FFA0 00401207 00000002 00000000 8043107B 77E97D05 !<nosymbols> 
0022FFC0 77E97D08 00670052 00000000 7FFDF000 C0000005 !<nosymbols> 
0022FFF0 00000000 004011F0 00000000 000000C8 00000100 kernel32!CreateProcessW 

*----> Scarico Raw Stack <----*
0022f740  52 00 67 00 01 0b 43 00 - 00 2e 55 00 00 00 00 00  R.g...C...U.....
0022f750  2d 03 43 00 c1 0a 43 00 - 23 03 43 00 a0 38 ac 00  -.C...C.#.C..8..
0022f760  90 fe 22 00 51 0a 43 00 - 23 31 23 00 00 00 00 00  ..".Q.C.#1#.....
0022f770  52 00 67 00 00 00 00 00 - 00 00 00 00 00 00 00 00  R.g.............
0022f780  00 00 00 00 00 00 00 00 - 00 00 00 00 00 00 00 00  ................
0022f790  00 00 00 00 00 00 00 00 - 00 00 00 00 00 00 00 00  ................
0022f7a0  00 00 00 00 00 00 00 00 - 00 00 00 00 00 00 00 00  ................
0022f7b0  00 00 00 00 00 00 00 00 - 00 00 00 00 00 00 00 00  ................
0022f7c0  00 00 00 00 00 00 00 00 - 00 00 00 00 00 00 00 00  ................
0022f7d0  00 00 00 00 00 00 00 00 - 00 00 00 00 00 00 00 00  ................
0022f7e0  00 00 00 00 00 00 00 00 - 00 00 00 00 00 00 00 00  ................
0022f7f0  00 00 00 00 00 00 00 00 - 00 00 00 00 00 00 00 00  ................
0022f800  00 00 00 00 00 00 00 00 - 00 00 00 00 00 00 00 00  ................
0022f810  00 00 00 00 00 00 00 00 - 00 00 00 00 00 00 00 00  ................
0022f820  88 51 23 00 00 00 23 00 - 00 01 23 00 5c f8 22 00  .Q#...#...#.\.".
0022f830  00 00 00 00 33 29 46 78 - 00 00 23 00 98 30 23 00  ....3)Fx..#..0#.
0022f840  00 00 00 00 38 f8 22 00 - 88 06 23 00 ec f8 22 00  ....8."...#...".
0022f850  a7 9d 49 78 50 29 46 78 - ff ff ff ff fc f8 22 00  ..IxP)Fx......".
0022f860  de b6 4a 78 d8 07 23 00 - a0 30 23 00 00 10 41 00  ..Jx..#..0#...A.
0022f870  88 27 23 00 00 00 00 00 - a8 f1 4a 78 ac f8 22 00  .'#.......Jx..".

Scarico dello stato per l'id del thread 0x17c

eax=77d50c62 ebx=00241808 ecx=00241694 edx=00000000 esi=002416d8 edi=00000100
eip=78462a84 esp=111afe28 ebp=111aff74 iopl=0         nv up ei pl nz na po nc
cs=001b  ss=0023  ds=0023  es=0023  fs=0038  gs=0000             efl=00000206


funzione: ZwReplyWaitReceivePortEx
        78462a79 b8ac000000       mov     eax,0xac
        78462a7e 8d542404         lea     edx,[esp+0x4]         
ss:11c4d3fb=????????
        78462a82 cd2e             int     2e
        78462a84 c21400           ret     0x14

*----> Back Trace dello stack <----*

FramePtr ReturnAd Param#1  Param#2  Param#3  Param#4  Function Name
111AFF74 77D50781 77D50D7F 002416D8 00000000 402411D8
ntdll!ZwReplyWaitReceivePortEx 
111AFFA8 77D50C7A 00240548 111AFFEC 77E8758A 00241808 rpcrt4!RpcBindingSetOption

111AFFB4 77E8758A 00241808 00000000 402411D8 00241808 rpcrt4!RpcBindingSetOption

111AFFEC 00000000 00000000 00000000 00000000 00000000 kernel32!SetFilePointer 



==> 1131.followup.1 <==
From ripley@stats.ox.ac.uk  Mon Oct 15 19:55:52 2001
Received: from toucan.stats.ox.ac.uk (toucan.stats.ox.ac.uk [163.1.20.20])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id TAA13270
	for <R-bugs@biostat.ku.dk>; Mon, 15 Oct 2001 19:55:52 +0200 (MET DST)
Received: from localhost (ripley@localhost)
	by toucan.stats.ox.ac.uk (8.9.0/8.9.0) with ESMTP id SAA08075;
	Mon, 15 Oct 2001 18:55:46 +0100 (BST)
X-Authentication-Warning: toucan.stats: ripley owned process doing -bs
Date: Mon, 15 Oct 2001 18:55:45 +0100 (BST)
From: Prof Brian Ripley <ripley@stats.ox.ac.uk>
X-X-Sender:  <ripley@toucan.stats>
To: <dfiaschi@ec.unipi.it>
cc: <R-bugs@biostat.ku.dk>
Subject: Re: [Rd] Crash of RGui under Windows 2000 (PR#1131)
In-Reply-To: <200110150749.JAA03596@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.31.0110151854460.7984-100000@toucan.stats>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

Read the rw-FAQ, especially the section about versions of MSVCRT.dll

On Mon, 15 Oct 2001 dfiaschi@ec.unipi.it wrote:

> Full_Name: Davide Fiaschi
> Version: R 1.3.1 and 1.2.3
> OS: Windows 2000
> Submission from: (NULL) (131.114.67.164)
>
>
> When I try to start RGUI, it generates an error in application and R chashs.
> (NOTE: R worked very well with trial version of Windows 2000!)
>
> Here is the (not very informative form me) Dr Watson's report:
>
> Exception dell'applicazione:
>         App:  (pid=1140)
>         Ora: 15/10/2001 @ 09:39:47.333
>         Numero exception: c0000005 (access violation)
>
> *----> System Information <----*
>         Nome computer: FIASCHI
>         Nome utente: Administrator
>         Numero processori: 1
>         Tipo processore: x86 Family 6 Model 1 Stepping 2
>         Versione di Windows 2000: 5.0
>         Build corrente: 2195
>         Service Pack: 2
>         Tipo corrente: Uniprocessor Free
>         Organizzazione registrata: DSE
>         Proprietario autorizzato: Davide Fiaschi
>
> *----> Elenco Task <----*
>    0 Idle.exe
>    8 System.exe
>  136 SMSS.exe
>  164 CSRSS.exe
>  184 WINLOGON.exe
>  212 SERVICES.exe
>  224 LSASS.exe
>  388 svchost.exe
>  424 SPOOLSV.exe
>  456 svchost.exe
>  480 mgabg.exe
>  512 regsvc.exe
>  552 Smc.exe
>  636 ups.exe
>  648 WinMgmt.exe
>  796 explorer.exe
>  788 pdesk.exe
>  960 internat.exe
>  580 netscp6.exe
>  436 drwtsn32.exe
> 1140 Rgui.exe
>  772 DRWTSN32.exe
>    0 _Total.exe
>
> (00400000 - 00406000)
> (78460000 - 784E0000)
> (00410000 - 005A8000)
> (77DB0000 - 77E0B000)
> (77E80000 - 77F3C000)
> (77D40000 - 77DB0000)
> (71780000 - 7180A000)
> (77F40000 - 77F7C000)
> (77E10000 - 77E74000)
> (76B10000 - 76B4D000)
> (70BD0000 - 70C34000)
> (78000000 - 78046000)
> (77590000 - 777D6000)
> (77820000 - 77827000)
> (75980000 - 75986000)
> (77A50000 - 77B46000)
> (779B0000 - 77A4B000)
> (6E380000 - 6E386000)
> (75E30000 - 75E4A000)
> (10F70000 - 10F83000)
> (72C90000 - 72D15000)
> (77850000 - 7788D000)
> (770A0000 - 770C3000)
>
> Scarico dello stato per l'id del thread 0x268
>
> eax=00003a43 ebx=0022fa20 ecx=00000000 edx=7efefeff esi=00000000 edi=00552e02
> eip=78001d22 esp=0022f740 ebp=0022fe90 iopl=0         nv up ei pl zr na po nc
> cs=001b  ss=0023  ds=0023  es=0023  fs=0038  gs=0000             efl=00000246
>
>
> funzione: strcpy
>         78001d05 7416             jz      _threadhandle+0xf4 (7800a71d)
>         78001d07 8a11             mov     dl,[ecx]
> ds:00000000=??
>         78001d09 41               inc     ecx
>         78001d0a 84d2             test    dl,dl
>         78001d0c 0f84ce0d0000     je      strcat+0x9c (78002ae0)
>         78001d12 8817             mov     [edi],dl
> ds:00552e02=00
>         78001d14 47               inc     edi
>         78001d15 f7c103000000     test    ecx,0x3
>         78001d1b 75ea             jnz     assert+0xe8 (7800d807)
>         78001d1d bafffefe7e       mov     edx,0x7efefeff
> FAULT ->78001d22 8b01             mov     eax,[ecx]
> ds:00000000=????????
>         78001d24 03d0             add     edx,eax
>         78001d26 83f0ff           xor     eax,0xff
>         78001d29 33c2             xor     eax,edx
>         78001d2b 8b11             mov     edx,[ecx]
> ds:00000000=????????
>         78001d2d 83c104           add     ecx,0x4
>         78001d30 a900010181       test    eax,0x81010100
>         78001d35 0f856b0d0000     jne     strcat+0x62 (78002aa6)
>         78001d3b 8917             mov     [edi],edx
> ds:00552e02=00000000
>         78001d3d 83c704           add     edi,0x4
>         78001d40 ebdb             jmp     _unDNameEx+0x3738 (7800731d)
>
> *----> Back Trace dello stack <----*
>
> FramePtr ReturnAd Param#1  Param#2  Param#3  Param#4  Function Name
> 0022FE90 004012F6 00000000 00AC38A0 77E8DB7E 00670052 !strcpy
> 0022FEB0 00401237 00000001 00AC38A0 0022FEE0 00401223 !<nosymbols>
> 0022FEE0 004013CD 00400000 00000000 00233123 00000001 !<nosymbols>
> 0022FF60 004011C1 00000001 00AC38A0 00AC29D8 004011A6 !<nosymbols>
> 0022FFA0 00401207 00000002 00000000 8043107B 77E97D05 !<nosymbols>
> 0022FFC0 77E97D08 00670052 00000000 7FFDF000 C0000005 !<nosymbols>
> 0022FFF0 00000000 004011F0 00000000 000000C8 00000100 kernel32!CreateProcessW
>
> *----> Scarico Raw Stack <----*
> 0022f740  52 00 67 00 01 0b 43 00 - 00 2e 55 00 00 00 00 00  R.g...C...U.....
> 0022f750  2d 03 43 00 c1 0a 43 00 - 23 03 43 00 a0 38 ac 00  -.C...C.#.C..8..
> 0022f760  90 fe 22 00 51 0a 43 00 - 23 31 23 00 00 00 00 00  ..".Q.C.#1#.....
> 0022f770  52 00 67 00 00 00 00 00 - 00 00 00 00 00 00 00 00  R.g.............
> 0022f780  00 00 00 00 00 00 00 00 - 00 00 00 00 00 00 00 00  ................
> 0022f790  00 00 00 00 00 00 00 00 - 00 00 00 00 00 00 00 00  ................
> 0022f7a0  00 00 00 00 00 00 00 00 - 00 00 00 00 00 00 00 00  ................
> 0022f7b0  00 00 00 00 00 00 00 00 - 00 00 00 00 00 00 00 00  ................
> 0022f7c0  00 00 00 00 00 00 00 00 - 00 00 00 00 00 00 00 00  ................
> 0022f7d0  00 00 00 00 00 00 00 00 - 00 00 00 00 00 00 00 00  ................
> 0022f7e0  00 00 00 00 00 00 00 00 - 00 00 00 00 00 00 00 00  ................
> 0022f7f0  00 00 00 00 00 00 00 00 - 00 00 00 00 00 00 00 00  ................
> 0022f800  00 00 00 00 00 00 00 00 - 00 00 00 00 00 00 00 00  ................
> 0022f810  00 00 00 00 00 00 00 00 - 00 00 00 00 00 00 00 00  ................
> 0022f820  88 51 23 00 00 00 23 00 - 00 01 23 00 5c f8 22 00  .Q#...#...#.\.".
> 0022f830  00 00 00 00 33 29 46 78 - 00 00 23 00 98 30 23 00  ....3)Fx..#..0#.
> 0022f840  00 00 00 00 38 f8 22 00 - 88 06 23 00 ec f8 22 00  ....8."...#...".
> 0022f850  a7 9d 49 78 50 29 46 78 - ff ff ff ff fc f8 22 00  ..IxP)Fx......".
> 0022f860  de b6 4a 78 d8 07 23 00 - a0 30 23 00 00 10 41 00  ..Jx..#..0#...A.
> 0022f870  88 27 23 00 00 00 00 00 - a8 f1 4a 78 ac f8 22 00  .'#.......Jx..".
>
> Scarico dello stato per l'id del thread 0x17c
>
> eax=77d50c62 ebx=00241808 ecx=00241694 edx=00000000 esi=002416d8 edi=00000100
> eip=78462a84 esp=111afe28 ebp=111aff74 iopl=0         nv up ei pl nz na po nc
> cs=001b  ss=0023  ds=0023  es=0023  fs=0038  gs=0000             efl=00000206
>
>
> funzione: ZwReplyWaitReceivePortEx
>         78462a79 b8ac000000       mov     eax,0xac
>         78462a7e 8d542404         lea     edx,[esp+0x4]
> ss:11c4d3fb=????????
>         78462a82 cd2e             int     2e
>         78462a84 c21400           ret     0x14
>
> *----> Back Trace dello stack <----*
>
> FramePtr ReturnAd Param#1  Param#2  Param#3  Param#4  Function Name
> 111AFF74 77D50781 77D50D7F 002416D8 00000000 402411D8
> ntdll!ZwReplyWaitReceivePortEx
> 111AFFA8 77D50C7A 00240548 111AFFEC 77E8758A 00241808 rpcrt4!RpcBindingSetOption
>
> 111AFFB4 77E8758A 00241808 00000000 402411D8 00241808 rpcrt4!RpcBindingSetOption
>
> 111AFFEC 00000000 00000000 00000000 00000000 00000000 kernel32!SetFilePointer
>
>
>
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1132 *
Subject: Problem with "describe" lists.
From: Rolf Turner <rolf@localhost.localdomain>
Date: Thu, 18 Oct 2001 16:41:03 +0800
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1132 <==
From postmaster@franz.stat.wisc.edu  Thu Oct 18 10:47:29 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id KAA09476
	for <r-bugs@biostat.ku.dk>; Thu, 18 Oct 2001 10:47:28 +0200 (MET DST)
Received: from localhost.localdomain (really [130.95.98.12]) by franz.stat.wisc.edu
	via smail with esmtp (ident root using rfc1413)
	id <m15u8po-000JMEC@franz.stat.wisc.edu> (Debian Smail3.2.0.114)
	for <r-bugs@r-project.org>; Thu, 18 Oct 2001 03:47:24 -0500 (CDT) 
Received: (from rolf@localhost)
	by localhost.localdomain (8.9.3/8.9.3) id QAA14213
	for r-bugs@r-project.org; Thu, 18 Oct 2001 16:41:03 +0800
Date: Thu, 18 Oct 2001 16:41:03 +0800
From: Rolf Turner <rolf@localhost.localdomain>
Message-Id: <200110180841.QAA14213@localhost.localdomain>
To: r-bugs@r-project.org
Subject: Problem with "describe" lists.



I ***think*** this is a bug.  It seems to arise if two
``describes'' are nested.  In summary, the bug is that
if a describe is nested within another, the output (in
html format) gets garbled.  An example *.Rd file which
produces this garble is enclosed below.

After creating this file (``foo.Rd'') I executed

R CMD Rdconv -t=html -o=foo.html foo.Rd

The command seemed to execute OK, but when I pointed
Netscape at the file foo.html, there was a hiccup at
the entry for ``fred'' under ``details''.  The entry
for ``fred'' contains a ``describe'' list which is
nested inside the ``describe'' list which comprises
most of ``details''.

Version information:

platform i686-pc-linux-gnu
arch     i686             
os       linux-gnu        
system   i686, linux-gnu  
status                    
major    1                
minor    2.1              
year     2001             
month    01               
day      15               
language R

I realize that the version is not ``current'', but I had
a quick look at the r-bugs web page and could find nothing
indicating that such a bug had been fixed.

				cheers,

					Rolf Turner

Current address: rolf@maths.uwa.edu.au
Usual address:   rolf@math.unb.ca

===+===+===+===+===+===+===+===+===+===+===+===+===+===+===+===+===+===+===

==========================
Documentation file foo.Rd:
==========================

\name{foo}
\alias{foo}
\title{Do nothing.}
\description{
Do nothing, but do it \bold{very} well!
}
\usage{
foo(gorp,par)
}
\arguments{
  \item{gorp}{I don't know either.}
  \item{par}{Never you mind!}
}

   \details{The parameter list \code{par} should be
   as follows, for each possible value of \code{gorp}:
   \describe{
   \item{melvin:}{ (Melvin Mingdinkler.) A vector with components
   \eqn{(\beta,\gamma,r)}{(beta,gamma,r)} which are respectively
   a load of dingos' kidneys, an elephant, and a duck.
   Note that \eqn{\gamma}{gamma} must be totally ridiculuous.
   }

   \item{clyde:}{ (Clyde, clyde, the cow's outside.) A vector with
   entries \eqn{(\beta,\gamma,r_0,r)}{(beta,gamma,r_0,r)} where
   \eqn{\beta}{beta}, \eqn{\gamma}{gamma}, and \eqn{r} are as for
   \code{melvin}, \eqn{r_0} is a hippopotamus.  Of course
   \eqn{r_0} must eat less than \eqn{r}.
   }

   \item{irving:}{ (The 142nd fastest gun in the West.) A vector
   with components \eqn{(\beta,\sigma,\kappa)}{(beta,sigma,kappa)}.
   Again \eqn{\beta}{beta} is a load of dingos' kidneys.
   The difference between a duck is
   \deqn{
       \left ( \frac{\sigma}{\kappa} \right )^2
   }{(sigma/kappa)^2}
   Note that it is necessary that \eqn{\kappa > 42}{kappa > 42}.
   }

   \item{fred:}{ (Fred Nurk.) Here \code{par} is
   given as a list with components

   \describe{
   \item{beta:}{A vector of loads of dingos' kidneys.}
   \item{gamma:}{A \bold{symmetric} matrix of elephants,
   with \eqn{\gamma_{ij}}{gamma_ij} pertaining to the kidneys of
   dingo \eqn{i} and dingo \eqn{j}.}

   \item{r:}{A \bold{symmetric} matrix of ducks with
   \eqn{r_{ij}}{r_ij} pertaining to the kidneys of dingo
   \eqn{i} and dingo \eqn{j}.}
   }}
}
}

\references{
   Gates, V. ``42 Wonderful Things to do in Come-by-Chance, Nfld.'',
   Memorial University Press, St. John's Nfld., 2001.

   Ye-of-little-faith, O.  ``An annotated bibliography of green
   peas and their ilk'', Journal of the Hopeless, vol. 42, 1950,
   pp.  101 -- 64.
}

\section{Warnings}{
Even paranoids have real enemies.
}

\seealso{
  \code{\link{bar}},
  \code{\link{snafu}},
}
\examples{
   #Oh come on!  You can think up your own examples!
   }

\author{Rolf Turner
  \email{rolf@math.unb.ca}
  \url{http://www.math.unb.ca/~rolf}
  }
\keyword{insanity}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1135 *
Subject: Canceling close behaves incorrectly
From: john_heumann@agilent.com
Date: Sat, 20 Oct 2001 01:02:02 +0200 (MET DST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1135 <==
From john_heumann@agilent.com  Sat Oct 20 01:02:02 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id BAA25157
	for <R-bugs@biostat.ku.dk>; Sat, 20 Oct 2001 01:02:02 +0200 (MET DST)
Date: Sat, 20 Oct 2001 01:02:02 +0200 (MET DST)
From: john_heumann@agilent.com
Message-Id: <200110192302.BAA25157@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: Canceling close behaves incorrectly

Full_Name: John M. Heumann
Version: 1.3.1
OS: NT4 SP 6
Submission from: (NULL) (192.25.140.108)


Picture 2 scenarios:
   (I) R command window sitting at prompt (no program executing)
      a) Do close action: "X" icon, or Alt-F4, or right click on RGui icon
         and select close.
      b) "Save workspace image" dialog appears.
      c) Press cancel. Program does not exit. This is all correct.

   (II) As in (I) but with a program running in the command window
        (e.g. 'source "foo.r"').
        Perform a), b), c) as above. Once again, RGui does not exit
        (which is correct). However the running program will be terminated
        as if you'd hit Escape, which is not correct. I suspect the
"Esc/Cancel"
        message is being passed on up to RGui, rather than trapped and 
        handled by the dialog.
        
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1136 *
Subject: cex/col/etc. in title(): documentation?
From: Ben Bolker <ben@zoo.ufl.edu>
Date: Mon, 22 Oct 2001 11:55:14 -0400 (EDT)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1136 <==
From postmaster@franz.stat.wisc.edu  Mon Oct 22 17:51:05 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id RAA09751
	for <r-bugs@biostat.ku.dk>; Mon, 22 Oct 2001 17:51:04 +0200 (MET DST)
Received: from smtp.ufl.edu (really [128.227.74.28]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m15vhLx-000JL0C@franz.stat.wisc.edu> (Debian Smail3.2.0.114)
	for <r-bugs@r-project.org>; Mon, 22 Oct 2001 10:51:01 -0500 (CDT) 
Received: from bolker.zoo.ufl.edu (bolker.zoo.ufl.edu [10.227.60.45])
	by smtp.ufl.edu (8.12.1/8.12.1/2.2.3) with ESMTP id f9MFoxir117294
	for <r-bugs@r-project.org>; Mon, 22 Oct 2001 11:51:00 -0400
Date: Mon, 22 Oct 2001 11:55:14 -0400 (EDT)
From: Ben Bolker <ben@zoo.ufl.edu>
Reply-To: <bolker@zoo.ufl.edu>
To: <r-bugs@r-project.org>
Subject: cex/col/etc. in title(): documentation?
Message-ID: <Pine.LNX.4.30.0110221153480.5576-100000@bolker.zoo.ufl.edu>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII


  There appears to be a mismatch between the documentation and behavior of
title(), or at least a clarification is in order.  The documentation says
you can pass extra arguments from par() as "...".  However, cex at least
is ignored. Later on in the documentation it becomes clear that you can
specify these extra parameters as part of a list.

  I wouldn't say this is necessarily a bug (and there's certainly a way to
do what you want, if you read the rest of the documentation), but I will
say it didn't seem to follow the same conventions as most of the rest of
the graphical annotation in R.  I would have expected
title(main="foo",cex=2) to set the title larger ...

  I think it would be nicer if title() worked this way, but if it doesn't
it would be nice to have an additional note in the documentation for "..."
to the effect that parameters such as cex, col, etc., should be set using
the list mechanism described below.

## setting parameter with par(): works
par(mfrow=c(3,3),cex=1)
for (i in 1:9) {
  plot(0:5)
  par(cex=i)
  title(main="hello")
  par(cex=1)
}

## passing parameter as part of a list: works
par(mfrow=c(3,3),cex=1)
for (i in 1:9) {
  plot(0:5)
  title(main=list("hello",cex=i))
  par(cex=1)
}

## passing cex as an additional arg: doesn't work
par(mfrow=c(3,3))
for (i in 1:9) {
  plot(0:5)
  title(main="hello",cex=i)
}


--please do not edit the information below--

Version:
 platform = i686-pc-linux-gnu
 arch = i686
 os = linux-gnu
 system = i686, linux-gnu
 status =
 major = 1
 minor = 3.1
 year = 2001
 month = 08
 day = 31
 language = R

Search Path:
 .GlobalEnv, package:bbfuns, package:cannib, package:ctest, Autoloads, package:base
-- 
318 Carr Hall                                bolker@zoo.ufl.edu
Zoology Department, University of Florida    http://www.zoo.ufl.edu/bolker
Box 118525                                   (ph)  352-392-5697
Gainesville, FL 32611-8525                   (fax) 352-392-3704

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1137 *
Subject: =?ks_c_5601-1987?B?W2luZm9dci1idWdztNQgvsiz58fPvcq0z7HuPw==?=
From: =?ks_c_5601-1987?B?wMzH9r/s?= <olk@olk.co.kr>
Date: Tue, 23 Oct 2001 06:50:44 +0900
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1137 <==
From olk@olk.co.kr  Mon Oct 22 23:50:37 2001
Received: from stat.math.ethz.ch (daemon@hypatia.ethz.ch [129.132.58.23])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id XAA11527
	for <R-bugs@biostat.ku.dk>; Mon, 22 Oct 2001 23:50:35 +0200 (MET DST)
Received: (from daemon@localhost)
	by stat.math.ethz.ch (8.9.1/8.9.1) id XAA15616
	for <r-bugs@lists.r-project.org>; Mon, 22 Oct 2001 23:50:22 +0200 (MET DST)
Message-Id: <200110222150.XAA15616@stat.math.ethz.ch>
Received: from s210-205-195-183.thrunet.ne.kr(210.205.195.183), claiming to be "meco902"
 via SMTP by hypatia, id smtpdAAAa003nw; Mon Oct 22 23:50:18 2001
From: =?ks_c_5601-1987?B?wMzH9r/s?= <olk@olk.co.kr>
To: r-bugs@hypatia.math.ethz.ch
Subject: =?ks_c_5601-1987?B?W2luZm9dci1idWdztNQgvsiz58fPvcq0z7HuPw==?=
Date: Tue, 23 Oct 2001 06:50:44 +0900
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----=_NextPart_000_0067_01C0F23A.93A50C00"
X-Priority: 3

This is a multi-part message in MIME format.

------=_NextPart_000_0067_01C0F23A.93A50C00
Content-Type: text/plain;
	charset="ks_c_5601-1987"
Content-Transfer-Encoding: base64

Ojo6SGFwcHkgbWFpbDo6OiAgCUhhcHB5bWFpbCC51yCx4sW4ILmuwMcgMDItNTg4LTA1MTAJ
MjAwMbPiIDEwv/kgICAgCSAgCQkgCQkJCSAJCQ0KCQkgCaLDILDHuMHB9QkJDQoJCSAJotEg
uru5rrq4seIJCSAJQSBibG9uZGUgaXMgd2Fsa2luZyBkb3duIHRoZSBzdHJlZXQgd2l0aGhl
ciBibG91c2Ugb3BlbiBhbmQgaGVyDQogcmlnaHQgYnJlYXN0IGhhbmdpbmcgb3V0LiANCkEg
cG9saWNlbWFuIGFwcHJvYWNoZXMgaGVyIGFuZCBzYXlzLiANCiJNYSdhbSwgDQogYXJlIHlv
dSBhd2FyZSB0aGF0IEkgY291bGRhcnJlc3QgeW91IGZvciBpbmRlY2VudCBleHBvc3VyZT8i
DQpTaGUgc2F5cywgIldoeSwgb2ZmaWNlcj8iDQoiQmVjYXVzZSB5b3VyIGJyZWFzdCBpcyBo
YW5naW5nb3V0LiINClNoZSBsb29rcyBkb3duIGFuZCBzaG91dHMuDQoiT0ggTVkgR09PRE5F
U1MhIEkgbGVmdCB0aGUgYmFieSBvbnRoZSBidXMgYWdhaW4hIg0KCQkNCgkJIAmi0SDH2Lyu
urix4gkJIAnH0SCx3bnfucyz4LChILrttvO/7L26sKEgyLDCpiC/rbfBIMDWsO0gv8C4pcLK
IMGlsKG9v8C7ILnbwLi3ziANCrTZILXlt6+zuyCz9cC6ILvzxcK3ziCx5sC7ILDJvu6wobDt
IMDWvvq02S4NCrDmsPzAzCCx17PgwMcgsdnDs7+hIL/NvK0guLvH37TZLg0KIrrOwM4sILO7
sKEgtOe9xcC7ILD6tNkgs+vD4sHLt84gw7zG98fSILz2tbUgwNa02bTCILvnvcfAuyC+y7Dt
DQogsOi9xbChv+Q/Ig0Ksdez4LChILTrtOTHz7HmOiAiv9Ygsde3uMHSLCCw5rD8tNQ/Ig0K
IrTnvcUgsKG9v8DMILnbv6Egs6q/zSDA1sDdvsa/5D8iDQqx17PgtMIgvsa3obimILq4tPW0
zyDAzLe4sNQgv9zDxrTZOg0KIr7GtM8hIMDMt7K89rChISEgtscgvsax4rimILn2vbq/oSC1
zrDtILO7t8Egufa3yL7uv+QhIgkJDQoJCSAJod4gYnJlYXN0ICC/yrChvb8NCqHeIGFwcHJv
YWNoIH6/oSCwobHuwMwgsKG02SANCqHeIGluZGVjZW50ICC59ripvvi0wiwgssMgu+ezqr/u
LCC/3LyzKMC9tvUpx9ENCqHeIGV4cG9zdXJlICCz68PiDQoJCSAJICAJCSAJCSIgV2hlcmUg
RG9lcyBNeSBIZWFydA0KICBCZWF0IE5vdyANCiAtIFN1bmcgYnkgQ2VsaW5lIERpb24gLSAi
CQkJIAkJCSAJCQkJIAkJCQ0KCQkgCaLDIERvbid0IGtub3cgaG93IGxvdmUgY291bGQgbGVh
dmUNCiAgICAgV2l0aG91dCBhIHRyYWNlIFdoZXJlIGRvIHNpbGVudCBoZWFydHMgZ28uCQkg
CQkxCTIJMwk0CTUJCTYJNwk4CTkJMTAJCQkJCQkgCaLDILvntvvAxyDI58D7tbUgs7Kx4sH2
IL7KwLogw6Qgsde3uLDUILaws68gvPYgwNa0wsH2DQogICAgvssgvPawoSC++L7uv+QuIMDM
IMfjxbvH0SC4tsC9wLogvu618LfOILChvt8gx8+zqr/kCQkNCgkJIAm8rbfOwMcgu+e2+8DM
IL3Evu4gufa4sCDDpCC09cDMu/Mgx9IguLvAzCC++LTCILvnwMywoSC1yCCwzcDMwdIuDQon
c2lsZW50IGhlYXJ0cye29SC52bfOILyttMPHz7DUIL3Evu4gufa4sCwgx+PFu7CouLggs7K+
xiC59riwILvzxcK4piDHpcf2x9EgsM3A1LTPtNkuIA0KJ3dpdGhvdXQgYSB0cmFjZSe0wiCh
uLvntvvAxyDI58D7tbUgs7Kx4sH2IL7KsO2hubbztMIgtubAuLfOICdzaWxlbnQgaGVhcnRz
J8DHIMDHucy4piANCrT1v+0gsK3BtsfYIMHWsO0gwNa+7r/kLiANCiANCqHeIHdpdGhvdXQg
YSB0cmFjZSC+xrmrt7EgyOfA+ywgwNrD67W1IL74wMwNCiAgorlUaGF0IGRvZyBoYXMgZ29u
ZSBhd2F5IHdpdGhvdXQgYSB0cmFjZS4gKLHXILCztMIgvsa5q7exIMjnwPu1tSC++MDMILvn
tvPBriC59rfItNkuKQkJIAkgIAkJIAkJCQ0KCQkgCaLDIE1heSBJIHRyeSB0aGlzIG9uPwkJ
IAkJMQkyCTMJNAk1CQk2CTcJOAk5CTEwCQkJCQkJIAmiwyDH0bn4IMDUvu66wbW1ILXJse6/
5D8JCQ0KCQkgCaLRILq7ua66uLHiIAkJCSAJCQkgCUE6IFRoaXMgaXMgdGhlIGxhdGVzdCBp
biBzd2ltd2Vhci4gDQpCOiBXaGF0IGNvbG9ycyBkbyB5b3UgaGF2ZT8gDQpBOiBCZXNpZGVz
IHRoaXMgb25lIGluIGJsYWNrLCB3ZSBoYXZlIHJlZCwgYmx1ZSBhbmQgZ3JlZW4uIA0KQjog
Q2FuIEkgdHJ5IHRoaXMgb25lIG9uPw0KCQkNCgkJIAmi0SDH2Lyuurix4iAJCSAJQSA6IMDM
sM3AzCC/7LiusKEgsKHB9rDtIMDWtMIgw9a9xSC89r+1urnAzL+hv+QuIA0KQiA6ILv2u/PA
uiC+7rayILDUIMDWs6q/5D8NCkEgOiCwy8C6u/bAziDAzLDNILi7sO0gu6GwoyC79iwgxsS2
9bv2LCDDyrfPu/bAzCDA1r7uv+QuIA0KQiA6IMGmsKEgwMywzSDH0SC5+CDA1L7uusG1tSC1
ybHuv+Q/CQkNCgkJIAknv8rAuyDH0SC5+CDA1L7uuri02Se287TCIMelx/bAuiAndHJ5IG9u
J8DUtM+02S4gDQondHJ5IHRvJ7TCICez67fCx8+02SfAzLDtICd0cnkgfiBpbmcntMIgJ73D
x+i7777GIH7Hz7TZJ7bztMIgtubAzMH2v+QuDQogIA0Kod4gc3dpbXdlYXIgILz2v7W6uSAg
ICAgICAgICAgICANCqHeIGJlc2lkZXMgILDUtNmwoSwgsde527+hDQqh3iB0cnkgb24gIH7A
uyDH0SC5+CDA1L7uuri02S4JCSAJICAJCSAJCQkJIAkJCQ0KCQkgCaLDINzW4sIJCQ0KCQkg
CaLRILq7ua66uLHiCQkgCe+j8ekgOiDfo++jqq+q86OsIPm8KKrKqvMpqs766yiqoqrKKaOs
z94oqtspqsOqxqqkquuqzj8gICAgICAgICAgIA0K36PvoyA6IKqiISDvo/Hpqq+q86OsIKqm
qsGqztDd5eAoqq2q86ququcpqs6qqtnXKKrPqqspqsqq86rAo64NCu+j8ekgOiCqx6rio6zQ
3eXgKKqtqvOqrqrnKarOqqrZ1yiqz6qrKarLqreqwarjo6yqvarOIPrrKKqiqsopLA0KICAg
ICAgICAg094oqqqqqimqraq5qq6q66roo64NCt+j76MgOiDewtuwKKq3qquqvymqyqqkquij
rg0KICAgICAgICAgqqaqwarO0N3l4Ciqrarzqq6q5ymqrKOs76Px6aqvqvOqzqvNq7OqzvHp
KKrKqqspqsvs/Q0KICAgICAgICAgKKrPqqQpqsOqv6reqt6qwKqrqumjriANCgkJDQoJCSAJ
otEgx9i8rrq4seIJCSAJtNmzqrHuIDogvt+4trTZsbosILmrvbwgsbi428C7IMbEsO0gwNa0
zz8gDQq+37i2tNkgOiC+xiEgtNmzqrHusbosIL/suK4gwf0gsd262L7uILmrtP3AzL7fLiAN
CrTZs6qx7iA6ILHXxKG4uCwgsd262L7uILmrtP3EobDvLCCx1yCxuLjbLCCzyrmrxam02S4g
DQq+37i2tNkgOiC+7sK/ILz2IL74vu4uIL/suK7B/SCx3brYvu6woSCzysjxwf0gsO2+58DM
ILnuvNO/oSC16b7uwNawxbXnLgkJDQoJCSAJod4g3Nbiwiiq1aqvqreq5aqmKSAgurm89g0K
od4g+usoqqKqyikgILG4uNsNCqHeIM/eKKrbKarrICDGxLTZDQqh3iCqpqrBqs5+ICAgv+y4
rijB/Sl+DQqh3iDQ3eXgKKqtqvOqrqrnKSAgsd262L7uDQqh3iCqqtnXKKrPqqspICC5q7T9
DQqh3iDT3iiqqqqqKaqtqrmqrqrrKKHn096qraqkKSAgs8q5q8WptNkuDQqh3iDewtuwKKq3
qquqvymqyqqkICC+7sK/ILz2IL74tNkuDQqh3iCqzaqzICCw7b7nwMwNCqHeIOz9KKrPqqQp
qusgILXpvu6wobTZLg0KCQkgCSAgCQkgCQkJDQoJCSAJosMg0dGqtarzqs8g+vzwqSiqrarn
qqaqwKqkKaqsIKqiquqq3qq5qqsJCSAJCTEJMgkzCTQJNQkJNgk3CTgJOQkxMAkJCQkJCSAJ
osMgsei+vrTCIMf8waawoSDA1r3AtM+x7j8JCQ0KCQkgCaLRILq7ua66uLHiCQkJIAkJCSAJ
2cr1vSA6INHRqrWq86rPIPr88Kkoqq2q56qmqsCqpCmqrCCqoqrqqt6quaqrLiANCtHRICAg
IDogqqiqqKOsIPr8KKqiqsspqsgg7asoqqKqzSmqrCDs6ezRKKrSqsiq6imquqrEIKqiquqq
3qq5LiANCtnK9b0gOiCqqvr8KKrLqqQpqrWq86rPIPm8KKrKqsspqvIgqreqxiCqpKreqrmq
qy4NCiDR0SAgICA6IPr8KKqiqsspqs8g3asoqsGqwSmqziD85d7kKKqrqqSqt6rjKarHIKrP
qr+q6aqkqsYgqqSq3qq5LgkJDQoJCSAJotEgx9i8rrq4seIJCSAJseK5q7bzIDogsei+vrTC
IMf8waawoSDA1r3AtM+x7j8NCrHoICAgICAgOiC/uSwgx/yw+iC0qbOqsKEgx9EguO2+vyDA
1r3AtM+02S4gDQqx4rmrtvMgOiDH/LTUwLoguau++cC7IMfPsO0gwNa9wLTPse4/IA0Ksegg
ICAgICA6IMf8wLogvsa59sH2IMi4u+e/obytIMDPx8+w7SDA1r3AtM+02S4gCQkNCgkJIAmh
3iD6/PCpKKqtqueqpqrAqqQpIMf8waah3iCqz6q/qumqryDAz8fPtNkgCQkgCQkJCQ0KCQkg
oeuh66Hroeuh66Hroeuh66Hroeuh66Hroeuh66Hroeuh66Hroeuh66Hroeuh66Hroeuh66Hr
oeuh66Hroeuh66Hroeuh66Hroeuh66Hroeuh66Hroeuh66HroesNCiByLWJ1Z3O01CAgvsiz
58fPvLy/5D8gDQogIA0KIMD6yPG0wiAgwPzIrbimIMDMv+vH2LytICCwrbvnv80gMSA6IDEg
t84gv9yxub7uIMfQvcDAuyDH0iAgvPYgwNa0wiCixCAgT25saW5lIEtvcmVhIKLFILbzIA0K
ILDtICDH1bTPtNkuICAgICAgucy4riDH47b0ud7B9iC+yrDtICDG7cH2ILXlt8Egwcu828fV
tM+02S4gICAgILrOtfAgILPKsde3r7/svcUgv+u8rbimLi4uLi4uDQogIA0KIMD6yPEgIMi4
u+e/obyttMIgv9yxub7uKL+1vu4swM++7im/oSCw/L3JIMDWtMIgILi5wLogutC16bKyILjF
wM8ov/ktsd0pLCC/tb7uwK+407/NILv9yLC/oQ0KIMfKv+TH0SAgyLjIrSDH0SC5rsDlvr/A
uyC5q7fht84gurizuyC15biusO0gwNa+7r/kLg0KICANCiDAp7/NICCwsMC6ILO7v+vAxyC8
rbrxvbq4piC53r7Gurix4iC/+MfPvcO46SCh7CAgb2xrQG9say5jby5rciAgIKHtt84gInll
cyK287TCICANCiCzu7/rwMcgtOTA5cC7IMHWvcOx4iC52bb4tM+02S4NCiAgDQogsde4rrDt
LCAgwPrI8SDA/MitIL/csbm+7iCwrcDHsKEgscOx3cfPvcUgutC16cC7ICDAp8fYLCAxyLi/
oSDH0cfYvK0gosIgILmrt+EgvcO5/LCtwMcgosK1tQ0KIL3HvcPH2CAgteW4rrDtIMDWwLi0
zyDH0bn4ILXpvu66uLDtIL3NwLi9w7jpIMH2sd0gIL3Fw7vH2CDB1ry8v+QuDQogIA0KILmr
t+EgIL3DufywrcDHIL3Fw7sguea5/cC6IKK6ICDAzLD3IKK4IMC7IMWsuK/Hz73FIMjEILCt
wMcgvcXDu7b1v6EgIMDWtMIgvcO5/LCtwMcgvcXDuyDG+8C7DQogwNu8usfPvMW8rSAguriz
uyDB1r3DuOkgtcu0z7TZLiAgubC30CwgwPzIrSAwMi01ODgtMDUxMCAgwLi3zrW1IL3Fw7vH
z73HILz2IMDWsbi/5C4NCiAgDQogvsa5q8LJt88gIMDMIMfQvcC5/cDMIHItYnVnc7TUwMcg
yLjIrSC9x7fCIMfiu/O/oSDA28C6ICC6uMXGwMwgtce++sC4uOkgx9W0z7TZLg0KICANCiBy
LWJ1Z3O01LKytMIgIGh0dHA6Ly93d3cua3IuZ251Lm9yZy9kaXJlY3Rvcnkvci5odG1sv6Eg
wNa0wiDB1rzSuKYguriw7SC43sDPILXlt8i0wrWlv+QsICC60sfKv+TH0SDBpLq4v7S02bjp
IMGkuLsgwcu828fVtM+02S4NCgkguN7AzyAgvPa9xSCwxbrOuKYgv/jHz73DuOkgb2xrQG9s
ay5jby5rciAgt84gW05PXSC287TCILTkwOXAuyDB1r3DuOkgtNm9w7TCICDAzLexILjewM/A
uw0KILXluK7B9iAgvsqw2r3AtM+02S4NCiCwqLvnx9W0z7TZLg0KCSAgCSAgICAg

------=_NextPart_000_0067_01C0F23A.93A50C00
Content-Type: text/html;
	charset="ks_c_5601-1987"
Content-Transfer-Encoding: base64

PGh0bWw+PGhlYWQ+DQo8dGl0bGU+Ojo6SGFwcHkgbWFpbDo6OjwvdGl0bGU+DQo8bWV0YSBo
dHRwLWVxdWl2PSJDb250ZW50LVR5cGUiIGNvbnRlbnQ9InRleHQvaHRtbDsgY2hhcnNldD1l
dWMta3IiPg0KPHN0eWxlIHR5cGU9InRleHQvY3NzIj4NCjwhLS0NClRke2ZvbnQtc2l6ZTox
MHB0O2ZvbnQtZmFtaWx5OrG8uLIsYXJpYWw7Y29sb3I6YmxhY2s7bGluZS1oZWlnaHQ6IDE1
cHQ7fQ0KLnRpdGxle2ZvbnQtc2l6ZToxMHB0O2ZvbnQtZmFtaWx5OrG8uLIsYXJpYWw7Y29s
b3I6IzAwOTlGRjtsaW5lLWhlaWdodDogMTVwdDsgRk9OVC1XRUlHSFQ6IGJvbGQ7fQ0KLnRy
YW5ze2ZvbnQtc2l6ZToxMHB0O2ZvbnQtZmFtaWx5OrG8uLIsYXJpYWw7Y29sb3I6IzY2NjY2
NjtsaW5lLWhlaWdodDogMTVwdDsgRk9OVC1XRUlHSFQ6IGJvbGQ7fQ0KLnRyYW5zXzF7Zm9u
dC1zaXplOjEwcHQ7Zm9udC1mYW1pbHk6sby4sixhcmlhbDtjb2xvcjojNjY5OUNDO2xpbmUt
aGVpZ2h0OiAxNXB0OyBGT05ULVdFSUdIVDogYm9sZDt9DQotLT4NCjwvc3R5bGU+DQoNCjwv
aGVhZD4NCg0KPGJvZHk+DQo8dGFibGUgd2lkdGg9IjU1NyIgY2VsbHNwYWNpbmc9IjEiIGNl
bGxwYWRkaW5nPSIzIiBhbGlnbj0iY2VudGVyIiBiZ2NvbG9yPSIjRDhEOEM1Ij4NCjx0cj4g
DQo8dGQgYmdjb2xvcj0iI0ZGRkZGRiI+DQo8dGFibGUgd2lkdGg9IjU1NyIgYm9yZGVyPSIw
IiBjZWxsc3BhY2luZz0iMCIgY2VsbHBhZGRpbmc9IjAiIGFsaWduPSJjZW50ZXIiPg0KPHRy
PiANCjx0ZCBhbGlnbj0icmlnaHQiPg0KPCEtLbO7v+sgvcPA2yDA1LTPtNkuLi4gLS0+DQo8
IS0ts7u/6yC9w8DbIMDUtM+02S4uLiAtLT4NCjx0YWJsZSB3aWR0aD0iNTU3IiBib3JkZXI9
IjAiIGNlbGxzcGFjaW5nPSIwIiBjZWxscGFkZGluZz0iMCIgYWxpZ249ImNlbnRlciI+DQo8
VFI+DQoJPFREPjxmb250IGNvbG9yPSIjNjY2NjY2Ij5IYXBweW1haWwgudcgseLFuCC5rsDH
ICA8Zm9udCBjb2xvcj0iI0NDMzMzMyI+PGI+MDItNTg4LTA1MTA8L2I+PC9mb250PjwvZm9u
dD48L1REPg0KCTxURCBhbGlnbj0icmlnaHQiPjxmb250IGNvbG9yPSIjNjY2NjY2Ij4yMDAx
s+IgMTC/+SZuYnNwOzwvZm9udD48L1REPg0KPC9UUj4NCjwvVEFCTEU+DQo8L3RkPg0KICAg
ICAgICAgICAgICAgICAgICA8dGQ+PC90ZD4NCjwvdHI+DQo8dHI+IA0KPHRkPjxBIEhSRUY9
Imh0dHA6Ly9tYWlsdGltZXMubmV0LyIgdGFyZ2V0PSJfYmxhbmsiPjxpbWcgc3JjPSJodHRw
Oi8vbWFpbHRpbWVzLm5ldC9zYW1wbGUvaW1hZ2VzL2htX3RvcDAyXzMuZ2lmIiB3aWR0aD0i
NTU3IiBoZWlnaHQ9IjYzIiBib3JkZXI9IjAiPjwvQT48L3RkPg0KICAgICAgICAgICAgICAg
ICAgICA8dGQ+PC90ZD4NCjwvdHI+DQoJDQo8IS0tv7W+7rfOIL/0vu6/5C4gvcPA2yDA1LTP
tNkuLi4gLS0+DQo8dHI+IA0KPHRkPiANCg0KCTx0YWJsZSB3aWR0aD0iNTU3IiBib3JkZXI9
IjAiIGNlbGxzcGFjaW5nPSIwIiBjZWxscGFkZGluZz0iMCIgYmdjb2xvcj0iQzFDMUMxIj4N
Cgk8dHI+IA0KCTx0ZCB3aWR0aD0iNDkwIj48aW1nIHNyYz0iaHR0cDovL21haWx0aW1lcy5u
ZXQvc2FtcGxlL2ltYWdlcy9obV90aXRsZTAxLmdpZiIgd2lkdGg9IjEzMiIgaGVpZ2h0PSIz
NSI+PC90ZD4NCgk8dGQgd2lkdGg9IjY3Ij4NCgk8Rk9STSBNRVRIT0Q9UE9TVCBBQ1RJT049
Imh0dHA6Ly9tYWlsdGltZXMubmV0L3NhbXBsZS9hdWRpby5hc3A/bm93ZGF5PTIwMDEtMDkt
MTgmdGI9bGVjdHVyZV9laHVtZXImbnVtPTEmY29kZT1hdWRpbyZ0dD0wMCIgdGFyZ2V0PSJh
dWRpbyIgbmFtZT0iZWh1bWVyXzEiPg0KCTxpbnB1dCB0eXBlPSJpbWFnZSIgc3JjPSJodHRw
Oi8vbWFpbHRpbWVzLm5ldC9zYW1wbGUvaW1hZ2VzL2J1dHRvbl9saXN0ZW4uZ2lmIiB3aWR0
aD0iNTYiIGhlaWdodD0iMTkiIGJvcmRlcj0iMCI+DQogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICA8L2Zvcm0+DQo8L3RkPjwvRk9STT4NCgk8L3RyPg0KCTwvdGFibGU+
DQo8aW1nIHNyYz0iaHR0cDovL21haWx0aW1lcy5uZXQvc2FtcGxlL2ltYWdlcy9obV9saW5l
LmdpZiIgd2lkdGg9IjU1NyIgaGVpZ2h0PSIxIj48YnI+DQoJPHRhYmxlIHdpZHRoPSIxMDAl
IiBib3JkZXI9IjAiIGNlbGxzcGFjaW5nPSIwIiBjZWxscGFkZGluZz0iNSI+DQoJPHRyPiAN
Cgk8dGQgY2xhc3M9InRpdGxlIj48Zm9udCBjb2xvcj0iIzAwOTlmZiI+PGI+osMgsMe4wcH1
PC9iPjwvZm9udD48L3RkPg0KCTwvdHI+DQoJPC90YWJsZT4NCjxpbWcgc3JjPSJodHRwOi8v
bWFpbHRpbWVzLm5ldC9zYW1wbGUvaW1hZ2VzL2htX2xpbmUuZ2lmIiB3aWR0aD0iNTU3IiBo
ZWlnaHQ9IjEiPjxicj4NCgk8dGFibGUgd2lkdGg9IjEwMCUiIGJvcmRlcj0iMCIgY2VsbHNw
YWNpbmc9IjAiIGNlbGxwYWRkaW5nPSI1Ij4NCgk8dHI+IA0KCTx0ZCBjbGFzcz0idHJhbnNf
MSI+PGZvbnQgY29sb3I9IiM2Njk5Y2MiPjxiPqLRILq7ua66uLHiPC9iPjwvZm9udD48L3Rk
Pg0KCTwvdHI+DQoJPHRyPiANCgk8dGQgY2xhc3M9InRyYW5zIj48cCBjbGFzcz1Nc29Ob3Jt
YWwgc3R5bGU9ImxpbmUtaGVpZ2h0OjE1MCU7IG1hcmdpbi10b3A6MDsgbWFyZ2luLWJvdHRv
bTowOyI+PGZvbnQgY29sb3I9IiM2NjY2NjYiIHNpemU9IjMiPjxzcGFuIGxhbmc9RU4tVVMg
c3R5bGU9ImZvbnQtc2l6ZToxMnB0OyI+QSBibG9uZGUgaXMgd2Fsa2luZyBkb3duIHRoZSBz
dHJlZXQgd2l0aA0KaGVyIGJsb3VzZSBvcGVuIGFuZCBoZXI8L3NwYW4+PC9mb250PjwvcD4N
Cg0KPHAgY2xhc3M9Ik1zb05vcm1hbCIgc3R5bGU9ImxpbmUtaGVpZ2h0OjE1MCU7IG1hcmdp
bi10b3A6MDsgbWFyZ2luLWJvdHRvbTowOyI+PGZvbnQgY29sb3I9IiM2NjY2NjYiIHNpemU9
IjMiPjxzcGFuIGxhbmc9RU4tVVMgc3R5bGU9ImZvbnQtc2l6ZToxMnB0OyI+IHJpZ2h0IDxm
b250IGNvbG9yPSJyZWQiPmJyZWFzdDwvZm9udD4gaGFuZ2luZyBvdXQuIDwvc3Bhbj48L2Zv
bnQ+PC9wPg0KPHAgY2xhc3M9TXNvTm9ybWFsIHN0eWxlPSJsaW5lLWhlaWdodDoxNTAlOyBt
YXJnaW4tdG9wOjA7IG1hcmdpbi1ib3R0b206MDsiPjxmb250IGNvbG9yPSIjNjY2NjY2IiBz
aXplPSIzIj48c3BhbiBsYW5nPUVOLVVTIHN0eWxlPSJmb250LXNpemU6MTJwdDsiPkEgcG9s
aWNlbWFuIDxmb250IGNvbG9yPSJyZWQiPmFwcHJvYWNoZXM8L2ZvbnQ+IGhlciBhbmQgc2F5
cy4gPC9zcGFuPjwvZm9udD48L3A+DQoNCjxwIGNsYXNzPU1zb05vcm1hbCBzdHlsZT0ibGlu
ZS1oZWlnaHQ6MTUwJTsgbWFyZ2luLXRvcDowOyBtYXJnaW4tYm90dG9tOjA7Ij48Zm9udCBj
b2xvcj0iIzY2NjY2NiIgc2l6ZT0iMyI+PHNwYW4gbGFuZz1FTi1VUyBzdHlsZT0iZm9udC1z
aXplOjEycHQ7Ij4mcXVvdDtNYSdhbSwgPC9zcGFuPjwvZm9udD48L3A+DQoNCjxwIGNsYXNz
PSJNc29Ob3JtYWwiIHN0eWxlPSJsaW5lLWhlaWdodDoxNTAlOyBtYXJnaW4tdG9wOjA7IG1h
cmdpbi1ib3R0b206MDsiPjxmb250IGNvbG9yPSIjNjY2NjY2IiBzaXplPSIzIj48c3BhbiBs
YW5nPUVOLVVTIHN0eWxlPSJmb250LXNpemU6MTJwdDsiPiZuYnNwO2FyZSB5b3UgYXdhcmUg
dGhhdCBJIGNvdWxkDQphcnJlc3QgeW91IGZvciA8Zm9udCBjb2xvcj0icmVkIj5pbmRlY2Vu
dCBleHBvc3VyZTwvZm9udD4/JnF1b3Q7PC9zcGFuPjwvZm9udD48L3A+DQo8cCBjbGFzcz1N
c29Ob3JtYWwgc3R5bGU9ImxpbmUtaGVpZ2h0OjE1MCU7IG1hcmdpbi10b3A6MDsgbWFyZ2lu
LWJvdHRvbTowOyI+PGZvbnQgY29sb3I9IiM2NjY2NjYiIHNpemU9IjMiPjxzcGFuIGxhbmc9
RU4tVVMgc3R5bGU9ImZvbnQtc2l6ZToxMnB0OyI+U2hlIHNheXMsICZxdW90O1doeSwgb2Zm
aWNlcj8mcXVvdDs8L3NwYW4+PC9mb250PjwvcD4NCg0KPHAgY2xhc3M9TXNvTm9ybWFsIHN0
eWxlPSJsaW5lLWhlaWdodDoxNTAlOyBtYXJnaW4tdG9wOjA7IG1hcmdpbi1ib3R0b206MDsi
Pjxmb250IGNvbG9yPSIjNjY2NjY2IiBzaXplPSIzIj48c3BhbiBsYW5nPUVOLVVTIHN0eWxl
PSJmb250LXNpemU6MTJwdDsiPiZxdW90O0JlY2F1c2UgeW91ciBicmVhc3QgaXMgaGFuZ2lu
Zw0Kb3V0LiZxdW90Ozwvc3Bhbj48L2ZvbnQ+PC9wPg0KDQo8cCBjbGFzcz1Nc29Ob3JtYWwg
c3R5bGU9ImxpbmUtaGVpZ2h0OjE1MCU7IG1hcmdpbi10b3A6MDsgbWFyZ2luLWJvdHRvbTow
OyI+PGZvbnQgY29sb3I9IiM2NjY2NjYiIHNpemU9IjMiPjxzcGFuIGxhbmc9RU4tVVMgc3R5
bGU9ImZvbnQtc2l6ZToxMnB0OyI+U2hlIGxvb2tzIGRvd24gYW5kIHNob3V0cy48L3NwYW4+
PC9mb250PjwvcD4NCg0KPHAgY2xhc3M9TXNvTm9ybWFsIHN0eWxlPSJsaW5lLWhlaWdodDox
NTAlOyBtYXJnaW4tdG9wOjA7IG1hcmdpbi1ib3R0b206MDsiPjxmb250IGNvbG9yPSIjNjY2
NjY2IiBzaXplPSIzIj48c3BhbiBsYW5nPUVOLVVTIHN0eWxlPSJmb250LXNpemU6MTJwdDsi
PiZxdW90O09IIE1ZIEdPT0RORVNTISBJIGxlZnQgdGhlIGJhYnkgb24NCnRoZSBidXMgYWdh
aW4hJnF1b3Q7PC9zcGFuPjwvZm9udD48L3A+PC90ZD4NCgk8L3RyPg0KCTwvdGFibGU+DQo8
aW1nIHNyYz0iaHR0cDovL21haWx0aW1lcy5uZXQvc2FtcGxlL2ltYWdlcy9obV9saW5lLmdp
ZiIgd2lkdGg9IjU1NyIgaGVpZ2h0PSIxIj48YnI+DQoJPHRhYmxlIHdpZHRoPSIxMDAlIiBi
b3JkZXI9IjAiIGNlbGxzcGFjaW5nPSIwIiBjZWxscGFkZGluZz0iNSI+DQoJPHRyPiANCgk8
dGQgY2xhc3M9InRyYW5zXzEiPjxmb250IGNvbG9yPSIjNjY5OWNjIj48Yj6i0SDH2Lyuurix
4jwvYj48L2ZvbnQ+PC90ZD4NCgk8L3RyPg0KCTx0cj4gDQoJPHRkIGNsYXNzPSJ0cmFucyI+
PHAgY2xhc3M9Ik1zb05vcm1hbCIgc3R5bGU9ImxpbmUtaGVpZ2h0OjE1MCU7IG1hcmdpbi10
b3A6MDsgbWFyZ2luLWJvdHRvbTowOyI+PGZvbnQgY29sb3I9IiM2NjY2NjYiPjxzcGFuIHN0
eWxlPSJmb250LXNpemU6MTJwdDsiPsfRILHdud+5zLPgsKEguu2287/svbqwoSDIsMKmIL+t
t8EgwNaw7SC/wLilwsogwaWwob2/wLsgudvAuLfOIDwvc3Bhbj48L2ZvbnQ+PC9wPg0KPHAg
Y2xhc3M9Ik1zb05vcm1hbCIgc3R5bGU9ImxpbmUtaGVpZ2h0OjE1MCU7IG1hcmdpbi10b3A6
MDsgbWFyZ2luLWJvdHRvbTowOyI+PGZvbnQgY29sb3I9IiM2NjY2NjYiPjxzcGFuIHN0eWxl
PSJmb250LXNpemU6MTJwdDsiPrTZILXlt6+zuyCz9cC6ILvzxcK3ziCx5sC7ILDJvu6wobDt
IMDWvvq02Twvc3Bhbj48c3BhbiBsYW5nPUVOLVVTIHN0eWxlPSJmb250LXNpemU6MTJwdDsi
Pi48L3NwYW4+PC9mb250PjwvcD4NCjxwIGNsYXNzPU1zb05vcm1hbCBzdHlsZT0ibGluZS1o
ZWlnaHQ6MTUwJTsgbWFyZ2luLXRvcDowOyBtYXJnaW4tYm90dG9tOjA7Ij48Zm9udCBjb2xv
cj0iIzY2NjY2NiI+PHNwYW4gc3R5bGU9ImZvbnQtc2l6ZToxMnB0OyI+sOaw/MDMILHXs+DA
xyCx2cOzv6Egv828rSC4u8fftNk8L3NwYW4+PHNwYW4gbGFuZz1FTi1VUyBzdHlsZT0iZm9u
dC1zaXplOjEycHQ7Ij4uPC9zcGFuPjwvZm9udD48L3A+DQoNCjxwIGNsYXNzPU1zb05vcm1h
bCBzdHlsZT0ibGluZS1oZWlnaHQ6MTUwJTsgbWFyZ2luLXRvcDowOyBtYXJnaW4tYm90dG9t
OjA7Ij48Zm9udCBjb2xvcj0iIzY2NjY2NiI+PHNwYW4gbGFuZz1FTi1VUyBzdHlsZT0iZm9u
dC1zaXplOjEycHQ7Ij4mcXVvdDu6zsDOLCCzu7ChILTnvcXAuyCw+rTZILPrw+LBy7fOIMO8
xvfH0iC89rW1IMDWtNm0wiC7573HwLsgvsuw7Twvc3Bhbj48L2ZvbnQ+PC9wPg0KDQo8cCBj
bGFzcz0iTXNvTm9ybWFsIiBzdHlsZT0ibGluZS1oZWlnaHQ6MTUwJTsgbWFyZ2luLXRvcDow
OyBtYXJnaW4tYm90dG9tOjA7Ij48Zm9udCBjb2xvcj0iIzY2NjY2NiI+PHNwYW4gbGFuZz1F
Ti1VUyBzdHlsZT0iZm9udC1zaXplOjEycHQ7Ij4mbmJzcDuw6L3FsKG/5D8mcXVvdDs8L3Nw
YW4+PC9mb250PjwvcD4NCjxwIGNsYXNzPU1zb05vcm1hbCBzdHlsZT0ibGluZS1oZWlnaHQ6
MTUwJTsgbWFyZ2luLXRvcDowOyBtYXJnaW4tYm90dG9tOjA7Ij48Zm9udCBjb2xvcj0iIzY2
NjY2NiI+PHNwYW4gc3R5bGU9ImZvbnQtc2l6ZToxMnB0OyI+sdez4LChILTrtOTHz7HmPC9z
cGFuPjxzcGFuIGxhbmc9RU4tVVMgc3R5bGU9ImZvbnQtc2l6ZToxMnB0OyI+OiAmcXVvdDu/
1iCx17e4wdIsILDmsPy01D8mcXVvdDs8L3NwYW4+PC9mb250PjwvcD4NCg0KPHAgY2xhc3M9
TXNvTm9ybWFsIHN0eWxlPSJsaW5lLWhlaWdodDoxNTAlOyBtYXJnaW4tdG9wOjA7IG1hcmdp
bi1ib3R0b206MDsiPjxmb250IGNvbG9yPSIjNjY2NjY2Ij48c3BhbiBsYW5nPUVOLVVTIHN0
eWxlPSJmb250LXNpemU6MTJwdDsiPiZxdW90O7TnvcUgsKG9v8DMILnbv6Egs6q/zSDA1sDd
vsa/5D8mcXVvdDs8L3NwYW4+PC9mb250PjwvcD4NCg0KPHAgY2xhc3M9TXNvTm9ybWFsIHN0
eWxlPSJsaW5lLWhlaWdodDoxNTAlOyBtYXJnaW4tdG9wOjA7IG1hcmdpbi1ib3R0b206MDsi
Pjxmb250IGNvbG9yPSIjNjY2NjY2Ij48c3BhbiBzdHlsZT0iZm9udC1zaXplOjEycHQ7Ij6x
17PgtMIgvsa3obimILq4tPW0zyDAzLe4sNQgv9zDxrTZPC9zcGFuPjxzcGFuIGxhbmc9RU4t
VVMgc3R5bGU9ImZvbnQtc2l6ZToxMnB0OyI+Ojwvc3Bhbj48L2ZvbnQ+PC9wPg0KDQo8cCBz
dHlsZT0ibGluZS1oZWlnaHQ6MTUwJTsgbWFyZ2luLXRvcDowOyBtYXJnaW4tYm90dG9tOjA7
Ij48Zm9udCBjb2xvcj0iIzY2NjY2NiI+PHNwYW4gbGFuZz1FTi1VUyBzdHlsZT0nZm9udC1m
YW1pbHk6udnFwTsgZm9udC1zaXplOjEycHQ7IG1zby1iaWRpLWZvbnQtc2l6ZToxMi4wcHQ7
bXNvLWhhbnNpLWZvbnQtZmFtaWx5OiJUaW1lcyBOZXcgUm9tYW4iO21zby1iaWRpLWZvbnQt
ZmFtaWx5OiJUaW1lcyBOZXcgUm9tYW4iOw0KbXNvLWZvbnQta2VybmluZzoxLjBwdDttc28t
YW5zaS1sYW5ndWFnZTpFTi1VUzttc28tZmFyZWFzdC1sYW5ndWFnZTpLTzsNCm1zby1iaWRp
LWxhbmd1YWdlOkFSLVNBJz4mcXVvdDu+xrTPISDAzLeyvPawoSEhILbHIL7GseK4piC59r26
v6Egtc6w7SCzu7fBILn2t8i+7r/kISZxdW90Ozwvc3Bhbj48L2ZvbnQ+PC90ZD4NCgk8L3Ry
Pg0KCTwvdGFibGU+DQo8aW1nIHNyYz0iaHR0cDovL21haWx0aW1lcy5uZXQvc2FtcGxlL2lt
YWdlcy9obV9saW5lMS5naWYiIHdpZHRoPSI1NTciIGhlaWdodD0iMSI+PGJyPg0KCTx0YWJs
ZSB3aWR0aD0iNTU3IiBib3JkZXI9IjAiIGNlbGxzcGFjaW5nPSIwIiBjZWxscGFkZGluZz0i
NSIgYmdjb2xvcj0iI0YzRjNFRCI+DQoJPHRyPiANCgk8dGQ+PHAgY2xhc3M9Ik1zb05vcm1h
bCIgc3R5bGU9ImxpbmUtaGVpZ2h0OjE1MCU7IG1hcmdpbi10b3A6MDsgbWFyZ2luLWJvdHRv
bTowOyI+PHNwYW4gbGFuZz1FTi1VUyBzdHlsZT0iZm9udC1zaXplOjEycHQ7Ij6h3iANCjxi
PmJyZWFzdDwvYj4gJm5ic3A7v8qwob2/PC9zcGFuPjwvcD4NCjxwIGNsYXNzPU1zb05vcm1h
bCBzdHlsZT0ibGluZS1oZWlnaHQ6MTUwJTsgbWFyZ2luLXRvcDowOyBtYXJnaW4tYm90dG9t
OjA7Ij48c3BhbiBsYW5nPUVOLVVTIHN0eWxlPSJmb250LXNpemU6MTJwdDsiPqHeIA0KPGI+
YXBwcm9hY2g8L2I+ICB+v6EgsKGx7sDMILChtNkgPC9zcGFuPjwvcD4NCg0KPHAgY2xhc3M9
Ik1zb05vcm1hbCIgc3R5bGU9ImxpbmUtaGVpZ2h0OjE1MCU7IG1hcmdpbi10b3A6MDsgbWFy
Z2luLWJvdHRvbTowOyI+PHNwYW4gbGFuZz1FTi1VUyBzdHlsZT0iZm9udC1zaXplOjEycHQ7
Ij6h3iANCjxiPmluZGVjZW50PC9iPiAmbmJzcDu59ripvvi0wiwgssMgu+ezqr/uLCC/3Lyz
KMC9tvUpx9E8L3NwYW4+PC9wPg0KPHAgY2xhc3M9Ik1zb05vcm1hbCIgc3R5bGU9ImxpbmUt
aGVpZ2h0OjE1MCU7IG1hcmdpbi10b3A6MDsgbWFyZ2luLWJvdHRvbTowOyI+PHNwYW4gbGFu
Zz1FTi1VUyBzdHlsZT0iZm9udC1zaXplOjEycHQ7Ij6h3iANCjxiPmV4cG9zdXJlPC9iPiAm
bmJzcDuz68PiPC9zcGFuPjwvcD48L3RkPg0KCTwvdHI+DQoJPC90YWJsZT4NCjwvdGQ+DQog
ICAgICAgICAgICAgICAgICAgIDx0ZD48L3RkPg0KPC90cj4NCjwhLS2/tb7ut84gv/S+7r/k
LiCzoSDA1LTPtNkuLi4gLS0+DQoJDQo8IS0tv8C0w8DHIMbLvNsgvcPA2y0tPg0KPHRyPiAN
Cjx0ZD4gDQoJPHRhYmxlIHdpZHRoPSI1NTciIGJvcmRlcj0iMCIgY2VsbHNwYWNpbmc9IjAi
IGNlbGxwYWRkaW5nPSIwIiBiZ2NvbG9yPSJDMUMxQzEiPg0KCTx0cj4gDQoJPHRkIHdpZHRo
PSIxMzQiPjxpbWcgc3JjPSJodHRwOi8vbWFpbHRpbWVzLm5ldC9zYW1wbGUvaW1hZ2VzL2ht
X3RpdGxlMDIuZ2lmIiB3aWR0aD0iMTMxIiBoZWlnaHQ9IjMyIj48L3RkPg0KCTx0ZCB3aWR0
aD0iMjIxIj48Yj48Zm9udCBjb2xvcj0iIzY2NjY2NiI+PGZvbnQgc2l6ZT0iMyI+JnF1b3Q7
IFdoZXJlIERvZXMgTXkgSGVhcnQ8YnI+Jm5ic3A7IEJlYXQgTm93IDxicj4mbmJzcDstIFN1
bmcgYnkgIENlbGluZSBEaW9uIC0gJnF1b3Q7PC9mb250PjwvZm9udD48L2I+PC90ZD4NCgk8
dGQgd2lkdGg9Ijc0Ij4NCgk8Rk9STSBNRVRIT0Q9UE9TVCBBQ1RJT049Imh0dHA6Ly9tYWls
dGltZXMubmV0L3NhbXBsZS9hdWRpby5hc3A/bm93ZGF5PTEyJnRiPWxlY3R1cmVfcG9wZnVs
bCZudW09MSZjb2RlPWF1ZGlvJnR0PTAwIiB0YXJnZXQ9ImF1ZGlvIiBuYW1lPSJwb3BfMSI+
DQoJPGlucHV0IHR5cGU9ImltYWdlIiBzcmM9Imh0dHA6Ly9tYWlsdGltZXMubmV0L3NhbXBs
ZS9pbWFnZXMvYnV0dG9uX2FsbGxpc3Rlbi5naWYiIHdpZHRoPSI2NSIgaGVpZ2h0PSIxOSIg
Ym9yZGVyPSIwIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZm9y
bT4NCjwvdGQ+PC9GT1JNPg0KCTx0ZCB3aWR0aD0iNjciPg0KCTxGT1JNIE1FVEhPRD1QT1NU
IEFDVElPTj0iaHR0cDovL21haWx0aW1lcy5uZXQvc2FtcGxlL3Nvbmdfd29yZC5hc3A/aWR4
PTEyJnR0PTAwIiB0YXJnZXQ9InRyYW5zIiBuYW1lPSJwb3BfMiI+DQoJPGlucHV0IHR5cGU9
ImltYWdlIiBzcmM9Imh0dHA6Ly9tYWlsdGltZXMubmV0L3NhbXBsZS9pbWFnZXMvYnV0dG9u
X2x5cmljcy5naWYiIHdpZHRoPSI1NiIgaGVpZ2h0PSIxOSIgYm9yZGVyPSIwIj4NCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9mb3JtPg0KDQoJPC90ZD48L0ZPUk0+DQoJ
PHRkIHdpZHRoPSI2MSI+DQoJPEZPUk0gTUVUSE9EPVBPU1QgQUNUSU9OPSJodHRwOi8vbWFp
bHRpbWVzLm5ldC9zYW1wbGUvc29uZ190cmFucy5hc3A/aWR4PTEyJnR0PTAwIiB0YXJnZXQ9
InRyYW5zIiBuYW1lPSJwb3BfMyI+DQoJPGlucHV0IHR5cGU9ImltYWdlIiBzcmM9Imh0dHA6
Ly9tYWlsdGltZXMubmV0L3NhbXBsZS9pbWFnZXMvYnV0dG9uX3RyYW5zbGF0ZS5naWYiIHdp
ZHRoPSI1NiIgaGVpZ2h0PSIxOSIgYm9yZGVyPSIwIj4NCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgPC9mb3JtPg0KDQoJPC90ZD48L0ZPUk0+DQoJPC90cj4NCgk8L3RhYmxl
Pg0KPGltZyBzcmM9Imh0dHA6Ly9tYWlsdGltZXMubmV0L3NhbXBsZS9pbWFnZXMvaG1fbGlu
ZS5naWYiIHdpZHRoPSI1NTciIGhlaWdodD0iMSI+PGJyPg0KCTx0YWJsZSB3aWR0aD0iNTU3
IiBib3JkZXI9IjAiIGNlbGxzcGFjaW5nPSIwIiBjZWxscGFkZGluZz0iNSI+DQoJPHRyPiAN
Cgk8dGQgd2lkdGg9IjQxNyIgY2xhc3M9InRpdGxlIj48Zm9udCBjb2xvcj0iIzAwOTlmZiIg
c2l6ZT0iMyI+osMgRG9uJ3Qga25vdyBob3cgbG92ZSBjb3VsZCBsZWF2ZTxicj4gJm5ic3A7
Jm5ic3A7Jm5ic3A7Jm5ic3A7V2l0aG91dCBhIHRyYWNlIFdoZXJlIGRvIHNpbGVudCBoZWFy
dHMgZ28uPC9mb250PjwvdGQ+DQoJPEZPUk0gTUVUSE9EPVBPU1QgQUNUSU9OPSJodHRwOi8v
bWFpbHRpbWVzLm5ldC9zYW1wbGUvYXVkaW8uYXNwP25vd2RheT0yMDAxLTA5LTE4JnRiPWxl
Y3R1cmVfcG9wJmNvZGU9dGl0bGVfYXVkaW8mdHQ9MDAiIHRhcmdldD0iYXVkaW8iIG5hbWU9
InBvcCI+DQoJPHRkIHdpZHRoPSIzNCI+IA0KCTxTRUxFQ1QgTkFNRT0ibnVtIj4NCgk8b3B0
aW9uIHZhbHVlPSIxIj4xCTxvcHRpb24gdmFsdWU9IjIiPjIJPG9wdGlvbiB2YWx1ZT0iMyI+
Mwk8b3B0aW9uIHZhbHVlPSI0Ij40CTxvcHRpb24gdmFsdWU9IjUiPjUJDQoJPG9wdGlvbiB2
YWx1ZT0iNiI+Ngk8b3B0aW9uIHZhbHVlPSI3Ij43CTxvcHRpb24gdmFsdWU9IjgiPjgJPG9w
dGlvbiB2YWx1ZT0iOSI+OQk8b3B0aW9uIHZhbHVlPSIxMCI+MTANCgk8L1NFTEVDVD4NCgk8
L3RkPg0KCTx0ZCB3aWR0aD0iNTciPg0KCTxpbnB1dCB0eXBlPSJpbWFnZSIgc3JjPSJodHRw
Oi8vbWFpbHRpbWVzLm5ldC9zYW1wbGUvaW1hZ2VzL2J1dHRvbl9saXN0ZW4uZ2lmIiB3aWR0
aD0iNTYiIGhlaWdodD0iMTkiIGJvcmRlcj0iMCI+PC90ZD48L0ZPUk0+DQoJPC90cj4NCgk8
dHI+IA0KCTx0ZCBjb2xzcGFuPSIzIiBjbGFzcz0idGl0bGUiPjxmb250IGNvbG9yPSIjMDA5
OWZmIj6iwyC757b7wMcgyOfA+7W1ILOyseLB9iC+ysC6IMOkILHXt7iw1CC2sLOvILz2IMDW
tMLB9jxicj4mbmJzcDsmbmJzcDsmbmJzcDsgvssgvPawoSC++L7uv+QuIMDMIMfjxbvH0SC4
tsC9wLogvu618LfOILChvt8gx8+zqr/kPC9mb250PjwvdGQ+DQoJPC90cj4NCgk8L3RhYmxl
Pg0KPGltZyBzcmM9Imh0dHA6Ly9tYWlsdGltZXMubmV0L3NhbXBsZS9pbWFnZXMvaG1fbGlu
ZTEuZ2lmIiB3aWR0aD0iNTU3IiBoZWlnaHQ9IjEiPjxicj4NCgk8dGFibGUgd2lkdGg9IjU1
NyIgYm9yZGVyPSIwIiBjZWxsc3BhY2luZz0iMCIgY2VsbHBhZGRpbmc9IjUiIGJnY29sb3I9
IiNGM0YzRUQiPg0KCTx0cj4gDQoJPHRkPjxwIHN0eWxlPSJsaW5lLWhlaWdodDoxNTAlOyBt
YXJnaW4tdG9wOjA7IG1hcmdpbi1ib3R0b206MDsiPrytt87AxyC757b7wMwgvcS+7iANCrn2
uLAgw6QgtPXAzLvzIMfSILi7wMwgvvi0wiC758DMsKEgtcggsM3AzMHSLjwvcD4NCjxwIHN0
eWxlPSJsaW5lLWhlaWdodDoxNTAlOyBtYXJnaW4tdG9wOjA7IG1hcmdpbi1ib3R0b206MDsi
PidzaWxlbnQgaGVhcnRzJ7b1IA0Kudm3ziC8rbTDx8+w1CC9xL7uILn2uLAsIMfjxbuwqLi4
ILOyvsYgufa4sCC788XCuKYgx6XH9sfRILDNwNS0z7TZLiA8L3A+DQo8cCBzdHlsZT0ibGlu
ZS1oZWlnaHQ6MTUwJTsgbWFyZ2luLXRvcDowOyBtYXJnaW4tYm90dG9tOjA7Ij4nd2l0aG91
dCBhIHRyYWNlJ7TCIA0Kobi757b7wMcgyOfA+7W1ILOyseLB9iC+yrDtobm287TCILbmwLi3
ziAnc2lsZW50IGhlYXJ0cyfAxyDAx7nMuKYgPC9wPg0KPHAgc3R5bGU9ImxpbmUtaGVpZ2h0
OjE1MCU7IG1hcmdpbi10b3A6MDsgbWFyZ2luLWJvdHRvbTowOyI+tPW/7SCwrcG2x9ggwdaw
7SANCsDWvu6/5C4gPC9wPg0KPHAgc3R5bGU9ImxpbmUtaGVpZ2h0OjE1MCU7IG1hcmdpbi10
b3A6MDsgbWFyZ2luLWJvdHRvbTowOyI+Jm5ic3A7PC9wPg0KPHAgc3R5bGU9ImxpbmUtaGVp
Z2h0OjE1MCU7IG1hcmdpbi10b3A6MDsgbWFyZ2luLWJvdHRvbTowOyI+od4gPGI+d2l0aG91
dCBhIA0KdHJhY2U8L2I+IL7Guau3sSDI58D7LCDA2sPrtbUgvvjAzDwvcD4NCjxwIHN0eWxl
PSJsaW5lLWhlaWdodDoxNTAlOyBtYXJnaW4tdG9wOjA7IG1hcmdpbi1ib3R0b206MDsiPiZu
YnNwOyZuYnNwO6K5VGhhdCANCmRvZyBoYXMgZ29uZSBhd2F5IHdpdGhvdXQgYSB0cmFjZS4g
KLHXILCztMIgvsa5q7exIMjnwPu1tSC++MDMILvntvPBriC59rfItNkuKTwvdGQ+DQoJPC90
cj4NCgk8L3RhYmxlPg0KPC90ZD4NCiAgICAgICAgICAgICAgICAgICAgPHRkPjwvdGQ+DQo8
L3RyPg0KPCEtLb/AtMPAxyDGy7zbILOhLS0+DQoJDQo8IS0tv8C0w8DHIL+1vu4gx9G4trXw
IL3DwNstLT4NCjx0cj4gDQo8dGQ+IA0KCTx0YWJsZSB3aWR0aD0iNTU3IiBib3JkZXI9IjAi
IGNlbGxzcGFjaW5nPSIwIiBjZWxscGFkZGluZz0iMCIgYmdjb2xvcj0iQzFDMUMxIj4NCgk8
dHI+IA0KCTx0ZCB3aWR0aD0iMzA1Ij48aW1nIHNyYz0iaHR0cDovL21haWx0aW1lcy5uZXQv
c2FtcGxlL2ltYWdlcy9obV90aXRsZTAzLmdpZiIgd2lkdGg9IjE2NyIgaGVpZ2h0PSIzMiI+
PC90ZD4NCgk8L3RyPg0KCTwvdGFibGU+DQo8aW1nIHNyYz0iaHR0cDovL21haWx0aW1lcy5u
ZXQvc2FtcGxlL2ltYWdlcy9obV9saW5lLmdpZiIgd2lkdGg9IjU1NyIgaGVpZ2h0PSIxIj48
YnI+DQoJPHRhYmxlIHdpZHRoPSI1NTciIGJvcmRlcj0iMCIgY2VsbHNwYWNpbmc9IjAiIGNl
bGxwYWRkaW5nPSI1Ij4NCgk8dHI+IA0KCTx0ZCB3aWR0aD0iNDE3IiBjbGFzcz0idGl0bGUi
Pjxmb250IGNvbG9yPSIjMDA5OWZmIiBzaXplPSIzIj6iwyBNYXkgSSB0cnkgdGhpcyBvbj88
L2ZvbnQ+PC90ZD4NCgk8Rk9STSBNRVRIT0Q9UE9TVCBBQ1RJT049Imh0dHA6Ly9tYWlsdGlt
ZXMubmV0L3NhbXBsZS9hdWRpby5hc3A/bm93ZGF5PTIwMDEtMDktMTgmdGI9bGVjdHVyZV9l
bmdsaXNoJmNvZGU9dGl0bGVfYXVkaW8mdHQ9MDAiIHRhcmdldD0iYXVkaW8iIG5hbWU9ImVu
Z2xpc2giPg0KCTx0ZCB3aWR0aD0iMzQiPiANCgk8U0VMRUNUIE5BTUU9Im51bSI+DQoJPG9w
dGlvbiB2YWx1ZT0iMSI+MQk8b3B0aW9uIHZhbHVlPSIyIj4yCTxvcHRpb24gdmFsdWU9IjMi
PjMJPG9wdGlvbiB2YWx1ZT0iNCI+NAk8b3B0aW9uIHZhbHVlPSI1Ij41CQ0KCTxvcHRpb24g
dmFsdWU9IjYiPjYJPG9wdGlvbiB2YWx1ZT0iNyI+Nwk8b3B0aW9uIHZhbHVlPSI4Ij44CTxv
cHRpb24gdmFsdWU9IjkiPjkJPG9wdGlvbiB2YWx1ZT0iMTAiPjEwPC9vcHRpb24+DQoJPC9T
RUxFQ1Q+DQoJPC90ZD4NCgk8dGQgd2lkdGg9IjU3Ij4NCgk8aW5wdXQgdHlwZT0iaW1hZ2Ui
IHNyYz0iaHR0cDovL21haWx0aW1lcy5uZXQvc2FtcGxlL2ltYWdlcy9idXR0b25fbGlzdGVu
LmdpZiIgd2lkdGg9IjU2IiBoZWlnaHQ9IjE5IiBib3JkZXI9IjAiPjwvdGQ+PC9GT1JNPg0K
CTwvdHI+DQoJPHRyPiANCgk8dGQgY29sc3Bhbj0iMyIgY2xhc3M9InRpdGxlIj48Zm9udCBj
b2xvcj0iIzAwOTlmZiI+osMgx9G5+CDA1L7uusG1tSC1ybHuv+Q/PC9mb250PjwvdGQ+DQoJ
PC90cj4NCgk8L3RhYmxlPg0KPGltZyBzcmM9Imh0dHA6Ly9tYWlsdGltZXMubmV0L3NhbXBs
ZS9pbWFnZXMvaG1fbGluZTEuZ2lmIiB3aWR0aD0iNTU3IiBoZWlnaHQ9IjEiPjxicj4NCgk8
dGFibGUgd2lkdGg9IjU1NyIgYm9yZGVyPSIwIiBjZWxsc3BhY2luZz0iMCIgY2VsbHBhZGRp
bmc9IjUiPg0KCTx0cj4gDQoJPHRkIHdpZHRoPSI1MDEiIGNsYXNzPSJ0cmFuc18xIj48Zm9u
dCBjb2xvcj0iIzY2OTljYyI+PGI+otEguru5rrq4seI8L2I+PC9mb250PiA8L3RkPg0KCTx0
ZCB3aWR0aD0iNTYiPg0KCTxGT1JNIE1FVEhPRD1QT1NUIEFDVElPTj0iaHR0cDovL21haWx0
aW1lcy5uZXQvc2FtcGxlL2F1ZGlvLmFzcD9ub3dkYXk9MjAwMS0wOS0xOCZ0Yj1sZWN0dXJl
X2VuZ2xpc2gmbnVtPTEmY29kZT1kaWFsb2d1ZV9hdWRpbyZ0dD0wMCIgdGFyZ2V0PSJhdWRp
byIgbmFtZT0iZW5nbGlzaF8yIj4NCgk8aW5wdXQgdHlwZT0iaW1hZ2UiIHNyYz0iaHR0cDov
L21haWx0aW1lcy5uZXQvc2FtcGxlL2ltYWdlcy9idXR0b25fbGlzdGVuLmdpZiIgd2lkdGg9
IjU2IiBoZWlnaHQ9IjE5IiBib3JkZXI9IjAiPg0KICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICA8L2Zvcm0+DQoNCgk8L3RkPjwvRk9STT4NCgk8L3RyPg0KCTx0cj4gDQoJPHRk
IGNvbHNwYW49IjIiIGNsYXNzPSJ0cmFucyI+PGZvbnQgY29sb3I9IiM2NjY2NjYiIHNpemU9
IjMiPkE6IFRoaXMgaXMgdGhlIGxhdGVzdCBpbiBzd2ltd2Vhci4gPGJyPiAgIA0KQjogV2hh
dCBjb2xvcnMgZG8geW91IGhhdmU/ICA8YnI+DQpBOiBCZXNpZGVzIHRoaXMgb25lIGluIGJs
YWNrLCB3ZSBoYXZlIHJlZCwgYmx1ZSBhbmQgZ3JlZW4uIDxicj4NCkI6IENhbiBJIHRyeSB0
aGlzIG9uZSBvbj88YnI+PC9mb250PjwvdGQ+DQoJPC90cj4NCgk8L3RhYmxlPg0KPGltZyBz
cmM9Imh0dHA6Ly9tYWlsdGltZXMubmV0L3NhbXBsZS9pbWFnZXMvaG1fbGluZTEuZ2lmIiB3
aWR0aD0iNTU3IiBoZWlnaHQ9IjEiPjxicj4NCgk8dGFibGUgd2lkdGg9IjU1NyIgYm9yZGVy
PSIwIiBjZWxsc3BhY2luZz0iMCIgY2VsbHBhZGRpbmc9IjUiPg0KCTx0cj4gDQoJPHRkIGNs
YXNzPSJ0cmFuc18xIj48Zm9udCBjb2xvcj0iIzY2OTljYyI+PGI+otEgx9i8rrq4seI8L2I+
PC9mb250PiA8L3RkPg0KCTwvdHI+DQoJPHRyPiANCgk8dGQgY2xhc3M9InRyYW5zIj48Zm9u
dCBjb2xvcj0iIzY2NjY2NiI+QSA6IMDMsM3AzCC/7LiusKEgsKHB9rDtIMDWtMIgw9a9xSC8
9r+1urnAzL+hv+QuIDxicj4NCkIgOiC79rvzwLogvu62siCw1CDA1rOqv+Q/PGJyPg0KQSA6
ILDLwLq79sDOIMDMsM0guLuw7SC7obCjILv2LCDGxLb1u/YsIMPKt8+79sDMIMDWvu6/5C4g
PGJyPg0KQiA6IMGmsKEgwMywzSDH0SC5+CDA1L7uusG1tSC1ybHuv+Q/PC9mb250Pg0KPC90
ZD4NCg0KCTwvdHI+DQoJPC90YWJsZT4NCjxpbWcgc3JjPSJodHRwOi8vbWFpbHRpbWVzLm5l
dC9zYW1wbGUvaW1hZ2VzL2htX2xpbmUxLmdpZiIgd2lkdGg9IjU1NyIgaGVpZ2h0PSIxIj48
YnI+DQoJPHRhYmxlIHdpZHRoPSI1NTciIGJvcmRlcj0iMCIgY2VsbHNwYWNpbmc9IjAiIGNl
bGxwYWRkaW5nPSI4IiBiZ2NvbG9yPSIjRjNGM0VEIj4NCgk8dHI+IA0KCTx0ZD48cCBzdHls
ZT0ibGluZS1oZWlnaHQ6MTUwJTsgbWFyZ2luLXRvcDowOyBtYXJnaW4tYm90dG9tOjA7Ij4n
v8rAuyDH0SC5+CDA1L7uuri02Se287TCIA0Kx6XH9sC6ICd0cnkgb24nwNS0z7TZLiA8L3A+
DQo8cCBzdHlsZT0ibGluZS1oZWlnaHQ6MTUwJTsgbWFyZ2luLXRvcDowOyBtYXJnaW4tYm90
dG9tOjA7Ij4ndHJ5IHRvJ7TCICez67fCx8+02SfAzLDtIA0KJ3RyeSB+IGluZye0wiAnvcPH
6LvvvsYgfsfPtNkntvO0wiC25sDMwfa/5C48L3A+DQo8cCBzdHlsZT0ibGluZS1oZWlnaHQ6
MTUwJTsgbWFyZ2luLXRvcDowOyBtYXJnaW4tYm90dG9tOjA7Ij4gJm5ic3A7PC9wPg0KPHAg
c3R5bGU9ImxpbmUtaGVpZ2h0OjE1MCU7IG1hcmdpbi10b3A6MDsgbWFyZ2luLWJvdHRvbTow
OyI+od4gPGI+c3dpbXdlYXI8L2I+IA0KJm5ic3A7vPa/tbq5ICZuYnNwOyZuYnNwOyZuYnNw
OyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNw
OzwvcD4NCjxwIHN0eWxlPSJsaW5lLWhlaWdodDoxNTAlOyBtYXJnaW4tdG9wOjA7IG1hcmdp
bi1ib3R0b206MDsiPqHeIDxiPmJlc2lkZXM8L2I+IA0KJm5ic3A7sNS02bChLCCx17nbv6E8
L3A+DQo8cCBzdHlsZT0ibGluZS1oZWlnaHQ6MTUwJTsgbWFyZ2luLXRvcDowOyBtYXJnaW4t
Ym90dG9tOjA7Ij6h3iA8Yj50cnkgb248L2I+IA0KJm5ic3A7fsC7IMfRILn4IMDUvu66uLTZ
LjwvdGQ+DQoJPC90cj4NCgk8L3RhYmxlPg0KPC90ZD4NCiAgICAgICAgICAgICAgICAgICAg
PHRkPjwvdGQ+DQo8L3RyPg0KPCEtLb/AtMPAxyC/tb7uIMfRuLa18CCzoS0tPg0KCQ0KPCEt
LcDPvu63ziC/9L7uv+QuIL3DwNstLT4NCjx0cj4gDQo8dGQ+IA0KCTx0YWJsZSB3aWR0aD0i
NTU3IiBib3JkZXI9IjAiIGNlbGxzcGFjaW5nPSIwIiBjZWxscGFkZGluZz0iMCIgYmdjb2xv
cj0iQzFDMUMxIj4NCgk8dHI+IA0KCTx0ZCB3aWR0aD0iNDkwIj48aW1nIHNyYz0iaHR0cDov
L21haWx0aW1lcy5uZXQvc2FtcGxlL2ltYWdlcy9obV90aXRsZTA2LmdpZiIgd2lkdGg9IjEz
MiIgaGVpZ2h0PSIzNSI+PC90ZD4NCgk8dGQgd2lkdGg9IjY3Ij4NCgk8Rk9STSBNRVRIT0Q9
UE9TVCBBQ1RJT049Imh0dHA6Ly9tYWlsdGltZXMubmV0L3NhbXBsZS9hdWRpby5hc3A/bm93
ZGF5PTIwMDEtMDktMTgmdGI9bGVjdHVyZV9qaHVtZXImbnVtPTEmY29kZT1hdWRpbyZ0dD0w
MCIgdGFyZ2V0PSJhdWRpbyIgbmFtZT0iamh1bWVyXzEiPg0KCTxpbnB1dCB0eXBlPSJpbWFn
ZSIgc3JjPSJodHRwOi8vbWFpbHRpbWVzLm5ldC9zYW1wbGUvaW1hZ2VzL2J1dHRvbl9saXN0
ZW4uZ2lmIiB3aWR0aD0iNTYiIGhlaWdodD0iMTkiIGJvcmRlcj0iMCI+DQogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Zvcm0+DQoNCgk8L3RkPjwvRk9STT4NCgk8
L3RyPg0KCTwvdGFibGU+DQo8aW1nIHNyYz0iaHR0cDovL21haWx0aW1lcy5uZXQvc2FtcGxl
L2ltYWdlcy9obV9saW5lLmdpZiIgd2lkdGg9IjU1NyIgaGVpZ2h0PSIxIj48YnI+DQoJPHRh
YmxlIHdpZHRoPSIxMDAlIiBib3JkZXI9IjAiIGNlbGxzcGFjaW5nPSIwIiBjZWxscGFkZGlu
Zz0iNSI+DQoJPHRyPiANCgk8dGQgY2xhc3M9InRpdGxlIj48Zm9udCBjb2xvcj0iIzAwOTlm
ZiI+PGI+osMg3NbiwjwvYj48L2ZvbnQ+PC90ZD4NCgk8L3RyPg0KCTwvdGFibGU+DQo8aW1n
IHNyYz0iaHR0cDovL21haWx0aW1lcy5uZXQvc2FtcGxlL2ltYWdlcy9obV9saW5lLmdpZiIg
d2lkdGg9IjU1NyIgaGVpZ2h0PSIxIj48YnI+DQoJPHRhYmxlIHdpZHRoPSIxMDAlIiBib3Jk
ZXI9IjAiIGNlbGxzcGFjaW5nPSIwIiBjZWxscGFkZGluZz0iNSI+DQoJPHRyPiANCgk8dGQg
Y2xhc3M9InRyYW5zXzEiPjxmb250IGNvbG9yPSIjNjY5OWNjIj48Yj6i0SC6u7muurix4jwv
Yj48L2ZvbnQ+PC90ZD4NCgk8L3RyPg0KCTx0cj4gDQoJPHRkIGNsYXNzPSJ0cmFucyI+PHAg
c3R5bGU9ImxpbmUtaGVpZ2h0OjE1MCU7IG1hcmdpbi10b3A6MDsgbWFyZ2luLWJvdHRvbTow
OyI+PGZvbnQgY29sb3I9IiM2NjY2NjYiIHNpemU9IjMiPu+j8ekgOiDfo++jqq+q86OsIA0K
+bwoqsqq8ymqzjxmb250IGNvbG9yPSJyZWQiPvrrKKqiqsopPC9mb250PqOsPGZvbnQgY29s
b3I9InJlZCI+z94oqtspPC9mb250PqrDqsaqpKrrqs4/IA0KJm5ic3A7Jm5ic3A7Jm5ic3A7
Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7PC9mb250PjwvcD4N
CjxwIHN0eWxlPSJsaW5lLWhlaWdodDoxNTAlOyBtYXJnaW4tdG9wOjA7IG1hcmdpbi1ib3R0
b206MDsiPjxmb250IGNvbG9yPSIjNjY2NjY2IiBzaXplPSIzIj7fo++jIDogqqIhIO+j8emq
r6rzo6wgDQo8Zm9udCBjb2xvcj0icmVkIj6qpqrBqs7Q3eXgKKqtqvOqrqrnKTwvZm9udD6q
zjxmb250IGNvbG9yPSJyZWQiPqqq2dcoqs+qqyk8L2ZvbnQ+qsqq86rAo648L2ZvbnQ+PC9w
Pg0KPHAgc3R5bGU9ImxpbmUtaGVpZ2h0OjE1MCU7IG1hcmdpbi10b3A6MDsgbWFyZ2luLWJv
dHRvbTowOyI+PGZvbnQgY29sb3I9IiM2NjY2NjYiIHNpemU9IjMiPu+j8ekgOiCqx6rio6zQ
3eXgKKqtqvOqrqrnKarOqqrZ1yiqz6qrKarLqreqwarjo6yqvarOIA0K+usoqqKqyiksPC9m
b250PjwvcD4NCjxwIHN0eWxlPSJsaW5lLWhlaWdodDoxNTAlOyBtYXJnaW4tdG9wOjA7IG1h
cmdpbi1ib3R0b206MDsiPjxmb250IGNvbG9yPSIjNjY2NjY2IiBzaXplPSIzIj4mbmJzcDsm
bmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDs8Zm9udCBj
b2xvcj0icmVkIj7T3iiqqqqqKaqtqrmqrqrrPC9mb250Pqroo648L2ZvbnQ+PC9wPg0KPHAg
c3R5bGU9ImxpbmUtaGVpZ2h0OjE1MCU7IG1hcmdpbi10b3A6MDsgbWFyZ2luLWJvdHRvbTow
OyI+PGZvbnQgY29sb3I9IiM2NjY2NjYiIHNpemU9IjMiPt+j76MgOiA8Zm9udCBjb2xvcj0i
cmVkIj7ewtuwKKq3qquqvymqyqqkPC9mb250Pqroo648L2ZvbnQ+PC9wPg0KPHAgc3R5bGU9
ImxpbmUtaGVpZ2h0OjE1MCU7IG1hcmdpbi10b3A6MDsgbWFyZ2luLWJvdHRvbTowOyI+PGZv
bnQgY29sb3I9IiM2NjY2NjYiIHNpemU9IjMiPiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZu
YnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwO6qmqsGqztDd5eAoqq2q86ququcpqqyjrO+j
8emqr6rzqs48Zm9udCBjb2xvcj0icmVkIj6rzauzPC9mb250PqrO8ekoqsqqqymqyzxmb250
IGNvbG9yPSJyZWQiPuz9PC9mb250PjwvZm9udD48L3A+DQo8cCBzdHlsZT0ibGluZS1oZWln
aHQ6MTUwJTsgbWFyZ2luLXRvcDowOyBtYXJnaW4tYm90dG9tOjA7Ij48Zm9udCBjb2xvcj0i
IzY2NjY2NiIgc2l6ZT0iMyI+PGZvbnQgY29sb3I9InJlZCI+Jm5ic3A7Jm5ic3A7Jm5ic3A7
Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7KKrPqqQpPC9mb250PqrDqr+q
3qreqsCqq6rpo648L2ZvbnQ+IA0KPC9wPjwvdGQ+DQoJPC90cj4NCgk8L3RhYmxlPg0KPGlt
ZyBzcmM9Imh0dHA6Ly9tYWlsdGltZXMubmV0L3NhbXBsZS9pbWFnZXMvaG1fbGluZS5naWYi
IHdpZHRoPSI1NTciIGhlaWdodD0iMSI+PGJyPg0KCTx0YWJsZSB3aWR0aD0iMTAwJSIgYm9y
ZGVyPSIwIiBjZWxsc3BhY2luZz0iMCIgY2VsbHBhZGRpbmc9IjUiPg0KCTx0cj4gDQoJPHRk
IGNsYXNzPSJ0cmFuc18xIj48Zm9udCBjb2xvcj0iIzY2OTljYyI+PGI+otEgx9i8rrq4seI8
L2I+PC9mb250PjwvdGQ+DQoJPC90cj4NCgk8dHI+IA0KCTx0ZCBjbGFzcz0idHJhbnMiPjxm
b250IGNvbG9yPSIjNjY2NjY2Ij602bOqse4gOiC+37i2tNmxuiwguau9vCCxuLjbwLsgxsSw
7SDA1rTPPyA8YnI+DQq+37i2tNkgOiC+xiEgtNmzqrHusbosIL/suK4gwf0gsd262L7uILmr
tP3AzL7fLiA8YnI+DQq02bOqse4gOiCx18ShuLgsILHduti+7iC5q7T9xKGw7ywgsdcgsbi4
2ywgs8q5q8WptNkuIDxicj4NCr7fuLa02SA6IL7uwr8gvPYgvvi+7i4gv+y4rsH9ILHduti+
7rChILPKyPHB/SCw7b7nwMwgue6807+hILXpvu7A1rDFtecuPC9mb250Pg0KPC90ZD4NCgk8
L3RyPg0KCTwvdGFibGU+DQo8aW1nIHNyYz0iaHR0cDovL21haWx0aW1lcy5uZXQvc2FtcGxl
L2ltYWdlcy9obV9saW5lMS5naWYiIHdpZHRoPSI1NTciIGhlaWdodD0iMSI+PGJyPg0KCTx0
YWJsZSB3aWR0aD0iNTU3IiBib3JkZXI9IjAiIGNlbGxzcGFjaW5nPSIwIiBjZWxscGFkZGlu
Zz0iNSIgYmdjb2xvcj0iI0YzRjNFRCI+DQoJPHRyPiANCgk8dGQ+PHAgc3R5bGU9ImxpbmUt
aGVpZ2h0OjE1MCU7IG1hcmdpbi10b3A6MDsgbWFyZ2luLWJvdHRvbTowOyI+od4gPGI+3Nbi
wiiq1aqvqreq5aqmKTwvYj4gDQombmJzcDu6ubz2PC9wPg0KPHAgc3R5bGU9ImxpbmUtaGVp
Z2h0OjE1MCU7IG1hcmdpbi10b3A6MDsgbWFyZ2luLWJvdHRvbTowOyI+od4gPGI++usoqqKq
yik8L2I+IA0KJm5ic3A7sbi42zwvcD4NCjxwIHN0eWxlPSJsaW5lLWhlaWdodDoxNTAlOyBt
YXJnaW4tdG9wOjA7IG1hcmdpbi1ib3R0b206MDsiPqHeIDxiPs/eKKrbKarrPC9iPiANCiZu
YnNwO8bEtNk8L3A+DQo8cCBzdHlsZT0ibGluZS1oZWlnaHQ6MTUwJTsgbWFyZ2luLXRvcDow
OyBtYXJnaW4tYm90dG9tOjA7Ij6h3iA8Yj6qpqrBqs5+PC9iPiANCiZuYnNwOyZuYnNwO7/s
uK4owf0pfjwvcD4NCjxwIHN0eWxlPSJsaW5lLWhlaWdodDoxNTAlOyBtYXJnaW4tdG9wOjA7
IG1hcmdpbi1ib3R0b206MDsiPqHeIDxiPtDd5eAoqq2q86ququcpPC9iPiANCiZuYnNwO7Hd
uti+7jwvcD4NCjxwIHN0eWxlPSJsaW5lLWhlaWdodDoxNTAlOyBtYXJnaW4tdG9wOjA7IG1h
cmdpbi1ib3R0b206MDsiPqHeIDxiPqqq2dcoqs+qqyk8L2I+IA0KJm5ic3A7uau0/TwvcD4N
CjxwIHN0eWxlPSJsaW5lLWhlaWdodDoxNTAlOyBtYXJnaW4tdG9wOjA7IG1hcmdpbi1ib3R0
b206MDsiPqHeIDxiPtPeKKqqqqopqq2quaququsooefT3qqtqqQpPC9iPiANCiZuYnNwO7PK
uavFqbTZLjwvcD4NCjxwIHN0eWxlPSJsaW5lLWhlaWdodDoxNTAlOyBtYXJnaW4tdG9wOjA7
IG1hcmdpbi1ib3R0b206MDsiPqHeIDxiPt7C27Aoqreqq6q/KarKqqQ8L2I+IA0KJm5ic3A7
vu7CvyC89iC++LTZLjwvcD4NCjxwIHN0eWxlPSJsaW5lLWhlaWdodDoxNTAlOyBtYXJnaW4t
dG9wOjA7IG1hcmdpbi1ib3R0b206MDsiPqHeIDxiPqrNqrM8L2I+ICZuYnNwO7DtvufAzDwv
cD4NCjxwIHN0eWxlPSJsaW5lLWhlaWdodDoxNTAlOyBtYXJnaW4tdG9wOjA7IG1hcmdpbi1i
b3R0b206MDsiPqHeIDxiPuz9KKrPqqQpqus8L2I+IA0KJm5ic3A7tem+7rChtNkuPC9wPjwv
dGQ+DQoJPC90cj4NCgk8L3RhYmxlPg0KPC90ZD4NCiAgICAgICAgICAgICAgICAgICAgPHRk
PjwvdGQ+DQo8L3RyPg0KPCEtLcDPvu63ziC/9L7uv+QuILOhLS0+DQoJDQo8IS0tquyqx6q3
queqpiC9w8DbLS0+DQo8dHI+IA0KPHRkPiANCgk8dGFibGUgd2lkdGg9IjU1NyIgYm9yZGVy
PSIwIiBjZWxsc3BhY2luZz0iMCIgY2VsbHBhZGRpbmc9IjAiIGJnY29sb3I9IkMxQzFDMSI+
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1138 *
Subject:  round() doesnt
From: David Brahm  <a215020@onyx.fmr.com>
Date: Mon, 22 Oct 2001 18:08:50 -0400 (EDT)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1138 <==
From postmaster@franz.stat.wisc.edu  Tue Oct 23 00:09:20 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id AAA11663
	for <r-bugs@biostat.ku.dk>; Tue, 23 Oct 2001 00:09:19 +0200 (MET DST)
Received: from gw16i.fmr.com (really [192.223.252.80]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m15vnG0-000JL0C@franz.stat.wisc.edu> (Debian Smail3.2.0.114)
	for <r-bugs@r-project.org>; Mon, 22 Oct 2001 17:09:16 -0500 (CDT) 
Received: (from smtp@localhost)
	by gw16i.fmr.com (8.8.7/8.8.7) id SAA17669
	for <r-bugs@r-project.org>; Mon, 22 Oct 2001 18:09:07 -0400 (EDT)
Received: from unknown(172.26.5.98) by gw16i.fmr.com via smap (V2.0)
	id xma017597; Mon, 22 Oct 01 18:08:51 -0400
Received: from arbprod.fmr.com (arbproda.fmr.com [155.1.103.75]) by msgmmk102nts.fmr.com with SMTP (Microsoft Exchange Internet Mail Service Version 5.5.2654.89)
	id 44XHDSB4; Mon, 22 Oct 2001 18:08:50 -0400
Received: (from a215020@localhost)
	by arbprod.fmr.com (8.11.1/8.11.1) id f9MM8oP21905;
	Mon, 22 Oct 2001 18:08:50 -0400 (EDT)
Date: Mon, 22 Oct 2001 18:08:50 -0400 (EDT)
From: David Brahm  <a215020@onyx.fmr.com>
Message-Id: <200110222208.f9MM8oP21905@arbprod.fmr.com>
Reply-to: brahm@alum.mit.edu
To: <>, R.bug.report@arbprod.fmr.com, 2/dev/null@arbprod.fmr.com,
        -c@arbprod.fmr.com, a215020@arbprod.fmr.com, r-bugs@r-project.org
Subject:  round() doesnt


==> 1138.reply.1 <==
From p.dalgaard@biostat.ku.dk  Tue Oct 23 01:20:26 2001
Received: from stat.math.ethz.ch (daemon@hypatia.ethz.ch [129.132.58.23])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id BAA12036
	for <R-bugs@biostat.ku.dk>; Tue, 23 Oct 2001 01:20:25 +0200 (MET DST)
Received: (from daemon@localhost)
	by stat.math.ethz.ch (8.9.1/8.9.1) id BAA21515
	for <r-bugs@stat.math.ethz.ch>; Tue, 23 Oct 2001 01:20:12 +0200 (MET DST)
Received: from mail.kubism.ku.dk(130.225.108.10), claiming to be "pubhealth.ku.dk"
 via SMTP by hypatia, id smtpdAAAa005G9; Tue Oct 23 01:20:05 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id BAA12030;
	Tue, 23 Oct 2001 01:19:40 +0200 (MET DST)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.11.2/8.11.2) id f9MNJkB16721;
	Tue, 23 Oct 2001 01:19:46 +0200
X-Authentication-Warning: blueberry.kubism.ku.dk: pd set sender to p.dalgaard@biostat.ku.dk using -f
Sender: pd@pubhealth.ku.dk
To: Thomas Lumley <tlumley@u.washington.edu>
Cc: <brahm@alum.mit.edu>, <r-bugs@stat.math.ethz.ch>
Subject: Re: [Rd] round() doesnt (PR#1138)
References: <Pine.A41.4.33.0110221551430.144652-100000@homer03.u.washington.edu>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 23 Oct 2001 01:19:46 +0200
In-Reply-To: <Pine.A41.4.33.0110221551430.144652-100000@homer03.u.washington.edu>
Message-ID: <x2y9m3dzzh.fsf@blueberry.kubism.ku.dk>
Lines: 44
User-Agent: Gnus/5.0808 (Gnus v5.8.8) Emacs/20.7
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

Thomas Lumley <tlumley@u.washington.edu> writes:

> On Mon, 22 Oct 2001, David Brahm wrote:
> 
> > Hi, all,
> >
> >    I swear, bug.report() ate my message!  Apologies to all, esp. Peter who
> > will once again have to clean up after my mess...
> >
> >    The bug report was supposed to say:
> >
> > R> round(100000/3, -2) - 33300
> >    [1] -7.275958e-12
> >
> > I would have hoped for 0.  The problem seems to be specifically for negative
> > "digits".
> > 			-- David Brahm (brahm@alum.mit.edu)
> >
> > Version:
> >  platform = sparc-sun-solaris2.6
> >  arch = sparc
> >  os = solaris2.6
> >  system = sparc, solaris2.6
> >  status =
> >  major = 1
> >  minor = 3.0
> 
> ^^^^^^^^
> I can duplicate this under Windows R1.3.0 but not Debian R1.3.1, so it may
> have been fixed.  Looking at the changes to arithmetic.c I don't see why,
> though.

It's an accuracy issue, still there in 1.3.1 for Solaris 7. Basically,
dividing by 10^-2 does not always give an integer on SPARC, so we
should be more careful with the logic in fround.c. Beats me why it
would act up on windows, but, well, ...

[Cc: to r-bugs so that we get it filed properly]

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1139 *
Subject: round() doesn't
From: David Brahm  <a215020@agate.fmr.com>
Date: Mon, 22 Oct 2001 19:15:13 -0400 (EDT)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1139 <==
From a215020@agate.fmr.com  Tue Oct 23 01:15:38 2001
Received: from gw34i.fmr.com (gw34e.fmr.com [192.223.207.76])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id BAA11985
	for <R-bugs@biostat.ku.dk>; Tue, 23 Oct 2001 01:15:37 +0200 (MET DST)
Received: (from smtp@localhost)
	by gw34i.fmr.com (8.8.7/8.8.7) id TAA08525
	for <R-bugs@biostat.ku.dk>; Mon, 22 Oct 2001 19:15:34 -0400 (EDT)
Received: from unknown(172.25.107.117) by gw34i.fmr.com via smap (V2.0)
	id xma008482; Mon, 22 Oct 01 19:15:14 -0400
Received: from arbres1a.fmr.com ([155.1.103.77]) by msgmmk102nts.fmr.com with SMTP (Microsoft Exchange Internet Mail Service Version 5.5.2654.89)
	id 44XHD460; Mon, 22 Oct 2001 19:15:13 -0400
Received: (from a215020@localhost)
	by arbres1a.FMR.Com (8.11.1/8.11.1) id f9MNFDV23550
	for R-bugs@biostat.ku.dk; Mon, 22 Oct 2001 19:15:13 -0400 (EDT)
Date: Mon, 22 Oct 2001 19:15:13 -0400 (EDT)
From: David Brahm  <a215020@agate.fmr.com>
Message-Id: <200110222315.f9MNFDV23550@arbres1a.FMR.Com>
Reply-to: a215020@agate.fmr.com
To: R-bugs@biostat.ku.dk
Subject: round() doesn't

R> round(100000/3, -2) - 33300
   [1] -7.275958e-12

I would have hoped for 0.  The problem seems to be specifically for negative
"digits".  This is in 1.3.1 on Solaris 2.6 (full description at bottom).

[Apologies for making everyone read this 3 times; my bug.report() burped.]

Peter Dalgaard <p.dalgaard@biostat.ku.dk> says the problem is in fround.c,
which reads in part:
    pow10 = R_pow_di(10., dig)
    ...
    return sgn * (intx + R_rint(x * pow10) / pow10);
and (says Peter),
> the problem is most likely that pow10 (== 1/100) has no finite binary
> representation. Patches are welcome...

I'm not up to patching C code, but I will say that a workaround is:
R> round(round(100000/3, -2)) - 33300
   [1] 0
and a smarter C-programmer could probably implement this concept:
if digits < 0, force the final result to an integer.

			-- David Brahm (brahm@alum.mit.edu)

Version:
 platform = sparc-sun-solaris2.6
 arch = sparc
 os = solaris2.6
 system = sparc, solaris2.6
 status = 
 major = 1
 minor = 3.0
 year = 2001
 month = 06
 day = 22
 language = R

Search Path:
 .GlobalEnv, package:misc, package:io, package:arrays, package:ls1, package:db, package:ts, package:ctest, Autoloads, package:base

==> 1139.followup.1 <==
From postmaster@franz.stat.wisc.edu  Wed Oct 24 20:52:38 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id UAA10208
	for <r-bugs@biostat.ku.dk>; Wed, 24 Oct 2001 20:52:37 +0200 (MET DST)
Received: from gw35i.fmr.com (really [192.223.207.77]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m15wT8h-000JJ6C@franz.stat.wisc.edu> (Debian Smail3.2.0.114)
	for <r-bugs@r-project.org>; Wed, 24 Oct 2001 13:52:31 -0500 (CDT) 
Received: (from smtp@localhost)
	by gw35i.fmr.com (8.8.7/8.8.7) id OAA00046
	for <r-bugs@r-project.org>; Wed, 24 Oct 2001 14:52:27 -0400 (EDT)
Received: from unknown(172.26.5.98) by gw35i.fmr.com via smap (V2.0)
	id xma026252; Wed, 24 Oct 01 14:47:10 -0400
Received: from arbres1a.fmr.com ([155.1.103.77]) by msgmmk102nts.fmr.com with SMTP (Microsoft Exchange Internet Mail Service Version 5.5.2654.89)
	id 44XHJYP3; Wed, 24 Oct 2001 14:47:09 -0400
Received: (from a215020@localhost)
	by arbres1a.FMR.Com (8.11.1/8.11.1) id f9OIl8G13960
	for r-bugs@r-project.org; Wed, 24 Oct 2001 14:47:08 -0400 (EDT)
Date: Wed, 24 Oct 2001 14:47:08 -0400 (EDT)
From: David Brahm  <a215020@agate.fmr.com>
Message-Id: <200110241847.f9OIl8G13960@arbres1a.FMR.Com>
Reply-to: brahm@alum.mit.edu
To: r-bugs@r-project.org
Subject: Re: [Rd] round() doesn't (PR#1139)

I reported this bug:
> R> round(100000/3, -2) - 33300
>    [1] -7.275958e-12

Peter Dalgaard <p.dalgaard@biostat.ku.dk> pointed out the problem is in
nmath/fround.c and said
> Patches are welcome...
so here goes!  I've only tested it stand-alone, not compiled into the full R
system.  I handle the 3 cases dig=0, dig>0, and dig<0 separately, and note I
avoid a call to R_pow_di altogether in the common case of dig=0.  Hope this is
useful.
			 -- David Brahm (brahm@alum.mit.edu)


double fround(double x, double digits) {
#define MAX_DIGITS DBL_MAX_10_EXP
    /* = 308 (IEEE); was till R 0.99: (DBL_DIG - 1) */
    /* Note that large digits make sense for very small numbers */
    double pow10, sgn, intx;
    int dig;

#ifdef IEEE_754
    if (ISNAN(x) || ISNAN(digits))
	return x + digits;
    if(!R_FINITE(x)) return x;
#endif

    if (digits > MAX_DIGITS)
	digits = MAX_DIGITS;
    dig = (int)floor(digits + 0.5);
    if(x < 0.) {
	sgn = -1.;
	x = -x;
    } else
	sgn = 1.;
    if (dig == 0) {
      return sgn * R_rint(x);
    } else if (dig > 0) {
        pow10 = R_pow_di(10., dig);
	intx = floor(x);
	return sgn * (intx + R_rint((x-intx) * pow10) / pow10);
    } else {
        pow10 = R_pow_di(10., -dig);
        return sgn * R_rint(x/pow10) * pow10;
    }
}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1140 *
Subject: Possible bug, Rprof() and scan(pipe())
From: Don MacQueen <macq@llnl.gov>
Date: Tue, 23 Oct 2001 13:50:26 -0700
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1140 <==
From macq@llnl.gov  Tue Oct 23 22:51:03 2001
Received: from smtp-2.llnl.gov (smtp-2.llnl.gov [128.115.250.82])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id WAA27064
	for <r-bugs@biostat.ku.dk>; Tue, 23 Oct 2001 22:51:02 +0200 (MET DST)
Received: from [128.115.153.6] (localhost [127.0.0.1])
	by smtp-2.llnl.gov (8.9.3/8.9.3/LLNL-gateway-1.0) with ESMTP id NAA16321
	for <r-bugs@biostat.ku.dk>; Tue, 23 Oct 2001 13:50:23 -0700 (PDT)
Mime-Version: 1.0
X-Sender: e556558@popgun.llnl.gov
Message-Id: <p05101015b7fb820c1d22@[128.115.153.6]>
Date: Tue, 23 Oct 2001 13:50:26 -0700
To: r-bugs@biostat.ku.dk
From: Don MacQueen <macq@llnl.gov>
Subject: Possible bug, Rprof() and scan(pipe())
Content-Type: text/plain; charset="us-ascii" ; format="flowed"

This looks like a bug?
Unable to use scan(pipe()) while profiling.
I have no idea whether this version of R violates the
    "do not use `Rprof' in an executable built for profiling"
warning in ?Rprof.

Thanks
-Don

>  version
          _
platform powerpc-apple-darwin1.4
arch     powerpc
os       darwin1.4
system   powerpc, darwin1.4
status   Patched
major    1
minor    3.1
year     2001
month    10
day      15
language R
>
>  foo <- scan(pipe('ls -1 | head -3'),what='')
Read 3 items
>  foo
[1] "README"      "RMfiles.dat" "RMfiles.tmp"
>  Rprof()
>  foo <- scan(pipe('ls -1 | head -3'),what='')
Read 0 items
>  foo
character(0)
>  Rprof(NULL)
>  foo <- scan(pipe('ls -1 | head -3'),what='')
Read 3 items
>

note, profiling does appear to be functional:
>  Rprof() ; hist(rnorm(10000)) ; Rprof(NULL)
>  system('R CMD Rprof Rprof.out')

Each sample represents 0.02 seconds.
Total run time: 0.1 seconds.

Total seconds: time spent in function and callees.
Self seconds: time spent in function alone.

    %       total       %       self
  total    seconds     self    seconds    name
100.00      0.10      0.00      0.00     "hist"
  60.00      0.06      0.00      0.00     "hist.default"
  40.00      0.04     40.00      0.04     "rnorm"
  40.00      0.04      0.00      0.00     "plot"
  40.00      0.04      0.00      0.00     "plot.histogram"
  20.00      0.02      0.00      0.00     "storage.mode<-"
  20.00      0.02     20.00      0.02     "X11"
  20.00      0.02      0.00      0.00     "paste"
  20.00      0.02      0.00      0.00     "rect"
  20.00      0.02      0.00      0.00     "plot.new"
  20.00      0.02     20.00      0.02     "seq.default"
  20.00      0.02      0.00      0.00     "seq"
  20.00      0.02     20.00      0.02     "par"

    %       self        %       total
  self     seconds    total    seconds    name
  40.00      0.04     40.00      0.04     "rnorm"
  20.00      0.02     20.00      0.02     "X11"
  20.00      0.02     20.00      0.02     "seq.default"
  20.00      0.02     20.00      0.02     "par"

-- 
--------------------------------------
Don MacQueen
Environmental Protection Department
Lawrence Livermore National Laboratory
Livermore, CA, USA
--------------------------------------
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1141 *
Subject: broken build with LDFLAGS
From: dks@phy.hr
Date: Wed, 24 Oct 2001 11:28:09 +0200 (MET DST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1141 <==
From dks@phy.hr  Wed Oct 24 11:28:10 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id LAA02199
	for <R-bugs@biostat.ku.dk>; Wed, 24 Oct 2001 11:28:09 +0200 (MET DST)
Date: Wed, 24 Oct 2001 11:28:09 +0200 (MET DST)
From: dks@phy.hr
Message-Id: <200110240928.LAA02199@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: broken build with LDFLAGS

Full_Name: Denis Sunko
Version: 1.3.1
OS: HP-UX 11.0
Submission from: (NULL) (161.53.2.114)


I invoked configure by

env LDFLAGS=/opt/fortran90/lib ./configure --with-f77=f90

Problem: although configure completed to (its own) satisfaction, the LDFLAGS
information was not propagated everywhere; I had to change the line

PKG_LIBS =   -l:libF90.a -lcl -lisamstub

to

PKG_LIBS =   -L/opt/fortran90/lib -l:libF90.a -lcl -lisamstub

in the files

src/library/ctest/src/Makefile
src/library/modreg/src/Makefile
src/library/mva/src/Makefile
src/library/ts/src/Makefile

by hand.

------
On the wish-list level (not really a bug): it would be nice if configure broke
with a less cryptic message than `f90 and gcc do not agree on int and double',
when all that happens is that it cannot find the fortran library. I suggest
putting -l:libF90.a on the compiler line of a previous (dummy) test program,
just to check for this.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1142 *
Subject: incompletely built html documentation
From: dks@phy.hr
Date: Wed, 24 Oct 2001 11:45:47 +0200 (MET DST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1142 <==
From dks@phy.hr  Wed Oct 24 11:45:47 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id LAA02660
	for <R-bugs@biostat.ku.dk>; Wed, 24 Oct 2001 11:45:47 +0200 (MET DST)
Date: Wed, 24 Oct 2001 11:45:47 +0200 (MET DST)
From: dks@phy.hr
Message-Id: <200110240945.LAA02660@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: incompletely built html documentation

Full_Name: Denis Sunko
Version: 1.3.1
OS: HP-UX 11.0
Submission from: (NULL) (161.53.2.114)


After building and installing R 1.3.1, i find some of the html files missing:

> ls -l /opt/lib/R/doc/manual/
total 0
-rw-r--r--   1 root       sys              0 Oct 17 22:16 R-FAQ.html
-rw-r--r--   1 root       sys              0 Oct 17 22:16 R-admin.html
-rw-r--r--   1 root       sys              0 Oct 17 22:16 R-data.html
-rw-r--r--   1 root       sys              0 Oct 17 22:16 R-exts.html
-rw-r--r--   1 root       sys              0 Oct 17 22:16 R-intro.html
-rw-r--r--   1 root       sys              0 Oct 17 22:16 R-lang.html

I can trace this to the lines

.texi.html:
        $(MAKEINFO) --no-split --html -I$(srcdir) $< -o $@ || touch $@

in the file

doc/manual/Makefile

where MAKEINFO is defined (in the same file)

MAKEINFO = false

(correctly, because I don't have the info system installed).

The html files for the packages are all built correctly. The final front
(index)
page for the html documentation also has broken links to various COPYING,
THANKS,
etc. pages.


==> 1142.reply.1 <==
From p.dalgaard@biostat.ku.dk  Wed Oct 24 12:05:08 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id MAA03016;
	Wed, 24 Oct 2001 12:05:07 +0200 (MET DST)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.11.2/8.11.2) id f9OA54219562;
	Wed, 24 Oct 2001 12:05:04 +0200
X-Authentication-Warning: blueberry.kubism.ku.dk: pd set sender to p.dalgaard@biostat.ku.dk using -f
Sender: pd@pubhealth.ku.dk
To: dks@phy.hr
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] incompletely built html documentation (PR#1142)
References: <200110240945.LAA02673@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 24 Oct 2001 12:05:04 +0200
In-Reply-To: <200110240945.LAA02673@pubhealth.ku.dk>
Message-ID: <x2g089qrov.fsf@blueberry.kubism.ku.dk>
Lines: 38
User-Agent: Gnus/5.0808 (Gnus v5.8.8) Emacs/20.7
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

dks@phy.hr writes:

> After building and installing R 1.3.1, i find some of the html files missing:
> 
> > ls -l /opt/lib/R/doc/manual/
> total 0
> -rw-r--r--   1 root       sys              0 Oct 17 22:16 R-FAQ.html
> -rw-r--r--   1 root       sys              0 Oct 17 22:16 R-admin.html
> -rw-r--r--   1 root       sys              0 Oct 17 22:16 R-data.html
> -rw-r--r--   1 root       sys              0 Oct 17 22:16 R-exts.html
> -rw-r--r--   1 root       sys              0 Oct 17 22:16 R-intro.html
> -rw-r--r--   1 root       sys              0 Oct 17 22:16 R-lang.html
> 
> I can trace this to the lines
> 
> .texi.html:
>         $(MAKEINFO) --no-split --html -I$(srcdir) $< -o $@ || touch $@
> 
> in the file
> 
> doc/manual/Makefile
> 
> where MAKEINFO is defined (in the same file)
> 
> MAKEINFO = false
> 
> (correctly, because I don't have the info system installed).

Well, those files are based on texinfo sources. Without the makeinfo
program you're not going to get them built...

(This is orthogonal to having the info *reader* system installed).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1143 *
Subject: Problem testing R version 1.3.1
From: Gordon Lack <gml4410@ggr.co.uk>
Date: Fri, 26 Oct 2001 16:42:21 +0100
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1143 <==
From postmaster@franz.stat.wisc.edu  Fri Oct 26 17:42:52 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id RAA02432
	for <r-bugs@biostat.ku.dk>; Fri, 26 Oct 2001 17:42:51 +0200 (MET DST)
Received: from gate1.ggr.co.uk (really [193.128.25.13]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m15x98B-000JH6C@franz.stat.wisc.edu> (Debian Smail3.2.0.114)
	for <r-bugs@r-project.org>; Fri, 26 Oct 2001 10:42:47 -0500 (CDT) 
Received: (uucp@localhost) by gate1.ggr.co.uk; Fri, 26 Oct 2001 16:42:25 +0100 (BST)
Received: from uk-stv-mhub1.ggr.co.uk(147.184.212.132) by gb-stv-fw3.ggr.co.uk via smap (V5.5)
	id xma006967; Fri, 26 Oct 01 16:42:01 +0100
Received: from ukwit01.ggr.co.uk (root@ukwit01.ggr.co.uk [147.184.219.175]) by mailhub.ggr.co.uk; Fri, 26 Oct 2001 16:42:22 +0100 (BST)
Received: from ggr.co.uk by ukwit01.ggr.co.uk (8.8.8/imd160294)
        id PAA138122; Fri, 26 Oct 2001 15:42:22 GMT
Sender: gml4410@ggr.co.uk
Message-ID: <3BD9845D.6010512F@ggr.co.uk>
Date: Fri, 26 Oct 2001 16:42:21 +0100
From: Gordon Lack <gml4410@ggr.co.uk>
Organization: Glaxo Wellcome
X-Mailer: Mozilla 4.78 [en] (X11; U; IRIX 6.5 IP32)
X-Accept-Language: en
MIME-Version: 1.0
To: r-bugs@r-project.org
Subject: Problem testing R version 1.3.1
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

   I have compiled R version 1.3.1 on a Linux system.  No errors or
warnings are reported.

  However, "make check" fails thus:

=====
make[5]: Leaving directory
`/proj/informatics-build/GML/R/R-1.3.1/src/library'
running code in base-Ex.R ...
../../bin/R --vanilla < base-Ex.R > base-Ex.Rout
make[4]: *** [base-Ex.Rout] Error 139
=====

   The base-Ex.Rout being produced at this point ends with:

=====
> ## 1-d tables
> (Poiss.tab <- table(N = rpois(200, lam= 5)))
N
 0  1  2  3  4  5  6  7  8  9 10 11 18
 1  4 14 21 46 40 24 14 19 11  3  2  1
=====

   Does anyone have any suggestions as to what the problem may be?


   The configuration parametsr used are:

environment parameters:

CC=gcc
CFLAGS=-O2
FC='g77 -L/usr/central/lib'
FFLAGS=-O2
CPPFLAGS=-I/usr/common/include
LIBS=-L/usr/central/lib

./configure --prefix=/proj/informatics-build/GML/R/Linux-ia32 \
   --without-readline --without-tcltk --without-gnome


(An equivalent build on an SGI Irix6.5 system also compiles, with
various warnings, but then fails to paas the checks either, but fails on
a later script).

==> 1143.reply.1 <==
From p.dalgaard@biostat.ku.dk  Fri Oct 26 17:58:56 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id RAA02568;
	Fri, 26 Oct 2001 17:58:55 +0200 (MET DST)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.11.2/8.11.2) id f9QFwfj04298;
	Fri, 26 Oct 2001 17:58:41 +0200
X-Authentication-Warning: blueberry.kubism.ku.dk: pd set sender to p.dalgaard@biostat.ku.dk using -f
Sender: pd@pubhealth.ku.dk
To: gml4410@ggr.co.uk
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] Problem testing R version 1.3.1 (PR#1143)
References: <200110261542.RAA02442@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 26 Oct 2001 17:58:40 +0200
In-Reply-To: <200110261542.RAA02442@pubhealth.ku.dk>
Message-ID: <x2snc6o0jz.fsf@blueberry.kubism.ku.dk>
Lines: 37
User-Agent: Gnus/5.0808 (Gnus v5.8.8) Emacs/20.7
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

gml4410@ggr.co.uk writes:

>    I have compiled R version 1.3.1 on a Linux system.  No errors or
                                          ^^^^^^^^^^^^
Which one? In particular, which compiler version?

> warnings are reported.
> 
>   However, "make check" fails thus:
> 
> =====
> make[5]: Leaving directory
> `/proj/informatics-build/GML/R/R-1.3.1/src/library'
> running code in base-Ex.R ...
> ../../bin/R --vanilla < base-Ex.R > base-Ex.Rout
> make[4]: *** [base-Ex.Rout] Error 139
> =====
> 
>    The base-Ex.Rout being produced at this point ends with:
> 
> =====
> > ## 1-d tables
> > (Poiss.tab <- table(N = rpois(200, lam= 5)))
> N
>  0  1  2  3  4  5  6  7  8  9 10 11 18
>  1  4 14 21 46 40 24 14 19 11  3  2  1
> =====

Unfortunately, the output is buffered so that one on catastrophic
error will lose the last bit. It might be more informative if you ran the
command directly, without the redirection to base-Ex.Rout.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 1143.reply.2 <==
From maechler@stat.math.ethz.ch  Fri Oct 26 18:05:40 2001
Received: from stat.math.ethz.ch (daemon@hypatia.ethz.ch [129.132.58.23])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id SAA02650
	for <R-bugs@biostat.ku.dk>; Fri, 26 Oct 2001 18:05:39 +0200 (MET DST)
Received: (from daemon@localhost)
	by stat.math.ethz.ch (8.9.1/8.9.1) id SAA23601;
	Fri, 26 Oct 2001 18:03:58 +0200 (MET DST)
Received: from lynne(129.132.58.30), claiming to be "lynne.ethz.ch"
 via SMTP by hypatia, id smtpdAAAa005kf; Fri Oct 26 18:03:48 2001
Received: (from maechler@localhost)
	by lynne.ethz.ch (8.11.6/8.11.2) id f9QG3xG11265;
	Fri, 26 Oct 2001 18:03:59 +0200
X-Authentication-Warning: lynne.ethz.ch: maechler set sender to maechler@stat.math.ethz.ch using -f
From: Martin Maechler <maechler@stat.math.ethz.ch>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Message-ID: <15321.35182.915453.863984@gargle.gargle.HOWL>
Date: Fri, 26 Oct 2001 18:03:58 +0200
To: gml4410@ggr.co.uk
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] Problem testing R version 1.3.1 (PR#1143)
In-Reply-To: <200110261542.RAA02442@pubhealth.ku.dk>
References: <200110261542.RAA02442@pubhealth.ku.dk>
X-Mailer: VM 6.95 under Emacs 20.7.1
Reply-To: Martin Maechler <maechler@stat.math.ethz.ch>

>>>>> "gml4410" == gml4410  <gml4410@ggr.co.uk> writes:

    gml4410>    I have compiled R version 1.3.1 on a Linux system.  No
    gml4410> errors or warnings are reported.

    gml4410>   However, "make check" fails thus:

    gml4410> ===== make[5]: Leaving directory
    gml4410> `/proj/informatics-build/GML/R/R-1.3.1/src/library' running
    gml4410> code in base-Ex.R ...  ../../bin/R --vanilla < base-Ex.R >
    gml4410> base-Ex.Rout make[4]: *** [base-Ex.Rout] Error 139 =====

    gml4410>    The base-Ex.Rout being produced at this point ends with:

    gml4410> =====
    >> ## 1-d tables (Poiss.tab <- table(N = rpois(200, lam= 5)))
    gml4410> N 0 1 2 3 4 5 6 7 8 9 10 11 18 1 4 14 21 46 40 24 14 19 11 3 2
    gml4410> 1 =====

    gml4410>    Does anyone have any suggestions as to what the problem may
    gml4410> be?

No,
but since you're on Linux you can find much more yourself :
Run R inside the debugger:

cd tests/Examples
../../bin/R -d gdb

 and then in (gdb) 

r --vanilla < base-Ex.R

 and it will (hopefully) stop at the same place
 but you'll see more


    gml4410>    The configuration parametsr used are:

    gml4410> environment parameters:

    gml4410> CC=gcc CFLAGS=-O2 FC='g77 -L/usr/central/lib' FFLAGS=-O2
    gml4410> CPPFLAGS=-I/usr/common/include LIBS=-L/usr/central/lib

FC='..' looks pretty fishy to me, but that maybe another issue entirely.

    gml4410> ./configure --prefix=/proj/informatics-build/GML/R/Linux-ia32
    gml4410> \ --without-readline --without-tcltk --without-gnome


    gml4410> (An equivalent build on an SGI Irix6.5 system also compiles,
    gml4410> with various warnings, but then fails to paas the checks
    gml4410> either, but fails on a later script).

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO D10	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><

==> 1143.followup.1 <==
From gml4410@ggr.co.uk  Fri Oct 26 18:41:35 2001
Received: from gate1.ggr.co.uk (gate1.ggr.co.uk [193.128.25.13])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id SAA02796;
	Fri, 26 Oct 2001 18:41:33 +0200 (MET DST)
Received: (uucp@localhost) by gate1.ggr.co.uk; Fri, 26 Oct 2001 17:40:35 +0100 (BST)
Received: from uk-stv-mhub1.ggr.co.uk(147.184.212.132) by gb-stv-fw3.ggr.co.uk via smap (V5.5)
	id xma022698; Fri, 26 Oct 01 17:39:45 +0100
Received: from ukwit01.ggr.co.uk (root@ukwit01.ggr.co.uk [147.184.219.175]) by mailhub.ggr.co.uk; Fri, 26 Oct 2001 17:40:06 +0100 (BST)
Received: from ggr.co.uk by ukwit01.ggr.co.uk (8.8.8/imd160294)
        id QAA137946; Fri, 26 Oct 2001 16:40:05 GMT
Sender: gml4410@ggr.co.uk
Message-ID: <3BD991E5.C9905BF9@ggr.co.uk>
Date: Fri, 26 Oct 2001 17:40:05 +0100
From: Gordon Lack <gml4410@ggr.co.uk>
Organization: Glaxo Wellcome
X-Mailer: Mozilla 4.78 [en] (X11; U; IRIX 6.5 IP32)
X-Accept-Language: en
MIME-Version: 1.0
To: Martin Maechler <maechler@stat.math.ethz.ch>
CC: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk,
        Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Subject: Re: [Rd] Problem testing R version 1.3.1 (PR#1143)
References: <200110261542.RAA02442@pubhealth.ku.dk> <15321.35182.915453.863984@gargle.gargle.HOWL>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

> >    I have compiled R version 1.3.1 on a Linux system.
>...
> Which one? In particular, which compiler version?

   Redhat6.2 with:

gcc version egcs-2.91.66 19990314/Linux (egcs-1.1.2 release)

> Unfortunately, the output is buffered so that one on catastrophic
> error will lose the last bit. It might be more informative if you ran the
> command directly, without the redirection to base-Ex.Rout.

  Good point.  The error at the end is now:

=====
> ##--- An example for the use of  `asp' :
> library(mva)
> data(eurodist)
> loc <- cmdscale(eurodist)
Segmentation fault
=====


Martin Maechler wrote:

> No,
> but since you're on Linux you can find much more yourself :
> Run R inside the debugger:
>...
>  but you'll see more

   Yes, thanks.  strace also showed a SIGSEGV on loading lapack.so, but
gdb gives a little more info.



Program received signal SIGSEGV, Segmentation fault.
_dl_lookup_versioned_symbol (
    undef_name=0xa4ad55dc <Address 0xa4ad55dc out of bounds>,
ref=0xbfffd2c8, 
    symbol_scope=0x934f71c, 
    reference_name=0x8ae7ce0
"/proj/informatics-build/GML/R/R-1.3.1/modules/lapack.so",
version=0x8e46c90, reloc_type=112) at ../sysdeps/generic/dl-hash.h:31
31      ../sysdeps/generic/dl-hash.h: No such file or directory.

==> 1143.reply.3 <==
From p.dalgaard@biostat.ku.dk  Fri Oct 26 18:55:07 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id SAA02856;
	Fri, 26 Oct 2001 18:55:06 +0200 (MET DST)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.11.2/8.11.2) id f9QGspf06300;
	Fri, 26 Oct 2001 18:54:51 +0200
X-Authentication-Warning: blueberry.kubism.ku.dk: pd set sender to p.dalgaard@biostat.ku.dk using -f
Sender: pd@pubhealth.ku.dk
To: Gordon Lack <gml4410@ggr.co.uk>
Cc: Martin Maechler <maechler@stat.math.ethz.ch>, r-devel@stat.math.ethz.ch,
        R-bugs@biostat.ku.dk, Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Subject: Re: [Rd] Problem testing R version 1.3.1 (PR#1143)
References: <200110261542.RAA02442@pubhealth.ku.dk>
	<15321.35182.915453.863984@gargle.gargle.HOWL>
	<3BD991E5.C9905BF9@ggr.co.uk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 26 Oct 2001 18:54:51 +0200
In-Reply-To: <3BD991E5.C9905BF9@ggr.co.uk>
Message-ID: <x2k7xinxyc.fsf@blueberry.kubism.ku.dk>
Lines: 65
User-Agent: Gnus/5.0808 (Gnus v5.8.8) Emacs/20.7
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

Gordon Lack <gml4410@ggr.co.uk> writes:

> > >    I have compiled R version 1.3.1 on a Linux system.
> >...
> > Which one? In particular, which compiler version?
> 
>    Redhat6.2 with:
> 
> gcc version egcs-2.91.66 19990314/Linux (egcs-1.1.2 release)
> 
> > Unfortunately, the output is buffered so that one on catastrophic
> > error will lose the last bit. It might be more informative if you ran the
> > command directly, without the redirection to base-Ex.Rout.
> 
>   Good point.  The error at the end is now:
> 
> =====
> > ##--- An example for the use of  `asp' :
> > library(mva)
> > data(eurodist)
> > loc <- cmdscale(eurodist)
> Segmentation fault
> =====
> 
> 
> Martin Maechler wrote:
> 
> > No,
> > but since you're on Linux you can find much more yourself :
> > Run R inside the debugger:
> >...
> >  but you'll see more
> 
>    Yes, thanks.  strace also showed a SIGSEGV on loading lapack.so, but
> gdb gives a little more info.
> 
> 
> 
> Program received signal SIGSEGV, Segmentation fault.
> _dl_lookup_versioned_symbol (
>     undef_name=0xa4ad55dc <Address 0xa4ad55dc out of bounds>,
> ref=0xbfffd2c8, 
>     symbol_scope=0x934f71c, 
>     reference_name=0x8ae7ce0
> "/proj/informatics-build/GML/R/R-1.3.1/modules/lapack.so",
> version=0x8e46c90, reloc_type=112) at ../sysdeps/generic/dl-hash.h:31
> 31      ../sysdeps/generic/dl-hash.h: No such file or directory.
> 

Odd. There are known issues with stock RH 6.2, but base R usually
compiles and passes make check on those systems. What usually happens
is that some packages refuse to dynload, with the error you're
observing, essentially.

The culprit is somewhere in the compiler suite - 2.95.x is known to
work, and I believe 3.0.x too (whereas the unofficial 2.96 from RH 7.0
caused trouble although later ones for 7.1 and 7.2 seem OK). You might
as well upgrade since R-1.4.0 will definitely not work with that
setup.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 1143.followup.2 <==
From tlumley@u.washington.edu  Fri Oct 26 18:57:16 2001
Received: from jason03.u.washington.edu (jason03.u.washington.edu [140.142.8.11])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id SAA02887
	for <R-bugs@biostat.ku.dk>; Fri, 26 Oct 2001 18:57:15 +0200 (MET DST)
Received: from homer37.u.washington.edu (homer37.u.washington.edu [140.142.16.3])
	by jason03.u.washington.edu (8.11.6+UW01.08/8.11.6+UW01.08) with ESMTP id f9QGuQ822126;
	Fri, 26 Oct 2001 09:56:26 -0700
Received: from localhost (tlumley@localhost)
	by homer37.u.washington.edu (8.11.6+UW01.08/8.11.6+UW01.08) with ESMTP id f9QGuQA80680;
	Fri, 26 Oct 2001 09:56:26 -0700
Date: Fri, 26 Oct 2001 09:56:25 -0700 (PDT)
From: Thomas Lumley <tlumley@u.washington.edu>
To: Gordon Lack <gml4410@ggr.co.uk>
cc: <r-devel@stat.math.ethz.ch>, <R-bugs@biostat.ku.dk>
Subject: Re: [Rd] Problem testing R version 1.3.1 (PR#1143)
In-Reply-To: <3BD991E5.C9905BF9@ggr.co.uk>
Message-ID: <Pine.A41.4.33.0110260954580.114078-100000@homer37.u.washington.edu>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Fri, 26 Oct 2001, Gordon Lack wrote:

> > >    I have compiled R version 1.3.1 on a Linux system.
> >...
> > Which one? In particular, which compiler version?
>
>    Redhat6.2 with:
>
> gcc version egcs-2.91.66 19990314/Linux (egcs-1.1.2 release)
>
> > Unfortunately, the output is buffered so that one on catastrophic
> > error will lose the last bit. It might be more informative if you ran the
> > command directly, without the redirection to base-Ex.Rout.
>
>   Good point.  The error at the end is now:
>
> =====
> > ##--- An example for the use of  `asp' :
> > library(mva)
> > data(eurodist)
> > loc <- cmdscale(eurodist)
> Segmentation fault
> =====

We've seen this one before. It's usually due to a problem with the Fortran
compile or flags such as linking in a math library compiled with different
flags from R.

	-thomas


==> 1143.followup.3 <==
From gml4410@ggr.co.uk  Fri Oct 26 19:26:43 2001
Received: from gate.ggr.co.uk (gate.ggr.co.uk [193.128.25.10])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id TAA03103;
	Fri, 26 Oct 2001 19:26:42 +0200 (MET DST)
Received: (uucp@localhost) by gate.ggr.co.uk; Fri, 26 Oct 2001 18:27:14 +0100 (BST)
Received: from uk-stv-mhub1.ggr.co.uk(147.184.212.132) by gb-stv-fw2.ggr.co.uk via smap (V5.5)
	id xma008881; Fri, 26 Oct 01 18:27:02 +0100
Received: from ukwit01.ggr.co.uk (root@ukwit01.ggr.co.uk [147.184.219.175]) by mailhub.ggr.co.uk; Fri, 26 Oct 2001 18:25:58 +0100 (BST)
Received: from ggr.co.uk by ukwit01.ggr.co.uk (8.8.8/imd160294)
        id RAA135138; Fri, 26 Oct 2001 17:25:57 GMT
Sender: gml4410@ggr.co.uk
Message-ID: <3BD99CA5.47910B70@ggr.co.uk>
Date: Fri, 26 Oct 2001 18:25:57 +0100
From: Gordon Lack <gml4410@ggr.co.uk>
Organization: Glaxo Wellcome
X-Mailer: Mozilla 4.78 [en] (X11; U; IRIX 6.5 IP32)
X-Accept-Language: en
MIME-Version: 1.0
To: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
CC: Martin Maechler <maechler@stat.math.ethz.ch>, r-devel@stat.math.ethz.ch,
        R-bugs@biostat.ku.dk
Subject: Re: [Rd] Problem testing R version 1.3.1 (PR#1143)
References: <200110261542.RAA02442@pubhealth.ku.dk>
		<15321.35182.915453.863984@gargle.gargle.HOWL>
		<3BD991E5.C9905BF9@ggr.co.uk> <x2k7xinxyc.fsf@blueberry.kubism.ku.dk>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

> The culprit is somewhere in the compiler suite - 2.95.x is known to
> work,

   Confirmed.  I've just found a Mandarke7.2 system with gcc 2.95.2 on,
and that passes the check (as does the RH6.2 system when using these
same binaries).

   Thanks.

   Now to track down the SGI problem....(which is already using gcc
2.95.2).
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1144 *
Subject: Re: Problem testing R version 1.3.1
From: Gordon Lack <gml4410@ggr.co.uk>
Date: Fri, 26 Oct 2001 16:59:26 +0100
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1144 <==
From postmaster@franz.stat.wisc.edu  Fri Oct 26 17:59:59 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id RAA02578
	for <r-bugs@biostat.ku.dk>; Fri, 26 Oct 2001 17:59:58 +0200 (MET DST)
Received: from gate1.ggr.co.uk (really [193.128.25.13]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m15x9Ol-000JH6C@franz.stat.wisc.edu> (Debian Smail3.2.0.114)
	for <r-bugs@r-project.org>; Fri, 26 Oct 2001 10:59:55 -0500 (CDT) 
Received: (uucp@localhost) by gate1.ggr.co.uk; Fri, 26 Oct 2001 16:59:17 +0100 (BST)
Received: from uk-stv-mhub1.ggr.co.uk(147.184.212.132) by gb-stv-fw3.ggr.co.uk via smap (V5.5)
	id xma012366; Fri, 26 Oct 01 16:59:06 +0100
Received: from ukwit01.ggr.co.uk (root@ukwit01.ggr.co.uk [147.184.219.175]) by mailhub.ggr.co.uk; Fri, 26 Oct 2001 16:59:27 +0100 (BST)
Received: from ggr.co.uk by ukwit01.ggr.co.uk (8.8.8/imd160294)
        id PAA126551; Fri, 26 Oct 2001 15:59:27 GMT
Sender: gml4410@ggr.co.uk
Message-ID: <3BD9885E.D0FD4D8F@ggr.co.uk>
Date: Fri, 26 Oct 2001 16:59:26 +0100
From: Gordon Lack <gml4410@ggr.co.uk>
Organization: Glaxo Wellcome
X-Mailer: Mozilla 4.78 [en] (X11; U; IRIX 6.5 IP32)
X-Accept-Language: en
MIME-Version: 1.0
To: r-bugs@r-project.org
Subject: Re: Problem testing R version 1.3.1
References: <3BD9845D.6010512F@ggr.co.uk>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

   Soem further info on this

>    The base-Ex.Rout being produced at this point ends with:
> 
> =====
> > ## 1-d tables
> > (Poiss.tab <- table(N = rpois(200, lam= 5)))
> N
>  0  1  2  3  4  5  6  7  8  9 10 11 18
>  1  4 14 21 46 40 24 14 19 11  3  2  1
> =====

   I just noticed that it is producing a postscript output file at this
point.  It fails on page 273, in mid-line (no newline appended):

=====
609.94 391.76 l
613.40 391.73 l
611.67 3
=====
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1145 *
Subject: Problem testing R version 1.3.1 on SGI Irix
From: Gordon Lack <gml4410@ggr.co.uk>
Date: Fri, 26 Oct 2001 19:04:04 +0100
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1145 <==
From postmaster@franz.stat.wisc.edu  Fri Oct 26 20:05:08 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id UAA03262
	for <r-bugs@biostat.ku.dk>; Fri, 26 Oct 2001 20:05:07 +0200 (MET DST)
Received: from gate.ggr.co.uk (really [193.128.25.10]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m15xBLs-000JIvC@franz.stat.wisc.edu> (Debian Smail3.2.0.114)
	for <r-bugs@r-project.org>; Fri, 26 Oct 2001 13:05:04 -0500 (CDT) 
Received: (uucp@localhost) by gate.ggr.co.uk; Fri, 26 Oct 2001 19:06:07 +0100 (BST)
Received: from uk-stv-mhub1.ggr.co.uk(147.184.212.132) by gb-stv-fw2.ggr.co.uk via smap (V5.5)
	id xma019101; Fri, 26 Oct 01 19:05:11 +0100
Received: from ukwit01.ggr.co.uk (root@ukwit01.ggr.co.uk [147.184.219.175]) by mailhub.ggr.co.uk; Fri, 26 Oct 2001 19:04:07 +0100 (BST)
Received: from ggr.co.uk by ukwit01.ggr.co.uk (8.8.8/imd160294)
        id SAA126689; Fri, 26 Oct 2001 18:04:05 GMT
Sender: gml4410@ggr.co.uk
Message-ID: <3BD9A594.82824E30@ggr.co.uk>
Date: Fri, 26 Oct 2001 19:04:04 +0100
From: Gordon Lack <gml4410@ggr.co.uk>
Organization: Glaxo Wellcome
X-Mailer: Mozilla 4.78 [en] (X11; U; IRIX 6.5 IP32)
X-Accept-Language: en
MIME-Version: 1.0
To: r-bugs@r-project.org
Subject: Problem testing R version 1.3.1 on SGI Irix
References: <3BD9845D.6010512F@ggr.co.uk>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

   I've compiled R verison 1.3.1 on SGI Irix 6.5

   It fails its check when running the ts-Ex.Rout test with:

=====
> 
> data(BJsales)
> ar(ts.union(BJsales, BJsales.lead))
Error in ar.yw.mts(x, aic = aic, order.max = order.max, na.action =
na.action,  : 
        On entry to DGEMM  parameter number 1 had an illegal value
Execution halted
=====

   It was compiled with gcc 2.95.2 (and the g77 which came with that,
which is 0.5.25).
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1146 *
Subject: promax rotation matrix
From: pperkins@ucsd.edu
Date: Fri, 26 Oct 2001 20:44:07 +0200 (MET DST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1146 <==
From pperkins@ucsd.edu  Fri Oct 26 20:44:08 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id UAA03424
	for <R-bugs@biostat.ku.dk>; Fri, 26 Oct 2001 20:44:07 +0200 (MET DST)
Date: Fri, 26 Oct 2001 20:44:07 +0200 (MET DST)
From: pperkins@ucsd.edu
Message-Id: <200110261844.UAA03424@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: promax rotation matrix

Full_Name: Peter Perkins
Version: 1.3.0
OS: Windows 2000
Submission from: (NULL) (144.212.95.125)


I believe that line 15 in promax from the mva library is incorrect. It currently
reads
    U <- U %*% xx$rotmat
and I believe it should be 
    U <- xx$rotmat %*% U

I could easily be wrong about this, what with the different definitions of the
rotation matrix vs. its transpose or its inverse.  But as I read the help page,
the rotation returned should be the one right-applied to the unrotated loadings.
 If one gets an unrotated solution from factanal, and then rotates it using
promax, the rotation matrix returned by promax does not rotate the original
loadings to the loadings actually returned by promax.  For example:

> ability.FA <- factanal(factors = 2, covmat = ability.cov, rotation = "none")
> pm <- promax(ability.FA$loadings)
> ability.FA$loadings %*% pm$rotmat
         
                          [,1]                [,2]
  general 0.506710586637257760  0.3869775784069614
  picture 0.016586316593501016  0.5487934474308697
  blocks  0.009193639894000683  0.7618755867650074
  maze    0.000379404610399037  0.4152980202252167
  reading 1.239552601870304500 -0.0721695133918453
  vocab   0.993619401777782300  0.0121717852577490

> pm$loadings
                    Factor1              Factor2
general  0.3645353358177468  0.47007326286349982
picture -0.0574968553480034  0.67108222064051182
blocks  -0.0911409139522113  0.93173350519662612
maze    -0.0534713467857141  0.50791682927425630
reading  1.0236923640723727 -0.09611608932609411
vocab    0.8115188349528749  0.00859299169089836

I believe that the latter is correct.  Changing the order of the product in line
15 makes the two the same.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1147 *
Subject: postscript problem
From: kjetil halvorsen <kjetilh@umsanet.edu.bo>
Date: Fri, 26 Oct 2001 15:23:45 -0400
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1147 <==
From postmaster@franz.stat.wisc.edu  Fri Oct 26 21:23:17 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id VAA03528
	for <r-bugs@biostat.ku.dk>; Fri, 26 Oct 2001 21:23:16 +0200 (MET DST)
Received: from jupiter.umsanet.edu.bo (really [166.114.17.11]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m15xCZT-000JIvC@franz.stat.wisc.edu> (Debian Smail3.2.0.114)
	for <r-bugs@r-project.org>; Fri, 26 Oct 2001 14:23:11 -0500 (CDT) 
Received: from umsanet.edu.bo (pc69.umsanet.edu.bo [166.114.17.69])
	by jupiter.umsanet.edu.bo (8.11.0/8.9.3) with ESMTP id f9QJZjK01812
	for <r-bugs@r-project.org>; Fri, 26 Oct 2001 15:35:47 -0400
Message-ID: <3BD9B841.215F6DB3@umsanet.edu.bo>
Date: Fri, 26 Oct 2001 15:23:45 -0400
From: kjetil halvorsen <kjetilh@umsanet.edu.bo>
Reply-To: kjetilh@umsanet.edu.bo
Organization: UMSA
X-Mailer: Mozilla 4.7 [en] (Win98; I)
X-Accept-Language: en
MIME-Version: 1.0
To: r-bugs@r-project.org
Subject: postscript problem
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

I reported this earlier, and have got reports that others have the same
promlem on UNIX machines, so it is not only a windows problem
S I file a bug report.

The function (boot.stat) given at the end produces a postscript file, 
which cannot be included correctly in LaTeX. Specifically, 
the image in LaTeX (when translated by dvips to postscript)
becomes very small, not using the bounding box, and turned on its head!

Kjetil Halvorsen

boot.stat <-
function (x, B = 1000, norm = FALSE) 
{
    xname <- deparse(substitute(x))
    means <- meds <- numeric(B)
    for (i in 1:B) {
        s <- sample(x, replace = TRUE)
        means[i] <- mean(s)
        meds[i] <- median(s)
    }
    CImedian <- quantile(meds, c(0.025, 0.5, 0.975))
    CImean <- quantile(means, c(0.025, 0.5, 0.975))
    hmean <- hist(means, freq = FALSE, plot = FALSE)
    hmeds <- hist(meds, freq = FALSE, plot = FALSE)
    split.screen(c(1, 2))
    xlims <- range(c(hmean$breaks, hmeds$breaks))
    ymax <- max(c(hmean$density, hmeds$density))
    screen(1)
    plot(hmean, freq = FALSE, col = "red", xlim = xlims, ylim = c(0, 
        ymax), xlab = paste("Sampling dist. of mean of ", xname), 
        main = "")
    if (norm) {
        n <- length(x)
        mu <- mean(x)
        sd <- sqrt(var(x)/n)
        ps <- seq(xlims[1], xlims[2], len = 100)
        lines(ps, dnorm(ps, mu, sd), col = "darkgreen")
    }
    lines(CImean, rep(ymax/2, 3))
    points(CImean[2], ymax/2, cex = 2, col = "black")
    screen(2)
    plot(hmeds, freq = FALSE, col = "lightblue", xlim = xlims, 
        ylim = c(0, ymax), xlab = paste("Sampling dist. of median of ",
            xname), main = "")
    if (norm) {
        n <- length(x)
        p <- 1/2
        mu <- median(x)
        d <- density(x, n = 1, from = mu, to = mu)$y
        sd <- sqrt(p * (1 - p)/n)/d
        ps <- seq(xlims[1], xlims[2], len = 100)
        lines(ps, dnorm(ps, mu, sd), col = "darkgreen")
    }
    lines(CImedian, rep(ymax/2, 3))
    points(CImedian[2], ymax/2, cex = 2, col = "black")
    names(B) <- "Number of bootstrap replicactions"
    invisible(list(CImean = CImean, CImedian = CImedian, B, means =
means, 
        meds = meds))
}


call with for example

boot.stat( rnorm(100), norm=TRUE)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1148 *
Subject: warnings --- wish/bug
From: kjetil halvorsen <kjetilh@umsanet.edu.bo>
Date: Fri, 26 Oct 2001 15:27:56 -0400
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1148 <==
From postmaster@franz.stat.wisc.edu  Fri Oct 26 21:27:58 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id VAA03559
	for <r-bugs@biostat.ku.dk>; Fri, 26 Oct 2001 21:27:57 +0200 (MET DST)
Received: from jupiter.umsanet.edu.bo (really [166.114.17.11]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m15xCde-000JIvC@franz.stat.wisc.edu> (Debian Smail3.2.0.114)
	for <r-bugs@r-project.org>; Fri, 26 Oct 2001 14:27:30 -0500 (CDT) 
Received: from umsanet.edu.bo (pc69.umsanet.edu.bo [166.114.17.69])
	by jupiter.umsanet.edu.bo (8.11.0/8.9.3) with ESMTP id f9QJduK01848
	for <r-bugs@r-project.org>; Fri, 26 Oct 2001 15:39:56 -0400
Message-ID: <3BD9B93C.AEAB778D@umsanet.edu.bo>
Date: Fri, 26 Oct 2001 15:27:56 -0400
From: kjetil halvorsen <kjetilh@umsanet.edu.bo>
Reply-To: kjetilh@umsanet.edu.bo
Organization: UMSA
X-Mailer: Mozilla 4.7 [en] (Win98; I)
X-Accept-Language: en
MIME-Version: 1.0
To: r-bugs@r-project.org
Subject: warnings --- wish/bug
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

When R prints warnings, they often go "out of the line", it would be
better if they where wrapped with
writeLines(strwrap ...

I tried to do that , changing the function warnings, but it has only
effect when called explicitely, not when R prints the warnings unasked.

Anyhow, here is the changed warnings:

warnings <-
function (...) 
{
    if (!(n <- length(last.warning))) 
        return()
    names <- names(last.warning)
    cat("Warning message", if (n > 1) 
        "s", ":\n", sep = "")
    for (i in 1:n) {
        out <- if (n == 1) 
            names[i]
        else paste(i, ": ", names[i], sep = "")
        if (length(last.warning[[i]])) {
            temp <- deparse(last.warning[[i]])
            out <- paste(out, "in:", temp[1], if (length(temp) > 
                1) 
                " ...")
        }
        writeLines(strwrap(out), ...)
    }
}


Kjetil Halvorsen

==> 1148.followup.1 <==
From ripley@stats.ox.ac.uk  Fri Oct 26 21:39:09 2001
Received: from toucan.stats.ox.ac.uk (toucan.stats.ox.ac.uk [163.1.20.20])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id VAA03605
	for <R-bugs@biostat.ku.dk>; Fri, 26 Oct 2001 21:39:08 +0200 (MET DST)
Received: from max175.public.ox.ac.uk (max175.public.ox.ac.uk [192.76.27.175])
	by toucan.stats.ox.ac.uk (8.9.0/8.9.0) with ESMTP id UAA25834;
	Fri, 26 Oct 2001 20:38:32 +0100 (BST)
Date: Fri, 26 Oct 2001 20:37:39 +0100 (BST)
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Sender: <ripley@auk.stats>
To: <kjetilh@umsanet.edu.bo>
cc: <R-bugs@biostat.ku.dk>
Subject: Re: [Rd] warnings --- wish/bug (PR#1148)
In-Reply-To: <200110261927.VAA03569@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.31.0110262031090.8695-100000@auk.stats>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

This is difficult.  The internal warnings should work as often as
possible without doing memory allocation, which might provoke an error
(*and* we try to print out warnings after a memory allocation error).
So strwrap is a no-no internally.

I've not seen warnings that are not wrapped by the console
(on Unix) or are scrollable (Rgui).   Can you give us an example of the
problem?

Incidentally, I think you want to strwrap the ... too.

On Fri, 26 Oct 2001 kjetilh@umsanet.edu.bo wrote:

> When R prints warnings, they often go "out of the line", it would be
> better if they where wrapped with
> writeLines(strwrap ...
>
> I tried to do that , changing the function warnings, but it has only
> effect when called explicitely, not when R prints the warnings unasked.
>
> Anyhow, here is the changed warnings:
>
> warnings <-
> function (...)
> {
>     if (!(n <- length(last.warning)))
>         return()
>     names <- names(last.warning)
>     cat("Warning message", if (n > 1)
>         "s", ":\n", sep = "")
>     for (i in 1:n) {
>         out <- if (n == 1)
>             names[i]
>         else paste(i, ": ", names[i], sep = "")
>         if (length(last.warning[[i]])) {
>             temp <- deparse(last.warning[[i]])
>             out <- paste(out, "in:", temp[1], if (length(temp) >
>                 1)
>                 " ...")
>         }
>         writeLines(strwrap(out), ...)
>     }
> }
>
>
> Kjetil Halvorsen
>
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


==> 1148.followup.2 <==
From kjetilh@umsanet.edu.bo  Fri Oct 26 21:48:22 2001
Received: from jupiter.umsanet.edu.bo (jupiter.umsanet.edu.bo [166.114.17.11])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id VAA03658
	for <R-bugs@biostat.ku.dk>; Fri, 26 Oct 2001 21:48:19 +0200 (MET DST)
Received: from umsanet.edu.bo (pc69.umsanet.edu.bo [166.114.17.69])
	by jupiter.umsanet.edu.bo (8.11.0/8.9.3) with ESMTP id f9QK02K02099;
	Fri, 26 Oct 2001 16:00:02 -0400
Message-ID: <3BD9BDF2.BC9F10D2@umsanet.edu.bo>
Date: Fri, 26 Oct 2001 15:48:02 -0400
From: kjetil halvorsen <kjetilh@umsanet.edu.bo>
Reply-To: kjetilh@umsanet.edu.bo
Organization: UMSA
X-Mailer: Mozilla 4.7 [en] (Win98; I)
X-Accept-Language: en
MIME-Version: 1.0
To: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
CC: R-bugs@biostat.ku.dk
Subject: Re: [Rd] warnings --- wish/bug (PR#1148)
References: <Pine.GSO.4.31.0110262031090.8695-100000@auk.stats>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

An example with a local package:

> library(nonpar)
> chisq.gof( rnorm(80), distribution=pnorm)

     Pearson Chi-square goodness of fit test

data:  rnorm(80) 
Chi-square = 19.1397, degrees of freedom = 11,
p-value = 0.05863 
alternative hypothesis: true is not equal to pnorm () 

Warning message: 
Minimum expected value is  2.61552251298291  <=5. Chi-square
approximation may be unsatisfactory in: chisq.gof(rnorm(80),
distribution = pnorm) 
> 

(where on the Rgui console (windows 98) the lines after "Warning
message"
extend out of sight)

Kjetil Halvorsen

Prof Brian D Ripley wrote:
> 
> This is difficult.  The internal warnings should work as often as
> possible without doing memory allocation, which might provoke an error
> (*and* we try to print out warnings after a memory allocation error).
> So strwrap is a no-no internally.
> 
> I've not seen warnings that are not wrapped by the console
> (on Unix) or are scrollable (Rgui).   Can you give us an example of the
> problem?
> 
> Incidentally, I think you want to strwrap the ... too.
> 
> On Fri, 26 Oct 2001 kjetilh@umsanet.edu.bo wrote:
> 
> > When R prints warnings, they often go "out of the line", it would be
> > better if they where wrapped with
> > writeLines(strwrap ...
> >
> > I tried to do that , changing the function warnings, but it has only
> > effect when called explicitely, not when R prints the warnings unasked.
> >
> > Anyhow, here is the changed warnings:
> >
> > warnings <-
> > function (...)
> > {
> >     if (!(n <- length(last.warning)))
> >         return()
> >     names <- names(last.warning)
> >     cat("Warning message", if (n > 1)
> >         "s", ":\n", sep = "")
> >     for (i in 1:n) {
> >         out <- if (n == 1)
> >             names[i]
> >         else paste(i, ": ", names[i], sep = "")
> >         if (length(last.warning[[i]])) {
> >             temp <- deparse(last.warning[[i]])
> >             out <- paste(out, "in:", temp[1], if (length(temp) >
> >                 1)
> >                 " ...")
> >         }
> >         writeLines(strwrap(out), ...)
> >     }
> > }
> >
> >
> > Kjetil Halvorsen
> >
> > -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> > r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> > Send "info", "help", or "[un]subscribe"
> > (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> > _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
> >
> 
> --
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272860 (secr)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595

==> 1148.followup.3 <==
From ripley@stats.ox.ac.uk  Fri Oct 26 21:53:16 2001
Received: from toucan.stats.ox.ac.uk (toucan.stats.ox.ac.uk [163.1.20.20])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id VAA03700
	for <R-bugs@biostat.ku.dk>; Fri, 26 Oct 2001 21:53:16 +0200 (MET DST)
Received: from gannet.stats (IDENT:root@gannet.stats [163.1.20.127])
	by toucan.stats.ox.ac.uk (8.9.0/8.9.0) with ESMTP id UAA25907;
	Fri, 26 Oct 2001 20:53:14 +0100 (BST)
Received: from localhost (ripley@localhost)
	by gannet.stats (8.11.3/8.11.3) with ESMTP id f9QJrDY00649;
	Fri, 26 Oct 2001 20:53:13 +0100
X-Authentication-Warning: gannet.stats: ripley owned process doing -bs
Date: Fri, 26 Oct 2001 20:53:13 +0100 (BST)
From: Prof Brian Ripley <ripley@stats.ox.ac.uk>
X-X-Sender:  <ripley@gannet.stats>
To: kjetil halvorsen <kjetilh@umsanet.edu.bo>
cc: <R-bugs@biostat.ku.dk>
Subject: Re: [Rd] warnings --- wish/bug (PR#1148)
In-Reply-To: <3BD9BDF2.BC9F10D2@umsanet.edu.bo>
Message-ID: <Pine.LNX.4.31.0110262049460.631-100000@gannet.stats>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Fri, 26 Oct 2001, kjetil halvorsen wrote:

> An example with a local package:
>
> > library(nonpar)
> > chisq.gof( rnorm(80), distribution=pnorm)
>
>      Pearson Chi-square goodness of fit test
>
> data:  rnorm(80)
> Chi-square = 19.1397, degrees of freedom = 11,
> p-value = 0.05863
> alternative hypothesis: true is not equal to pnorm ()
>
> Warning message:
> Minimum expected value is  2.61552251298291  <=5. Chi-square
> approximation may be unsatisfactory in: chisq.gof(rnorm(80),
> distribution = pnorm)
> >
>
> (where on the Rgui console (windows 98) the lines after "Warning
> message"
> extend out of sight)

That's bad design, but you can scroll the RGui window, surely?

BTW, that's nothing to do with warnings().  The internal code assumes that
the author has used sensible line lengths in the call to warning (R or C)
or warningcall (C).

>
> Kjetil Halvorsen
>
> Prof Brian D Ripley wrote:
> >
> > This is difficult.  The internal warnings should work as often as
> > possible without doing memory allocation, which might provoke an error
> > (*and* we try to print out warnings after a memory allocation error).
> > So strwrap is a no-no internally.
> >
> > I've not seen warnings that are not wrapped by the console
> > (on Unix) or are scrollable (Rgui).   Can you give us an example of the
> > problem?
> >
> > Incidentally, I think you want to strwrap the ... too.
> >
> > On Fri, 26 Oct 2001 kjetilh@umsanet.edu.bo wrote:
> >
> > > When R prints warnings, they often go "out of the line", it would be
> > > better if they where wrapped with
> > > writeLines(strwrap ...
> > >
> > > I tried to do that , changing the function warnings, but it has only
> > > effect when called explicitely, not when R prints the warnings unasked.
> > >
> > > Anyhow, here is the changed warnings:
> > >
> > > warnings <-
> > > function (...)
> > > {
> > >     if (!(n <- length(last.warning)))
> > >         return()
> > >     names <- names(last.warning)
> > >     cat("Warning message", if (n > 1)
> > >         "s", ":\n", sep = "")
> > >     for (i in 1:n) {
> > >         out <- if (n == 1)
> > >             names[i]
> > >         else paste(i, ": ", names[i], sep = "")
> > >         if (length(last.warning[[i]])) {
> > >             temp <- deparse(last.warning[[i]])
> > >             out <- paste(out, "in:", temp[1], if (length(temp) >
> > >                 1)
> > >                 " ...")
> > >         }
> > >         writeLines(strwrap(out), ...)
> > >     }
> > > }
> > >
> > >
> > > Kjetil Halvorsen
> > >
> > > -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> > > r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> > > Send "info", "help", or "[un]subscribe"
> > > (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> > > _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
> > >
> >
> > --
> > Brian D. Ripley,                  ripley@stats.ox.ac.uk
> > Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> > University of Oxford,             Tel:  +44 1865 272861 (self)
> > 1 South Parks Road,                     +44 1865 272860 (secr)
> > Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1149 *
Subject: psignrank and pwilcox null pointer deref
From: charlie@stat.umn.edu
Date: Fri, 26 Oct 2001 23:50:07 +0200 (MET DST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1149 <==
From charlie@stat.umn.edu  Fri Oct 26 23:50:08 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id XAA04182
	for <R-bugs@biostat.ku.dk>; Fri, 26 Oct 2001 23:50:07 +0200 (MET DST)
Date: Fri, 26 Oct 2001 23:50:07 +0200 (MET DST)
From: charlie@stat.umn.edu
Message-Id: <200110262150.XAA04182@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: psignrank and pwilcox null pointer deref

Full_Name: Charles J. Geyer
Version: 1.3.1
OS: SuSE 7.2
Submission from: (NULL) (134.84.86.22)


in line 90 of signrank.c and lines 114 and 273 of wilcox.c calloc is used and
the return is not checked to see if it is null (violating numbers 2 and 6 of
the ten commandments for C programmers).  The following code thus makes
R segfault (for suitably large values of 1000)

for (n in seq(100, 1000, 100)) {
   mu <- n * (n + 1) / 4
   sigma <- sqrt(n * (n + 1) * (2 * n + 1) / 24)
   z <- floor(qnorm(0.05, mu, sigma))
   p <- psignrank(z, n)
   cat("z = ", z, ", n = ", n, ", p = ", p, "\n", sep="")
}

for (n in seq(100, 1000, 100)) {
   m <- n
   mu <- n * m / 2
   sigma <- sqrt(m * n * (m + n + 1) / 12)
   z <- floor(qnorm(0.05, mu, sigma))
   p <- pwilcox(z, m, n)
   cat("z = ", z, ", m = ", m, ", n = ", n, ", p = ", p, "\n", sep="")
}

A fix is hard because a good solution would free all the previously allocated
memory before dying.  Probably a better algorithm is needed.  But I don't know
if one exists.

Anyway the current behavior is unacceptable.






~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
