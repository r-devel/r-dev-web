=================================================
This is an automated collection of open reports in
the R-bugs repository.
=================================================

Directory:  Accuracy

none

Directory:  Add-ons

* PR# 521 *
Subject: akima core dumps on loading
From: santini@dsi.unimi.it
Date: Mon, 17 Apr 2000 11:30:41 +0200 (MET DST)
--Probably compiler-specific
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 521 <==
From santini@dsi.unimi.it  Mon Apr 17 11:30:42 2000
Received: from localhost (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id LAA01559
	for <R-bugs@biostat.ku.dk>; Mon, 17 Apr 2000 11:30:41 +0200 (MET DST)
Date: Mon, 17 Apr 2000 11:30:41 +0200 (MET DST)
From: santini@dsi.unimi.it
Message-Id: <200004170930.LAA01559@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: akima core dumps on loading

Full_Name: Massimo santini
Version: 1.0.1
OS: Linux
Submission from: (NULL) (159.149.147.89)


I've just dl the .rpm of R 1.0.1, installed it and then launched 

	insatll.packages("akima")

after re-launching R [--vanilla], the command

	library(akima)

has the only effect to coredump the program. Here is the output of gdb and
strace...

--- GDB (commands given can be seen from the except)

$ R -d gdb
GNU gdb 19991004
Copyright 1998 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain conditions.
Type "show copying" to see the conditions.
There is absolutely no warranty for GDB.  Type "show warranty" for details.
This GDB was configured as "i386-redhat-linux"...
(gdb) run --vanilla
Starting program: /usr/lib/R/bin/R.X11 --vanilla

R : Copyright 2000, The R Development Core Team
Version 1.0.1  (April 14, 2000)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type	"?license" or "?licence" for distribution details.

R is a collaborative project with many contributors.
Type	"?contributors" for a list.

Type	"demo()" for some demos, "help()" for on-line help, or
    	"help.start()" for a HTML browser interface to help.
Type	"q()" to quit R.

> library(akima)

Program received signal SIGSEGV, Segmentation fault.
_dl_lookup_symbol (undef_name=0x2d2e3b3 <Address 0x2d2e3b3 out of bounds>,
ref=0xbfffabb4, 
    symbol_scope=0x81ec65c, reference_name=0x81e8b20
"/usr/lib/R/library/akima/libs/akima.so", reloc_type=208)
    at ../sysdeps/generic/dl-hash.h:31
31	../sysdeps/generic/dl-hash.h: No such file or directory.
(gdb) 

--- STRACE (echo "library(akima)" | strace R --vanilla)

[...]
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
stat("/usr/lib/R/library/akima/libs/akima.so", {st_mode=S_IFREG|0755,
st_size=289367, ...}) = 0
stat("/usr/lib/R/library/base/libs/akima.so", 0xbfffdb60) = -1 ENOENT (No such
file or directory)
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
rt_sigprocmask(SIG_SETMASK, [], NULL, 8) = 0
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
rt_sigprocmask(SIG_SETMASK, [], NULL, 8) = 0
open("/usr/lib/R/library/akima/libs/akima.so", O_RDONLY) = 4
fstat(4, {st_mode=S_IFREG|0755, st_size=289367, ...}) = 0
read(4, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0\3\0\1\0\0\0000F\0\000"..., 4096) =
4096
old_mmap(NULL, 115364, PROT_READ|PROT_EXEC, MAP_PRIVATE, 4, 0) = 0x40f3d000
mprotect(0x40f55000, 17060, PROT_NONE)  = 0
old_mmap(0x40f55000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED, 4,
0x17000) = 0x40f55000
old_mmap(0x40f57000, 8868, PROT_READ|PROT_WRITE,
MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0x40f57000
close(4)                                = 0
mprotect(0x40f3d000, 98304, PROT_READ|PROT_WRITE) = 0
--- SIGSEGV (Segmentation fault) ---
+++ killed by SIGSEGV +++

==> 521.reply.1 <==
From pd@blueberry.kubism.ku.dk  Mon Apr 17 12:00:35 2000
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id MAA01944
	for <R-bugs@biostat.ku.dk>; Mon, 17 Apr 2000 12:00:35 +0200 (MET DST)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.9.3/8.9.3) id MAA31083;
	Mon, 17 Apr 2000 12:03:19 +0200
Sender: pd@blueberry.kubism.ku.dk
To: santini@dsi.unimi.it
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] akima core dumps on loading (PR#521)
References: <200004170930.LAA01569@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 17 Apr 2000 12:03:19 +0200
In-Reply-To: santini@dsi.unimi.it's message of "Mon, 17 Apr 2000 11:30:43 +0200 (MET DST)"
Message-ID: <x2zoqtkpso.fsf@blueberry.kubism.ku.dk>
Lines: 52
X-Mailer: Gnus v5.7/Emacs 20.5
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

santini@dsi.unimi.it writes:

> Full_Name: Massimo santini
> Version: 1.0.1
> OS: Linux
> Submission from: (NULL) (159.149.147.89)
> 
> 
> I've just dl the .rpm of R 1.0.1, installed it and then launched 
> 
> 	insatll.packages("akima")
> 
> after re-launching R [--vanilla], the command
> 
> 	library(akima)
> 
> has the only effect to coredump the program. Here is the output of gdb and
> strace...

Hmm. Doesn't happen here. (BTW: Remember to include as much
information about your system as you can think of. It's not obvious
whether you're running RedHat or SuSE for instance and in what
version.) 

> Program received signal SIGSEGV, Segmentation fault.
> _dl_lookup_symbol (undef_name=0x2d2e3b3 <Address 0x2d2e3b3 out of bounds>,
> ref=0xbfffabb4, 
>     symbol_scope=0x81ec65c, reference_name=0x81e8b20
> "/usr/lib/R/library/akima/libs/akima.so", reloc_type=208)
>     at ../sysdeps/generic/dl-hash.h:31
> 31	../sysdeps/generic/dl-hash.h: No such file or directory.
> (gdb) 
> 
> --- STRACE (echo "library(akima)" | strace R --vanilla)
> 
> [...]
> rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
> stat("/usr/lib/R/library/akima/libs/akima.so", {st_mode=S_IFREG|0755,
> st_size=289367, ...}) = 0
> stat("/usr/lib/R/library/base/libs/akima.so", 0xbfffdb60) = -1 ENOENT (No such
> file or directory)

This would seem to be the problem: the dynamic library isn't there.
Did you get any error messages while compiling the package? (Except
for "...might be used uninitialized..." of which there are quite a few
here too).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 521.reply.2 <==
From pd@blueberry.kubism.ku.dk  Mon Apr 17 15:47:37 2000
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id PAA05177
	for <r-bugs@biostat.ku.dk>; Mon, 17 Apr 2000 15:47:36 +0200 (MET DST)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.9.3/8.9.3) id PAA31429;
	Mon, 17 Apr 2000 15:50:37 +0200
Sender: pd@blueberry.kubism.ku.dk
To: Massimo Santini <santini@dsi.unimi.it>
Subject: Re: [Rd] akima core dumps on loading (PR#521)
Cc: r-bugs@biostat.ku.dk
References: <Pine.LNX.4.21.0004171357340.30022-100000@zorn.usr.dsi.unimi.it>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 17 Apr 2000 15:50:36 +0200
In-Reply-To: Massimo Santini's message of "Mon, 17 Apr 2000 14:00:28 +0200 (CEST)"
Message-ID: <x2snwkalar.fsf@blueberry.kubism.ku.dk>
Lines: 80
X-Mailer: Gnus v5.7/Emacs 20.5
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

Massimo Santini <santini@dsi.unimi.it> writes:

> > Hmm. Doesn't happen here. (BTW: Remember to include as much
> > information about your system as you can think of. It's not obvious
> > whether you're running RedHat or SuSE for instance and in what
> > version.) 
> 
> You are perfectly right. My system is an updated RedHat 6.2.

Same here...

> > > stat("/usr/lib/R/library/akima/libs/akima.so", {st_mode=S_IFREG|0755,
> > > st_size=289367, ...}) = 0
> > > stat("/usr/lib/R/library/base/libs/akima.so", 0xbfffdb60) = -1 ENOENT (No such
> > > file or directory)
> > 
> > This would seem to be the problem: the dynamic library isn't there.
> > Did you get any error messages while compiling the package? (Except
> > for "...might be used uninitialized..." of which there are quite a few
> > here too).
> 
> Non errors during the installation phase. The akima.so library is in 
> 
> 	/usr/lib/R/library/akima/libs/akima.so
> 
> where it should be (with correct premissions), but is not in
> 
> 	/usr/lib/R/library/base/libs/akima.so
> 
> (the dir /usr/lib/R/library/base/libs is missing, to be precise).

Oh. Didn't see that. Then that part is OK. Sorry.

> Have you some hint about what to do now?

Hmmm. Interesting: I can provoke the crash on *my other* RedHat6.2
computer (the one still running the egcs compiler). My stack trace says

#0  _dl_lookup_symbol (
    undef_name=0xcbf203b4 <Address 0xcbf203b4 out of bounds>,
    ref=0xbfffb234, 
    symbol_scope=0x81d3cac, 
    reference_name=0x81d3a60
    "/usr/local/src/misc/r-release/BUILD/library/akima/libs/akima.so",
    reloc_type=64) at ../sysdeps/generic/dl-hash.h:31
#1  0x400096ad in _dl_relocate_object (l=0x81d3aa8, scope=0x81d3cac, lazy=0, 
    consider_profiling=0) at ../sysdeps/i386/dl-machine.h:326
#2  0x40255be4 in dl_open_worker (a=0xbfffb3a0) at dl-open.c:182
#3  0x4000ac3b in _dl_catch_error (errstring=0xbfffb39c, 
    operate=0x40255990 <dl_open_worker>, args=0xbfffb3a0) at dl-error.c:141
#4  0x40255d3d in _dl_open (
    file=0xbfffc51c 
"/usr/local/src/misc/r-release/BUILD/library/akima/libs/akima.so",
mode=2, caller=0xbfffb39c) at dl-open.c:232
#5  0x401323d3 in dlopen_doit (a=0xbfffb4b0) at dlopen.c:41
#6  0x4000ac3b in _dl_catch_error (errstring=0x40134080, 
    operate=0x401323a8 <dlopen_doit>, args=0xbfffb4b0) at
dl-error.c:141
#7  0x401328b9 in _dlerror_run (operate=0x401323a8 <dlopen_doit>, 
    args=0xbfffb4b0) at dlerror.c:125
#8  0x40132393 in __dlopen_check (
    file=0xbfffc51c
"/usr/local/src/misc/r-release/BUILD/library/akima/libs/akima.so",
mode=2) at dlopen.c:53
#9  0x80d9cc3 in AddDLL (
    path=0xbfffc51c
"/usr/local/src/misc/r-release/BUILD/library/akima/libs/akim
a.so", asLocal=1, now=1) at ../../../R/src/unix/dynload.c:207


Looks like it is happening during the dynamic linking itself. Doesn't
look nice. (But installing gcc 2.95.2 might fix your problem.)

[diverted back to r-bugs]

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 521.audit <==
Tue Apr 25 07:04:44 2000	ripley	changed notes
Tue Apr 25 07:04:44 2000	ripley	moved from incoming to Add-ons
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 503 *
Subject: dmvnorm() bug in e1071
From: "Gregory R. Warnes" <warnes@biostat.washington.edu>
Date: Fri, 24 Mar 2000 03:24:45 +0000 (GMT)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 503 <==
From warnes@warnes.net  Fri Mar 24 20:26:17 2000
Received: from hydra.warnes.net (mail@c877378-a.sttln1.wa.home.com [24.9.60.166])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id UAA06279
	for <r-bugs@biostat.ku.dk>; Fri, 24 Mar 2000 20:25:43 +0100 (MET)
Received: from warnes (helo=localhost)
	by hydra.warnes.net with local-esmtp (Exim 3.12 #1 (Debian))
	id 12YKiM-0003AT-00
	for <r-bugs@biostat.ku.dk>; Thu, 23 Mar 2000 19:24:46 -0800
Date: Fri, 24 Mar 2000 03:24:45 +0000 (GMT)
From: "Gregory R. Warnes" <warnes@biostat.washington.edu>
X-Sender: warnes@hydra.warnes.net
To: r-bugs@biostat.ku.dk
Subject: dmvnorm() bug in e1071
Message-ID: <Pine.LNX.4.21.0003240321480.575-100000@hydra.warnes.net>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
Sender: "Gregory R. Warnes" <warnes@warnes.net>


When dmvnorm is applied to matrices it fails.  The offending lines are

  if (length(x) != ncol(sigma)) {
    stop("x and sigma have non-conforming size")
  }

which works fine if x is a dataframe, but not if x is a matrix.

Replacing this test with

  if (ncol(x) != ncol(sigma)) {
    stop("x and sigma have non-conforming size")
  }

Corrects the problem, and still works for data frames and
vectors.  (Vectors have already been converted to matrices).

-Gregory


==> 503.audit <==
Sat Mar 25 09:48:26 2000	maechler	moved from incoming to Add-ons
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 496 *
From: bonneau@epi.roazhon.inra.fr (en148)
Date: Tue, 21 Mar 2000 10:57:13 +0100 (MET)
--base R has no est.variogram function.
--This appears to be a bug report on sgeostat.
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 496 <==
From bonneau@epi.roazhon.inra.fr  Tue Mar 21 11:40:23 2000
Received: from stat.math.ethz.ch (daemon@hypatia.ethz.ch [129.132.58.23])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id LAA24613
	for <R-bugs@biostat.ku.dk>; Tue, 21 Mar 2000 11:40:21 +0100 (MET)
Received: (from daemon@localhost)
	by stat.math.ethz.ch (8.9.1/8.9.1) id LAA00472
	for <r-bugs@hypatia.math.ethz.ch>; Tue, 21 Mar 2000 11:40:33 +0100 (MET)
Received: from epi.roazhon.inra.fr(194.167.76.1)
 via SMTP by hypatia, id smtpdAAAa0007L; Tue Mar 21 11:40:28 2000
Received: from (bonneau@localhost)
          by epi.roazhon.inra.fr (8.8.8/jtpda-5.3) id KAA09010
          for r-bugs@lists.r-project.org; Tue, 21 Mar 2000 10:57:13 +0100 (MET)
Date: Tue, 21 Mar 2000 10:57:13 +0100 (MET)
From: bonneau@epi.roazhon.inra.fr (en148)
Message-Id: <200003210957.KAA09010@epi.roazhon.inra.fr>

I am using R 0.65.1 under linux (Redhat 6.0),
and I have a problem with the est.variogram function when the first lag is empty (I am trying to estimate anisotropic varios)

fittedpnt<-point(fitted, x="X2", y="X3")
fittedpair<-pair(fittedpnt, num.lags=15, type="anisotropic", theta=60, dtheta=20, maxdist=maxfittedist)
fittedvario<-est.variogram(fittedpnt, fittedpair, "fit")

With my datas I have no pair in lags 1 to 3 and the error message is :
Error in psort(x, partial) : index 0 outside bounds

What can I do, in order to fix the bug ?

==> 496.audit <==
Sat Apr 01 07:32:27 2000	ripley	changed notes
Sat Apr 01 07:32:27 2000	ripley	moved from incoming to Add-ons
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 488 *
Subject: Error in lme?
From: simon.frost@ed.ac.uk
Date: Tue, 14 Mar 2000 14:15:52 +0100 (MET)
--No example to reproduce this.
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 488 <==
From simon.frost@ed.ac.uk  Tue Mar 14 14:15:53 2000
Received: from localhost (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id OAA21597
	for <R-bugs@biostat.ku.dk>; Tue, 14 Mar 2000 14:15:52 +0100 (MET)
Date: Tue, 14 Mar 2000 14:15:52 +0100 (MET)
From: simon.frost@ed.ac.uk
Message-Id: <200003141315.OAA21597@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: Error in lme?

Full_Name: Simon Frost
Version: 1.0.0
OS: Windows
Submission from: (NULL) (129.215.60.79)


Hi everyone,

I've just installed R for Windows - I've previously been using it on Linux -
and I've run into a problem when using lme.

The lme routine throws up an error in the getGroups.data.frame command,
complaining about an error in the formula:

Error in getGroups.data.frame(dataMix, groups) : 
        Invalid formula for groups

getGroups works just fine, and I haven't run into this problem previously.

Any ideas?

Best wishes
Simon

==> 488.reply.1 <==
From bates@franz.stat.wisc.edu  Tue Mar 14 14:41:32 2000
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id OAA22170
	for <R-bugs@biostat.ku.dk>; Tue, 14 Mar 2000 14:41:31 +0100 (MET)
Received: by franz.stat.wisc.edu
	via sendmail from stdin
	id <m12Urd2-000ZTZC@franz.stat.wisc.edu> (Debian Smail3.2.0.102)
	for R-bugs@biostat.ku.dk; Tue, 14 Mar 2000 07:44:56 -0600 (CST) 
Sender: bates@franz.stat.wisc.edu
To: simon.frost@ed.ac.uk
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] Error in lme? (PR#488)
References: <200003141315.OAA21607@pubhealth.ku.dk>
From: Douglas Bates <bates@stat.wisc.edu>
Date: 14 Mar 2000 07:44:56 -0600
In-Reply-To: simon.frost@ed.ac.uk's message of "Tue, 14 Mar 2000 14:15:54 +0100 (MET)"
Message-ID: <6rg0ttll7r.fsf@franz.stat.wisc.edu>
Lines: 15
X-Mailer: Gnus v5.7/Emacs 20.5

simon.frost@ed.ac.uk writes:

> I've just installed R for Windows - I've previously been using it on Linux -
> and I've run into a problem when using lme.
> 
> The lme routine throws up an error in the getGroups.data.frame command,
> complaining about an error in the formula:
> 
> Error in getGroups.data.frame(dataMix, groups) : 
>         Invalid formula for groups
> 
> getGroups works just fine, and I haven't run into this problem previously.

Could you send us an example call that generates this error
(preferably using one of the data sets that comes with R)?

==> 488.audit <==
Sat Apr 01 07:44:08 2000	ripley	changed notes
Sat Apr 08 07:31:32 2000	ripley	moved from incoming to Add-ons
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Directory:  Analyses

none

Directory:  Documentation

* PR# 527 *
Subject: Comments on Win95 R Distribution
From: Art Salwin <salwin@mitretek.org>
Date: Mon, 24 Apr 2000 14:38:42 -0400
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 527 <==
From salwin@mitretek.org  Mon Apr 24 20:36:54 2000
Received: from mtk-mail1.mitretek.org (mtk-mail1.mitretek.org [206.241.50.65])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id UAA08573
	for <r-bugs@biostat.ku.dk>; Mon, 24 Apr 2000 20:36:53 +0200 (MET DST)
Received: from mail1.mitretek.org (mail1.mitretek.org [206.241.49.31])
	by mtk-mail1.mitretek.org (8.9.3/8.9.3) with ESMTP id OAA25586
	for <r-bugs@biostat.ku.dk>; Mon, 24 Apr 2000 14:36:34 -0400 (EDT)
Received: from mitretek.org ([206.241.172.28])
          by mail1.mitretek.org (Lotus Domino Release 5.0.2c)
          with ESMTP id 2000042414363560:43616 ;
          Mon, 24 Apr 2000 14:36:35 -0400 
Message-ID: <390494B2.752CEE17@mitretek.org>
Date: Mon, 24 Apr 2000 14:38:42 -0400
From: Art Salwin <salwin@mitretek.org>
Reply-To: salwin@mitretek.org
Organization: Mitretek Systems
X-Mailer: Mozilla 4.06 [en] (Win95; U)
MIME-Version: 1.0
To: r-bugs@biostat.ku.dk
Subject: Comments on Win95 R Distribution
X-MIMETrack: Itemize by SMTP Server on Mail1/Mitretek Systems(Release 5.0.2c |February 2, 2000) at
 04/24/2000 02:36:35 PM,
	Serialize by Router on Mail1/Mitretek Systems(Release 5.0.2c |February 2, 2000) at
 04/24/2000 02:36:37 PM,
	Serialize complete at 04/24/2000 02:36:37 PM
Content-Transfer-Encoding: 7bit
Content-Type: text/plain; charset=us-ascii

Here are some comments generated by a new R user based on
initial experiences with the tool.  

On-line help for tapply:
The following appears "for to each (non-empty) group of
values"  It seems there's an extra preposition in this
sentence.

On-line help for cut:
"break" should be "breaks"

morley.data not available with the distribution.  Would be
helpful for doing the examples in the Intro.

The rwinst.exe did not work at all on Win95.  It could find
no files.  Wasn't clear from the instructions which
directory I should be in while running rwinst.  I tried
several; none worked.  So I manually unzipped the files and
they worked fine.  


-- 
Art Salwin
salwin@mitretek.org
(202) 863-2985
(202) 863-2988 (fax)

==> 527.audit <==
Tue Apr 25 07:03:53 2000	ripley	moved from incoming to Documentation

==> 527.followup.1 <==
From ripley@stats.ox.ac.uk  Tue Apr 25 09:10:14 2000
Received: from toucan.stats.ox.ac.uk (toucan.stats.ox.ac.uk [163.1.20.20])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id JAA10472
	for <R-bugs@biostat.ku.dk>; Tue, 25 Apr 2000 09:10:13 +0200 (MET DST)
Received: from max118.public.ox.ac.uk (max118.public.ox.ac.uk [192.76.27.118])
	by toucan.stats.ox.ac.uk (8.9.0/8.9.0) with ESMTP id IAA25783;
	Tue, 25 Apr 2000 08:10:19 +0100 (BST)
Date: Tue, 25 Apr 2000 08:09:32 +0100 (BST)
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Sender: ripley@auk.stats
To: salwin@mitretek.org
cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] Comments on Win95 R Distribution (PR#527)
In-Reply-To: <200004241836.UAA08583@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.05.10004250800560.13729-100000@auk.stats>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Mon, 24 Apr 2000 salwin@mitretek.org wrote:

> Here are some comments generated by a new R user based on
> initial experiences with the tool.  

Please give the R version number or (preferably) use bug.report() to
generate the report.

> On-line help for tapply:
> The following appears "for to each (non-empty) group of
> values"  It seems there's an extra preposition in this
> sentence.
> 
> On-line help for cut:
> "break" should be "breaks"

[Fixed, thank you]

> morley.data not available with the distribution.  Would be
> helpful for doing the examples in the Intro.

That has already been altered for R 1.1. The file is in the Rnotes
package on CRAN at present, and will be in 1.1.0 on.

> The rwinst.exe did not work at all on Win95.  It could find
> no files.  Wasn't clear from the instructions which
> directory I should be in while running rwinst.  I tried
> several; none worked.  So I manually unzipped the files and
> they worked fine.  

You can use it from anywhere, hence it does not specify where. This
puzzles me: you have to set the source directory to where the files
are: use the Browse button to do so.  The installer is known to work
on Windows 95, and there have been many, many, successful uses.
Could you please try again using Browse to get the right directory
with the zip files?


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Directory:  Graphics

* PR# 495 *
Subject: barplot
From: skala@incoma.cz
Date: Tue, 21 Mar 2000 09:20:33 +0100 (MET)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 495 <==
From skala@incoma.cz  Tue Mar 21 09:20:34 2000
Received: from localhost (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id JAA22354
	for <R-bugs@biostat.ku.dk>; Tue, 21 Mar 2000 09:20:33 +0100 (MET)
Date: Tue, 21 Mar 2000 09:20:33 +0100 (MET)
From: skala@incoma.cz
Message-Id: <200003210820.JAA22354@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: barplot

Full_Name: Zdenek Skala
Version: 1.0.0
OS: MS Windows 95
Submission from: (NULL) (194.108.127.14)


Dear all,
a problem with barplot() was already discussed on R-help for R 0.90.0 - sorry,
if this is a known bug, but I was unable to find it in the bugs database.
In:
> barplot(c(.1,.5,1), ylim=(0:1))
or
> barplot(c(.1,.5,1), ylim=c(0,1))
the y axis is drawn from 0.2 to 0.8, in:
> barplot(c(.1,.5,1))
the y axis is drawn from 0.0 to 0.8.
As I was notified earlier by Peter Dalgaard, "the axis settings use yaxs='i' 
(or xaxs if horizontal) which sets the plot boundaries equal to the ylim 
(stated or computed) and marks the axes "internally". The endpoints of the 
axes are not considered to be internal."
Sorry again if this is already reported.
With regards
Zdenek Skala

==> 495.reply.1 <==
From pd@biostat.ku.dk  Tue Mar 21 09:53:22 2000
Received: from biostat.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id JAA22811;
	Tue, 21 Mar 2000 09:53:21 +0100 (MET)
Received: (from pd@localhost)
	by biostat.ku.dk (8.9.3/8.9.3) id JAA13278;
	Tue, 21 Mar 2000 09:56:30 +0100
Sender: pd@blueberry.kubism.ku.dk
To: skala@incoma.cz
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] barplot (PR#495)
References: <200003210820.JAA22364@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 21 Mar 2000 09:56:30 +0100
In-Reply-To: skala@incoma.cz's message of "Tue, 21 Mar 2000 09:20:35 +0100 (MET)"
Message-ID: <x2aejs66rl.fsf@blueberry.kubism.ku.dk>
Lines: 21
X-Mailer: Gnus v5.7/Emacs 20.4
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

skala@incoma.cz writes:

> > barplot(c(.1,.5,1), ylim=c(0,1))
> the y axis is drawn from 0.2 to 0.8, in:

> As I was notified earlier by Peter Dalgaard, "the axis settings use yaxs='i' 
> (or xaxs if horizontal) which sets the plot boundaries equal to the ylim 
> (stated or computed) and marks the axes "internally". The endpoints of the 
> axes are not considered to be internal."
> Sorry again if this is already reported.

I actually thought we had that one fixed, but obviously not ...
As usual, the workaround is to extend the ylim a tiny bit:

barplot(c(.1,.5,1), ylim=c(-.001,1.001))

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 495.audit <==
Sat Mar 25 09:45:25 2000	maechler	moved from incoming to Graphics
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 414 *
Subject:  graphics bugs: steep slopes and large values beyond ylim 
From: Ben Bolker <bolker@zoo.ufl.edu>
Date: Mon, 7 Feb 2000 18:28:04 -0500
--Followup on R-devel showed this was due to generating integer coordinates 
--outside +/- 2^15 in the X11 driver.
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 414 <==
From ben@bolker-nt.zoo.ufl.edu  Tue Feb  8 00:32:03 2000
Received: from triarch.zoo.ufl.edu (triarch.zoo.ufl.edu [128.227.60.248])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id AAA13274
	for <r-bugs@biostat.ku.dk>; Tue, 8 Feb 2000 00:32:02 +0100 (MET)
Received: from bolker-nt.zoo.ufl.edu ([128.227.60.126])
          by triarch.zoo.ufl.edu (Netscape Messaging Server 3.5)
           with ESMTP id 494; Mon, 7 Feb 2000 18:32:02 -0500
Received: (from ben@localhost)
	by bolker-nt.zoo.ufl.edu (8.9.3/8.9.3) id SAA22301;
	Mon, 7 Feb 2000 18:28:04 -0500
Date: Mon, 7 Feb 2000 18:28:04 -0500
From: Ben Bolker <bolker@zoo.ufl.edu>
Message-Id: <200002072328.SAA22301@bolker-nt.zoo.ufl.edu>
To: r-bugs@biostat.ku.dk
Subject:  graphics bugs: steep slopes and large values beyond ylim 
Cc: ben@bolker-nt.zoo.ufl.edu


  Some of my students have uncovered some apparent graphics bugs in 
R.  I think they may manifest slightly different on different platforms/
with different display devices (they sometimes report a Windows graph
that looks OK but odd results on printing).
  I'm able to replicate similar problems on my Linux (RH 6.0) system.


1. abline() plots nothing, or a wrong line, when the slope is too steep.

plot(0:10,0:10)
abline(a=0,b=100)
abline(a=0,b=200)
abline(a=0,b=300)
abline(a=0,b=80)

2. when plotting with type "l" and with values far beyond the limits of
the plot, semi-random lines appear on the plot.

plot(exp(1:100),ylim=c(0,10),type="l")

Any thoughts?  I poked a little bit at this myself: abline calls GLine, neither of them
seems to do much checking whether the endpoints of the line to be drawn are way outside of the
window (I guess that XDrawLine, which gets called by GLine, can't handle this).
I guess this should probably be fixed at the the level of GLine (it might fix both of
the above problems, but I'm a little bit afraid digging this deeply into the graphics drivers.
  Maybe it will be obvious to someone closer to the code?

--please do not edit the information below--

Version:
 platform = i686-unknown-linux
 arch = i686
 os = linux
 system = i686, linux
 status = 
 major = 0
 minor = 99.0
 year = 2000
 month = February
 day = 7
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base

==> 414.audit <==
Wed Feb 16 19:26:57 2000	ripley	moved from incoming to Graphics
Sun Feb 20 10:13:40 2000	ripley	changed notes
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 400 *
Subject: X11 troubles
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 13 Jan 2000 14:31:42 +0100
--a) We don't handle multiple window closes well
--b) X11 errors should be caught by an error handler, not kill R
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 400 <==
From pd@biostat.ku.dk  Thu Jan 13 14:29:00 2000
Received: from biostat.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id OAA01544
	for <r-bugs@mail.kubism.ku.dk>; Thu, 13 Jan 2000 14:29:00 +0100 (MET)
Received: (from pd@localhost)
	by biostat.ku.dk (8.9.3/8.9.3) id OAA15286;
	Thu, 13 Jan 2000 14:31:43 +0100
Sender: pd@blueberry.kubism.ku.dk
To: r-bugs@biostat.ku.dk
Subject: X11 troubles
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 13 Jan 2000 14:31:42 +0100
Message-ID: <x23ds2nlmp.fsf@blueberry.kubism.ku.dk>
Lines: 24
X-Mailer: Gnus v5.7/Emacs 20.4
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

Just to get these issues recorded in the bug repository:

a) We don't handle multiple window closes well

My "favourite" version of this is when I ^Z out of an R session with
an open graphics window to do something on the command line, then kill
the graphics window (which does nothing), kill it again, realise that
it's because the R session was stopped, and:

[pd@blueberry BUILD]$ %
bin/R
Segmentation fault (core dumped)

b) X11 errors should be caught by an error handler, not kill R.

This is mainly seen when there's an error somewhere else, such as
trouble with the font setup. But in principle, we should at worst shut
down the graphics window, not R itself.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 400.audit <==
Wed Jan 26 19:28:37 2000	ripley	moved from incoming to Graphics
Mon Feb 28 17:07:48 2000	pd	changed notes
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 202 *
Subject: persp box occlusion bug
From: wsi@gcal.ac.uk
Date: Wed, 2 Jun 1999 15:02:03 +0200 (MET DST)
--The persp algorithm does not apply the occlusion rules to the frame, 
--which is always plotted first. 
--A bug, but not very simple to fix.
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 202 <==
From wsi@gcal.ac.uk  Wed Jun  2 15:02:10 1999
Received: from localhost (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id PAA27126
	for <R-bugs@biostat.ku.dk>; Wed, 2 Jun 1999 15:02:03 +0200 (MET DST)
Date: Wed, 2 Jun 1999 15:02:03 +0200 (MET DST)
From: wsi@gcal.ac.uk
Message-Id: <199906021302.PAA27126@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: persp box occlusion bug

Full_Name: Bill Simpson
Version: 64.1
OS: linux
Submission from: (NULL) (193.62.250.209)


Bug in persp() bounding box:
If the surface being plotted extends below the lower z-axis boundary, the box
is
drawn with the wrong occlusion. The box is shown as being occluded by the
surface
even though it should be in front of the surface.

The box is correct for surface extending above the box. Problem is only for
surface extending below the box.

This exhibits the bug:

std<-rep(seq(-32,32,8),9)/1000 * 60
cf<-rep(seq(-32,32,8),rep(9,9))/1000 *60 
dp<-(cf-std)/.6
std<-unique(std)
cf<-unique(cf)
dp<-t(matrix(dp,length(cf),length(std)))
persp(std,cf,dp, xlim=c(-2,2), ylim=c(-2,2), zlim=c(0,5),theta=-40,    
phi=45,
box=TRUE,ltheta=-120, lphi=120,
d=1.5, shade=.7)


==> 202.audit <==
Wed Jun 30 19:31:18 1999	pd	moved from incoming to Graphics
Thu Jul 01 18:19:48 1999	pd	changed notes
Sun Feb 20 10:07:11 2000	ripley	changed notes
Mon Feb 28 17:17:51 2000	pd	changed notes
Mon Feb 28 17:18:28 2000	pd	changed notes
Mon Feb 28 17:19:35 2000	pd	changed notes
Mon Feb 28 17:20:17 2000	pd	changed notes
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Directory:  In-Out

none

Directory:  Installation

* PR# 485 *
Subject: Install R1.0.0
From: Lynn Zhang <lyzhang@umich.edu>
Date: Mon, 13 Mar 2000 16:10:52 -0500 (EST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 485 <==
From lyzhang@umich.edu  Mon Mar 13 22:13:28 2000
Received: from shiwala.admin.lsa.umich.edu (shiwala.admin.lsa.umich.edu [141.211.75.248])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id WAA13925
	for <r-bugs@biostat.ku.dk>; Mon, 13 Mar 2000 22:13:26 +0100 (MET)
Received: from kongzi.admin.lsa.umich.edu (lyzhang@kongzi.admin.lsa.umich.edu [141.211.32.160])
	by shiwala.admin.lsa.umich.edu (8.9.3/8.9.3/LSA 8.9.3 1999/10/05 22:57:41 lyzhang) with ESMTP id QAA15200
	for <r-bugs@biostat.ku.dk>; Mon, 13 Mar 2000 16:13:31 -0500 (EST)
Received: from localhost by kongzi.admin.lsa.umich.edu (8.9.3/8.9.3) with SMTP id QAA23357
	for <r-bugs@biostat.ku.dk>; Mon, 13 Mar 2000 16:10:52 -0500 (EST)
X-Authentication-Warning: kongzi.admin.lsa.umich.edu: lyzhang owned process doing -bs
Date: Mon, 13 Mar 2000 16:10:52 -0500 (EST)
From: Lynn Zhang <lyzhang@umich.edu>
X-Sender: lyzhang@kongzi.admin.lsa.umich.edu
To: r-bugs@biostat.ku.dk
Subject: Install R1.0.0
Message-ID: <Pine.SOL.3.95.1000313160825.18282A-100000@kongzi.admin.lsa.umich.edu>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII


Hello,

I tried to compile and install R. After I ran
make 2>&1 | tee log
., I got the following error:

making system.d from system.c
system.c:37: readline/readline.h: No such file or directory
make[3]: *** [system.d] Error 1
make[3]: Leaving directory
`/afs/lsa.umich.edu/group/admin/software/build/R/R-1.
0.0/src/unix'
make[2]: *** [R] Error 2
make[2]: Leaving directory
`/afs/lsa.umich.edu/group/admin/software/build/R/R-1.
0.0/src/unix'
make[1]: *** [R] Error 1
make[1]: Leaving directory
`/afs/lsa.umich.edu/group/admin/software/build/R/R-1.
0.0/src'
make: *** [R] Error 1



Please help.

Lots aof thanks!

*=======================================* 
*	Lynn Zhang             	        *
*	LS&A System Services Team       *
*	lyzhang@umich.edu               *
*=======================================*


==> 485.reply.1 <==
From thomas@biostat.washington.edu  Mon Mar 13 22:24:59 2000
Received: from mail.biostat.washington.edu (mail.biostat.washington.edu [128.95.113.21])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id WAA13978
	for <R-bugs@biostat.ku.dk>; Mon, 13 Mar 2000 22:24:58 +0100 (MET)
Received: from mail.biostat.washington.edu (mail.biostat.washington.edu [128.95.113.21])
	by mail.biostat.washington.edu (8.9.3+Sun/8.9.1-fetrow-99-05-16b) with ESMTP id NAA03758;
	Mon, 13 Mar 2000 13:25:00 -0800 (PST)
Date: Mon, 13 Mar 2000 13:24:59 -0800 (PST)
From: Thomas Lumley <thomas@biostat.washington.edu>
To: lyzhang@umich.edu
cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] Install R1.0.0 (PR#485)
In-Reply-To: <200003132113.WAA13935@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.21.0003131315460.18281-100000@mail.biostat.washington.edu>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Mon, 13 Mar 2000 lyzhang@umich.edu wrote:

> 
> Hello,
> 
> I tried to compile and install R. After I ran
> make 2>&1 | tee log
> ., I got the following error:
> 
> making system.d from system.c
> system.c:37: readline/readline.h: No such file or directory

It looks as though you are trying to use GNU readline without it being
present.  This shouldn't be allowed by configure.

Try 
     make distclean
     ./configure
     make

again, to see if the problem goes away. If it doesn't then
look at src/include/config.h to see if you have something like
/* GNU Readline Library */
#define HAVE_LIBREADLINE 1
#define HAVE_READLINE_HISTORY_H 1
#define HAVE_READLINE_READLINE_H 1
indicating that configure thinks you have readline or like
/* GNU Readline Library */
/* #undef HAVE_LIBREADLINE */
/* #undef HAVE_READLINE_HISTORY_H */
/* #undef HAVE_READLINE_READLINE_H */
indicating that it doesn't.

In either case there would be a problem with configure, but a different
one. It's possible, for example, that configure is finding the readline
headers but that the compiler isn't looking in the same place.

Of course this is assuming you do have the GNU readline library and
headers. If you don't, then
	./configure --without-readline
is a workaround, though we would still like to know why configure thinks
you have it.


	-thomas

Thomas Lumley
Assistant Professor, Biostatistics
University of Washington, Seattle




> make[3]: *** [system.d] Error 1
> make[3]: Leaving directory
> `/afs/lsa.umich.edu/group/admin/software/build/R/R-1.
> 0.0/src/unix'
> make[2]: *** [R] Error 2
> make[2]: Leaving directory
> `/afs/lsa.umich.edu/group/admin/software/build/R/R-1.
> 0.0/src/unix'
> make[1]: *** [R] Error 1
> make[1]: Leaving directory
> `/afs/lsa.umich.edu/group/admin/software/build/R/R-1.
> 0.0/src'
> make: *** [R] Error 1
> 
> 
> 
> Please help.
> 
> Lots aof thanks!
> 
> *=======================================* 
> *	Lynn Zhang             	        *
> *	LS&A System Services Team       *
> *	lyzhang@umich.edu               *
> *=======================================*
> 
> 
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
> 

Thomas Lumley
Assistant Professor, Biostatistics
University of Washington, Seattle


==> 485.followup.1 <==
From lyzhang@umich.edu  Tue Mar 14 22:36:11 2000
Received: from shiwala.admin.lsa.umich.edu (shiwala.admin.lsa.umich.edu [141.211.75.248])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id WAA25640
	for <R-bugs@biostat.ku.dk>; Tue, 14 Mar 2000 22:36:10 +0100 (MET)
Received: from kongzi.admin.lsa.umich.edu (lyzhang@kongzi.admin.lsa.umich.edu [141.211.32.160])
	by shiwala.admin.lsa.umich.edu (8.9.3/8.9.3/LSA 8.9.3 1999/10/05 22:57:41 lyzhang) with ESMTP id QAA22968;
	Tue, 14 Mar 2000 16:36:17 -0500 (EST)
Received: from localhost by kongzi.admin.lsa.umich.edu (8.9.3/8.9.3) with SMTP id QAA09313;
	Tue, 14 Mar 2000 16:33:30 -0500 (EST)
X-Authentication-Warning: kongzi.admin.lsa.umich.edu: lyzhang owned process doing -bs
Date: Tue, 14 Mar 2000 16:33:30 -0500 (EST)
From: Lynn Zhang <lyzhang@umich.edu>
X-Sender: lyzhang@kongzi.admin.lsa.umich.edu
To: Thomas Lumley <thomas@biostat.washington.edu>
cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] Install R1.0.0 (PR#485)
In-Reply-To: <Pine.GSO.4.21.0003131315460.18281-100000@mail.biostat.washington.edu>
Message-ID: <Pine.SOL.3.95.1000314163154.17926J-100000@kongzi.admin.lsa.umich.edu>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII


Hello,

After I run make, I got the following error,

__d_sign                            /usr/lsa/lib/libblas.a(drotg.o)
ld: fatal: Symbol referencing errors. No output written to ../../bin/R.X11
make[3]: *** [../../bin/R.X11] Error 1
make[3]: Leaving directory
`/afs/lsa.umich.edu/group/admin/software/build/R/R-1.0.0/src/main'
make[2]: *** [R] Error 2
make[2]: Leaving directory
`/afs/lsa.umich.edu/group/admin/software/build/R/R-1.0.0/src/main'
make[1]: *** [R] Error 1
make[1]: Leaving directory
`/afs/lsa.umich.edu/group/admin/software/build/R/R-1.0.0/src'
make: *** [R] Error 1


Would you please help me on that?

Lots of thanks!




*=======================================* 
*	Lynn Zhang             	        *
*	LS&A System Services Team       *
*	lyzhang@umich.edu               *
*=======================================*


==> 485.audit <==
Sat Mar 25 09:40:03 2000	maechler	moved from incoming to Installation
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 478 *
Subject: Conditional for XDR code left out in saveload.c
From: hoffmann@ehmgs2.et.tu-dresden.de
Date: Thu, 9 Mar 2000 09:43:01 +0100 (MET)
--This seems to be a harmless warning, not an error.
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 478 <==
From hoffmann@ehmgs2.et.tu-dresden.de  Thu Mar  9 09:43:02 2000
Received: from localhost (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id JAA07568
	for <R-bugs@biostat.ku.dk>; Thu, 9 Mar 2000 09:43:01 +0100 (MET)
Date: Thu, 9 Mar 2000 09:43:01 +0100 (MET)
From: hoffmann@ehmgs2.et.tu-dresden.de
Message-Id: <200003090843.JAA07568@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: Conditional for XDR code left out in saveload.c

Full_Name: Thomas Hoffmann
Version: 1.0.0
OS: OS/2 Warp 4.0 FP 11
Submission from: (NULL) (141.30.125.20)


I autoconfigured/configured the src'es w/o having XDR (#undef HAVE_RPC_XDR_H).

In saveload.c , at the beginning of the file the XDR code is enclosed by
matching #ifdefs.

But in the NEW_SAVE_FORMAT section, there are no #ifdefs around the XDR code.

Does this imply that using the new save format requires using XDR or is 
this simply an oversight?

==> 478.followup.1 <==
From ripley@stats.ox.ac.uk  Thu Mar  9 10:13:28 2000
Received: from toucan.stats.ox.ac.uk (toucan.stats.ox.ac.uk [163.1.20.20])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id KAA08143
	for <R-bugs@biostat.ku.dk>; Thu, 9 Mar 2000 10:13:27 +0100 (MET)
Received: from max164.public.ox.ac.uk (max164.public.ox.ac.uk [192.76.27.164])
	by toucan.stats.ox.ac.uk (8.9.0/8.9.0) with ESMTP id JAA17986;
	Thu, 9 Mar 2000 09:10:23 GMT
Date: Thu, 9 Mar 2000 09:10:51 +0000 (GMT)
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Sender: ripley@auk.stats
To: hoffmann@ehmgs2.et.tu-dresden.de
cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] Conditional for XDR code left out in saveload.c (PR#478)
In-Reply-To: <200003090843.JAA07578@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.05.10003090908141.7342-100000@auk.stats>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Thu, 9 Mar 2000 hoffmann@ehmgs2.et.tu-dresden.de wrote:

> Full_Name: Thomas Hoffmann
> Version: 1.0.0
> OS: OS/2 Warp 4.0 FP 11
> Submission from: (NULL) (141.30.125.20)
> 
> 
> I autoconfigured/configured the src'es w/o having XDR (#undef HAVE_RPC_XDR_H).
> 
> In saveload.c , at the beginning of the file the XDR code is enclosed by
> matching #ifdefs.
> 
> But in the NEW_SAVE_FORMAT section, there are no #ifdefs around the XDR code.
> 
> Does this imply that using the new save format requires using XDR or is 
> this simply an oversight?

The defines in R_SaveToFile and R_LoadFromFile determine what is 
actually used.  I think all that happens is that unused code is not
excluded from the compile (and that happens with the BinarySave code
if XDR is available).

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


==> 478.audit <==
Sun Mar 12 13:57:21 2000	ripley	changed notes
Sun Mar 12 13:57:21 2000	ripley	moved from incoming to Installation
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 467 *
Subject: Re: [R] Re: R-1.0.0 is released
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 01 Mar 2000 20:26:40 +0100
--followup to PR#466
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 467 <==
From pd@biostat.ku.dk  Wed Mar  1 20:27:42 2000
Received: from stat.math.ethz.ch (daemon@hypatia.ethz.ch [129.132.58.23])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id UAA01870
	for <R-bugs@biostat.ku.dk>; Wed, 1 Mar 2000 20:27:42 +0100 (MET)
Received: (from daemon@localhost)
	by stat.math.ethz.ch (8.9.1/8.9.1) id UAA07371;
	Wed, 1 Mar 2000 20:26:49 +0100 (MET)
Received: from kubism.kubism.ku.dk(130.225.108.10), claiming to be "pubhealth.ku.dk"
 via SMTP by hypatia, id smtpdAAAa001n5; Wed Mar  1 20:26:44 2000
Received: from biostat.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id UAA01866;
	Wed, 1 Mar 2000 20:26:30 +0100 (MET)
Received: (from pd@localhost)
	by biostat.ku.dk (8.9.3/8.9.3) id UAA10344;
	Wed, 1 Mar 2000 20:26:40 +0100
Sender: pd@blueberry.kubism.ku.dk
To: bhoel@server.python.net (Berthold H?llmann)
Cc: r-help@stat.math.ethz.ch, r-bugs@stat.math.ethz.ch
Subject: Re: [R] Re: R-1.0.0 is released
References: <x23dqc5obk.fsf@blueberry.kubism.ku.dk> <m2zosienvd.fsf@pchoel.privat.uni-hamburg.de>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 01 Mar 2000 20:26:40 +0100
In-Reply-To: bhoel@server.python.net's message of "01 Mar 2000 16:00:54 +0100"
Message-ID: <x29002cwzz.fsf@blueberry.kubism.ku.dk>
Lines: 52
X-Mailer: Gnus v5.7/Emacs 20.4
Mime-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
X-MIME-Autoconverted: from 8bit to quoted-printable by pubhealth.ku.dk id UAA01866
Content-Transfer-Encoding: 8bit
X-MIME-Autoconverted: from quoted-printable to 8bit by pubhealth.ku.dk id UAA01870

bhoel@server.python.net (Berthold Höllmann) writes:

> Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:
> 
> > I've rolled up R-1.0.0.tgz a short while ago. 
> > 
> I've build R-1.0.0 on my
> 
> >uname -a
> Linux pchoel 2.2.14 #3 Mit Jan 5 08:57:39 MET 2000 i686 unknown
> 
> box. Calling "make check" fails with 
....
> > all(tx == tx0)
> Error in all(tx == tx0) : dim<- length of dims do not match the length of object
> Execution halted
> 
> Don't shure what I should think about it. 
> 
> my compiler is:
> 
> >gcc --version
> 2.95.2
> 
> R is compiled using the
> 
> "-fPIC -O3 -fstrict-aliasing -ffast-math -funroll-loops -mpentiumpro -march=pentiumpro -fschedule-insns2"
> 
> compiler switches. I used 
> 
> ./configure --with-g77 --enable-blas_risc --enable-readline --with-x
> 
> for configuring.

That's a pretty heavy set of optimization options you're using there!

Basically, there are two possibilities:

1) You've triggered a compiler bug
2) You've triggered a bug in R

In either case, you'll have to dig deeper and see if you can catch the
exact spot where things go wrong. You might start R with the debugger,
run the base-Ex.R with it while having a breakpoint set at the error
message you are getting. But before that try running the example that
triggers the bug by itself and see if the bug is still tickled.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 467.reply.1 <==
From pd@biostat.ku.dk  Wed Mar  1 20:40:32 2000
Received: from biostat.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id UAA01920;
	Wed, 1 Mar 2000 20:40:32 +0100 (MET)
Received: (from pd@localhost)
	by biostat.ku.dk (8.9.3/8.9.3) id UAA10356;
	Wed, 1 Mar 2000 20:40:48 +0100
Sender: pd@blueberry.kubism.ku.dk
To: p.dalgaard@biostat.ku.dk
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk, r-help@stat.math.ethz.ch
Subject: Re: [Rd] Re: [R] Re: R-1.0.0 is released (PR#467)
References: <200003011927.UAA01880@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 01 Mar 2000 20:40:48 +0100
In-Reply-To: p.dalgaard@biostat.ku.dk's message of "Wed, 1 Mar 2000 20:27:43 +0100 (MET)"
Message-ID: <x266v6cwcf.fsf@blueberry.kubism.ku.dk>
Lines: 11
X-Mailer: Gnus v5.7/Emacs 20.4
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

p.dalgaard@biostat.ku.dk writes:

...and notice that it is a very bad idea to mail to both r-help and
r-bugs. Anyone who answers the one on r-help without resetting the
Cc's will generate a new PR# , like I just did!

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 467.audit <==
Sat Apr 01 07:37:57 2000	ripley	moved from incoming to Installation
Sat Apr 01 07:38:40 2000	ripley	changed notes
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 466 *
Subject: Re: R-1.0.0 is released
From: bhoel@server.python.net (Berthold=?iso-8859-1?q?_H=F6llmann?=)
Date: 01 Mar 2000 16:00:54 +0100
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 466 <==
From bhoel@server.python.net  Wed Mar  1 18:12:56 2000
Received: from stat.math.ethz.ch (daemon@hypatia.ethz.ch [129.132.58.23])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id SAA01317
	for <R-bugs@biostat.ku.dk>; Wed, 1 Mar 2000 18:12:55 +0100 (MET)
Received: (from daemon@localhost)
	by stat.math.ethz.ch (8.9.1/8.9.1) id SAA03990
	for <r-bugs@hypatia.math.ethz.ch>; Wed, 1 Mar 2000 18:13:07 +0100 (MET)
Received: from public.rrz.uni-hamburg.de(134.100.32.55), claiming to be "public.uni-hamburg.de"
 via SMTP by hypatia, id smtpdBAAa000yI; Wed Mar  1 18:12:57 2000
Received: from pchoel.privat.uni-hamburg.de (root@max1-055.public.uni-hamburg.de [134.100.43.55])
	by public.uni-hamburg.de (8.8.8/8.8.8) with ESMTP id SAA10846;
	Wed, 1 Mar 2000 18:12:54 +0100
Received: (from hoel@localhost)
	by pchoel.privat.uni-hamburg.de (8.9.3/8.9.3) id QAA27467;
	Wed, 1 Mar 2000 16:00:54 +0100
X-Authentication-Warning: pchoel.privat.uni-hamburg.de: hoel set sender to bhoel@starship.python.net using -f
Sender: hoel@public.uni-hamburg.de
To: r-help@stat.math.ethz.ch, r-bugs@stat.math.ethz.ch
Subject: Re: R-1.0.0 is released
References: <x23dqc5obk.fsf@blueberry.kubism.ku.dk>
From: bhoel@server.python.net (Berthold=?iso-8859-1?q?_H=F6llmann?=)
Date: 01 Mar 2000 16:00:54 +0100
In-Reply-To: Peter Dalgaard BSA's message of "29 Feb 2000 10:51:27 +0100"
Message-ID: <m2zosienvd.fsf@pchoel.privat.uni-hamburg.de>
Lines: 63
User-Agent: Gnus/5.0803 (Gnus v5.8.3) Emacs/20.6
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

> I've rolled up R-1.0.0.tgz a short while ago. 
> 
I've build R-1.0.0 on my

>uname -a
Linux pchoel 2.2.14 #3 Mit Jan 5 08:57:39 MET 2000 i686 unknown

box. Calling "make check" fails with 

...
make[4]: Entering directory `/opt/src/devel/R-1.0.0/tests/Examples'
updating base-Ex.R ...
make[5]: Entering directory `/opt/src/devel/R-1.0.0/src/library'
 >>> Building/Updating help pages for package `base'
     Formats: text example 
make[5]: Leaving directory `/opt/src/devel/R-1.0.0/src/library'
running code in base-Ex.R ...
../../bin/R --vanilla < base-Ex.R > base-Ex.Rout
make[4]: *** [base-Ex.Rout] Error 1
...

and 

>tail tests/Examples/base-Ex.Rout
> 
> cut(rep(1,5),4)#-- dummy
[1] (0.9995,1] (0.9995,1] (0.9995,1] (0.9995,1] (0.9995,1]
Levels:  (0.999,0.9995] (0.9995,1] (1,1.0005] (1.0005,1.001] 
> tx0 <- c(9, 4, 6, 5, 3, 10, 5, 3, 5)
> x <- rep(0:8, tx0)
> tx <- table(x)
> all(tx == tx0)
Error in all(tx == tx0) : dim<- length of dims do not match the length of object
Execution halted

Don't shure what I should think about it. 

my compiler is:

>gcc --version
2.95.2

R is compiled using the

"-fPIC -O3 -fstrict-aliasing -ffast-math -funroll-loops -mpentiumpro -march=pentiumpro -fschedule-insns2"

compiler switches. I used 

./configure --with-g77 --enable-blas_risc --enable-readline --with-x

for configuring.

Cheers

Berthold

-- 
bhoel@starship.python.net / http://starship.python.net/crew/bhoel/
        It is unlawful to use this email address for unsolicited ads
        (USC Title 47 Sec.227). I will assess a US$500 charge for
        reviewing and deleting each unsolicited ad.

==> 466.followup.1 <==
From plummer@iarc.fr  Thu Mar  2 10:59:27 2000
Received: from smtp02.iarc.fr (IDENT:root@uu194-7-167-221.unknown.uunet.be [194.7.167.221])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id KAA06126
	for <R-bugs@biostat.ku.dk>; Thu, 2 Mar 2000 10:59:27 +0100 (MET)
Received: from xena.iarc.fr ([10.10.150.125])
	by smtp02.iarc.fr (8.9.3/8.9.3) with ESMTP id KAA13613;
	Thu, 2 Mar 2000 10:58:59 +0100
Message-ID: <XFMail.000302110739.plummer@iarc.fr>
X-Mailer: XFMail 1.3 [p0] on Linux
X-Priority: 3 (Normal)
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 8bit
MIME-Version: 1.0
In-Reply-To: <200003011712.SAA01327@pubhealth.ku.dk>
Date: Thu, 02 Mar 2000 11:07:39 +0100 (CET)
Organization: International Agency for Research on Cancer
Sender: martyn@xena.iarc.fr
From: Martyn Plummer <plummer@iarc.fr>
To: bhoel@server.python.net
Subject: RE: [Rd] Re: R-1.0.0 is released (PR#466)
Cc: R-bugs@biostat.ku.dk, r-devel@stat.math.ethz.ch

On 01-Mar-00 bhoel@server.python.net wrote:
> R is compiled using the
> 
> "-fPIC -O3 -fstrict-aliasing -ffast-math -funroll-loops -mpentiumpro
> -march=pentiumpro -fschedule-insns2"
> 
> compiler switches. I used 
> 
> ./configure --with-g77 --enable-blas_risc --enable-readline --with-x
> 
> for configuring.

I can't help noticing that you are configuring for a RISC optimized BLAS
library on an Intel x86 processor.  I have no idea if this is serious,
but it seems a bit odd.

Martyn

==> 466.followup.2 <==
From bacon@aerodyne.com  Thu Mar  2 18:01:00 2000
Received: from chi6-1.relay.mail.uu.net (chi6-1.relay.mail.uu.net [199.171.54.98])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id SAA11561
	for <R-bugs@biostat.ku.dk>; Thu, 2 Mar 2000 18:00:59 +0100 (MET)
From: bacon@aerodyne.com
Received: from aerodyne.com by chi6sosrv11.alter.net with ESMTP 
	(peer crosschecked as: [198.4.243.2])
	id QQieuf23702;
	Thu, 2 Mar 2000 15:27:53 GMT
Received: from aerodyne.com (keeshond.aerodyne.com [198.4.242.196]) by aerodyne.com (Hah!/nope) with ESMTP id KAA01933; Thu, 2 Mar 2000 10:27:39 -0500 (EST)
Message-Id: <200003021527.KAA01933@aerodyne.com>
Date: Thu, 2 Mar 2000 10:36:46 -0500 (EST)
Reply-To: bacon@aerodyne.com
Subject: RE: [Rd] Re: R-1.0.0 is released (PR#466)
To: plummer@iarc.fr
cc: bhoel@server.python.net, R-bugs@biostat.ku.dk, r-devel@stat.math.ethz.ch
In-Reply-To: <XFMail.000302110739.plummer@iarc.fr>
MIME-Version: 1.0
Content-Type: TEXT/plain; CHARSET=US-ASCII

On  2 Mar, Martyn Plummer wrote:
>  On 01-Mar-00 bhoel@server.python.net wrote:
> > R is compiled using the
> > 
> > "-fPIC -O3 -fstrict-aliasing -ffast-math -funroll-loops -mpentiumpro
> > -march=pentiumpro -fschedule-insns2"
> > 
> > compiler switches. I used 
> > 
> > ./configure --with-g77 --enable-blas_risc --enable-readline --with-x
> > 
> > for configuring.
>  
>  I can't help noticing that you are configuring for a RISC optimized BLAS
>  library on an Intel x86 processor.  I have no idea if this is serious,
>  but it seems a bit odd.
>  

Since this feature was added for PowerPC Linux distributions at my
request, I'll comment on this.  I would say that it is very unlikely to
be of any help, but it probably won't hurt.  The configure script will
check to see if libblas_risc can be located.  If it can't be found, it
won't be used.  Configure won't even look for it unless you request it
with --enable-blas_risc.

Furthermore, I don't believe that configure will actually use
libblas_risc unless you also --enable-blas.  I could be wrong in that
regard.  Using --enable-blas_risc could implicitly --enable-blas as
well. It's been many months since I wrote that configure option.  I do
know that configure will test if linking -lblas works first.  If that
fails, it won't even bother with -lblas_risc.  

Hope this helps,

-- 
Fred Bacon

==============================================================================
Aerodyne Research, Inc.                        Phone:  (978) 663-9500 ext. 273
45 Manning Rd.                                   FAX:  (978) 663-4918
Billerica, MA 01821-3976                        http://www.aerodyne.com
==============================================================================
"Oh my God!  Space aliens!  Don't eat me, I have a wife and kids!  Eat them."
                                                             -- Homer Simpson



==> 466.audit <==
Sat Apr 01 07:37:27 2000	ripley	moved from incoming to Installation
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Directory:  Language

* PR# 412 *
Subject: anomalies with call objects
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 06 Feb 2000 01:18:50 +0100
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 412 <==
From postmaster@franz.stat.wisc.edu  Sun Feb  6 01:16:33 2000
Received: from stat.math.ethz.ch (daemon@hypatia.ethz.ch [129.132.58.23])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id BAA26868
	for <R-bugs@biostat.ku.dk>; Sun, 6 Feb 2000 01:16:31 +0100 (MET)
Received: (from daemon@localhost)
	by stat.math.ethz.ch (8.9.1/8.9.1) id BAA18080
	for <r-bugs@hypatia.math.ethz.ch>; Sun, 6 Feb 2000 01:16:38 +0100 (MET)
Received: from franz.stat.wisc.edu(128.105.174.95)
 via SMTP by hypatia, id smtpdAAAa004QS; Sun Feb  6 01:16:33 2000
Received: from pubhealth.ku.dk (really [130.225.108.10]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m12HFNP-000ZSxC@franz.stat.wisc.edu> (Debian Smail3.2.0.102)
	for <r-bugs@r-project.org>; Sat, 5 Feb 2000 18:16:31 -0600 (CST) 
Received: from biostat.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id BAA26864
	for <r-bugs@r-project.org>; Sun, 6 Feb 2000 01:16:18 +0100 (MET)
Received: (from pd@localhost)
	by biostat.ku.dk (8.9.3/8.9.3) id BAA12311;
	Sun, 6 Feb 2000 01:18:51 +0100
Sender: pd@blueberry.kubism.ku.dk
To: r-bugs@r-project.org
Subject: anomalies with call objects
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 06 Feb 2000 01:18:50 +0100
Message-ID: <x2900zyyhh.fsf@blueberry.kubism.ku.dk>
Lines: 51
X-Mailer: Gnus v5.7/Emacs 20.4
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit


Call objects don't always behave as you'd expect. They're mostly
list-like, but with exceptions:

> f<-function(x,y,...)match.call(expand.dots=FALSE)
> xx <- f(y=1,2,z=3,4)
> dd <- xx$...
> xx$... <- NULL
> c(xx,dd)
[[1]]
f(x = 2, y = 1)

$z
[1] 3

[[3]]
[1] 4

> as.call(c(as.list(xx),dd))
f(x = 2, y = 1, z = 3, 4)

(Splus has this rather differently, since dd becomes a call to list()
rather than a list of promises:

S> c(xx,dd)
f(x = 2, y = 1, list, z = 3, 4)
S> as.call(c(as.list(xx),dd))
f(x = 2, y = 1, list, z = 3, 4)

...but at least gives the same in both cases)

Also, the names of arguments added with [[<- is getting dropped if a
new element is required:

> xx[["abc"]]<-123
> xx
f(x = 2, y = 1, 123)

S has what I'd expect there:

S> xx[["abc"]]<-123
S> xx
f(x = 2, y = 1, abc = 123)

[R-0.99.0 prerelease on RedHat6.1, but this is likely not a new thing.]

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 412.audit <==
Wed Feb 16 19:26:57 2000	ripley	moved from incoming to Language
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 408 *
Subject: convolution bug
From: wsimpson@gcal.ac.uk
Date: Fri, 28 Jan 2000 11:17:36 +0100 (MET)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 408 <==
From wsimpson@gcal.ac.uk  Fri Jan 28 11:17:36 2000
Received: from localhost (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id LAA11325
	for <R-bugs@biostat.ku.dk>; Fri, 28 Jan 2000 11:17:36 +0100 (MET)
Date: Fri, 28 Jan 2000 11:17:36 +0100 (MET)
From: wsimpson@gcal.ac.uk
Message-Id: <200001281017.LAA11325@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: convolution bug

Full_Name: Bill Simpson
Version: 65.1 , 0.90.1
OS: Linux
Submission from: (NULL) (193.62.250.209)


I reported this on r-help, but here is official bug report.

The present convolve() does not do convolution by default. Its default behaviour
is
correlation. This is a bug.

The default argument conj should be set to FALSE.

The zero-padding should be on the right for linear convolution (don't ask me
why you call this type="open"; I suggest type="linear").

Here is what I expect linear convolution to do:
myconvolve<-function (x,h) 
{
    nx <- length(x)
    nh <- length(h)
    #zero pad
    if(nx>nh)
       {
       x <- c(x,rep(0, nh-1))
       h<-c(h,rep(0,nx-1))
       }
    else
       {
       h <- c(h,rep(0, nx-1))
       x<-c(x,rep(0,nh-1))
       }
    x <- fft(fft(x) * fft(h), inv = TRUE)
    Re(x)/length(x)
#I am not sure about this, the R IFFT is weird
}

What "circular" convolution should do is just
eliminate the zero-padding:

myconvolve2<-function (x,h)
{
#no padding, circular convolution
    nx <- length(x)
    nh <- length(h)
    x <- fft(fft(x) * fft(h), inv = TRUE)
    Re(x)/(nx)
}


I suggest that you create two functions, convolve() and correlate(), and get
rid
of the conj argument in convolve().

==> 408.audit <==
Wed Feb 16 19:28:42 2000	ripley	moved from incoming to Language
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Directory:  Low-level

* PR# 505 *
Subject: interrupted save 
From: Thomas Lumley <thomas@biostat.washington.edu>
Date: Sat, 25 Mar 2000 12:16:50 -0800 (PST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 505 <==
From thomas@biostat.washington.edu  Sat Mar 25 21:16:39 2000
Received: from mail.biostat.washington.edu (mail.biostat.washington.edu [128.95.113.21])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id VAA08785
	for <R-bugs@biostat.ku.dk>; Sat, 25 Mar 2000 21:16:38 +0100 (MET)
Received: from mail.biostat.washington.edu (mail.biostat.washington.edu [128.95.113.21])
	by mail.biostat.washington.edu (8.9.3+Sun/8.9.1-fetrow-99-05-16b) with ESMTP id MAA24561
	for <R-bugs@biostat.ku.dk>; Sat, 25 Mar 2000 12:16:50 -0800 (PST)
Date: Sat, 25 Mar 2000 12:16:50 -0800 (PST)
From: Thomas Lumley <thomas@biostat.washington.edu>
To: R-bugs@biostat.ku.dk
Subject: interrupted save 
In-Reply-To: <Pine.GSO.4.21.0003251204350.22429-100000@mail.biostat.washington.edu>
Message-ID: <Pine.GSO.4.21.0003251207350.22429-100000@mail.biostat.washington.edu>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII


If an error occurs during a save the file does not appear to be
closed and buffers flushed.  This can lead to corruption if the same
filename is used later and then the buffer is flushed on program exit.

For example, tn the context of PR #504

 f<-function(x,...){ function(y) list(x=x,y=y,...)}
 a<-f(1,2,3)
 save(list="a",file="a.rdata")  ## -- error --
 b<-1:10
 save(list="b",file="a.rdata")
 load("a.rdata")  ## works
 q("no")
 
 R

 load("a.rdata")  ## error



This is R1.0 on Linux

	-thomas

Thomas Lumley
Assistant Professor, Biostatistics
University of Washington, Seattle


==> 505.audit <==
Thu Apr 13 06:21:36 2000	ripley	moved from incoming to Low-level
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Directory:  Misc

none

Directory:  Models

none

Directory:  Startup

* PR# 486 *
Subject: Re: autoload error in profile {was anova-bug in R-version  1.0.0?}
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Tue, 14 Mar 2000 10:32:43 +0100 (MET)
--workaround to the origin problem in 1.0.1
--New report: try does not work from the profile.
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 486 <==
From maechler@stat.math.ethz.ch  Tue Mar 14 10:32:36 2000
Received: from stat.math.ethz.ch (daemon@hypatia.ethz.ch [129.132.58.23])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id KAA17249
	for <R-bugs@biostat.ku.dk>; Tue, 14 Mar 2000 10:32:35 +0100 (MET)
Received: (from daemon@localhost)
	by stat.math.ethz.ch (8.9.1/8.9.1) id KAA21252;
	Tue, 14 Mar 2000 10:32:48 +0100 (MET)
Received: from lynne(129.132.58.30), claiming to be "lynne.ethz.ch"
 via SMTP by hypatia, id smtpdAAAa005C1; Tue Mar 14 10:32:44 2000
Received: (maechler@localhost) by lynne.ethz.ch (8.9.3/D-MATH-client) id KAA03934; Tue, 14 Mar 2000 10:32:44 +0100
X-Authentication-Warning: lynne.ethz.ch: maechler set sender to maechler@stat.math.ethz.ch using -f
From: Martin Maechler <maechler@stat.math.ethz.ch>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Message-ID: <14542.1851.731086.380@lynne.ethz.ch>
Date: Tue, 14 Mar 2000 10:32:43 +0100 (MET)
To: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Cc: R-bugs@stat.math.ethz.ch
Subject: Re: autoload error in profile {was anova-bug in R-version  1.0.0?}
 (PR#470)
In-Reply-To: <Pine.GSO.4.05.10003071100180.20079-100000@auk.stats>
References: <14532.56910.278837.379365@lynne.ethz.ch>
	<Pine.GSO.4.05.10003071100180.20079-100000@auk.stats>
X-Mailer: VM 6.75 under Emacs 20.6.1
Reply-To: Martin Maechler <maechler@stat.math.ethz.ch>

>>>>> "BDR" == Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:

    BDR> On Tue, 7 Mar 2000, Martin Maechler wrote:
    >> >>>>> "BDR" == Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:
    >> 
    BDR> On Tue, 7 Mar 2000, Trenkler, Dietrich wrote:
    >> >> I think I've discovered what went wrong.
    >> >> 
    >> >> My workspace included a function wilcox.test formerly copied from
    >> >> ctest. Now ctest ist part of the distribution and because of that I
    >> >> always got the message:
    >> >> 
    >> >> [Previously saved workspace restored]
    >> >> 
    >> >> Error in autoload("wilcox.test", "ctest") :
    >> >> Object already exists
    >> >> 
    >> >> I didn't take care of this message. Now I removed wilcox.test, saved
    >> >> the WS, restarted R without the vanilla-option and alas, anova
    >> >> now works.
    >> >> 
    >> >> It seems that R stops initializing after encountering the error
    >> >> mentioned above. Is this correct?   
    >> 
    BDR> Yes, in that the rest of the system Rprofile file is skipped
    BDR> and hence options show.signif.stars and show.coef.Pvalues are not set.
    >> but other options as well..
    >> I think this shouldn't happen and *is* a bug.

    BDR> It looks to me as if a bit more protection is needed in print.coefmat,
    BDR> at least.

	 which Brian has implemented in the mean time.

	 ....

    >> For the 1.0.x patches, at least, I'll move the autoload()'s to the end of
    >> profile/Common.R

    BDR> I _think_ they should have try() around them, which is what S-PLUS 
    BDR> now does with all startup code.

I tried this, but it does not work :

try(autoload(..)) works okay when used after startup, but not *during*
startup.  However, I'll put a workaround into Common.R

Should this {try(.) not working during startup} be another bug report ?

Martin

==> 486.audit <==
Sat Mar 25 09:44:47 2000	maechler	moved from incoming to Startup
Sat Apr 08 07:41:36 2000	ripley	changed notes
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Directory:  System-specific

* PR# 490 *
Subject: R-1.0.0 on alpha/osf1 memory glitch
From: Ray Brownrigg <Ray.Brownrigg@mcs.vuw.ac.nz>
Date: Fri, 17 Mar 2000 11:25:30 +1300 (NZDT)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 490 <==
From ray@mcs.vuw.ac.nz  Thu Mar 16 23:25:28 2000
Received: from kaukau.mcs.vuw.ac.nz (kaukau.mcs.vuw.ac.nz [130.195.5.20])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id XAA21828
	for <r-bugs@biostat.ku.dk>; Thu, 16 Mar 2000 23:25:25 +0100 (MET)
Received: from aqua.mcs.vuw.ac.nz (aqua.mcs.vuw.ac.nz [130.195.6.201])
	by kaukau.mcs.vuw.ac.nz (8.10.0.Beta6/8.10.0.Beta6) with ESMTP id e2GMPUS01452
	for <r-bugs@biostat.ku.dk>; Fri, 17 Mar 2000 11:25:31 +1300 (NZDT)
From: Ray Brownrigg <Ray.Brownrigg@mcs.vuw.ac.nz>
Received: (from ray@localhost)
	by aqua.mcs.vuw.ac.nz (8.9.2/8.8.6) id LAA25041
	for r-bugs@biostat.ku.dk; Fri, 17 Mar 2000 11:25:30 +1300 (NZDT)
Date: Fri, 17 Mar 2000 11:25:30 +1300 (NZDT)
Message-Id: <200003162225.LAA25041@aqua.mcs.vuw.ac.nz>
To: r-bugs@biostat.ku.dk
Subject: R-1.0.0 on alpha/osf1 memory glitch

Digital Alpha (various), Digital UNIX V4.0[EF], R-1.0.0, gcc, f77

When using batch mode with the save option, an error message is issued.
However [I have just discovered that] it appears that the operation
does complete, i.e. the .RData file is saved successfully.  The main
problem is that the return code is non-zero (and so it is impossible to
distinguish this "non-error" from some other error in a script).

Reproduce by:

    bats>  echo 'x <- 1' | R --save
    
    R : Copyright 2000, The R Development Core Team
    Version 1.0.0  (February 29, 2000)
    
    R is free software and comes with ABSOLUTELY NO WARRANTY.
    You are welcome to redistribute it under certain conditions.
    Type    "?license" or "?licence" for distribution details.
    
    R is a collaborative project with many contributors.
    Type    "?contributors" for a list.
    
    Type    "demo()" for some demos, "help()" for on-line help, or
            "help.start()" for a HTML browser interface to help.
    Type    "q()" to quit R.
    
    > x <- 1
    >
    xmalloc: out of virtual memory
    bats> 

Note that an alternate form that achieves the same desired effect does
not issue any error messages:

    echo 'x <- 1; save(list = ls(), file = ".RData")' | R --no-save

I can't find any record of the configure summary output (is it saved
anywhere, or does it only appear on the screen?) but I could reproduce
this if necessary.

Ray Brownrigg

==> 490.audit <==
Sat Apr 01 07:28:48 2000	ripley	moved from incoming to System-specific
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 452 *
Subject: problem with glm
From: Brad McNeney <mcneney@cs.sfu.ca>
Date: Fri, 18 Feb 2000 17:51:54 -0800 (PST)
--Problems on Alpha's with glm. Status unclear
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 452 <==
From mcneney@cs.sfu.ca  Sat Feb 19 02:51:57 2000
Received: from stat.math.ethz.ch (daemon@hypatia.ethz.ch [129.132.58.23])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id CAA15326
	for <R-bugs@biostat.ku.dk>; Sat, 19 Feb 2000 02:51:56 +0100 (MET)
Received: (from daemon@localhost)
	by stat.math.ethz.ch (8.9.1/8.9.1) id CAA05839
	for <r-bugs@stat.math.ethz.ch>; Sat, 19 Feb 2000 02:52:05 +0100 (MET)
Received: from cs.sfu.ca(142.58.111.1)
 via SMTP by hypatia, id smtpdAAAa001RB; Sat Feb 19 02:51:57 2000
Received: from smahlt.math.sfu.ca (smahlt [199.60.17.25])
	by cs.sfu.ca (8.9.1/8.9.1) with ESMTP id RAA10291
	for <r-bugs@stat.math.ethz.ch>; Fri, 18 Feb 2000 17:51:55 -0800 (PST)
Received: from localhost by smahlt.math.sfu.ca (8.8.8/1.1.20.8/23Nov99-0751PM)
	id RAA0000400367; Fri, 18 Feb 2000 17:51:54 -0800 (PST)
X-Authentication-Warning: smahlt.math.sfu.ca: mcneney owned process doing -bs
Date: Fri, 18 Feb 2000 17:51:54 -0800 (PST)
From: Brad McNeney <mcneney@cs.sfu.ca>
X-Sender: mcneney@smahlt.math.sfu.ca
To: r-bugs@stat.math.ethz.ch
Subject: problem with glm
Message-ID: <Pine.OSF.4.21.0002181750080.400767-100000@smahlt.math.sfu.ca>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

I'm having sporadic problems with glm on my alpha workstation running
Compaq Tru64 UNIX V5.0 (I can't replicate the problem on my Linux PC). I
have the same problem whether I use a version of R built with the native
C-compiler or a version compiled with gcc. In both cases I've built with
g77.

I want to do some simulations with a call to glm in each rep. A simplified
version would be something like:

N_100; NREPS_100; lam.e_5; logit.inv_function(x){ exp(x)/(1+exp(x)) }
for(i in (1:NREPS)) {
   cat(paste("REP",i,"\n"))
   T_rexp(N,(lam.e))
   Delta_rbinom(N,1,logit.inv(1+T))
   ff_glm(Delta ~ T,family=binomial(logit))
}
 
It often completes all reps, but I occasionally get errors related to
lengths of various objects, etc.:

REP 1 
REP 2
<snip>
REP 9 
Error in model.matrix(t, data) : variable lengths differ


REP 1 
<snip>
REP 53 
Error: subscript out of bounds

REP 1 
<snip>
REP 41 
Error in model.matrix(t, data) : invalid variable type

Different error messages, different numbers of reps. When I call glm again
using the values of T and Delta just before the error, it runs error-free.
When I put the data in a data frame before calling glm I can also get
messages like:

REP 1 
<snip>
REP 64 
Error in model.frame(formula, rownames, variables, varnames, extras, extranames,  : 
        invalid variable type


--please do not edit the information below--

Version:
 platform = alpha-dec-osf5.0
 arch = alpha
 os = osf5.0
 system = alpha, osf5.0
 status = Patched
 major = 0
 minor = 99.0
 year = 2000
 month = February
 day = 9
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base

-------------------------------------------------------------------------
Brad McNeney                               email: mcneney@stat.sfu.ca
Department of Mathematics and Statistics   web: www.math.sfu.ca/~mcneney/
Simon Fraser University                    phone: 604.291.4815
8888 University Drive                      fax: 604.291.4947
Burnaby, British Columbia
Canada V5A 1S6


==> 452.reply.1 <==
From pd@biostat.ku.dk  Sat Feb 19 13:57:47 2000
Received: from biostat.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id NAA16134;
	Sat, 19 Feb 2000 13:57:46 +0100 (MET)
Received: (from pd@localhost)
	by biostat.ku.dk (8.9.3/8.9.3) id NAA30569;
	Sat, 19 Feb 2000 13:59:28 +0100
Sender: pd@blueberry.kubism.ku.dk
To: mcneney@cs.sfu.ca
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] problem with glm (PR#452)
References: <200002190151.CAA15336@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 19 Feb 2000 13:59:27 +0100
In-Reply-To: mcneney@cs.sfu.ca's message of "Sat, 19 Feb 2000 02:51:58 +0100 (MET)"
Message-ID: <x24sb5l55c.fsf@blueberry.kubism.ku.dk>
Lines: 47
X-Mailer: Gnus v5.7/Emacs 20.4
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

mcneney@cs.sfu.ca writes:

> N_100; NREPS_100; lam.e_5; logit.inv_function(x){ exp(x)/(1+exp(x)) }
> for(i in (1:NREPS)) {
>    cat(paste("REP",i,"\n"))
>    T_rexp(N,(lam.e))
>    Delta_rbinom(N,1,logit.inv(1+T))
>    ff_glm(Delta ~ T,family=binomial(logit))
> }
>  
> It often completes all reps, but I occasionally get errors related to
> lengths of various objects, etc.:
...
> --please do not edit the information below--
> 
> Version:
>  platform = alpha-dec-osf5.0
>  arch = alpha
>  os = osf5.0
>  system = alpha, osf5.0
>  status = Patched
>  major = 0
>  minor = 99.0
>  year = 2000
>  month = February
>  day = 9
>  language = R
> 
> Search Path:
>  .GlobalEnv, Autoloads, package:base

I just did the above ~10 times on i386 and nothing happened. We've had
previous reports on trouble in the lm/glm/model.matrix etc. region on
Alpha. 

If you compile with all warnings on, are you getting warnings on
pointer/integer comparisons or assignments?

Can you create a reproducible case (with set.seed to keep the random
generator sequence constant) and would you know how run a debugger on
your version so that we can figure out what is going wrong?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 452.followup.1 <==
From mcneney@cs.sfu.ca  Sun Feb 20 05:11:05 2000
Received: from cs.sfu.ca (cs.sfu.ca [142.58.111.1])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id FAA17753;
	Sun, 20 Feb 2000 05:11:03 +0100 (MET)
Received: from smahlt.math.sfu.ca (smahlt [199.60.17.25])
	by cs.sfu.ca (8.9.1/8.9.1) with ESMTP id UAA15662;
	Sat, 19 Feb 2000 20:11:12 -0800 (PST)
Received: from localhost by smahlt.math.sfu.ca (8.8.8/1.1.20.8/23Nov99-0751PM)
	id UAA0000433332; Sat, 19 Feb 2000 20:11:12 -0800 (PST)
X-Authentication-Warning: smahlt.math.sfu.ca: mcneney owned process doing -bs
Date: Sat, 19 Feb 2000 20:11:12 -0800 (PST)
From: Brad McNeney <mcneney@cs.sfu.ca>
X-Sender: mcneney@smahlt.math.sfu.ca
To: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] problem with glm (PR#452)
In-Reply-To: <x24sb5l55c.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.OSF.4.21.0002191945010.433325-100000@smahlt.math.sfu.ca>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII


> If you compile with all warnings on, are you getting warnings on
> pointer/integer comparisons or assignments?
> 

Yes, all the ones in regex.c that Doug mentioned. Here's a sample
of these and others (warnings related to graphics/X stuff have been
omitted):

uncmin.c: In function `lltslv':
uncmin.c:281: warning: type mismatch in implicit declaration for built-in
function `memcpy'
character.c: In function `stripchars':
character.c:269: warning: subscript has type `char'
character.c:281: warning: subscript has type `char'
character.c:296: warning: subscript has type `char'
character.c:296: warning: subscript has type `char'
character.c:304: warning: subscript has type `char'
character.c:312: warning: subscript has type `char'
character.c:312: warning: subscript has type `char'
character.c:312: warning: subscript has type `char'
character.c:320: warning: subscript has type `char'
character.c:320: warning: subscript has type `char'
character.c:330: warning: subscript has type `char'
character.c:330: warning: subscript has type `char'
character.c:341: warning: subscript has type `char'
character.c: In function `do_makenames':
character.c:384: warning: subscript has type `char'
character.c:395: warning: subscript has type `char'
/usr/share/misc/bison.simple: In function `Rf_yyparse':
/usr/share/misc/bison.simple:254: warning: `yyval' might be used
uninitialized in this function
regex.c: In function `re_match_2':
regex.c:3770: warning: cast from pointer to integer of different size
regex.c:3770: warning: cast from pointer to integer of different size
regex.c:3776: warning: cast to pointer from integer of different size
regex.c:3776: warning: cast to pointer from integer of different size
regex.c:3923: warning: cast to pointer from integer of different size
regex.c:3923: warning: cast to pointer from integer of different size
regex.c:3976: warning: cast to pointer from integer of different size
regex.c:3976: warning: cast to pointer from integer of different size
regex.c:4082: warning: cast from pointer to integer of different size
regex.c:4083: warning: cast from pointer to integer of different size
regex.c:4115: warning: cast to pointer from integer of different size
regex.c:4115: warning: cast to pointer from integer of different size
regex.c:4128: warning: cast to pointer from integer of different size
regex.c:4128: warning: cast to pointer from integer of different size
regex.c:4296: warning: cast from pointer to integer of different size
regex.c:4297: warning: cast from pointer to integer of different size
saveload.c:495: warning: `BinarySave' defined but not used
saveload.c:1775: warning: `NewBinarySave' defined but not used


I'll see what I can do about getting a more reproducible error. 

Any tips on what to look for if I'm running R within GDB? I don't have
much experience with the debugger. I mostly just use it to see where my
programs are dying. But R is not -- it just gives strange error messages.

TIA,
Brad


==> 452.followup.2 <==
From ripley@stats.ox.ac.uk  Sun Feb 20 09:33:06 2000
Received: from toucan.stats.ox.ac.uk (toucan.stats.ox.ac.uk [163.1.20.20])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id JAA17966;
	Sun, 20 Feb 2000 09:33:05 +0100 (MET)
Received: from max168.public.ox.ac.uk (max168.public.ox.ac.uk [192.76.27.168])
	by toucan.stats.ox.ac.uk (8.9.0/8.9.0) with ESMTP id IAA20341;
	Sun, 20 Feb 2000 08:33:06 GMT
Date: Sun, 20 Feb 2000 08:32:05 +0000 (GMT)
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Sender: ripley@auk.stats
To: Brad McNeney <mcneney@cs.sfu.ca>
cc: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>, r-devel@stat.math.ethz.ch,
        R-bugs@biostat.ku.dk
Subject: Re: [Rd] problem with glm (PR#452)
In-Reply-To: <Pine.OSF.4.21.0002191945010.433325-100000@smahlt.math.sfu.ca>
Message-ID: <Pine.GSO.4.05.10002200807420.5046-100000@auk.stats>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Sat, 19 Feb 2000, Brad McNeney wrote:

> 
> > If you compile with all warnings on, are you getting warnings on
> > pointer/integer comparisons or assignments?
> > 
> 
> Yes, all the ones in regex.c that Doug mentioned. Here's a sample
> of these and others (warnings related to graphics/X stuff have been
> omitted):

(Two suggestions which are in the current snapshot follow. Looks like
what is which header varies a bit.)

> uncmin.c: In function `lltslv':
> uncmin.c:281: warning: type mismatch in implicit declaration for built-in
> function `memcpy'

Add a line (third one here) to src/include/R_ext/RS.h:

#ifndef R_RS_H
#define R_RS_H

#include <string.h> /* for memcpy */
#include "Rconfig.h" /* for F77_SYMBOL */


> character.c: In function `stripchars':
> character.c:269: warning: subscript has type `char'
> character.c:281: warning: subscript has type `char'
> character.c:296: warning: subscript has type `char'
> character.c:296: warning: subscript has type `char'
> character.c:304: warning: subscript has type `char'
> character.c:312: warning: subscript has type `char'
> character.c:312: warning: subscript has type `char'
> character.c:312: warning: subscript has type `char'
> character.c:320: warning: subscript has type `char'
> character.c:320: warning: subscript has type `char'
> character.c:330: warning: subscript has type `char'
> character.c:330: warning: subscript has type `char'
> character.c:341: warning: subscript has type `char'
> character.c: In function `do_makenames':
> character.c:384: warning: subscript has type `char'
> character.c:395: warning: subscript has type `char'
> /usr/share/misc/bison.simple: In function `Rf_yyparse':
> /usr/share/misc/bison.simple:254: warning: `yyval' might be used
> uninitialized in this function

Those are all normal.

> regex.c: In function `re_match_2':
> regex.c:3770: warning: cast from pointer to integer of different size
> regex.c:3770: warning: cast from pointer to integer of different size

That looks like a regex bug, with a why? comment in the code. Change
(int) to (long), twice.

> regex.c:3776: warning: cast to pointer from integer of different size
> regex.c:3776: warning: cast to pointer from integer of different size
> regex.c:3923: warning: cast to pointer from integer of different size
> regex.c:3923: warning: cast to pointer from integer of different size
> regex.c:3976: warning: cast to pointer from integer of different size
> regex.c:3976: warning: cast to pointer from integer of different size
> regex.c:4082: warning: cast from pointer to integer of different size
> regex.c:4083: warning: cast from pointer to integer of different size
> regex.c:4115: warning: cast to pointer from integer of different size
> regex.c:4115: warning: cast to pointer from integer of different size
> regex.c:4128: warning: cast to pointer from integer of different size
> regex.c:4128: warning: cast to pointer from integer of different size
> regex.c:4296: warning: cast from pointer to integer of different size
> regex.c:4297: warning: cast from pointer to integer of different size

I've never seen those, but try adding

#define STDC_HEADERS 1

at the top of regex.c.  (I am not convinced that is the cause here.)

> saveload.c:495: warning: `BinarySave' defined but not used
> saveload.c:1775: warning: `NewBinarySave' defined but not used

Normal, on a platform with xdr.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


==> 452.reply.2 <==
From pd@biostat.ku.dk  Sun Feb 20 13:28:12 2000
Received: from biostat.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id NAA18510;
	Sun, 20 Feb 2000 13:28:12 +0100 (MET)
Received: (from pd@localhost)
	by biostat.ku.dk (8.9.3/8.9.3) id NAA31926;
	Sun, 20 Feb 2000 13:30:08 +0100
Sender: pd@blueberry.kubism.ku.dk
To: Brad McNeney <mcneney@cs.sfu.ca>
Cc: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>, r-devel@stat.math.ethz.ch,
        R-bugs@biostat.ku.dk
Subject: Re: [Rd] problem with glm (PR#452)
References: <Pine.OSF.4.21.0002191945010.433325-100000@smahlt.math.sfu.ca>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 20 Feb 2000 13:30:07 +0100
In-Reply-To: Brad McNeney's message of "Sat, 19 Feb 2000 20:11:12 -0800 (PST)"
Message-ID: <x2snyogipc.fsf@blueberry.kubism.ku.dk>
Lines: 34
X-Mailer: Gnus v5.7/Emacs 20.4
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

Brad McNeney <mcneney@cs.sfu.ca> writes:

> I'll see what I can do about getting a more reproducible error. 
> 
> Any tips on what to look for if I'm running R within GDB? I don't have
> much experience with the debugger. I mostly just use it to see where my
> programs are dying. But R is not -- it just gives strange error messages.

One technique is to set a breakpoint at the line that displays the
error, then you can inspect the condition that caused it (you may have
to go "up" a couple of times to get into an interesting environment.)

Sometimes, it turns out that a variable contains something that it
shouldn't due to memory corruption and then you may have to set a
breakpoint earlier in the code and then maybe a watchpoint on the
memory location.

Another thing that is useful even without gdb is to investigate the
output of traceback() and maybe set 

options(error=quote(DUMP <<- sys.status()))

which allows you to subsequently investigate any active environment at
the time of the error, e.g. using ls(envir=DUMP$sys.frames[[3]]), and
get("x",envir=DUMP$sys.frames[[3]]).

(Newer snapshots have a more elaborate dump.frames function, but the
above should do). 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 452.audit <==
Sun Feb 20 21:27:15 2000	ripley	moved from incoming to System-specific
Mon Feb 28 17:30:41 2000	pd	changed notes

==> 452.followup.3 <==
From mcneney@cs.sfu.ca  Sat Mar  4 19:23:48 2000
Received: from cs.sfu.ca (cs.sfu.ca [142.58.111.1])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id TAA25981;
	Sat, 4 Mar 2000 19:23:42 +0100 (MET)
Received: from smahlt.math.sfu.ca (smahlt [199.60.17.25])
	by cs.sfu.ca (8.9.1/8.9.1) with ESMTP id KAA07172;
	Sat, 4 Mar 2000 10:23:52 -0800 (PST)
Received: from localhost by smahlt.math.sfu.ca (8.8.8/1.1.20.8/23Nov99-0751PM)
	id KAA0000263254; Sat, 4 Mar 2000 10:23:52 -0800 (PST)
X-Authentication-Warning: smahlt.math.sfu.ca: mcneney owned process doing -bs
Date: Sat, 4 Mar 2000 10:23:52 -0800 (PST)
From: Brad McNeney <mcneney@cs.sfu.ca>
X-Sender: mcneney@smahlt.math.sfu.ca
To: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] problem with glm (PR#452)
In-Reply-To: <x2snyogipc.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.OSF.4.21.0003041022320.263210-100000@smahlt.math.sfu.ca>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

I looked into the glm problem some more. Seems to be a memory problem that
occurs just after garbage collection. The easiest way for me to
reproduce  the error is in lapply. I take a list and ask lapply to provide
the descriptive stat summary. I do this several times with the same list.
Most often it gives the correct summary, but just after allocSExp calls
R_gc, one of the summaries for a list element will be NULL. 

E.g for a data frame dat with five columns I get the following (having added
print statements in summary.default and in allocSExp just after the test
for whether gc is necessary):

> lapply(as.list(dat), summary, maxsum = maxsum)
[1] "exiting summary.default"
R_FreeSEXP == NULL  
[1] "exiting summary.default"
[1] "exiting summary.default"
[1] "exiting summary.default"
[1] "exiting summary.default"
$Delta
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.00    1.00    1.00    1.19    2.00    2.00 

$D
NULL

$R
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.00    1.00    1.00    0.86    1.00    1.00 

$V
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
0.004552 0.740700 1.575000 1.754000 3.205000 3.390000 

$X
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
    0.0     0.0     0.5     0.5     1.0     1.0 


I don't know if the following is relevant, but for some reason I've found 
I can avoid this particular problem if I make a small change in lapply in 
its main loop.  Around line 50 of apply.c:

    PROTECT(ans = allocVector(VECSXP, n));
    for(i = 0; i < n; i++) {
        INTEGER(ind)[0] = i + 1;
        VECTOR(ans)[i] = eval(R_fcall, rho);
    }

if I change it to make an assignment to a
temporary variable first everything seems to work fine:

    PROTECT(ans = allocVector(VECSXP, n));
    for(i = 0; i < n; i++) {
        INTEGER(ind)[0] = i + 1;
        tem = eval(R_fcall, rho);
        VECTOR(ans)[i] = tem;
    }

hasn't given me any NULLs yet. 



On 20 Feb 2000, Peter Dalgaard BSA wrote:

> Brad McNeney <mcneney@cs.sfu.ca> writes:
> 
> > I'll see what I can do about getting a more reproducible error. 
> > 


==> 452.reply.3 <==
From pd@biostat.ku.dk  Sun Mar  5 01:02:38 2000
Received: from biostat.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id BAA26687;
	Sun, 5 Mar 2000 01:02:37 +0100 (MET)
Received: (from pd@localhost)
	by biostat.ku.dk (8.9.3/8.9.3) id BAA17617;
	Sun, 5 Mar 2000 01:03:15 +0100
Sender: pd@blueberry.kubism.ku.dk
To: Brad McNeney <mcneney@cs.sfu.ca>
Cc: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>, r-devel@stat.math.ethz.ch,
        R-bugs@biostat.ku.dk
Subject: Re: [Rd] problem with glm (PR#452)
References: <Pine.OSF.4.21.0003041022320.263210-100000@smahlt.math.sfu.ca>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 05 Mar 2000 01:03:15 +0100
In-Reply-To: Brad McNeney's message of "Sat, 4 Mar 2000 10:23:52 -0800 (PST)"
Message-ID: <x2putauvuk.fsf@blueberry.kubism.ku.dk>
Lines: 47
X-Mailer: Gnus v5.7/Emacs 20.4
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

Brad McNeney <mcneney@cs.sfu.ca> writes:

> I don't know if the following is relevant, but for some reason I've found 
> I can avoid this particular problem if I make a small change in lapply in 
> its main loop.  Around line 50 of apply.c:
> 
>     PROTECT(ans = allocVector(VECSXP, n));
>     for(i = 0; i < n; i++) {
>         INTEGER(ind)[0] = i + 1;
>         VECTOR(ans)[i] = eval(R_fcall, rho);
>     }
> 
> if I change it to make an assignment to a
> temporary variable first everything seems to work fine:
> 
>     PROTECT(ans = allocVector(VECSXP, n));
>     for(i = 0; i < n; i++) {
>         INTEGER(ind)[0] = i + 1;
>         tem = eval(R_fcall, rho);
>         VECTOR(ans)[i] = tem;
>     }
> 
> hasn't given me any NULLs yet. 

Now that is pretty darn odd... Looks quite a bit like a compiler bug.
Those two pieces of code should be equivalent as far as I can see.

One thing that you might do: objdump -dS apply.o allows you to see
what code the compiler generates for the two cases. Also, of course,
you can try reducing the level of optimization.


Alternatively, the mere addition of "tem" changes the local memory use
of that function so that something that got clobbered before doesn't
get clobbered now.

The effect doesn't seem to be present on Intels:

> dfr<-do.call("data.frame",lapply(1:100,function(i)rnorm(100)))
> any(sapply(lapply(dfr,summary),is.null))
[1] FALSE

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Directory:  TooMuchAtOnce

none

Directory:  Windows

none

Directory:  incoming

* PR# 538 *
Subject: no $method from as.hclust
From: Denis White <denis@mercury.cor.epa.gov>
Date: Wed, 10 May 2000 15:00:05 -0700 (PDT)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 538 <==
From denis@mercury.cor.epa.gov  Thu May 11 00:00:22 2000
Received: from mail.cor.epa.gov (mercury.cor.epa.gov [204.47.138.12])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id AAA05986
	for <r-bugs@biostat.ku.dk>; Thu, 11 May 2000 00:00:18 +0200 (MET DST)
Received: from okapi.cor.epa.gov (okapi.cor.epa.gov [204.47.148.18])
	by mail.cor.epa.gov (8.9.1/8.9.1) with ESMTP id PAA28197
	for <r-bugs@biostat.ku.dk>; Wed, 10 May 2000 15:00:33 -0700 (PDT)
Received: (from denis@localhost)
	by okapi.cor.epa.gov (8.9.1b+Sun/8.9.1) id PAA22905;
	Wed, 10 May 2000 15:00:05 -0700 (PDT)
Date: Wed, 10 May 2000 15:00:05 -0700 (PDT)
From: Denis White <denis@mercury.cor.epa.gov>
To: r-bugs@biostat.ku.dk
Subject: no $method from as.hclust
Message-ID: <Pine.SUN.3.91.1000510145428.22674I-100000@okapi.cor.epa.gov>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

as.hclust returns objects with only 6 of the standard 7 
components of class hclust, leaving out "method", therefore
being incompatible with applications looking for all
7 components.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 522 *
Subject: na.omit fails for matrices
From: Sergei Zuyev <sergei@stams.strath.ac.uk>
Date: Mon, 17 Apr 2000 11:52:28 +0100
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 522 <==
From sergei@stams.strath.ac.uk  Mon Apr 17 12:53:19 2000
Received: from stat.math.ethz.ch (daemon@hypatia.ethz.ch [129.132.58.23])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id MAA02525
	for <R-bugs@biostat.ku.dk>; Mon, 17 Apr 2000 12:53:18 +0200 (MET DST)
Received: (from daemon@localhost)
	by stat.math.ethz.ch (8.9.1/8.9.1) id MAA28818
	for <r-bugs@lists.r-project.org>; Mon, 17 Apr 2000 12:53:36 +0200 (MET DST)
Received: from harris.cc.strath.ac.uk(130.159.248.11)
 via SMTP by hypatia, id smtpdAAAa0072F; Mon Apr 17 12:53:29 2000
Received: from [130.159.96.151] (helo=titan.stams.strath.ac.uk ident=sergei)
	by harris.cc.strath.ac.uk with esmtp (Exim 2.05 #1)
	id 12h99j-0000fN-00; Mon, 17 Apr 2000 11:53:27 +0100
X-Mailer: exmh version 2.0.3
To: r-bugs@hypatia.math.ethz.ch
cc: sergei@stams.strath.ac.uk
Subject: na.omit fails for matrices
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Date: Mon, 17 Apr 2000 11:52:28 +0100
From: Sergei Zuyev <sergei@stams.strath.ac.uk>
Message-Id: <E12h99j-0000fN-00@harris.cc.strath.ac.uk>

Dear R-core team,
I came across the following bug (feature?):
Modyfying example from help(na.omit):
> ( m<-matrix(c(1, 2, 3, 0, 10, NA),ncol=2) )
     [,1] [,2]
[1,]    1    0
[2,]    2   10
[3,]    3   NA
> ( mo<- na.omit(m) )
     [,1] [,2]
attr(,"na.action")
[1] 1
attr(,"na.action")attr(,"class")
[1] "omit"  
> dim(mo)
[1] 0 2        
> is.matrix(mo)
[1] TRUE                                                                       

So the result is an empty matrix! On the other hand   
> na.omit(as.data.frame(m))
  V1 V2
1  1  0
2  2 10                                                                        


works fine. help(na.omit) does not say that matrix is not a valid argument. At 
least in na.omit in Splus it is valid.
I have tested this in R-1.0.0 and development version R-1.1 under LINUX, 
Solaris and MSWindows.

Best wishes,
Sergei

=================================================================
                           Dr. Sergei ZUYEV
Statistics and Modelling Science dept., University of Strathclyde
    Livingston Tower, 26 Richmond str., Glasgow, G1 1XH, U.K.
     Tel.: +44 (0)141 548 3663    Fax:  +44 (0)141 552 2079
E-mail: sergei@stams.strath.ac.uk   http://www.stams.strath.ac.uk
=================================================================

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 529 *
Subject: graphics: par(mfg=c(i,j,r,c))
From: Craig.Mckinstry@pnl.gov
Date: Fri, 28 Apr 2000 17:36:35 +0200 (MET DST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 529 <==
From Craig.Mckinstry@pnl.gov  Fri Apr 28 17:36:36 2000
Received: from localhost (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id RAA21889
	for <R-bugs@biostat.ku.dk>; Fri, 28 Apr 2000 17:36:35 +0200 (MET DST)
Date: Fri, 28 Apr 2000 17:36:35 +0200 (MET DST)
From: Craig.Mckinstry@pnl.gov
Message-Id: <200004281536.RAA21889@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: graphics: par(mfg=c(i,j,r,c))

Full_Name: Craig A. McKinstry
Version: 1.0.0
OS: WinNT4.0 and Win98
Submission from: (NULL) (192.101.100.130)


When creating a multi-panel graphic, the command par(mfg=c(i,j,r,c)) is
supposed
to allow the user free movement between graphics panels to develop each panel 
separately. This works for the first invocation of par(mfg=c()) and for the 
first panel panel specified, but not for subsequent calls to the other panels. 

Coded example:

x_1:20
y_1:20
#these 5 commands produce a 2x2 panel plot
par(mfrow=c(2,2))
plot(x,y)
plot(x,y)
plot(x,y)
plot(x,y)

#the following 2 commands successfully added the text 'panel[2,1]' to
panel[2,1]
par(mfg=c(2,1,2,2))
text(10,10,'panel[2,1]')

#None of the following 3 command-pairs produced their intended results for the
other
# 3 panels
par(mfg=c(1,2,2,2))
text(10,10,'panel[1,2]')

par(mfg=c(1,1,2,2))
text(10,10,'panel[1,1]')

par(mfg=c(2,2,2,2))
text(10,10,'panel[2,2]')

#However, the following command-pair did as intended on the first panel
specified
# by mfg=c(2,1,2,2) above
par(mfg=c(2,1,2,2))
text(15,15,'panel[2,2]')

#Running this in S-plus 4.0 produced the intended results


==> 529.reply.1 <==
From pd@blueberry.kubism.ku.dk  Fri Apr 28 17:53:49 2000
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id RAA22039
	for <R-bugs@biostat.ku.dk>; Fri, 28 Apr 2000 17:53:48 +0200 (MET DST)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.9.3/8.9.3) id RAA10058;
	Fri, 28 Apr 2000 17:58:30 +0200
Sender: pd@blueberry.kubism.ku.dk
To: Craig.Mckinstry@pnl.gov
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] graphics: par(mfg=c(i,j,r,c)) (PR#529)
References: <200004281536.RAA21899@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 28 Apr 2000 17:58:29 +0200
In-Reply-To: Craig.Mckinstry@pnl.gov's message of "Fri, 28 Apr 2000 17:36:37 +0200 (MET DST)"
Message-ID: <x28zxyw72y.fsf@blueberry.kubism.ku.dk>
Lines: 48
X-Mailer: Gnus v5.7/Emacs 20.5
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

Craig.Mckinstry@pnl.gov writes:

> x_1:20
> y_1:20
> #these 5 commands produce a 2x2 panel plot
> par(mfrow=c(2,2))
> plot(x,y)
> plot(x,y)
> plot(x,y)
> plot(x,y)
> 
> #the following 2 commands successfully added the text 'panel[2,1]' to
> panel[2,1]
> par(mfg=c(2,1,2,2))
> text(10,10,'panel[2,1]')
> 
> #None of the following 3 command-pairs produced their intended results for the
> other
> # 3 panels
> par(mfg=c(1,2,2,2))
> text(10,10,'panel[1,2]')
> 
> par(mfg=c(1,1,2,2))
> text(10,10,'panel[1,1]')
> 
> par(mfg=c(2,2,2,2))
> text(10,10,'panel[2,2]')
> 
> #However, the following command-pair did as intended on the first panel
> specified
> # by mfg=c(2,1,2,2) above
> par(mfg=c(2,1,2,2))
> text(15,15,'panel[2,2]')

Same thing happens on Linux. Might be something with restoring the
coordinate transformations. Using

par(mfg=c(1,1,2,2))
plot(x,y)
text(10,10,'panel[1,1]')

*does* seem to work.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 529.followup.1 <==
From paul@stat.auckland.ac.nz  Mon May  1 02:40:25 2000
Received: from mailhost.auckland.ac.nz (mailhost.auckland.ac.nz [130.216.1.4] (may be forged))
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id CAA29460;
	Mon, 1 May 2000 02:40:19 +0200 (MET DST)
Received: from stat1.stat.auckland.ac.nz (stat1.stat.auckland.ac.nz [130.216.93.1])
	by mailhost.auckland.ac.nz (8.9.2/8.9.2/8.9.2-ua) with ESMTP id MAA06634;
	Mon, 1 May 2000 12:40:11 +1200 (NZST)
Received: from murrell (murrell.stat.auckland.ac.nz [130.216.93.23])
	by stat1.stat.auckland.ac.nz (8.9.3+Sun/8.8.8) with SMTP id MAA04773;
	Mon, 1 May 2000 12:38:55 +1200 (NZST)
Message-ID: <00f701bfb307$06dc3120$175dd882@stat.auckland.ac.nz>
From: "Paul Murrell" <paul@stat.auckland.ac.nz>
To: <Craig.Mckinstry@pnl.gov>, "Peter Dalgaard BSA" <p.dalgaard@biostat.ku.dk>
Cc: <r-devel@stat.math.ethz.ch>, <R-bugs@biostat.ku.dk>
References: <200004281536.RAA21899@pubhealth.ku.dk> <x28zxyw72y.fsf@blueberry.kubism.ku.dk>
Subject: Re: [Rd] graphics: par(mfg=c(i,j,r,c)) (PR#529)
Date: Mon, 1 May 2000 12:48:53 +1200
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: 7bit
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook Express 5.00.2014.211
X-MimeOLE: Produced By Microsoft MimeOLE V5.00.2014.211

hi


> > x_1:20
> > y_1:20
> > #these 5 commands produce a 2x2 panel plot
> > par(mfrow=c(2,2))
> > plot(x,y)
> > plot(x,y)
> > plot(x,y)
> > plot(x,y)
> >
> > #the following 2 commands successfully added the text 'panel[2,1]' to
> > panel[2,1]
> > par(mfg=c(2,1,2,2))
> > text(10,10,'panel[2,1]')
> >
> > #None of the following 3 command-pairs produced their intended results
for the
> > other
> > # 3 panels
> > par(mfg=c(1,2,2,2))
> > text(10,10,'panel[1,2]')
> >
> > par(mfg=c(1,1,2,2))
> > text(10,10,'panel[1,1]')
> >
> > par(mfg=c(2,2,2,2))
> > text(10,10,'panel[2,2]')
> >
> > #However, the following command-pair did as intended on the first panel
> > specified
> > # by mfg=c(2,1,2,2) above
> > par(mfg=c(2,1,2,2))
> > text(15,15,'panel[2,2]')
>
> Same thing happens on Linux. Might be something with restoring the
> coordinate transformations. Using
>
> par(mfg=c(1,1,2,2))
> plot(x,y)
> text(10,10,'panel[1,1]')
>
> *does* seem to work.


This was a clipping bug, to do with the fact that GClip only reset the
device's clipping region if the value of dd->gp.xpd changed.

I have committed a fix, which *forces* a reset of the clipping region when
par(xpd) is set.

For the record:  this just fixes the par(xpd) situation.  The problem may
resurface elsewhere, in which case it may be worth considering changing
GClip to *always* force a reset of the clipping region.

paul


~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 528 *
Subject: Wrong SEs in predict.lm(..., type="terms")
Subject: Wrong SEs in predict.lm(..., type="terms")
From: John Maindonald <john.maindonald@anu.edu.au>
Date: Wed, 26 Apr 2000 12:42:00 +1000 (EST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 528 <==
From john.maindonald@leonard.anu.edu.au  Wed Apr 26 04:41:49 2000
Received: from leonard.anu.edu.au (leonard.anu.edu.au [150.203.2.15])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id EAA21997
	for <r-bugs@biostat.ku.dk>; Wed, 26 Apr 2000 04:41:47 +0200 (MET DST)
Received: (from e980153@localhost)
	by leonard.anu.edu.au (8.9.3/8.9.3) id MAA19979
	for r-bugs@biostat.ku.dk; Wed, 26 Apr 2000 12:42:00 +1000 (EST)
Date: Wed, 26 Apr 2000 12:42:00 +1000 (EST)
From: John Maindonald <john.maindonald@anu.edu.au>
Message-Id: <200004260242.MAA19979@leonard.anu.edu.au>
To: r-bugs@biostat.ku.dk
Subject: Wrong SEs in predict.lm(..., type="terms")

From e980153 Tue Apr 25 14:42:27 2000
To: r-help@stat.math.ethz.ch
Subject: Wrong SEs in predict.lm(..., type="terms")

For what it is worth, I am using RW-1.0.0 under Windows 98.
I submitted this earlier to r-help.  There is one change
below to my proposed corrected code:

predict.lm(..., type="terms") gives wrong standard errors.

Below, I have provided what I believe are the necessary fixes.
However, there are subtleties, and the code needs careful
checking.  Some of the looping is surely not necessary, but
it is surely best to begin with the minimum necessary changes.

My tests, including checks against S-PLUS, have extended to fitting
spline curves.  I have not tested the code with any example where
the pivot sequence does not run sequentially from 1 to p1.

df<-data.frame(x=1:9,y=c(2,3,6,4,8,10,12,14,15))
> df.lm_lm(y~x,data=df)
> as.vector(predict(df.lm,se=T,type="terms")$se.fit)
[1] 0.9904885 0.7428664 0.4952442 0.2476221 0.0000000 0.2476221 0.4952442
[8] 0.7428664 0.9904885

Here is what one should get:
> abs((df$x-mean(df$x)))*summary(df.lm)$coef[2,2]
[1] 0.5769836 0.4327377 0.2884918 0.1442459 0.0000000 0.1442459 0.2884918
[8] 0.4327377 0.5769836

Here is the relevant section of corrected code:


    if (type=="terms"){
      asgn <- attrassign(object)
      beta<-coef(object)
      hasintercept<-attr(tt,"intercept")>0
      if (hasintercept)
        asgn$"(Intercept)"<-NULL
      nterms<-length(asgn)
      predictor<-matrix(ncol=nterms,nrow=NROW(X))
      dimnames(predictor)<-list(rownames(X),names(asgn))

      if (se.fit){
        ip<-matrix(ncol=nterms,nrow=NROW(X))
        dimnames(ip)<-list(rownames(X),names(asgn))
      }
      if (hasintercept){     # This was omitted in the code on r-help
        avX<-apply(X,2,mean)  
        X<-sweep(X,2,avX)    # We'd best sweep out column means
                             # before we start
      }
      for (i in seq(1,nterms,length=nterms)){
        ii<-piv[asgn[[i]]]
	        predictor[,i]<-X[,ii,drop=F]%*%(beta[ii])
        if (se.fit){
          ii2_asgn[[i]]      # X[,piv] matches rows & columns of R
          vci<-R[ii2,ii2]*res.var
          for(j in (1:NROW(X))){
            xi<-X[j,ii,drop=F]  # Do not multiply by beta[ii]
           ip[j,i]<-sum(xi%*% vci %*%t(xi))

          }
        }
      }

Here is the existing section of the (1.0.0) code:

    if (type=="terms"){
      asgn <- attrassign(object)
      beta<-coef(object)
      hasintercept<-attr(tt,"intercept")>0
      if (hasintercept)
        asgn$"(Intercept)"<-NULL
      nterms<-length(asgn)
      predictor<-matrix(ncol=nterms,nrow=NROW(X))
      dimnames(predictor)<-list(rownames(X),names(asgn))
      if (se.fit){
        ip<-matrix(ncol=nterms,nrow=NROW(X))
        dimnames(ip)<-list(rownames(X),names(asgn))
      }
      for (i in seq(1,nterms,length=nterms)){
        if (hasintercept)  # Redundant
          i0<-1            # Redundant
        else               # Redundant
          i0<-NULL         # Redundant
        ii<-piv[asgn[[i]]]
        predictor[,i]<-X[,ii,drop=F]%*%(beta[ii])  # Should be centred
        X[,ii]<-X[,ii]-mean(X[,ii]) # Columns must be centred individually
        if (se.fit){
          vci<-R[ii,ii]*res.var    # The pivot should not be applied to R
          for(j in (1:NROW(X))){
            xi<-X[j,ii,drop=F]*(beta[ii])  # Do not Xply by beta
            ip[j,i]<-sum(xi%*% vci %*%t(xi))
          }
        }
      }


John Maindonald               email : john.maindonald@anu.edu.au        
Statistical Consulting Unit,  phone : (6249)3998        
c/o CMA, SMS,                 fax   : (6249)5549  
John Dedman Mathematical Sciences Building
Australian National University
Canberra ACT 0200
Australia

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 526 *
Subject: INSTALL_SCRIPT during installation
From: "Johnny C. Lam" <lamj@stat.cmu.edu>
Date: Wed, 19 Apr 2000 11:27:52 -0400
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 526 <==
From lamj@stat.cmu.edu  Wed Apr 19 17:27:36 2000
Received: from distress.stat.cmu.edu (DISTRESS.STAT.CMU.EDU [128.2.241.210])
	by pubhealth.ku.dk (8.9.3/8.9.1) with SMTP id RAA23521
	for <r-bugs@biostat.ku.dk>; Wed, 19 Apr 2000 17:27:35 +0200 (MET DST)
Received: from localhost (lamj@localhost) by distress.stat.cmu.edu (8.6.10/8.6.6) with SMTP id LAA01662; Wed, 19 Apr 2000 11:27:52 -0400
Message-Id: <200004191527.LAA01662@distress.stat.cmu.edu>
X-Authentication-Warning: distress.stat.cmu.edu: Host localhost didn't use HELO protocol
To: r-bugs@biostat.ku.dk
cc: lamj@stat.cmu.edu
Subject: INSTALL_SCRIPT during installation
Date: Wed, 19 Apr 2000 11:27:52 -0400
From: "Johnny C. Lam" <lamj@stat.cmu.edu>

The following patch uses INSTALL_SCRIPT to install scripts, as opposed
to directly using INSTALL.  It is relative to R-1.0.1 source.

     -- Johnny C. Lam <lamj@stat.cmu.edu>
        Department of Statistics, Carnegie Mellon University
        http://www.stat.cmu.edu/~lamj/

--- Makeconf.in.orig	Sat Jan 22 15:10:00 2000
+++ Makeconf.in	Mon Apr 17 16:04:58 2000
@@ -23,6 +23,7 @@
 INSTALL = @INSTALL@
 INSTALL_DATA = @INSTALL_DATA@
 INSTALL_PROGRAM = @INSTALL_PROGRAM@
+INSTALL_SCRIPT = @INSTALL_SCRIPT@
 INSTALL_DIR = ${INSTALL} -d
 LATEX = @LATEX@
 LDCMD = @LDCMD@
--- Makefile.in.orig	Mon Feb 21 02:03:26 2000
+++ Makefile.in	Mon Apr 17 16:11:47 2000
@@ -74,7 +74,7 @@
 	@for f in `ls bin/* | grep -v '^bin/R\**$$' \
 	                    | grep -v '^bin/R.X11\**$$' \
 	                    | grep -v '^bin/R.GNOME\**$$'`; do \
-	  $(INSTALL) $${f} $(rhome)/bin; \
+	  $(INSTALL_SCRIPT) $${f} $(rhome)/bin; \
 	done
 	@echo "installing headers ..."
 	@for f in include/*.h; do \
--- src/scripts/Makefile.in.orig	Mon Feb 21 05:49:10 2000
+++ src/scripts/Makefile.in	Mon Apr 17 16:13:11 2000
@@ -38,10 +38,10 @@
 	  > $(top_builddir)/bin/R
 	@chmod +x $(top_builddir)/bin/R
 	@for f in $(SCRIPTS_S); do \
-	  $(INSTALL) $(srcdir)/$$f $(top_builddir)/bin; \
+	  $(INSTALL_SCRIPT) $(srcdir)/$$f $(top_builddir)/bin; \
 	done
 	@for f in $(SCRIPTS_B); do \
-	  $(INSTALL) $$f $(top_builddir)/bin; \
+	  $(INSTALL_SCRIPT) $$f $(top_builddir)/bin; \
 	done
 
 $(SCRIPTS_B): $(top_builddir)/config.status

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 532 *
Subject: Bug report -- 1.0.1, HP-UX
From: Russ Lenth <russell-lenth@uiowa.edu>
Date: Wed, 03 May 2000 12:15:26 -0500
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 532 <==
From russell-lenth@uiowa.edu  Wed May  3 19:15:10 2000
Received: from ns-mx.uiowa.edu (ns-mx.uiowa.edu [128.255.56.78])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id TAA27659
	for <r-bugs@biostat.ku.dk>; Wed, 3 May 2000 19:15:09 +0200 (MET DST)
Received: from uiowa.edu (dhcp80ff429a.dynamic.uiowa.edu [128.255.66.154])
	by ns-mx.uiowa.edu (8.9.3/8.9.1/ns-mx-1.7) with ESMTP id MAA48478
	for <r-bugs@biostat.ku.dk>; Wed, 3 May 2000 12:15:27 -0500
Message-ID: <39105EAE.38DCEB94@uiowa.edu>
Date: Wed, 03 May 2000 12:15:26 -0500
From: Russ Lenth <russell-lenth@uiowa.edu>
Organization: University of Iowa
X-Mailer: Mozilla 4.61 [en] (Win98; U)
X-Accept-Language: en
MIME-Version: 1.0
To: r-bugs@biostat.ku.dk
Subject: Bug report -- 1.0.1, HP-UX
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

Dear R folks,

Additional problem... bug.report() failed, so am sending it from another
mailer.  The file it generated is appended.

Thanks

Russ
-- 
Russell V. Lenth -- Department of Statistics & Actuarial Science
The University of Iowa -- Iowa City, IA 52242  USA
Tel (319)335-0814 -- FAX (319)335-3017
mailto:Russell-Lenth@uiowa.edu - http://www.stat.uiowa.edu/~rlenth/


===== R.bug.report =============================================
Hello,

We're experiencing problems with R 1.0.1 on the HP-UX system.
The most serious one is that the random-number generators don't work:

        R> runif(100)
        Error in runif(100) : .Random.seed[0] is not a valid Normal type

        R> .Random.seed
        [1] 18851  3338  2439

Is this a subscripting error?  Strange because building it on linux
works just fine.

Smaller errors I've noticed...  The command-line history doesn't work.
It was built by our computer-support people, and I think they had
trouble with the libraries for that.  (Contact is Ben Sherman,
bsherman@divms.uiowa.edu).  Also help.start() generates a bunch of
error messages:

R> help.start()
If netscape  is already running,        it is *not* restarted,
 and you must switch to its window.
Otherwise, be patient..
/usr/pkg/R/1.0.1/lib/R/bin/help.links[29]:
/space/rlenth/.R/doc/html/packages.ht
ml: Cannot create the specified file.
/usr/pkg/R/1.0.1/lib/R/bin/help.links[30]:
/space/rlenth/.R/doc/html/packages.ht
ml: Cannot create the specified file.
/usr/pkg/R/1.0.1/lib/R/bin/help.links[42]:
/space/rlenth/.R/doc/html/packages.ht
ml: Cannot create the specified file.
/usr/pkg/R/1.0.1/lib/R/bin/help.links[42]:
/space/rlenth/.R/doc/html/packages.ht
ml: Cannot create the specified file.
/usr/pkg/R/1.0.1/lib/R/bin/help.links[42]:
/space/rlenth/.R/doc/html/packages.ht
ml: Cannot create the specified file.
/usr/pkg/R/1.0.1/lib/R/bin/help.links[42]:
/space/rlenth/.R/doc/html/packages.ht
ml: Cannot create the specified file.
/usr/pkg/R/1.0.1/lib/R/bin/help.links[42]:
/space/rlenth/.R/doc/html/packages.ht
ml: Cannot create the specified file.
/usr/pkg/R/1.0.1/lib/R/bin/help.links[42]:
/space/rlenth/.R/doc/html/packages.ht
ml: Cannot create the specified file.
/usr/pkg/R/1.0.1/lib/R/bin/help.links[42]:
/space/rlenth/.R/doc/html/packages.ht
ml: Cannot create the specified file.
/usr/pkg/R/1.0.1/lib/R/bin/help.links[42]:
/space/rlenth/.R/doc/html/packages.ht
ml: Cannot create the specified file.
/usr/pkg/R/1.0.1/lib/R/bin/help.links[42]:
/space/rlenth/.R/doc/html/packages.ht
ml: Cannot create the specified file.
/usr/pkg/R/1.0.1/lib/R/bin/help.links[42]:
/space/rlenth/.R/doc/html/packages.ht
ml: Cannot create the specified file.
/usr/pkg/R/1.0.1/lib/R/bin/help.links[49]:
/space/rlenth/.R/doc/html/packages.ht
ml: Cannot create the specified file.
/usr/pkg/R/1.0.1/lib/R/bin/help.links[50]:
/space/rlenth/.R/doc/html/packages.ht
ml: Cannot create the specified file.
/usr/pkg/R/1.0.1/lib/R/bin/help.links[53]:
/space/rlenth/.R/doc/html/packages.ht
ml: Cannot create the specified file.



Any idea what the problems are?

Thanks

Russ Lenth

--please do not edit the information below--

Version:
 platform = hppa1.1-hp-hpux10.20
 arch = hppa1.1
 os = hpux10.20
 system = hppa1.1, hpux10.20
 status = 
 major = 1
 minor = 0.1
 year = 2000
 month = April
 day = 14
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base

==> 532.followup.1 <==
From ripley@stats.ox.ac.uk  Wed May  3 20:28:52 2000
Received: from toucan.stats.ox.ac.uk (toucan.stats.ox.ac.uk [163.1.20.20])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id UAA27986
	for <R-bugs@biostat.ku.dk>; Wed, 3 May 2000 20:28:49 +0200 (MET DST)
Received: from max118.public.ox.ac.uk (max118.public.ox.ac.uk [192.76.27.118])
	by toucan.stats.ox.ac.uk (8.9.0/8.9.0) with ESMTP id TAA13192;
	Wed, 3 May 2000 19:28:59 +0100 (BST)
Date: Wed, 3 May 2000 19:27:57 +0100 (BST)
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Sender: ripley@auk.stats
To: russell-lenth@uiowa.edu
cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] Bug report -- 1.0.1, HP-UX (PR#532)
In-Reply-To: <200005031715.TAA27669@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.05.10005031926360.24579-100000@auk.stats>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Wed, 3 May 2000 russell-lenth@uiowa.edu wrote:

> Dear R folks,
> 
> Additional problem... bug.report() failed, so am sending it from another
> mailer.  The file it generated is appended.
> 
> Thanks
> 
> Russ
> -- 
> Russell V. Lenth -- Department of Statistics & Actuarial Science
> The University of Iowa -- Iowa City, IA 52242  USA
> Tel (319)335-0814 -- FAX (319)335-3017
> mailto:Russell-Lenth@uiowa.edu - http://www.stat.uiowa.edu/~rlenth/
> 
> 
> ===== R.bug.report =============================================
> Hello,
> 
> We're experiencing problems with R 1.0.1 on the HP-UX system.
> The most serious one is that the random-number generators don't work:
> 
>         R> runif(100)
>         Error in runif(100) : .Random.seed[0] is not a valid Normal type
> 
>         R> .Random.seed
>         [1] 18851  3338  2439
> 
> Is this a subscripting error?  Strange because building it on linux
> works just fine.

I think you've got a (very) old workspace being loaded there. Try starting
with R --vanilla to cross-check.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 531 *
Subject: Possible bug in factor
From: Murray Smith <mh.smith@auckland.ac.nz>
Date: Wed, 03 May 2000 11:48:35 +1200
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 531 <==
From mh.smith@auckland.ac.nz  Wed May  3 01:46:32 2000
Received: from stat.math.ethz.ch (daemon@hypatia.ethz.ch [129.132.58.23])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id BAA17691
	for <R-bugs@biostat.ku.dk>; Wed, 3 May 2000 01:46:31 +0200 (MET DST)
Received: (from daemon@localhost)
	by stat.math.ethz.ch (8.9.1/8.9.1) id BAA00423
	for <r-bugs@hypatia.math.ethz.ch>; Wed, 3 May 2000 01:46:48 +0200 (MET DST)
Received: from mailhost.auckland.ac.nz(130.216.1.4)
 via SMTP by hypatia, id smtpdAAAa0006.; Wed May  3 01:46:42 2000
Received: from esu1.auckland.ac.nz (esu1.auckland.ac.nz [130.216.208.1])
	by mailhost.auckland.ac.nz (8.9.2/8.9.2/8.9.2-ua) with ESMTP id LAA09755
	for <@mailhost.auckland.ac.nz:r-bugs@hypatia.math.ethz.ch>; Wed, 3 May 2000 11:46:36 +1200 (NZST)
Received: from auckland.ac.nz (esp7 [130.216.208.107]) by esu1.auckland.ac.nz (980427.SGI.8.8.8/980728.SGI.AUTOCF) via ESMTP id LAA51851 for <r-bugs@lists.r-project.org>; Wed, 3 May 2000 11:46:34 +1200 (NZT)
Message-ID: <390F6953.4C5999C3@auckland.ac.nz>
Date: Wed, 03 May 2000 11:48:35 +1200
From: Murray Smith <mh.smith@auckland.ac.nz>
Organization: University of Auckland
X-Mailer: Mozilla 4.5 [en] (WinNT; I)
X-Accept-Language: en
MIME-Version: 1.0
To: r-bugs@stat.math.ethz.ch
Subject: Possible bug in factor
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

The expressions

> x<-factor(x)

and

> class(x)<-"factor"

behave differently when x is already an ordered factor.  It may not be a
bug but it caught me out when I was trying to remove the "orderedness"
from a factor variable. The following R code illustrates the difference.
Is this difference between the 2 commands desirable?

> x<-1:3
> class(x)
NULL
> x<-ordered(x)
> class(x)
[1] "ordered" "factor"
> x<-factor(x)
> class(x)
[1] "ordered" "factor"
> class(x)<-"factor"
> class(x)
[1] "factor"

Murray Smith

--
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Murray H. Smith,      Senior Lecturer in Engineering Statistics
Engineering Science Department
The University of Auckland
Private Bag 92019
Auckland
New Zealand
Phone: +64 9 373 7599 x4517, Fax: +64 9 373 7468
email: mh.smith@auckland.ac.nz
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++



==> 531.reply.1 <==
From thomas@biostat.washington.edu  Wed May  3 02:06:05 2000
Received: from mail.biostat.washington.edu (mail.biostat.washington.edu [128.95.113.21])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id CAA17731
	for <R-bugs@biostat.ku.dk>; Wed, 3 May 2000 02:06:04 +0200 (MET DST)
Received: from mail.biostat.washington.edu (mail.biostat.washington.edu [128.95.113.21])
	by mail.biostat.washington.edu (8.9.3+Sun/8.9.1-fetrow-99-05-16b) with ESMTP id RAA11509;
	Tue, 2 May 2000 17:05:51 -0700 (PDT)
Date: Tue, 2 May 2000 17:05:51 -0700 (PDT)
From: Thomas Lumley <thomas@biostat.washington.edu>
To: mh.smith@auckland.ac.nz
cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] Possible bug in factor (PR#531)
In-Reply-To: <200005022346.BAA17701@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.21.0005021656010.6086-100000@mail.biostat.washington.edu>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Wed, 3 May 2000 mh.smith@auckland.ac.nz wrote:

> The expressions
> 
> > x<-factor(x)
> 
> and
> 
> > class(x)<-"factor"
> 
> behave differently when x is already an ordered factor.  It may not be a
> bug but it caught me out when I was trying to remove the "orderedness"
> from a factor variable. The following R code illustrates the difference.
> Is this difference between the 2 commands desirable?

Yes.  factor, like as.factor, turns its argument into a factor. As it
already is a factor this doesn't do anything. 

class(x)<-"factor" says that x is a factor and has no other class.  In
general it is a bad idea to explicitly set the class of a variable
like this (except when you're constructing the object).  This is for two
reasons. One, you usually don't want to remove other classes. Two, x may
not be a factor, and just setting its class to "factor" may leave it in an
inconsistent state. 
Eg
> x<-1:10
> class(x)<-"factor"
> x
NULL
Levels:

In this particular case you know that x has class c("ordered","factor")
and that you want it to have class "factor", so it is harmless. It still
may be unnecessary -- eg if you just want it to have treatment contrasts
rather than polynomial contrasts you can use C() or constrasts()<-.

	-thomas

Thomas Lumley
Assistant Professor, Biostatistics
University of Washington, Seattle


==> 531.reply.2 <==
From pd@blueberry.kubism.ku.dk  Wed May  3 07:44:12 2000
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id HAA18291
	for <R-bugs@biostat.ku.dk>; Wed, 3 May 2000 07:44:12 +0200 (MET DST)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.9.3/8.9.3) id HAA22303;
	Wed, 3 May 2000 07:49:26 +0200
Sender: pd@blueberry.kubism.ku.dk
To: Thomas Lumley <thomas@biostat.washington.edu>
Cc: mh.smith@auckland.ac.nz, r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] Possible bug in factor (PR#531)
References: <Pine.GSO.4.21.0005021656010.6086-100000@mail.biostat.washington.edu>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 03 May 2000 07:49:26 +0200
In-Reply-To: Thomas Lumley's message of "Tue, 2 May 2000 17:05:51 -0700 (PDT)"
Message-ID: <x2zoq889p5.fsf@blueberry.kubism.ku.dk>
Lines: 31
X-Mailer: Gnus v5.7/Emacs 20.5
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

Thomas Lumley <thomas@biostat.washington.edu> writes:

> In this particular case you know that x has class c("ordered","factor")
> and that you want it to have class "factor", so it is harmless. It still
> may be unnecessary -- eg if you just want it to have treatment contrasts
> rather than polynomial contrasts you can use C() or constrasts()<-.

We do have a problem in the documentation:

The default for factor is ordered=FALSE according to the help page but

> factor(ordered(4:1),ordered=F)
[1] 4 3 2 1
Levels:  1 2 3 4 
> factor(ordered(4:1))
[1] 4 3 2 1
Levels:  1 < 2 < 3 < 4 

and the actual function definition says

function (x, levels = sort(unique(x), na.last = TRUE),
                    labels=levels, exclude = NA, ordered =
                    is.ordered(x))



-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 531.reply.3 <==
From maechler@stat.math.ethz.ch  Wed May  3 09:39:02 2000
Received: from stat.math.ethz.ch (daemon@hypatia.ethz.ch [129.132.58.23])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id JAA19683;
	Wed, 3 May 2000 09:39:01 +0200 (MET DST)
Received: (from daemon@localhost)
	by stat.math.ethz.ch (8.9.1/8.9.1) id JAA18670;
	Wed, 3 May 2000 09:38:48 +0200 (MET DST)
Received: from lynne(129.132.58.30), claiming to be "lynne.ethz.ch"
 via SMTP by hypatia, id smtpdAAAa004Zg; Wed May  3 09:38:46 2000
Received: (maechler@localhost) by lynne.ethz.ch (8.9.3/D-MATH-client) id JAA02692; Wed, 3 May 2000 09:38:46 +0200
X-Authentication-Warning: lynne.ethz.ch: maechler set sender to maechler@stat.math.ethz.ch using -f
From: Martin Maechler <maechler@stat.math.ethz.ch>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Message-ID: <14607.55173.968286.549995@lynne.ethz.ch>
Date: Wed, 3 May 2000 09:38:45 +0200 (CEST)
To: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Cc: Thomas Lumley <thomas@biostat.washington.edu>, mh.smith@auckland.ac.nz,
        r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] Possible bug in factor (PR#531)
In-Reply-To: <x2zoq889p5.fsf@blueberry.kubism.ku.dk>
References: <Pine.GSO.4.21.0005021656010.6086-100000@mail.biostat.washington.edu>
	<x2zoq889p5.fsf@blueberry.kubism.ku.dk>
X-Mailer: VM 6.75 under Emacs 20.6.1
Reply-To: Martin Maechler <maechler@stat.math.ethz.ch>

>>>>> "PD" == Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

    PD> Thomas Lumley <thomas@biostat.washington.edu> writes:
    >> In this particular case you know that x has class
    >> c("ordered","factor") and that you want it to have class "factor",
    >> so it is harmless. It still may be unnecessary -- eg if you just
    >> want it to have treatment contrasts rather than polynomial contrasts
    >> you can use C() or constrasts()<-.

    PD> We do have a problem in the documentation:

    PD> The default for factor is ordered=FALSE according to the help page
    PD> but

    >> factor(ordered(4:1),ordered=F)
    PD> [1] 4 3 2 1 Levels: 1 2 3 4
    >> factor(ordered(4:1))
    PD> [1] 4 3 2 1 Levels: 1 < 2 < 3 < 4

    PD> and the actual function definition says

    PD> function (x, levels = sort(unique(x), na.last = TRUE),
    PD> labels=levels, exclude = NA, ordered = is.ordered(x))

I've fixed the docu for "r-release" [1.0.2 if ever].

BTW:  A branch merge would come handy...
      (should I try, using instructions on the R-developers' page?)

Martin

==> 531.followup.1 <==
From mh.smith@auckland.ac.nz  Thu May  4 05:25:32 2000
Received: from mailhost.auckland.ac.nz (mailhost.auckland.ac.nz [130.216.1.4] (may be forged))
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id FAA29586;
	Thu, 4 May 2000 05:25:24 +0200 (MET DST)
Received: from esu1.auckland.ac.nz (esu1.auckland.ac.nz [130.216.208.1])
	by mailhost.auckland.ac.nz (8.9.2/8.9.2/8.9.2-ua) with ESMTP id PAA23180;
	Thu, 4 May 2000 15:25:40 +1200 (NZST)
Received: from auckland.ac.nz (esp7 [130.216.208.107]) by esu1.auckland.ac.nz (980427.SGI.8.8.8/980728.SGI.AUTOCF) via ESMTP id PAA78911; Thu, 4 May 2000 15:25:27 +1200 (NZT)
Message-ID: <3910EE24.E64A79DA@auckland.ac.nz>
Date: Thu, 04 May 2000 15:27:32 +1200
From: Murray Smith <mh.smith@auckland.ac.nz>
Organization: University of Auckland
X-Mailer: Mozilla 4.5 [en] (WinNT; I)
X-Accept-Language: en
MIME-Version: 1.0
To: Martin Maechler <maechler@stat.math.ethz.ch>
CC: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>,
        Thomas Lumley <thomas@biostat.washington.edu>,
        r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] Possible bug in factor (PR#531)
References: <Pine.GSO.4.21.0005021656010.6086-100000@mail.biostat.washington.edu>
		<x2zoq889p5.fsf@blueberry.kubism.ku.dk> <14607.55173.968286.549995@lynne.ethz.ch>
Content-Type: multipart/alternative;
 boundary="------------24483C2DB55E1A8493E7697F"


--------------24483C2DB55E1A8493E7697F
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

Hi all,

The problem arose when I had a data frame in which all the factor variables
were declared to be ordered (although some of them clearly should not have been
ordered).  For future analyses using the frame I wanted to correct the classes
of the those factors.  This was because I wished to use Helmert contrasts
rather than polynomial contrasts in the future analyses. I decided to correct
the class of these factors by using
> x<-factor(x)
Although I didn't say so in my bug report, I got into trouble by assuming,
according to the documentation (as Peter Dalgaard pointed out), that the
default value of the parameter ordered in factor() was FALSE.  I reassembled
the data frame and still found that polynomial contrasts were being used for
all factors.

By the way as.factor() behaves in the same way as factor().

The issue comes down to that of whether the class "factor" and the class
c("factor","ordered") are nested or disjoint in relation to the functions
factor(), as.factor(), class().

In R we have 2 kinds of factor, unordered and ordered. A vector is made an
unordered factor by the function factor() and an ordered factor by the function
ordered(). That is unless the vector is already an ordered factor. Then
factor() does not create an unordered factor.  Why is it so much more difficult
to convert an ordered factor to an unordered factor than vice versa?  No good
reason. The semantics of representing the 2 types of factor by the class
"factor" and the class c("factor","ordered") have got in the way. We certainly
want both types to be of class "factor" so that is.factor() is TRUE for both,
but it is wrong to think of ordered factors as somehow nested in unordered
factors just because of the way the classes are represented in R.

I suggest that it is natural to have the default value of FALSE for the
parameter ordered in the functions factor() and as.factor()and I would make a
plea for that to be reimplemented (since the current manual entry for factor()
probably represents what the situation was once).

Murray

--
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Murray H. Smith,      Senior Lecturer in Engineering Statistics
Engineering Science Department
The University of Auckland
Private Bag 92019
Auckland
New Zealand
Phone: +64 9 373 7599 x4517, Fax: +64 9 373 7468
email: mh.smith@auckland.ac.nz
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++


--------------24483C2DB55E1A8493E7697F
Content-Type: text/html; charset=us-ascii
Content-Transfer-Encoding: 7bit

<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
Hi all,
<p>The problem arose when I had a data frame in which all the factor variables
were declared to be ordered (although some of them clearly should not have
been ordered).&nbsp; For future analyses using the frame I wanted to correct
the classes of the those factors.&nbsp; This was because I wished to use
Helmert contrasts rather than polynomial contrasts in the future analyses.
I decided to correct the class of these factors by using
<br><tt>> x&lt;-factor(x)</tt>
<br>Although I didn't say so in my bug report, I got into trouble by assuming,
according to the documentation (as Peter Dalgaard pointed out), that the
default value of the parameter <tt>ordered</tt> in <tt>factor()</tt> was
<tt>FALSE.</tt>&nbsp; I reassembled the data frame and still found that
polynomial contrasts were being used for all factors.
<p>By the way <tt>as.factor()</tt> behaves in the same way as <tt>factor()</tt>.
<p>The issue comes down to that of whether the <tt>class</tt> <tt>"factor"</tt>
and the <tt>class c("factor","ordered")</tt> are nested or disjoint in
relation to the functions <tt>factor(), as.factor(), class()</tt>.
<p>In R we have 2 kinds of factor, unordered and ordered. A vector is made
an unordered factor by the function <tt>factor()</tt> and an ordered factor
by the function <tt>ordered()</tt>. That is unless the vector is already
an ordered factor. Then <tt>factor()</tt> does not create an unordered
factor.&nbsp; Why is it so much more difficult to convert an ordered factor
to an unordered factor than vice versa?&nbsp; No good reason. The semantics
of representing the 2 types of factor by the <tt>class</tt> <tt>"factor"</tt>
and the <tt>class c("factor","ordered")</tt> have got in the way. We certainly
want both types to be of <tt>class "factor"</tt> so that <tt>is.factor()</tt>
is <tt>TRUE</tt> for both, but it is wrong to think of ordered factors
as somehow nested in unordered factors just because of the way the classes
are represented in R.
<p>I suggest that it is natural to have the default value of <tt>FALSE</tt>
for the parameter <tt>ordered</tt> in the functions <tt>factor()</tt> and
<tt>as.factor()</tt>and I would make a plea for that to be reimplemented
(since the current manual entry for <tt>factor()</tt> probably represents
what the situation was once).
<p>Murray
<p>--
<br>+++++++++++++++++++++++++++++++++++++++++++++++++++++++++
<br>Murray H. Smith,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Senior Lecturer in Engineering
Statistics
<br>Engineering Science Department
<br>The University of Auckland
<br>Private Bag 92019
<br>Auckland
<br>New Zealand
<br>Phone: +64 9 373 7599 x4517, Fax: +64 9 373 7468
<br>email: mh.smith@auckland.ac.nz
<br>+++++++++++++++++++++++++++++++++++++++++++++++++++++++++
<br>&nbsp;</html>

--------------24483C2DB55E1A8493E7697F--

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 530 *
Subject: rpois hangs
From: kjetikj@astro.uio.no
Date: Sun, 30 Apr 2000 21:01:02 +0200 (MET DST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 530 <==
From kjetikj@astro.uio.no  Sun Apr 30 21:01:03 2000
Received: from localhost (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id VAA28600
	for <R-bugs@biostat.ku.dk>; Sun, 30 Apr 2000 21:01:02 +0200 (MET DST)
Date: Sun, 30 Apr 2000 21:01:02 +0200 (MET DST)
From: kjetikj@astro.uio.no
Message-Id: <200004301901.VAA28600@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: rpois hangs

Full_Name: Kjetil Kjernsmo
Version: Version 1.0.0
OS: osf1
Submission from: (NULL) (129.240.28.227)


Dear all,

I have come across another really strange bug in rpois.
If I do
> rpois(1, 1000000 * rpois(1, 10000))
sometimes it hangs, and hangs...
On my XP1000 alphaev6 workstation, it seems to happen more 
frequently than on other machines. I started a session on an older 
computer, and from the start, it looks like this:
> rpois(1, 1000000 * rpois(1, 10000))
[1] 1537190728
> ^[[A
Error: syntax error [whoops, I'm usually using ESS]
> rpois(1, 1000000 * rpois(1, 10000))
[1] 1507263999
> rpois(1000, 1000000 * rpois(1000, 10000))          
[hanged here, killed with ^C]

> rpois(1, 1000000 * rpois(1, 10000))
[1] 1463075843
> rpois(1, 1000000 * rpois(1, 10000))
[1] 1438068697
> rpois(1, 1000000 * rpois(1, 10000))
[hanging]

I think this is strange, because I've been doing this stuff 
a lot lately, but usually with a rather small parameter to the 
second rpois.  

Kjetil

==> 530.reply.1 <==
From pd@blueberry.kubism.ku.dk  Sun Apr 30 21:36:38 2000
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id VAA28680
	for <R-bugs@biostat.ku.dk>; Sun, 30 Apr 2000 21:36:37 +0200 (MET DST)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.9.3/8.9.3) id VAA18036;
	Sun, 30 Apr 2000 21:41:36 +0200
Sender: pd@blueberry.kubism.ku.dk
To: kjetikj@astro.uio.no
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] rpois hangs (PR#530)
References: <200004301901.VAA28610@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 30 Apr 2000 21:41:36 +0200
In-Reply-To: kjetikj@astro.uio.no's message of "Sun, 30 Apr 2000 21:01:04 +0200 (MET DST)"
Message-ID: <x2ya5vcr67.fsf@blueberry.kubism.ku.dk>
Lines: 31
X-Mailer: Gnus v5.7/Emacs 20.5
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

kjetikj@astro.uio.no writes:

> I have come across another really strange bug in rpois.
> If I do
> > rpois(1, 1000000 * rpois(1, 10000))
> sometimes it hangs, and hangs...
> On my XP1000 alphaev6 workstation, it seems to happen more 
> frequently than on other machines. I started a session on an older 
........
> > rpois(1, 1000000 * rpois(1, 10000))
> [hanging]
> 
> I think this is strange, because I've been doing this stuff 
> a lot lately, but usually with a rather small parameter to the 
> second rpois.  

On Intel, that consistently gives

>  rpois(1, 1000000 * rpois(1, 10000))
[1] -2147483648

I.e. signs of integer overflow. Apparently you partly get away with it
on a 64 bit machine, but I'm not surprised you get into regimes that
are not well tested by the poor developers working on hardware from
the bygone millennium....

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 530.followup.1 <==
From kjetikj@astro.uio.no  Sun Apr 30 21:57:40 2000
Received: from mons.uio.no (7411@mons.uio.no [129.240.130.14])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id VAA28753;
	Sun, 30 Apr 2000 21:57:39 +0200 (MET DST)
Received: from alnair.uio.no ([129.240.28.227])
	by mons.uio.no with esmtp (Exim 2.12 #7)
	id 12lzqp-00044W-00; Sun, 30 Apr 2000 21:57:59 +0200
Received: from localhost ([127.0.0.1])
	by alnair.uio.no with esmtp (Exim 2.12 #1)
	id 12lzqp-0005yZ-00; Sun, 30 Apr 2000 21:57:59 +0200
Date: Sun, 30 Apr 2000 21:57:59 +0200 (MET DST)
From: Kjetil Kjernsmo <kjetil.kjernsmo@astro.uio.no>
X-Sender: kjetikj@alnair.uio.no
To: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] rpois hangs (PR#530)
In-Reply-To: <x2ya5vcr67.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.OSF.4.05.10004302139190.20697-100000@alnair.uio.no>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On 30 Apr 2000, Peter Dalgaard BSA wrote:

>On Intel, that consistently gives
>
>>  rpois(1, 1000000 * rpois(1, 10000))
>[1] -2147483648
>
>I.e. signs of integer overflow.

Aha!

> Apparently you partly get away with it
>on a 64 bit machine, but I'm not surprised you get into regimes that
>are not well tested by the poor developers working on hardware from
>the bygone millennium....

:-) Whaddayamean "bygone", you're speaking to an astronomer here, you
know... :-) Anyway, if I can put my hardware to use, I'd be happy to do
so, just give me some detailed instructions.

Best,

Kjetil
-- 
Kjetil Kjernsmo
Graduate astronomy-student                    Problems worthy of attack
University of Oslo, Norway            Prove their worth by hitting back
E-mail: kjetikj@astro.uio.no                                - Piet Hein
Homepage <URL:http://www.astro.uio.no/~kjetikj/>
Webmaster@skepsis.no 


==> 530.reply.2 <==
From maechler@stat.math.ethz.ch  Tue May  2 12:12:21 2000
Received: from stat.math.ethz.ch (daemon@hypatia.ethz.ch [129.132.58.23])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id MAA10821
	for <R-bugs@biostat.ku.dk>; Tue, 2 May 2000 12:12:20 +0200 (MET DST)
Received: (from daemon@localhost)
	by stat.math.ethz.ch (8.9.1/8.9.1) id MAA17727;
	Tue, 2 May 2000 12:12:37 +0200 (MET DST)
Received: from lynne(129.132.58.30), claiming to be "lynne.ethz.ch"
 via SMTP by hypatia, id smtpdAAAa004Kx; Tue May  2 12:12:29 2000
Received: (maechler@localhost) by lynne.ethz.ch (8.9.3/D-MATH-client) id MAA01377; Tue, 2 May 2000 12:12:28 +0200
X-Authentication-Warning: lynne.ethz.ch: maechler set sender to maechler@stat.math.ethz.ch using -f
From: Martin Maechler <maechler@stat.math.ethz.ch>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Message-ID: <14606.43532.609051.863357@lynne.ethz.ch>
Date: Tue, 2 May 2000 12:12:28 +0200 (CEST)
To: kjetikj@astro.uio.no
CC: R-bugs@biostat.ku.dk
Subject: Re: [Rd] rpois hangs (PR#530)
In-Reply-To: <x2ya5vcr67.fsf@blueberry.kubism.ku.dk>
References: <200004301901.VAA28610@pubhealth.ku.dk>
	<x2ya5vcr67.fsf@blueberry.kubism.ku.dk>
X-Mailer: VM 6.75 under Emacs 20.6.1
Reply-To: Martin Maechler <maechler@stat.math.ethz.ch>

>>>>> "PD" == Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

    PD> kjetikj@astro.uio.no writes:
    >> I have come across another really strange bug in rpois.  If I do >
    >> rpois(1, 1000000 * rpois(1, 10000)) sometimes it hangs, and hangs...
    >> On my XP1000 alphaev6 workstation, it seems to happen more
    >> frequently than on other machines. I started a session on an older
    PD> ........
    >> > rpois(1, 1000000 * rpois(1, 10000)) [hanging]
    >> 
    >> I think this is strange, because I've been doing this stuff a lot
    >> lately, but usually with a rather small parameter to the second
    >> rpois.

    PD> On Intel, that consistently gives

    >> rpois(1, 1000000 * rpois(1, 10000))
    PD> [1] -2147483648

    PD> I.e. signs of integer overflow. Apparently you partly get away with
    PD> it on a 64 bit machine, but I'm not surprised you get into regimes
    PD> that are not well tested by the poor developers working on hardware
    PD> from the bygone millennium....

I'm fixing this.  It's clear in the source code (rpois.c) 
that `int's are used in places where they must overflow as soon as  
lambda > ~= .Machine$integer.max

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO D10	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 534 *
Subject: wsfe bug report just made
From: mallen@tntech.edu
Date: Thu, 4 May 2000 19:20:35 +0200 (MET DST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 534 <==
From mallen@tntech.edu  Thu May  4 19:20:35 2000
Received: from localhost (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id TAA11074
	for <R-bugs@biostat.ku.dk>; Thu, 4 May 2000 19:20:35 +0200 (MET DST)
Date: Thu, 4 May 2000 19:20:35 +0200 (MET DST)
From: mallen@tntech.edu
Message-Id: <200005041720.TAA11074@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: wsfe bug report just made

Full_Name: Michael R. Allen
Version: 1.01
OS: linux redhat 6.2
Submission from: (NULL) (149.149.32.46)


Sorry, I forgot to tell you.  I am running version 6.2 of redhat.  Also, I have
loaded the latest version of R as well.

Mike
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 533 *
Subject: acepack, akima and tripack will not load 
From: mallen@tntech.edu
Date: Thu, 4 May 2000 19:18:59 +0200 (MET DST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 533 <==
From mallen@tntech.edu  Thu May  4 19:19:00 2000
Received: from localhost (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id TAA11041
	for <R-bugs@biostat.ku.dk>; Thu, 4 May 2000 19:18:59 +0200 (MET DST)
Date: Thu, 4 May 2000 19:18:59 +0200 (MET DST)
From: mallen@tntech.edu
Message-Id: <200005041718.TAA11041@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: acepack, akima and tripack will not load 

Full_Name: Michael R. Allen
Version: 1.01
OS: linux redhat
Submission from: (NULL) (149.149.32.46)


Hello,

	Thought you might be interested.  I tried to load the package tripack
needed by the sgeostat package.  After some careful searching,  three packages
were 
found which had the same error.  Here is the output.

Mike
  
> library(acepack) Error in dyn.load(x, as.logical(local),
as.logical(now)) :
        unable to load shared library
"/usr/lib/R/library/acepack/libs/acepack.so":
  /usr/lib/R/library/acepack/libs/acepack.so: undefined symbol: e_wsfe 
>library(tripack) Error in dyn.load(x, as.logical(local), as.logical(now))
:
        unable to load shared library
"/usr/lib/R/library/tripack/libs/tripack.so":
  /usr/lib/R/library/tripack/libs/tripack.so: undefined symbol: e_wsfe 
>library(akima) Error in dyn.load(x, as.logical(local), as.logical(now)) :
        unable to load shared library
"/usr/lib/R/library/akima/libs/akima.so":
  /usr/lib/R/library/akima/libs/akima.so: undefined symbol: e_wsfe      

==> 533.followup.1 <==
From ripley@stats.ox.ac.uk  Thu May  4 19:41:38 2000
Received: from toucan.stats.ox.ac.uk (toucan.stats.ox.ac.uk [163.1.20.20])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id TAA11202
	for <R-bugs@biostat.ku.dk>; Thu, 4 May 2000 19:41:35 +0200 (MET DST)
Received: from max126.public.ox.ac.uk (max126.public.ox.ac.uk [192.76.27.126])
	by toucan.stats.ox.ac.uk (8.9.0/8.9.0) with ESMTP id SAA09846;
	Thu, 4 May 2000 18:41:45 +0100 (BST)
Date: Thu, 4 May 2000 18:40:42 +0100 (BST)
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Sender: ripley@auk.stats
To: mallen@tntech.edu
cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] acepack, akima and tripack will not load (PR#533)
In-Reply-To: <200005041719.TAA11051@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.05.10005041827230.26380-100000@auk.stats>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Thu, 4 May 2000 mallen@tntech.edu wrote:

> Full_Name: Michael R. Allen
> Version: 1.01
> OS: linux redhat
> Submission from: (NULL) (149.149.32.46)
> 
> 
> Hello,
> 
> 	Thought you might be interested.  I tried to load the package tripack
> needed by the sgeostat package.  After some careful searching,  three packages
> were 
> found which had the same error.  Here is the output.

> Mike
>   
> > library(acepack) Error in dyn.load(x, as.logical(local),
> as.logical(now)) :
>         unable to load shared library
> "/usr/lib/R/library/acepack/libs/acepack.so":
>   /usr/lib/R/library/acepack/libs/acepack.so: undefined symbol: e_wsfe 
> >library(tripack) Error in dyn.load(x, as.logical(local), as.logical(now))
> :
>         unable to load shared library
> "/usr/lib/R/library/tripack/libs/tripack.so":
>   /usr/lib/R/library/tripack/libs/tripack.so: undefined symbol: e_wsfe 
> >library(akima) Error in dyn.load(x, as.logical(local), as.logical(now)) :
>         unable to load shared library
> "/usr/lib/R/library/akima/libs/akima.so":
>   /usr/lib/R/library/akima/libs/akima.so: undefined symbol: e_wsfe      

That's a symbol from the Fortran I/O code.  There is no problem on RH6.0
on R 1.0.1, where the symbol is resolved from libg2c.a.

(1) Does FLIBS in etc/Makeconf include -lg2c?

(2) If so, do those packages have Makefiles in src? If so delete them
and reinstall.  (The latest version of akima does not, but earlier versions
did.)

(3) Does lg2c include e_wsfe?  (nm -g on it).  Is it finding the right
libg2c.a?

(4) I get nm -g ..../akima.so  giving

00013c5c T e_wsfe

and so I think it should be resolved in the *.so.

Which version of RedHat?  I suspect a RedHat inconsistency here, and other
people have reported that upgrading to the gcc-2.95.2 compiler set
solved the problem.  But it might just be old package versions.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


==> 533.reply.1 <==
From bates@franz.stat.wisc.edu  Thu May  4 19:44:14 2000
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id TAA11222
	for <R-bugs@biostat.ku.dk>; Thu, 4 May 2000 19:44:13 +0200 (MET DST)
Received: by franz.stat.wisc.edu
	via sendmail from stdin
	id <m12nPhM-000ZTOC@franz.stat.wisc.edu> (Debian Smail3.2.0.102)
	for R-bugs@biostat.ku.dk; Thu, 4 May 2000 12:46:04 -0500 (CDT) 
Sender: bates@franz.stat.wisc.edu
To: mallen@tntech.edu
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] acepack, akima and tripack will not load (PR#533)
References: <200005041719.TAA11051@pubhealth.ku.dk>
From: Douglas Bates <bates@stat.wisc.edu>
Date: 04 May 2000 12:46:04 -0500
In-Reply-To: mallen@tntech.edu's message of "Thu, 4 May 2000 19:19:01 +0200 (MET DST)"
Message-ID: <6rog6m2opv.fsf@franz.stat.wisc.edu>
Lines: 12
X-Mailer: Gnus v5.7/Emacs 20.6

mallen@tntech.edu writes:

> > library(acepack) Error in dyn.load(x, as.logical(local),
> as.logical(now)) :
>         unable to load shared library
> "/usr/lib/R/library/acepack/libs/acepack.so":
>   /usr/lib/R/library/acepack/libs/acepack.so: undefined symbol: e_wsfe 

That name e_wsfe probably comes from Fortran input/output routines.
Check if some Fortran code is trying to use a WRITE statement.  I
think there was another message this morning about this.


==> 533.reply.2 <==
From pd@blueberry.kubism.ku.dk  Thu May  4 22:04:44 2000
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id WAA11927
	for <R-bugs@biostat.ku.dk>; Thu, 4 May 2000 22:04:44 +0200 (MET DST)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.9.3/8.9.3) id WAA04273;
	Thu, 4 May 2000 22:10:21 +0200
Sender: pd@blueberry.kubism.ku.dk
To: mallen@tntech.edu
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] wsfe bug report just made (PR#533)
References: <200005041720.TAA11084@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 04 May 2000 22:10:21 +0200
In-Reply-To: mallen@tntech.edu's message of "Thu, 4 May 2000 19:20:36 +0200 (MET DST)"
Message-ID: <x2bt2m13gy.fsf@blueberry.kubism.ku.dk>
Lines: 29
X-Mailer: Gnus v5.7/Emacs 20.5
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

mallen@tntech.edu writes:

> Full_Name: Michael R. Allen
> Version: 1.01
> OS: linux redhat 6.2
> Submission from: (NULL) (149.149.32.46)
> 
> 
> Sorry, I forgot to tell you.  I am running version 6.2 of redhat.  Also, I have
> loaded the latest version of R as well.
> 
> Mike
> 

But did you build the packages yourself and if so, how? (using which
compilers).

BTW: when you follow up on an earlier report via the web interface,
please do it as a follow-up. If you do it by mail, say for PR#533,
please include (PR#533) in the Subject line. That way things get filed
together. (I've fixed the number on this mail)



-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 537 *
Subject: eigen broken on AIX with R-devel?
From: Thomas J Vogels <tov@ece.cmu.edu>
Date: 08 May 2000 12:01:04 -0400
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 537 <==
From tov@ece.cmu.edu  Mon May  8 18:00:51 2000
Received: from ece.cmu.edu (ECE.CMU.EDU [128.2.236.200])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id SAA10501
	for <r-bugs@biostat.ku.dk>; Mon, 8 May 2000 18:00:51 +0200 (MET DST)
Received: from bavaria.ece.cmu.edu (root@BAVARIA.ECE.CMU.EDU [128.2.216.38])
	by ece.cmu.edu (8.9.2/8.8.8) with ESMTP id MAA09223;
	Mon, 8 May 2000 12:01:04 -0400 (EDT)
Received: (from tov@localhost)
	by bavaria.ece.cmu.edu (8.9.3/8.9.3/Debian 8.9.3-21) id MAA00641;
	Mon, 8 May 2000 12:01:04 -0400
Sender: tov@bavaria.ece.cmu.edu
To: r-bugs@biostat.ku.dk
Cc: Thomas Vogels <tov@ece.cmu.edu>
Subject: eigen broken on AIX with R-devel?
Reply-To: Thomas Vogels <tov@ece.cmu.edu>
X-URI: http://www.ece.cmu.edu/~tov
From: Thomas J Vogels <tov@ece.cmu.edu>
Date: 08 May 2000 12:01:04 -0400
Message-ID: <87ln1ldoan.fsf@bavaria.ece.cmu.edu>
Lines: 61
User-Agent: Gnus/5.0803 (Gnus v5.8.3) Emacs/20.5
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii


Hi,  I get the wrong eigen values on an AIX machine with R-devel of 5/3/00.

Here are the results:

R> m <- matrix (c(6.8, 2.4, 2.4, 8.2), nrow=2)
R> m
     [,1] [,2]
[1,]  6.8  2.4
[2,]  2.4  8.2
R> eigen(m)
$values
[1] 19.281403  6.337993

$vectors
          [,1]       [,2]
[1,] 0.1918866  0.9967987
[2,] 0.9967987 -0.1918866


And for comparison, here is what I get on a Sun (with r-stable):

R> m <- matrix (c(6.8, 2.4, 2.4, 8.2), nrow=2)
R> eigen (m)
$values
[1] 10  5

$vectors
     [,1] [,2]
[1,]  0.6  0.8
[2,]  0.8 -0.6


I found this by running "make check" which also stumbles over svd.
Please let me know how I can help to investigate this.

  -tom


--please do not edit the information below--

Version:
 platform = powerpc-ibm-aix4.3.2.0
 arch = powerpc
 os = aix4.3.2.0
 system = powerpc, aix4.3.2.0
 status = Under development (unstable)
 major = 1
 minor = 1.0
 year = 2000
 month = May
 day = 3
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base


-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204


==> 537.reply.1 <==
From pd@blueberry.kubism.ku.dk  Mon May  8 20:41:00 2000
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id UAA11280
	for <R-bugs@biostat.ku.dk>; Mon, 8 May 2000 20:40:59 +0200 (MET DST)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.9.3/8.9.3) id UAA29246;
	Mon, 8 May 2000 20:47:12 +0200
Sender: pd@blueberry.kubism.ku.dk
To: tov@ece.cmu.edu
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] eigen broken on AIX with R-devel? (PR#537)
References: <200005081600.SAA10511@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 08 May 2000 20:47:12 +0200
In-Reply-To: tov@ece.cmu.edu's message of "Mon, 8 May 2000 18:00:52 +0200 (MET DST)"
Message-ID: <x2hfc86frj.fsf@blueberry.kubism.ku.dk>
Lines: 25
X-Mailer: Gnus v5.7/Emacs 20.5
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

tov@ece.cmu.edu writes:

> Hi,  I get the wrong eigen values on an AIX machine with R-devel of 5/3/00.

Hmm. We had a similar report a while back and it turned out to be
system specific. I believe the report was from Chong Gu.

> Version:
>  platform = powerpc-ibm-aix4.3.2.0
>  arch = powerpc
>  os = aix4.3.2.0
>  system = powerpc, aix4.3.2.0
>  status = Under development (unstable)
>  major = 1
>  minor = 1.0
>  year = 2000
>  month = May
>  day = 3
>  language = R

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 537.reply.2 <==
From thomas@biostat.washington.edu  Tue May  9 17:38:55 2000
Received: from mail.biostat.washington.edu (mail.biostat.washington.edu [128.95.113.21])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id RAA21900
	for <R-bugs@biostat.ku.dk>; Tue, 9 May 2000 17:38:54 +0200 (MET DST)
Received: from mail.biostat.washington.edu (mail.biostat.washington.edu [128.95.113.21])
	by mail.biostat.washington.edu (8.9.3+Sun/8.9.1-fetrow-99-05-16b) with ESMTP id IAA05789;
	Tue, 9 May 2000 08:39:05 -0700 (PDT)
Date: Tue, 9 May 2000 08:39:05 -0700 (PDT)
From: Thomas Lumley <thomas@biostat.washington.edu>
To: tov@ece.cmu.edu
cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] eigen broken on AIX with R-devel? (PR#537)
In-Reply-To: <200005081600.SAA10511@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.21.0005090837420.4639-100000@mail.biostat.washington.edu>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Mon, 8 May 2000 tov@ece.cmu.edu wrote:

> 
> Hi,  I get the wrong eigen values on an AIX machine with R-devel of 5/3/00.
> 

When we last saw this bug it was compiler-specific.  gcc/g77 worked but
cc/f77 didn't (and I think gcc/f77 wouldn't even configure). 

I don't think we understand the bug, though.

	-thomas

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 536 *
Subject: Problem with match.arg()
From: kjetikj@astro.uio.no
Date: Sun, 7 May 2000 13:58:21 +0200 (MET DST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 536 <==
From kjetikj@astro.uio.no  Sun May  7 13:58:22 2000
Received: from localhost (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id NAA29341
	for <R-bugs@biostat.ku.dk>; Sun, 7 May 2000 13:58:21 +0200 (MET DST)
Date: Sun, 7 May 2000 13:58:21 +0200 (MET DST)
From: kjetikj@astro.uio.no
Message-Id: <200005071158.NAA29341@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: Problem with match.arg()

Full_Name: Kjetil Kjernsmo
Version: Version 1.0.0
OS: osf1
Submission from: (NULL) (129.240.28.227)


Hello again!

This is a follow-up to my message on R-help about a problem with match.arg()
I have a little more on the topic, but not much really. 

First, it was not entirely true what I wrote in r-help that I call match.arg()
in my ramp(), because ramp() just calls qamp() with runif() as argument, but 
I have found that it happens both in ramp() and qamp().

Last night, just before I went home, R crashed with a segmentation fault. 
Unfortunately, I had limit coredumpsize 0, because I seldom want core-files,
so I haven't got it. I have removed that limit now. I have not been able to 
reproduce the crash, however.

Now, for a
> last.dump
$"apply(cbind(rep(1e+05, 25000)), 1, lineprofile, 10, 100, 1, "point")"
<environment: 140e187f0>

$"FUN(newX[, i], ...)"
<environment: 1404b6608>

$"apply(cbind(-as.integer(numberofbins/2):as.integer(numberofbins/2)), "
<environment: 1404b5460>

$"FUN(newX[, i], ...)"
<environment: 1400f6798>

$"photonsdetectedbin(ncb, intensityfromcloud(ncb, intensityfromcloud, "
<environment: 1400f55c8>

$"sum(rpois(ncloudsbin, sensitivity * intensityfromcloud))"
<environment: 1400f53e8>

$"rpois(ncloudsbin, sensitivity * intensityfromcloud)"
<environment: 1400f5168>

$"intensityfromcloud(ncb, intensityfromcloud, exptime, amptype)"
<environment: 1400f4c68>

$"ramp(ncloudsbin, amptype)"
<environment: 1400f4920>

$"qamp(runif(n), type)"
<environment: 1400ebdc0>

$"match.arg(type)"
<environment: 1400e97f0>

$"all(arg == choices)"
<environment: 140e2d740>

attr(,"error.message")
[1] "Error in arg == choices : comparison (1) is possible only for vector
types\n"
attr(,"class")
[1] "dump.frames"

I have also inserted some print statements at some places in the code. First:
qamp <- function(p,  type=c("point", "nolens"))
{
  print(c(2,type))
  type <- match.arg(type)
  if(type == "point")
    return(1 / (2 * sqrt(1 - p)))
  else return(1)
}
  
ramp <- function(n, type=c("point", "nolens"))
{
  print(c(1,type))
  type <- match.arg(type)
  if(type == "point")
    return(qamp(runif(n), type))
  else return(rep(1, n))
}
(I'll rewrite these to use switch eventually).

And, also in match.arg():
match.arg <- function (arg, choices) {
    if (missing(choices)) {
	formal.args <- formals(sys.function(sys.parent()))
	choices <- eval(formal.args[[deparse(substitute(arg))]])
    }
    print(c(2, arg, choices))
    if (all(arg == choices)) return(choices[1])
[...]
Upon running, I get
[1] "1"     "point"
[1] "point"  "point"  "nolens"
[1] "2"     "point"
[1] "point"  "point"  "nolens"
[thousands of these... :-) ]
[1] "1"     "point"
[1] "point"  "point"  "nolens"
[1] "2"     "point"
[1] "point"  "point"  "nolens"
[1] "1"     "point"
[1] "point"  "point"  "nolens"
[1] "2"     "point"
[1] "point"
Error in arg == choices : comparison (1) is possible only for vector types
So, suddenly, "choices" doesn't have a value, and consequently, the error.
FWIW, I have also printed formals(qamp)$type inside qamp, and it has the 
right value. 

Now, it seems hard to reproduce, I just did 100000 runs of ramp(10000, "point")

directly with no problems. In my code, ramp is called by a function that is
called
by a function, that is... :-) 

However, the code isn't very involved, really, so if you want to try, here it
is:
ncloudsbin <- function(binno, ntotalclouds, numberofbins = 100,
                       linewidth = numberofbins / 6)
  return(ntotalclouds * dnorm(binno, sd = linewidth))

intensityfromcloud <- function(ncloudsbin, cloudintensity, exptime, amptype)
  return(cloudintensity * exptime * ramp(ncloudsbin, amptype))

photonsdetectedbin <- function(ncloudsbin, intensityfromcloud,
                               continuumintensity, exptime, amptype,
                               sensitivity)
  return(sum(rpois(ncloudsbin, sensitivity * intensityfromcloud))
         + rgeom(1, 1 /(1 + (sensitivity * exptime * continuumintensity))))



lineprofile <- function(ntotalclouds, intensityfromcloud, continuumintensity,
                        exptime, amptype, sensitivity = 0.1, numberofbins =
100,
                        linewidth = numberofbins / 6)
{
  tf <- function(binno, ntotalclouds, intensityfromcloud, continuumintensity,
                 exptime, amptype, sensitivity, numberofbins, linewidth)
  {
    ncb <- ncloudsbin(binno, ntotalclouds, numberofbins, linewidth)
    return(photonsdetectedbin(ncb,
                   intensityfromcloud(
                            ncb, intensityfromcloud, exptime, amptype),
                   continuumintensity, exptime, amptype, sensitivity))
  }
  return(apply(cbind(-as.integer(numberofbins/2):as.integer(numberofbins/2)),
               1, tf,
               ntotalclouds, intensityfromcloud, continuumintensity,
               exptime, amptype, sensitivity, numberofbins, linewidth)) 
}

Note that "amptype" is here the "type" of the ?amp-functions. 
I call this by e.g. 
ll25000 <- apply(cbind(rep(100000, 25000)), 1, lineprofile, 10, 100, 1,
"point")


Just an idea: I have some problems in an entirely unrelated and more involved 
piece of code where it seems like sometimes, arguments are not returned from a 
function, that is, one variable of an object suddenly has no value. I haven't
really figured out if that is a bug of mine or in R, but could it be possible 
that something in
	formal.args <- formals(sys.function(sys.parent()))
	choices <- eval(formal.args[[deparse(substitute(arg))]])
doesn't get a value because there is an error in how objects are returned 
from a function?

BTW, I was exiting R (my ESS buffer was getting rather large), and I got the
following:
Save workspace image? [y/n/c]: y
Error: NewWriteItem: unknown type 17

Well, I guess this isn't much go on, but I know you are really good at this!
By running the above code, the error happens on every run here, it is just a
matter
of letting it run for long enough. I hope it is something to start on. I have a
few
more last.dumps on file too, if they are of use.

Kjetil

==> 536.reply.1 <==
From pd@blueberry.kubism.ku.dk  Mon May  8 00:35:02 2000
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id AAA00947
	for <R-bugs@biostat.ku.dk>; Mon, 8 May 2000 00:35:02 +0200 (MET DST)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.9.3/8.9.3) id AAA28561;
	Mon, 8 May 2000 00:41:09 +0200
Sender: pd@blueberry.kubism.ku.dk
To: kjetikj@astro.uio.no
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] Problem with match.arg() (PR#536)
References: <200005071158.NAA29351@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 08 May 2000 00:41:09 +0200
In-Reply-To: kjetikj@astro.uio.no's message of "Sun, 7 May 2000 13:58:23 +0200 (MET DST)"
Message-ID: <x2u2gac7ay.fsf@blueberry.kubism.ku.dk>
Lines: 22
X-Mailer: Gnus v5.7/Emacs 20.5
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

kjetikj@astro.uio.no writes:

> Full_Name: Kjetil Kjernsmo
> Version: Version 1.0.0
> OS: osf1
> Submission from: (NULL) (129.240.28.227)
> 
...
> BTW, I was exiting R (my ESS buffer was getting rather large), and I got the
> following:
> Save workspace image? [y/n/c]: y
> Error: NewWriteItem: unknown type 17

That one was fixed in 1.0.1, I believe. (Perhaps you should upgrade
and see if the other problem goes away too... I don't see anything
obviously relevant in the NEWS file though)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 535 *
Subject:  axis() deficiency 
From: William.Venables@cmis.CSIRO.AU (Bill Venables)
Date: Sat, 6 May 2000 10:33:32 +1000 (EST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 535 <==
From William.Venables@cmis.CSIRO.AU  Sat May  6 06:01:50 2000
Received: from snowy.nsw.cmis.CSIRO.AU (snowy.nsw.cmis.CSIRO.AU [130.155.16.108])
	by pubhealth.ku.dk (8.9.3/8.9.1) with SMTP id GAA26229
	for <r-bugs@biostat.ku.dk>; Sat, 6 May 2000 06:01:42 +0200 (MET DST)
Received: by snowy.nsw.cmis.CSIRO.AU (SMI-8.6/SMI-SVR4)
	id OAA22516; Sat, 6 May 2000 14:01:21 +1000
From: William.Venables@cmis.CSIRO.AU (Bill Venables)
Received: from acland.qld.cmis.csiro.au(192.231.212.92)
 via SMTP by snowy.nsw.cmis.CSIRO.AU, id smtpdAAAa005Vj; Sat May  6 14:01:17 2000
Received: (from venables@localhost)
	by acland.qld.cmis.CSIRO.AU (8.9.3+Sun/8.9.3) id KAA03889;
	Sat, 6 May 2000 10:33:32 +1000 (EST)
Date: Sat, 6 May 2000 10:33:32 +1000 (EST)
Message-Id: <200005060033.KAA03889@acland.qld.cmis.CSIRO.AU>
To: r-bugs@biostat.ku.dk
Cc: William.Venables@cmis.CSIRO.AU
Subject:  axis() deficiency 

This is more a deficiency than a bug.  The axis() function does
not seem to allow an axis to be placed internally on the plot (as
allowed by the argument pos to the corresponding S function).

The help information nevertheless has some reference to
"position" of the axis, (as well as side) as if there were some
choice about position other than side.

Bill Venables.


--please do not edit the information below--

Version:
 platform = sparc-sun-solaris2.7
 arch = sparc
 os = solaris2.7
 system = sparc, solaris2.7
 status = 
 major = 1
 minor = 0.1
 year = 2000
 month = April
 day = 14
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
